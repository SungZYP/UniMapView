/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{i as n,o as t,isAborted as r,createAbortError as o,onAbort as s}from"./promiseUtils.js";import{m as i,h as e}from"../chunks/handleUtils.js";import{r as u}from"./lang.js";import{a as c}from"../chunks/watch.js";export{b as autorun}from"../chunks/watch.js";import"./Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/ArrayPool.js";import"./scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";function l(n,t,r={}){return f(n,t,r,k)}function m(n,t,r={}){return f(n,t,r,g)}function f(n,t,r={},o){let s=null;const i=r.once?(n,r)=>{o(n)&&(u(s),t(n,r))}:(n,r)=>{o(n)&&t(n,r)};if(s=c(n,i,r.sync,r.equals),r.initial){const t=n();i(t,t)}return s}function a(r,o,s,e={}){let c=null,m=null,f=null;function a(){c&&m&&(m.remove(),null==e.onListenerRemove||e.onListenerRemove(c),c=null,m=null)}function j(n){e.once&&e.once&&u(f),s(n)}const p=l(r,((r,s)=>{a(),n(r)&&(c=r,m=t(r,o,j),null==e.onListenerAdd||e.onListenerAdd(r))}),{sync:e.sync,initial:!0});return f=i((()=>{p.remove(),a()})),f}function j(n,t){return h(n,null,t)}function p(n,t){return h(n,g,t)}function h(n,t,i){if(r(i))return Promise.reject(o());const c=n();if(null!=t&&t(c))return Promise.resolve(c);let l=null;function m(){l=u(l)}return new Promise(((r,u)=>{l=e([s(i,(()=>{m(),u(o())})),f(n,(n=>{m(),r(n)}),{sync:!1,once:!0},null!=t?t:k)])}))}function k(n){return!0}function g(n){return!!n}const y={sync:!0},d={initial:!0},v={sync:!0,initial:!0};export{d as initial,a as on,j as once,y as sync,v as syncAndInitial,l as watch,m as when,p as whenOnce};
