/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import{x as s,b as t}from"../../core/lang.js";import{aliasOf as i}from"../../core/accessorSupport/decorators/aliasOf.js";import{cast as r}from"../../core/accessorSupport/decorators/cast.js";import{property as n}from"../../core/accessorSupport/decorators/property.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import l from"../Widget.js";import"../../chunks/widgetUtils.js";import{m as a}from"../../chunks/messageBundle.js";import"../../chunks/Logger.js";import{t as c}from"../../chunks/jsxFactory.js";import p from"./SnappingControls/SnappingControlsViewModel.js";import"../../config.js";import"../../chunks/object.js";import"../../chunks/string.js";import"../../chunks/ensureType.js";import"../../chunks/get.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../chunks/metadata.js";import"../../core/Error.js";import"../../chunks/tracking.js";import"../../intl.js";import"../../chunks/number.js";import"../../chunks/jsonMap.js";import"../../chunks/locale.js";import"../../chunks/messages.js";import"../../core/promiseUtils.js";import"../../request.js";import"../../kernel.js";import"../../core/urlUtils.js";import"../../chunks/assets.js";import"../../chunks/deprecate.js";import"../../chunks/domUtils.js";import"../../chunks/Evented.js";import"../../core/Accessor.js";import"../../chunks/ArrayPool.js";import"../../chunks/watch.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../core/Handles.js";import"../../core/Collection.js";import"../../chunks/shared.js";import"../../chunks/Promise.js";import"../../core/reactiveUtils.js";import"../../chunks/uuid.js";import"../../chunks/projector.js";import"../../chunks/jsxWidgetSupport.js";import"../../chunks/widgetThemeUtils.js";import"../../core/HandleOwner.js";import"../../core/watchUtils.js";import"../../chunks/layerListUtils.js";import"../../views/interactive/snapping/FeatureSnappingLayerSource.js";import"../LayerList/LayerListViewModel.js";import"../LayerList/ListItem.js";import"../../chunks/Identifiable.js";import"../../support/actions/ActionBase.js";import"../../support/actions/ActionButton.js";import"../../chunks/ActionSlider.js";import"../../support/actions/ActionToggle.js";import"../LayerList/ListItemPanel.js";import"./widget.js";import"../../chunks/accessibleHandler.js";import"../../chunks/vmEvent.js";const d={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},h="esri-snapping-controls",m="esri-snapping-controls__container",u="esri-snapping-controls__panel",g="esri-snapping-controls__toggle-block",b="esri-snapping-controls__layer-list-block",j="esri-snapping-controls__layer-list",w="esri-snapping-controls__nested-container",k="esri-widget";let v=class extends l{constructor(e,s){super((()=>{const{view:s,viewModel:t,snappingOptions:i,...r}=e;return r})(),s),this.label=void 0,this.messages=null,this.messagesCommon=null,this.snappingOptions=null,this.view=null,this.visibleElements={...d},this._defaultViewModel=null,null!=e&&e.viewModel?this.viewModel=e.viewModel:(this._defaultViewModel=new p({snappingOptions:e.snappingOptions,view:e.view}),this.viewModel=this._defaultViewModel)}destroy(){this._defaultViewModel=s(this._defaultViewModel)}loadDependencies(){return Promise.all([import("../../chunks/calcite-action.js"),import("../../chunks/calcite-block.js"),import("../../chunks/calcite-icon.js"),import("../../chunks/calcite-label.js"),import("../../chunks/calcite-panel.js"),import("../../chunks/calcite-pick-list.js"),import("../../chunks/calcite-pick-list-item.js"),import("../../chunks/calcite-switch.js")])}set viewModel(e){e!==this._get("viewModel")&&((t(this._defaultViewModel)||this._defaultViewModel!==e)&&(this._defaultViewModel=s(this._defaultViewModel)),this._set("viewModel",e))}castVisibleElements(e){return{...d,...e}}render(){const{label:e,visibleElements:{header:s}}=this;return c("div",{"aria-label":e,class:this.classes(h,k)},c("div",{class:m},s?this.renderHeaderView():this.renderContent()))}renderHeaderView(){return c("calcite-panel",{heading:this.label,class:u},this.renderContent())}renderContent(){return[this.renderToggles(),this.renderLayerList()]}renderToggles(){return c("calcite-block",{class:g,heading:"",open:!0},this.renderEnabledToggle(),c("div",{class:w},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))}renderEnabledToggle(){if(!this.visibleElements.enabledToggle)return;const{messages:{enableSnapping:e},viewModel:{snappingOptions:{enabled:s,enabledToggled:t}}}=this;return c("calcite-label",{layout:"inline-space-between"},e,c("calcite-switch",{checked:s,disabled:t,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}renderSelfEnabledToggle(){if(!this.visibleElements.selfEnabledToggle)return;const{messages:{geometryGuides:e},viewModel:{snappingOptions:{enabled:s,selfEnabled:t,enabledToggled:i}}}=this;return c("calcite-label",{layout:"inline-space-between"},e,c("calcite-switch",{checked:t,disabled:i||!s,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}renderFeatureEnabledToggle(){if(!this.visibleElements.featureEnabledToggle)return;const{messages:{featureToFeature:e},viewModel:{snappingOptions:{enabled:s,featureEnabled:t,enabledToggled:i}}}=this;return c("calcite-label",{layout:"inline-space-between"},e,c("calcite-switch",{checked:t,disabled:i||!s,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}renderLayerList(){if(!this.visibleElements.layerList)return;const{messages:{snappingLayers:e,searchLayers:s}}=this;return c("calcite-block",{heading:e,class:b,open:!0,collapsible:!0},c("calcite-pick-list",{class:j,multiple:!0,bind:this,onCalciteListChange:this._layerListChange,filterEnabled:this.viewModel.layerListViewModel.operationalItems.length>=10,"filter-placeholder":s},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems)))}renderLayerListItemCollection(e){return e.map((e=>e.children.length>0?this.renderLayerListItemGroup(e):this.renderLayerListItem(e))).toArray()}renderLayerListItem(e){var s;const{messages:{untitledLayer:t}}=this,i=e.title||t,r=(null==(s=e.children)?void 0:s.length)>0,n=e.enabled;return c("calcite-pick-list-item",{slot:r?"parent-item":null,key:`${this.id}-pick-list-item-${e.uid}`,label:i,value:e.layer.id,selected:n})}renderLayerListItemGroup(e){const s=e.title||this.messages.untitledLayer;return c("calcite-pick-list-group",{"group-title":s,key:e.uid},[...this.renderLayerListItemCollection(e.children)])}_enableSnappingSwitchChange(e){this.snappingOptions.enabled=e.target.checked}_featureEnabledSwitchChange(e){this.snappingOptions.featureEnabled=e.target.checked}_selfEnabledSwitchChange(e){this.snappingOptions.selfEnabled=e.target.checked}async _layerListChange(e){const s=await e.target.getSelectedItems();this.viewModel.updateEnabledFeatureSources([...s.keys()])}};e([n({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],v.prototype,"label",void 0),e([n(),a("esri/widgets/support/SnappingControls/t9n/SnappingControls")],v.prototype,"messages",void 0),e([n(),a("esri/t9n/common")],v.prototype,"messagesCommon",void 0),e([i("viewModel.snappingOptions")],v.prototype,"snappingOptions",void 0),e([i("viewModel.view")],v.prototype,"view",void 0),e([n()],v.prototype,"viewModel",null),e([n()],v.prototype,"visibleElements",void 0),e([r("visibleElements")],v.prototype,"castVisibleElements",null),v=e([o("esri.widgets.support.SnappingControls")],v);const y=v;export{y as default};
