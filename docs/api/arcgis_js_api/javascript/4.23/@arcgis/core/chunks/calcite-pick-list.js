/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{h as t,a as e,H as i,c as a,F as s,p as n}from"../widgets/Widget.js";import{C as r,S as l,I as o}from"./resources3.js";import{f as c,g as m}from"./dom.js";import{g as d}from"./array.js";import{d as p}from"./debounce.js";import{c as u}from"./observers.js";import{d as h}from"./icon.js";import{d as f}from"./input.js";import{d as b}from"./loader.js";import{d as g}from"./progress.js";import{d as w}from"./scrim.js";import{f as y}from"./forIn.js";import"./tslib.es6.js";import"../intl.js";import"./number.js";import"./jsonMap.js";import"./object.js";import"../core/lang.js";import"./locale.js";import"./Logger.js";import"../config.js";import"./string.js";import"./messages.js";import"../core/Error.js";import"../core/promiseUtils.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"./assets.js";import"./deprecate.js";import"./domUtils.js";import"./Evented.js";import"../core/Accessor.js";import"./get.js";import"./utils.js";import"./handleUtils.js";import"../core/accessorSupport/decorators/subclass.js";import"./metadata.js";import"./tracking.js";import"./ensureType.js";import"./ArrayPool.js";import"../core/accessorSupport/decorators/property.js";import"./watch.js";import"../core/scheduling.js";import"./nextTick.js";import"../core/Handles.js";import"../core/Collection.js";import"./shared.js";import"./Promise.js";import"../core/reactiveUtils.js";import"./uuid.js";import"../core/accessorSupport/decorators/cast.js";import"./projector.js";import"./widgetUtils.js";import"./jsxWidgetSupport.js";import"./widgetThemeUtils.js";import"./guid.js";import"./label.js";import"./form.js";import"./math.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */function v(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const k=["ArrowUp","ArrowDown"];function x(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=p(L.bind(this),0)}function j(){var t;null===(t=this.mutationObserver)||void 0===t||t.observe(this.el,{childList:!0,subtree:!0})}function D(){var t;null===(t=this.mutationObserver)||void 0===t||t.disconnect()}function I(t){const{selectedValues:e}=this,{item:i,value:a,selected:s,shiftPressed:n}=t.detail;s?(this.multiple&&n&&this.selectSiblings(i),this.multiple||this.deselectSiblingItems(i),e.set(a,i)):(e.delete(a),this.multiple&&n&&this.selectSiblings(i,!0)),this.multiple||(_(i,s),s&&c(i)),this.lastSelectedItem=i,this.emitCalciteListChange()}function E(t){t.stopPropagation();const e=t.detail.oldValue,i=this.selectedValues;if(i.has(e)){const a=i.get(e);i.delete(e),i.set(t.detail.newValue,a)}}function F(t){const{el:e,items:i,multiple:a,selectedValues:s}=this;if(a)return;e.contains(t.relatedTarget)||i.forEach((e=>{_(e,0===s.size?e.contains(t.target)||t.target===e:e.selected)}))}function C(t){const{key:e,target:i}=t;if(!function(t){return!!k.find((e=>e===t))}(e))return;const{items:a,multiple:s,selectionFollowsFocus:n}=this,{length:r}=a,l=a.indexOf(i);if(!r||-1===l)return;t.preventDefault();const o=a[d(l+("ArrowUp"===e?-1:1),r)];a.forEach((t=>_(t,t===o))),!s&&n&&(o.selected=!0),c(o)}function L(){this.calciteListChange.emit(this.selectedValues)}function S(t){if(t.defaultPrevented)return;const e=t.target,i=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===e.parentElement.tagName?(e.parentElement.remove(),Array.from(e.parentElement.children).forEach((t=>i.delete(t.value)))):(e.remove(),i.delete(e.value)),this.emitCalciteListChange()}function _(t,e){e?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1")}async function H(t){if(this.filterEnabled&&"filter"===t)return void await c(this.filterEl);const{items:e,multiple:i,selectionFollowsFocus:a}=this;if(0===e.length)return;if(i)return e[0].setFocus();const s=e.find((t=>t.selected))||e[0];return a&&(s.selected=!0),s.setFocus()}function V(t){this.items=Array.from(this.el.querySelectorAll(t));let e=!1;const{items:i}=this;i.forEach((t=>{t.icon=this.getIconType(),this.multiple||(t.disableDeselect=!0,_(t,!1)),t.selected&&(e=!0,_(t,!0),this.selectedValues.set(t.value,t))}));const[a]=i;!e&&a&&_(a,!0)}function O(){const t=this.selectedValues,e=this.items.map((({value:t})=>t));t.forEach((t=>{e.includes(t.value)||this.selectedValues.delete(t.value)}))}function U(t){this.items.forEach((e=>{e.value!==t.value&&(e.toggleSelected(!1),this.selectedValues.has(e.value)&&this.selectedValues.delete(e.value))}))}function z(t,e=!1){if(!this.lastSelectedItem)return;const{items:i}=this,a=i.findIndex((t=>t.value===this.lastSelectedItem.value)),s=i.findIndex((e=>e.value===t.value));i.slice(Math.min(a,s),Math.max(a,s)).forEach((t=>{t.toggleSelected(!e),e?this.selectedValues.delete(t.value):this.selectedValues.set(t.value,t)}))}let P;function A(t){const{filteredItems:e}=t.currentTarget,i=e.map((t=>t.value));let a=!1;P||(P=new Set);const s=this.items.filter((t=>{const e=t.parentElement;e.matches("calcite-pick-list-group")&&P.add(e);const s=i.includes(t.value);return t.hidden=!s,a||(a=s&&t.selected),s}));P.forEach((t=>{const e=s.some((e=>t.contains(e)));if(t.hidden=!e,!e)return;const i=m(t,"parent-item");i&&(i.hidden=!1,s.includes(i)&&Array.from(t.children).forEach((t=>t.hidden=!1)))})),P.clear(),s.length>0&&!a&&!this.multiple&&_(s[0],!0)}function T(){return this.items.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})))}const R=i=>{var{props:{disabled:a,loading:s,filterEnabled:n,dataForFilter:o,handleFilter:c,filterPlaceholder:m,setFilterEl:d}}=i,p=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(t);s<a.length;s++)e.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(t,a[s])&&(i[a[s]]=t[a[s]])}return i}(i,["props"]);const u=t("slot",null);return t(e,Object.assign({"aria-busy":s.toString(),"aria-disabled":a.toString(),role:"menu"},p),t("section",null,t("header",{class:{[r.sticky]:!0}},n?t("calcite-filter",{"aria-label":m,disabled:s||a,items:o,onCalciteFilterChange:c,placeholder:m,ref:d}):null,t("slot",{name:l.menuActions})),s||a?t("calcite-scrim",{loading:s}):null,u))},M="container",q="clear-button",K="Filter",W="Clear filter",G="search",N="x";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */let B=class extends i{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteFilterChange=a(this,"calciteFilterChange",7),this.disabled=!1,this.filteredItems=[],this.scale="m",this.filter=p((t=>{const e=new RegExp(t,"i");if(0===this.items.length)return void this.updateFiltered([]);const i=(t,e)=>{let a=!1;return y(t,(t=>{"function"!=typeof t&&(Array.isArray(t)||"object"==typeof t&&null!==t?i(t,e)&&(a=!0):e.test(t)&&(a=!0))})),a},a=this.items.filter((t=>i(t,e)));this.updateFiltered(a)}),250),this.inputHandler=t=>{const e=t.target;this.value=e.value},this.keyDownHandler=({key:t})=>{"Escape"===t&&this.clear()},this.clear=()=>{this.value="",this.setFocus()}}watchItemsHandler(){this.filter(this.value)}valueHandler(t){this.filter(t)}async setFocus(){c(this.textInput)}updateFiltered(t){this.filteredItems.length=0,this.filteredItems=this.filteredItems.concat(t),this.calciteFilterChange.emit()}render(){const{disabled:e,scale:i}=this;return t(s,null,e?t("calcite-scrim",null):null,t("div",{class:M},t("label",null,t("calcite-input",{"aria-label":this.intlLabel||K,disabled:this.disabled,icon:G,onCalciteInputInput:this.inputHandler,onKeyDown:this.keyDownHandler,placeholder:this.placeholder,ref:t=>{this.textInput=t},scale:i,type:"text",value:this.value})),this.value?t("button",{"aria-label":this.intlClear||W,class:q,onClick:this.clear},t("calcite-icon",{icon:N,scale:i})):null))}get el(){return this}static get watchers(){return{items:["watchItemsHandler"],value:["valueHandler"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:host{-webkit-box-sizing:border-box;box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{display:-ms-flexbox;display:flex;width:100%}.container{display:-ms-flexbox;display:flex;width:100%;padding:0.5rem}label{position:relative;margin-left:0.25rem;margin-right:0.25rem;margin-top:0px;margin-bottom:0px;display:-ms-flexbox;display:flex;width:100%;-ms-flex-align:center;align-items:center;overflow:hidden}input[type=text]{margin-bottom:0.25rem;width:100%;border-style:none;background-color:transparent;padding-top:0.25rem;padding-bottom:0.25rem;padding-right:0.25rem;padding-left:1.5rem;font-family:inherit;font-size:var(--calcite-font-size--2);line-height:1rem;color:var(--calcite-ui-text-1);-webkit-transition:padding var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), box-shadow var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing)}input[type=text]::-ms-clear{display:none}calcite-input{width:100%}.search-icon{position:absolute;display:-ms-flexbox;display:flex;color:var(--calcite-ui-text-2);inset-inline-start:0;-webkit-transition:left var(--calcite-animation-timing), right var(--calcite-animation-timing), opacity var(--calcite-animation-timing);transition:left var(--calcite-animation-timing), right var(--calcite-animation-timing), opacity var(--calcite-animation-timing)}input[type=text]:focus{border-color:var(--calcite-ui-brand);outline:2px solid transparent;outline-offset:2px;padding-inline:0.25rem}input[type=text]:focus~.search-icon{inset-inline-start:calc(1rem * -1);opacity:0}.clear-button{display:-ms-flexbox;display:flex;cursor:pointer;-ms-flex-align:center;align-items:center;border-width:0px;background-color:transparent;color:var(--calcite-ui-text-2)}.clear-button:hover,.clear-button:focus{color:var(--calcite-ui-text-1)}"}};function J(){if("undefined"==typeof customElements)return;["calcite-filter","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-scrim"].forEach((t=>{switch(t){case"calcite-filter":customElements.get(t)||customElements.define(t,B);break;case"calcite-icon":customElements.get(t)||h();break;case"calcite-input":customElements.get(t)||f();break;case"calcite-loader":customElements.get(t)||b();break;case"calcite-progress":customElements.get(t)||g();break;case"calcite-scrim":customElements.get(t)||w()}}))}B=n(B,[1,"calcite-filter",{items:[1040],disabled:[516],filteredItems:[1040],intlClear:[1,"intl-clear"],intlLabel:[1,"intl-label"],placeholder:[1],scale:[513],value:[1025],setFocus:[64]}]),J();let Q=class extends i{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteListChange=a(this,"calciteListChange",7),this.disabled=!1,this.filterEnabled=!1,this.loading=!1,this.multiple=!1,this.selectionFollowsFocus=!1,this.selectedValues=new Map,this.dataForFilter=[],this.lastSelectedItem=null,this.mutationObserver=u("mutation",v.bind(this)),this.setFilterEl=t=>{this.filterEl=t},this.deselectRemovedItems=O.bind(this),this.deselectSiblingItems=U.bind(this),this.selectSiblings=z.bind(this),this.handleFilter=A.bind(this),this.getItemData=T.bind(this),this.keyDownHandler=C.bind(this)}connectedCallback(){x.call(this),j.call(this)}disconnectedCallback(){D.call(this)}calciteListItemRemoveHandler(t){S.call(this,t)}calciteListItemChangeHandler(t){I.call(this,t)}calciteListItemPropsChangeHandler(t){t.stopPropagation(),this.setUpFilter()}calciteListItemValueChangeHandler(t){E.call(this,t)}calciteListFocusOutHandler(t){F.call(this,t)}setUpItems(){V.call(this,"calcite-pick-list-item")}setUpFilter(){this.filterEnabled&&(this.dataForFilter=this.getItemData())}async getSelectedItems(){return this.selectedValues}async setFocus(t){return H.call(this,t)}getIconType(){return this.multiple?o.square:o.circle}render(){return t(R,{onKeyDown:this.keyDownHandler,props:this})}get el(){return this}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-negative:0;flex-shrink:0;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:stretch;align-items:stretch;background-color:transparent;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:host([filter-enabled]) header{margin-bottom:0.25rem;display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:end;justify-content:flex-end;background-color:var(--calcite-ui-foreground-1);--tw-shadow:0 1px 0 var(--calcite-ui-border-3);--tw-shadow-colored:0 1px 0 var(--tw-shadow-color);-webkit-box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}:host([filter-enabled]) header.sticky-pos{position:-webkit-sticky;position:sticky;top:0px;z-index:1}calcite-filter{margin-bottom:0px}:host([loading][disabled]){min-height:2rem}"}};function X(){if("undefined"==typeof customElements)return;["calcite-pick-list","calcite-filter","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-scrim"].forEach((t=>{switch(t){case"calcite-pick-list":customElements.get(t)||customElements.define(t,Q);break;case"calcite-filter":customElements.get(t)||J();break;case"calcite-icon":customElements.get(t)||h();break;case"calcite-input":customElements.get(t)||f();break;case"calcite-loader":customElements.get(t)||b();break;case"calcite-progress":customElements.get(t)||g();break;case"calcite-scrim":customElements.get(t)||w()}}))}Q=n(Q,[1,"calcite-pick-list",{disabled:[516],filterEnabled:[516,"filter-enabled"],filterPlaceholder:[513,"filter-placeholder"],headingLevel:[2,"heading-level"],loading:[516],multiple:[516],selectionFollowsFocus:[4,"selection-follows-focus"],selectedValues:[32],dataForFilter:[32],getSelectedItems:[64],setFocus:[64]},[[0,"calciteListItemRemove","calciteListItemRemoveHandler"],[0,"calciteListItemChange","calciteListItemChangeHandler"],[0,"calciteListItemPropsChange","calciteListItemPropsChangeHandler"],[0,"calciteListItemValueChange","calciteListItemValueChangeHandler"],[0,"focusout","calciteListFocusOutHandler"]]]),X();const Y=Q,Z=X;export{Y as CalcitePickList,Z as defineCustomElement};
