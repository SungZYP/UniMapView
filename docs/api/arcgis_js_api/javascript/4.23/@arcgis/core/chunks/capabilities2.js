/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{b as e,i as t}from"../core/lang.js";import{C as r,c as n}from"./context-util.js";let s,a;function i(t){switch(t){case r.WEBGL1:return o();case r.WEBGL2:return function(){a||(a=function(){const t=new l,n=p(r.WEBGL2,t);if(e(n))return t;return t}());return a}()}}function o(){return s||(s=function(){const t=new c,n=p(r.WEBGL1,t);if(e(n))return t;return t.supportsElementIndexUint=null!==n.getExtension("OES_element_index_uint"),t.supportsStandardDerivatives=null!==n.getExtension("OES_standard_derivatives"),t.supportsInstancedArrays=null!==n.getExtension("ANGLE_instanced_arrays"),t.supportsTextureFloat=null!==n.getExtension("OES_texture_float"),t}()),s}class u{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1}}class c extends u{constructor(){super(...arguments),this.type=r.WEBGL1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1}}class l extends u{constructor(){super(...arguments),this.type=r.WEBGL2}}function p(s,a){if(s===r.WEBGL1&&void 0===typeof WebGLRenderingContext||s===r.WEBGL2&&void 0===typeof WebGL2RenderingContext)return null;const i=document.createElement("canvas");if(!i)return null;let o=n(i,s,{failIfMajorPerformanceCaveat:!0});if(e(o)&&(o=n(i,s),t(o)&&(a.majorPerformanceCaveat=!0)),e(o))return o;if(s===r.WEBGL1){const e=o.getParameter(o.VERSION),t=null==e?void 0:e.match(/^WebGL\s+([\d.]*)/);if(t){const e=parseFloat(t[1]);a.available=e>=.94}}else a.available=!0;a.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),a.supportsVertexShaderSamplers=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const u=o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT);return u&&(a.supportsHighPrecisionFragment=u.precision>0),o}export{i as a,o as g};
