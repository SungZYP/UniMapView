/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{d as n,f as t,e as r,j as c,b as e,a as o,h as s,c as u,y as a,n as i}from"./mathUtils.js";import{i as f}from"../core/lang.js";import"./sphere.js";import{s as I,c as N}from"./vectorStacks.js";function M(n=D){return[n[0],n[1],n[2],n[3]]}function g(n,t,r,c){return h(n,t,r,c,N.get())}function E(n,t){return h(t[0],t[1],t[2],t[3],n)}function h(n,t,r,c,e=M()){return e[0]=n,e[1]=t,e[2]=r,e[3]=c,e}function m(n,t,r){return c(r,n),r[3]=t,r}function A(n,t,r){const c=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2]),r}function F(n,t,r,c=M()){const e=r[0]-t[0],o=r[1]-t[1],s=r[2]-t[2],u=n[0]-t[0],a=n[1]-t[1],i=n[2]-t[2],f=o*i-s*a,I=s*u-e*i,N=e*a-o*u,g=f*f+I*I+N*N,E=Math.abs(g-1)>1e-5&&g>1e-12?1/Math.sqrt(g):1;c[0]=f*E,c[1]=I*E,c[2]=N*E,c[3]=-(c[0]*n[0]+c[1]*n[1]+c[2]*n[2])}function T(t,r,c,e,o){if(t.count<3)return!1;t.getVec(c,p);let u=e,f=!1;for(;u<t.count-1&&!f;)t.getVec(u,j),u++,f=!a(p,j);if(!f)return!1;for(u=Math.max(u,o),f=!1;u<t.count&&!f;)t.getVec(u,b),u++,s(d,p,j),i(d,d),s(l,j,b),i(l,l),f=!a(p,b)&&!a(j,b)&&Math.abs(n(d,l))<_;return f?(F(p,j,b,r),!0):(0!==c||1!==e||2!==o)&&T(t,r,0,1,2)}const _=.99619469809,p=e(),j=e(),b=e(),d=e(),l=e();function v(t,r,c){return r!==t&&E(t,r),t[3]=-n(t,c),t}function y(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function X(n,t,r,c){return o(b,t,n),A(r,b,c)}function C(n,t,r,c){return z(n,t,s(I.get(),r,t),H,c)}function L(n,t,r){return!!f(t)&&z(n,t.origin,t.direction,J,r)}function P(n,t,r){return z(n,t.origin,t.vector,G.NONE,r)}function q(n,t,r){return z(n,t.origin,t.vector,G.CLAMP,r)}function O(n,t){return U(n,t)>=0}function V(n,t){const r=t[0],c=t[1],e=t[2],o=t[3],s=t[4],u=t[5];return n[0]*(n[0]>0?r:o)+n[1]*(n[1]>0?c:s)+n[2]*(n[2]>0?e:u)+n[3]>=0}function k(t,r){const c=n(t,r.ray.direction),e=-U(t,r.ray.origin);if(e<0&&c>=0)return!1;if(c>-1e-6&&c<1e-6)return e>0;if((e<0||c<0)&&!(e<0&&c<0))return!0;const o=e/c;return c>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function x(t,r){const c=n(t,r.ray.direction),e=-U(t,r.ray.origin);if(c>-1e-6&&c<1e-6)return e>0;const o=e/c;return c>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function w(n,c,e){const o=r(I.get(),n,-n[3]),u=S(n,s(I.get(),c,o),I.get());return t(e,u,o),e}function S(t,c,e){const o=r(I.get(),t,n(t,c));return s(e,c,o),e}function U(t,r){return n(t,r)+t[3]}function z(c,e,o,s,a){const i=n(c,o);if(0===i)return!1;let f=-(n(c,e)+c[3])/i;return s&G.CLAMP&&(f=u(f,0,1)),!(!(s&G.INFINITE_MIN)&&f<0||!(s&G.INFINITE_MAX)&&f>1)&&(t(a,e,r(a,o,f)),!0)}function B(n){return n}const D=[0,0,1,0];var G;!function(n){n[n.NONE=0]="NONE",n[n.CLAMP=1]="CLAMP",n[n.INFINITE_MIN=4]="INFINITE_MIN",n[n.INFINITE_MAX=8]="INFINITE_MAX"}(G||(G={}));const H=G.INFINITE_MIN|G.INFINITE_MAX,J=G.INFINITE_MAX;export{X as a,O as b,M as c,E as d,h as e,A as f,P as g,q as h,L as i,F as j,U as k,V as l,x as m,B as n,k as o,w as p,C as q,m as r,v as s,y as t,S as u,T as v,g as w};
