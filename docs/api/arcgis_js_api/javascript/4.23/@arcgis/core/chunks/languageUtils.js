/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import e from"../geometry/Point.js";import{create as t,resolve as n,reject as r,all as i}from"../core/promiseUtils.js";import s from"../geometry/Extent.js";import o from"../geometry/Geometry.js";import a from"../geometry/Multipoint.js";import l,{i as u}from"../geometry/Polygon.js";import c from"../geometry/Polyline.js";import{D as f}from"./datetime.js";import{b as y}from"../core/lang.js";import{p as d,f as p}from"./number3.js";import{g as m}from"./locale.js";import h from"../layers/support/Field.js";class g{constructor(e,t){this.definition=null,this.context=null,this.definition=e,this.context=t}}class S{constructor(e=[]){this._elements=e}length(){return this._elements.length}get(e){return this._elements[e]}toArray(){const e=[];for(let t=0;t<this.length();t++)e.push(this.get(t));return e}}class T extends S{constructor(e,t,n,r,i,s){super(e),this._lazyPt=[],this._hasZ=!1,this._hasM=!1,this._spRef=t,this._hasZ=n,this._hasM=r,this._cacheId=i,this._partId=s}get(t){if(void 0===this._lazyPt[t]){const n=this._elements[t];if(void 0===n)return;const r=this._hasZ,i=this._hasM;let s=null;s=r&&!i?new e(n[0],n[1],n[2],void 0,this._spRef):i&&!r?new e(n[0],n[1],void 0,n[2],this._spRef):r&&i?new e(n[0],n[1],n[2],n[3],this._spRef):new e(n[0],n[1],this._spRef),s.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+t.toString(),this._lazyPt[t]=s}return this._lazyPt[t]}equalityTest(e){return e===this||null!==e&&(e instanceof T!=!1&&e.getUniqueHash()===this.getUniqueHash())}getUniqueHash(){return this._cacheId.toString()+"-"+this._partId.toString()}}class x extends S{constructor(e,t,n,r,i){super(e),this._lazyPath=[],this._hasZ=!1,this._hasM=!1,this._hasZ=n,this._hasM=r,this._spRef=t,this._cacheId=i}get(e){if(void 0===this._lazyPath[e]){const t=this._elements[e];if(void 0===t)return;this._lazyPath[e]=new T(t,this._spRef,this._hasZ,this._hasM,this._cacheId,e)}return this._lazyPath[e]}equalityTest(e){return e===this||null!==e&&(e instanceof x!=!1&&e.getUniqueHash()===this.getUniqueHash())}getUniqueHash(){return this._cacheId.toString()}}var F,b;function _(e){return h.fromJSON(e.toJSON())}function v(e){return e.toJSON?e.toJSON():e}function D(e){return"string"==typeof e||e instanceof String}function I(e){return"number"==typeof e}function N(e){return e instanceof Date}function M(e,t){return e===t||!(!N(e)||!N(t))&&e.getTime()===t.getTime()}function k(e){if(void 0===e)return null;if("number"==typeof e)return e;switch(e.toLowerCase()){case"meters":case"meter":return 109404;case"miles":case"mile":return 109413;case"kilometers":case"kilometer":case"km":return 109414}return null}function G(e){if(null===e)return null;switch(e.type){case"polygon":case"multipoint":case"polyline":return e.extent;case"point":return new s({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case"extent":return e}return null}function R(e){if(void 0===e)return null;if("number"==typeof e)return e;if("number"==typeof e)return e;switch(e.toLowerCase()){case"meters":case"meter":return 9001;case"miles":case"mile":return 9035;case"kilometers":case"kilometer":case"km":return 9036}return null}!function(e){e[e.Standardised=0]="Standardised",e[e.StandardisedNoInterval=1]="StandardisedNoInterval",e[e.SqlServer=2]="SqlServer",e[e.Oracle=3]="Oracle",e[e.Postgres=4]="Postgres",e[e.PGDB=5]="PGDB",e[e.FILEGDB=6]="FILEGDB",e[e.NotEvaluated=7]="NotEvaluated"}(F||(F={})),function(e){e[e.InFeatureSet=0]="InFeatureSet",e[e.NotInFeatureSet=1]="NotInFeatureSet",e[e.Unknown=2]="Unknown"}(b||(b={}));const O=1e3,w={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"},A={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"},P={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger",long:"esriFieldTypeLong",single:"esriFieldTypeSingle",double:"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"eesriFieldTypeXML",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"eesriFieldTypeXML"};function j(e,i){return t(((t,s)=>{const o=n(!0);e.reduce(((e,t,n,s)=>e.then((e=>{try{return i(e,t,n,s)}catch(e){return r(e)}}),(e=>r(e)))),o).then(t,s)}))}function C(e){return void 0===e?"":e=(e=(e=e.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer")).replace(/\/mapserver\/[0-9]*/i,"/MapServer")).split("?")[0]}function L(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});const n="boolean"==typeof t.cycles&&t.cycles,r=t.cmp&&(i=t.cmp,function(e){return function(t,n){const r={key:t,value:e[t]},s={key:n,value:e[n]};return i(r,s)}});var i;const s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===t)return;if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);let i,o;if(Array.isArray(t)){for(o="[",i=0;i<t.length;i++)i&&(o+=","),o+=e(t[i])||"null";return o+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const a=s.push(t)-1,l=Object.keys(t).sort(r&&r(t));for(o="",i=0;i<l.length;i++){const n=l[i],r=e(t[n]);r&&(o&&(o+=","),o+=JSON.stringify(n)+":"+r)}return s.splice(a,1),"{"+o+"}"}(e)}class J{constructor(e){this.value=e}}class Z{constructor(e){this.value=e}}class E{constructor(e){this.fn=e}}class Y{constructor(e,t){this.paramCount=t,this.fn=e}}const z=E,U=Z,q=J,H=Y,B={type:"VOID"},V={type:"BREAK"},X={type:"CONTINUE"};function $(e,t,n){return""===t||null==t||t===n||t===n?e:e=e.split(t).join(n)}function Q(e){return e instanceof E||e instanceof g||e instanceof Y}function W(e){return!!ee(e)||(!!ne(e)||(!!ue(e)||(!!te(e)||(null===e||(e===B||"number"==typeof e)))))}function K(e,t){return void 0===e?t:e}function ee(e){return"string"==typeof e||e instanceof String}function te(e){return"boolean"==typeof e}function ne(e){return"number"==typeof e}function re(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function ie(e){return e instanceof Array}function se(e){return"esri.arcade.Feature"===(null==e?void 0:e.arcadeDeclaredClass)}function oe(e){return!0===(e&&e.declaredRootClass&&"esri.arcade.featureset.support.FeatureSet"===e.declaredRootClass)}function ae(e){return!0===(e&&e.declaredRootClass&&"esri.arcade.featureSetCollection"===e.declaredRootClass)}function le(e){return e instanceof S}function ue(e){return e instanceof Date}function ce(e,t,n){if(e.length<t||e.length>n)throw new Error("Function called with wrong number of Parameters")}function fe(e){return e<0?-Math.round(-e):Math.round(e)}function ye(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function de(e,t){return!1===isNaN(e)?null==t||""===t?e.toString():(t=$(t,"‰",""),t=$(t,"¤",""),p(e,{pattern:t})):e.toString()}function pe(e,t){const n=f.fromJSDate(e);return null==t||""===t?n.toISO({suppressMilliseconds:!0}):n.toFormat(me(t),{locale:m(),numberingSystem:"latn"})}function me(e){e=e.replace(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]");let t="";const n=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const r of e.match(n))switch(r){case"D":t+="d";break;case"DD":t+="dd";break;case"DDD":t+="o";break;case"d":t+="c";break;case"ddd":t+="ccc";break;case"dddd":t+="cccc";break;case"M":t+="L";break;case"MM":t+="LL";break;case"MMM":t+="LLL";break;case"MMMM":t+="LLLL";break;case"YY":t+="yy";break;case"Y":case"YYYY":t+="yyyy";break;case"Q":t+="q";break;case"Z":t+="ZZ";break;case"ZZ":t+="ZZZ";break;case"S":t+="'S'";break;case"SS":t+="'SS'";break;case"SSS":t+="u";break;case"A":case"a":t+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":t+=r;break;default:r.length>=2&&"["===r.slice(0,1)&&"]"===r.slice(-1)?t+=`'${r.slice(1,-1)}'`:t+=`'${r}'`}return t}function he(e,t,n){switch(n){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}return!1}function ge(e,t,n){if(null===e){if(null===t||t===B)return he(null,null,n);if(ne(t))return he(0,t,n);if(ee(t))return he(0,_e(t),n);if(te(t))return he(0,_e(t),n);if(ue(t))return he(0,t.getTime(),n)}if(e===B){if(null===t||t===B)return he(null,null,n);if(ne(t))return he(0,t,n);if(ee(t))return he(0,_e(t),n);if(te(t))return he(0,_e(t),n);if(ue(t))return he(0,t.getTime(),n)}else if(ne(e)){if(ne(t))return he(e,t,n);if(te(t))return he(e,_e(t),n);if(null===t||t===B)return he(e,0,n);if(ee(t))return he(e,_e(t),n);if(ue(t))return he(e,t.getTime(),n)}else if(ee(e)){if(ee(t))return he(Te(e),Te(t),n);if(ue(t))return he(_e(e),t.getTime(),n);if(ne(t))return he(_e(e),t,n);if(null===t||t===B)return he(_e(e),0,n);if(te(t))return he(_e(e),_e(t),n)}else if(ue(e)){if(ue(t))return he(e,t,n);if(null===t||t===B)return he(e.getTime(),0,n);if(ne(t))return he(e.getTime(),t,n);if(te(t))return he(e.getTime(),_e(t),n);if(ee(t))return he(e.getTime(),_e(t),n)}else if(te(e)){if(te(t))return he(e,t,n);if(ne(t))return he(_e(e),_e(t),n);if(ue(t))return he(_e(e),t.getTime(),n);if(null===t||t===B)return he(_e(e),0,n);if(ee(t))return he(_e(e),_e(t),n)}return!!Se(e,t)&&("<="===n||">="===n)}function Se(t,n){if(t===n)return!0;if(null===t&&n===B||null===n&&t===B)return!0;if(ue(t)&&ue(n))return t.getTime()===n.getTime();if(t instanceof x)return t.equalityTest(n);if(t instanceof T)return t.equalityTest(n);if(t instanceof e&&n instanceof e){const e=t.cache._arcadeCacheId,r=n.cache._arcadeCacheId;if(null!=e)return e===r}if(void 0!==t&&void 0!==n&&null!==t&&null!==n&&"object"==typeof t&&"object"==typeof n){if(t._arcadeCacheId===n._arcadeCacheId&&void 0!==t._arcadeCacheId&&null!==t._arcadeCacheId)return!0;if(t._underlyingGraphic===n._underlyingGraphic&&void 0!==t._underlyingGraphic&&null!==t._underlyingGraphic)return!0}return!1}function Te(e,t){if(ee(e))return e;if(null===e)return"";if(ne(e))return de(e,t);if(te(e))return e.toString();if(ue(e))return pe(e,t);if(e instanceof o)return JSON.stringify(e.toJSON());if(ie(e)){const t=[];for(let n=0;n<e.length;n++)t[n]=be(e[n]);return"["+t.join(",")+"]"}if(e instanceof S){const t=[];for(let n=0;n<e.length();n++)t[n]=be(e.get(n));return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText():Q(e)?"object, Function":""}function xe(e){const t=[];if(!1===ie(e))return null;if(e instanceof S){for(let n=0;n<e.length();n++)t[n]=_e(e.get(n));return t}for(let n=0;n<e.length;n++)t[n]=_e(e[n]);return t}function Fe(e,t){if(ee(e))return e;if(null===e)return"";if(ne(e))return de(e,t);if(te(e))return e.toString();if(ue(e))return pe(e,t);if(e instanceof o)return e instanceof s?'{"xmin":'+e.xmin.toString()+',"ymin":'+e.ymin.toString()+","+(e.hasZ?'"zmin":'+e.zmin.toString()+",":"")+(e.hasM?'"mmin":'+e.mmin.toString()+",":"")+'"xmax":'+e.xmax.toString()+',"ymax":'+e.ymax.toString()+","+(e.hasZ?'"zmax":'+e.zmax.toString()+",":"")+(e.hasM?'"mmax":'+e.mmax.toString()+",":"")+'"spatialReference":'+Ae(e.spatialReference)+"}":Ae(e.toJSON(),((e,t)=>e.key===t.key?0:"spatialReference"===e.key?1:"spatialReference"===t.key||e.key<t.key?-1:e.key>t.key?1:0));if(ie(e)){const t=[];for(let n=0;n<e.length;n++)t[n]=be(e[n]);return"["+t.join(",")+"]"}if(e instanceof S){const t=[];for(let n=0;n<e.length();n++)t[n]=be(e.get(n));return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText():Q(e)?"object, Function":""}function be(e){if(null===e)return"null";if(te(e)||ne(e)||ee(e))return JSON.stringify(e);if(e instanceof o)return Fe(e);if(e instanceof S)return Fe(e);if(e instanceof Array)return Fe(e);if(e instanceof Date)return JSON.stringify(pe(e,""));if(null!==e&&"object"==typeof e){if(void 0!==e.castToText)return e.castToText()}else if(e===B)return"null";return"null"}function _e(e,t){return ne(e)?e:null===e||""===e?0:ue(e)?NaN:te(e)?e?1:0:ie(e)||""===e||void 0===e?NaN:void 0!==t&&ee(e)?(t=$(t,"‰",""),t=$(t,"¤",""),d(e,{pattern:t})):e===B?0:Number(e)}function ve(e){if(ue(e))return e;if(ee(e)){const t=Ie(e);if(t)return t.toJSDate()}return null}function De(e){return ue(e)?f.fromJSDate(e):ee(e)?Ie(e):null}function Ie(e){const t=/ (\d\d)/;let n=f.fromISO(e);return n.isValid||t.test(e)&&(e=e.replace(t,"T$1"),n=f.fromISO(e),n.isValid)?n:null}function Ne(e){return te(e)?e:ee(e)?"true"===(e=e.toLowerCase()):!!ne(e)&&(0!==e&&!isNaN(e))}function Me(e,t){return y(e)?null:(null!==e.spatialReference&&void 0!==e.spatialReference||(e.spatialReference=t),e)}function ke(t){if(null===t)return null;if(t instanceof e)return"NaN"===t.x||null===t.x||isNaN(t.x)?null:t;if(t instanceof l){if(0===t.rings.length)return null;for(const e of t.rings)if(e.length>0)return t;return null}if(t instanceof c){if(0===t.paths.length)return null;for(const e of t.paths)if(e.length>0)return t;return null}return t instanceof a?0===t.points.length?null:t:t instanceof s?"NaN"===t.xmin||null===t.xmin||isNaN(t.xmin)?null:t:null}function Ge(e,t){if(!e)return t;if(!e.domain)return t;let n=null;if("string"===e.field.type||"esriFieldTypeString"===e.field.type)t=Te(t);else{if(null==t)return null;if(""===t)return t;t=_e(t)}for(let r=0;r<e.domain.codedValues.length;r++){const i=e.domain.codedValues[r];i.code===t&&(n=i)}return null===n?t:n.name}function Re(e,t){if(!e)return t;if(!e.domain)return t;let n=null;t=Te(t);for(let r=0;r<e.domain.codedValues.length;r++){const i=e.domain.codedValues[r];i.name===t&&(n=i)}return null===n?t:n.code}function Oe(e,t,n=null,r=null){if(!t)return null;if(!t.fields)return null;let i,s,o=null;for(let n=0;n<t.fields.length;n++){const r=t.fields[n];r.name.toLowerCase()===e.toString().toLowerCase()&&(o=r)}if(null===o)throw new Error("Field not found");return null===r&&n&&t.typeIdField&&(r=n.hasField(t.typeIdField)?n.field(t.typeIdField):null),null!=r&&t.types.some((function(e){return e.id===r&&(i=e.domains&&e.domains[o.name],i&&"inherited"===i.type&&(i=we(o.name,t),s=!0),!0)})),s||i||(i=we(e,t)),{field:o,domain:i}}function we(e,t){let n;return t.fields.some((function(t){return t.name.toLowerCase()===e.toLowerCase()&&(n=t.domain),!!n})),n}function Ae(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});const n="boolean"==typeof t.cycles&&t.cycles,r=t.cmp&&(i=t.cmp,function(e){return function(t,n){const r={key:t,value:e[t]},s={key:n,value:e[n]};return i(r,s)}});var i;const s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===t)return;if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);let i,o;if(Array.isArray(t)){for(o="[",i=0;i<t.length;i++)i&&(o+=","),o+=e(t[i])||"null";return o+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const a=s.push(t)-1,l=Object.keys(t).sort(r&&r(t));for(o="",i=0;i<l.length;i++){const n=l[i],r=e(t[n]);r&&(o&&(o+=","),o+=JSON.stringify(n)+":"+r)}return s.splice(a,1),"{"+o+"}"}(e)}function Pe(e){if(null===e)return null;const t=[];for(const n of e)n&&n.arcadeDeclaredClass&&"esri.arcade.Feature"===n.arcadeDeclaredClass?t.push(n.geometry()):t.push(n);return t}function je(t,n){if(!(n instanceof e))throw new Error("Invalid Argument");t.push(n.hasZ?n.hasM?[n.x,n.y,n.z,n.m]:[n.x,n.y,n.z]:[n.x,n.y])}function Ce(e,t){if(ie(e)||le(e)){let n=!1,r=!1,i=[],s=t;if(ie(e)){for(const t of e)je(i,t);i.length>0&&(s=e[0].spatialReference,n=e[0].hasZ,r=e[0].hasM)}else if(e instanceof T)i=e._elements,i.length>0&&(n=e._hasZ,r=e._hasM,s=e.get(0).spatialReference);else{if(!le(e))throw new Error("Invalid Argument");for(const t of e.toArray())je(i,t);i.length>0&&(s=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}if(0===i.length)return null;return!1===u(i,r,n)&&(i=i.slice(0).reverse()),new l({rings:[i],spatialReference:s,hasZ:n,hasM:r})}return e}function Le(e,t){if(ie(e)||le(e)){let n=!1,r=!1,i=[],s=t;if(ie(e)){for(const t of e)je(i,t);i.length>0&&(s=e[0].spatialReference,n=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof T)i=e._elements,i.length>0&&(n=e._hasZ,r=e._hasM,s=e.get(0).spatialReference);else if(le(e)){for(const t of e.toArray())je(i,t);i.length>0&&(s=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===i.length?null:new c({paths:[i],spatialReference:s,hasZ:n,hasM:r})}return e}function Je(e,t){if(ie(e)||le(e)){let n=!1,r=!1,i=[],s=t;if(ie(e)){for(const t of e)je(i,t);i.length>0&&(s=e[0].spatialReference,n=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof T)i=e._elements,i.length>0&&(n=e._hasZ,r=e._hasM,s=e.get(0).spatialReference);else if(le(e)){for(const t of e.toArray())je(i,t);i.length>0&&(s=e.get(0).spatialReference,n=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===i.length?null:new a({points:i,spatialReference:s,hasZ:n,hasM:r})}return e}function Ze(e,t=!1){const n=[];if(null===e)return n;if(!0===ie(e)){for(let r=0;r<e.length;r++){const i=Te(e[r]);""===i&&!0!==t||n.push(i)}return n}if(e instanceof S){for(let r=0;r<e.length();r++){const i=Te(e.get(r));""===i&&!0!==t||n.push(i)}return n}if(W(e)){const r=Te(e);return""===r&&!0!==t||n.push(r),n}return[]}let Ee=0;function Ye(e){return Ee++,Ee%100==0?(Ee=0,t((t=>{setTimeout((()=>{t(e)}),0)}))):e}function ze(e,t,n){switch(n){case"&":return e&t;case"|":return e|t;case"^":return e^t;case"<<":return e<<t;case">>":return e>>t;case">>>":return e>>>t}}function Ue(e,t=null){return null==e?null:te(e)||ne(e)||ee(e)?e:e instanceof o?!0===(null==t?void 0:t.keepGeometryType)?e:e.toJSON():e instanceof S?e.toArray().map((e=>Ue(e,t))):e instanceof Array?e.map((e=>Ue(e,t))):e instanceof Date?e:null!==e&&"object"==typeof e&&void 0!==e.castAsJson?e.castAsJson(t):null}function qe(e,t,n,r,i){return He(e,t,n).then((e=>{i[r]=e}))}function He(e,t=null,r=null){if(e instanceof S&&(e=e.toArray()),null==e)return n(null);if(W(e)||e instanceof o||e instanceof Date)return n(Ue(e,r));if(e instanceof Array){const s=[],a=[];for(const n of e)null===n||W(n)||n instanceof o||n instanceof Date?a.push(Ue(n,r)):(a.push(null),s.push(qe(n,t,r,a.length-1,a)));return s.length>0?i(s).then((()=>a)):n(a)}return null!==e&&"object"==typeof e&&void 0!==e.castAsJsonAsync?e.castAsJsonAsync(t,r):n(null)}function Be(e,t,n){const r=e.fullSchema();if(null===r)return null;if(!r.fields)return null;return Oe(t,r,e,n)}function Ve(e){const t=e.fullSchema();return null===t?null:t.fields&&t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map((e=>({name:e.name,code:e.id}))):[]}:null}function Xe(e,t,n,r){const i=e.fullSchema();if(null===i)return null;if(!i.fields)return null;const s=Oe(t,i,e,r);if(void 0===n)try{n=e.field(t)}catch(e){return null}return Ge(s,n)}function $e(e,t,n,r){const i=e.fullSchema();if(null===i)return null;if(!i.fields)return null;if(void 0===n){try{n=e.field(t)}catch(e){return null}return n}return Re(Oe(t,i,e,r),n)}function Qe(e){const t=e.fullSchema();if(null===t)return null;if(!t.fields)return null;const n=[];for(const e of t.fields)n.push(v(e));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField,geometryType:void 0===A[t.geometryType]?"":A[t.geometryType],fields:n}}const We=Object.freeze({__proto__:null,ReturnResultE:J,ImplicitResultE:Z,NativeFunctionE:E,SizzleFunctionE:Y,NativeFunction:z,ImplicitResult:U,ReturnResult:q,SizzleFunction:H,voidOperation:B,breakResult:V,continueResult:X,multiReplace:$,isFunctionParameter:Q,isSimpleType:W,defaultUndefined:K,isString:ee,isBoolean:te,isNumber:ne,isInteger:re,isArray:ie,isFeature:se,isFeatureSet:oe,isFeatureSetCollection:ae,isImmutableArray:le,isDate:ue,pcCheck:ce,absRound:fe,generateUUID:ye,formatNumber:de,formatDate:pe,standardiseDateFormat:me,greaterThanLessThan:ge,equalityTest:Se,toString:Te,toNumberArray:xe,toStringExplicit:Fe,toNumber:_e,toDate:ve,toDateTime:De,toBoolean:Ne,fixSpatialReference:Me,fixNullGeometry:ke,getDomainValue:Ge,getDomainCode:Re,getDomain:Oe,stableStringify:Ae,autoCastFeatureToGeometry:Pe,autoCastArrayOfPointsToPolygon:Ce,autoCastArrayOfPointsToPolyline:Le,autoCastArrayOfPointsToMultiPoint:Je,toStringArray:Ze,tick:Ye,binaryOperator:ze,castAsJson:Ue,castAsJsonAsync:He,featureFullDomain:Be,featureSubtypes:Ve,featureDomainValueLookup:Xe,featureDomainCodeLookup:$e,featureSchema:Qe});export{U as $,Q as A,Le as B,Ce as C,Je as D,$ as E,g as F,xe as G,ye as H,S as I,se as J,Qe as K,Ve as L,Be as M,z as N,P as O,Xe as P,$e as Q,oe as R,H as S,ae as T,ge as U,ze as V,We as W,V as X,X as Y,x as Z,q as _,ne as a,j as a0,w as a1,b as a2,_ as a3,F as a4,Ye as a5,O as a6,L as a7,C as a8,I as a9,D as aa,M as ab,k as ac,R as ad,v as ae,A as af,G as ag,Ze as ah,Oe as ai,Ge as aj,Re as ak,ee as b,He as c,Ue as d,W as e,_e as f,Ne as g,Te as h,te as i,ue as j,ve as k,ie as l,re as m,K as n,le as o,ce as p,Se as q,De as r,me as s,Fe as t,fe as u,B as v,T as w,Me as x,ke as y,Pe as z};
