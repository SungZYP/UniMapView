// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
require({cache:{"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(U,N,H,J,w,V,T,R,P){function K(I,E){if(!I)return null;if("classBreaks"===I.type&&I.classificationMethod){var L=I.authoringInfo||{classificationMethod:""};L.classificationMethod=
I.classificationMethod;I.authoringInfo=L}"vectorField"===I.type&&I.visualVariables&&!Array.isArray(I.visualVariables)&&(I.visualVariables=[I.visualVariables]);L=I?u[I.type]||null:null;if(L)return L=new L,L.read(I,E),L;E&&E.messages&&I&&E.messages.push(new N("renderer:unsupported","Renderers of type '"+(I.type||"unknown")+"' are not supported",{definition:I,context:E}));return null}const q={key:"type",base:null,typeMap:{"unique-value":R,"class-breaks":H,"raster-colormap":w,"raster-stretch":T,"vector-field":P,
"raster-shaded-relief":V,flow:J}},m={...q,typeMap:{...q.typeMap}};delete m.typeMap["vector-field"];delete m.typeMap.flow;const u={uniqueValue:R,classBreaks:H,rasterStretch:T,rasterColormap:w,vectorField:P,rasterShadedRelief:V,flowRenderer:J};U.ClassBreaksRenderer=H;U.FlowRenderer=J;U.RasterColormapRenderer=w;U.RasterShadedReliefRenderer=V;U.RasterStretchRenderer=T;U.UniqueValueRenderer=R;U.VectorFieldRenderer=P;U.fromJSON=function(I,E){return K(I,E)};U.rasterRendererTypes=q;U.read=K;U.websceneRasterRendererTypes=
m;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/renderers/FlowRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E){var L;J=new J.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});w=L=function(c){function v(x){x=c.call(this,x)||this;x.density=.8;x.color=new H([255,255,255,1]);x.maxPathLength=200;x.trailWidth=1.5;x.flowSpeed=10;x.trailLength=100;x.smoothing=0;x.flowRepresentation="flow-from";x.type="flow";x.authoringInfo=null;x.legendOptions=null;return x}U._inheritsLoose(v,c);var F=v.prototype;F.clone=function(){var x,A;const {density:B,maxPathLength:y,trailWidth:b,flowSpeed:d,
trailLength:l,smoothing:h,flowRepresentation:g}=this,p=this.color.clone(),n=(this.visualVariables||[]).map(k=>k.clone()),f=null==(x=this.authoringInfo)?void 0:x.clone();x=null==(A=this.legendOptions)?void 0:A.clone();return new L({density:B,color:p,maxPathLength:y,trailWidth:b,flowSpeed:d,trailLength:l,smoothing:h,flowRepresentation:g,visualVariables:n,authoringInfo:f,legendOptions:x})};F.getSymbol=function(x,A){};F.getSymbolAsync=function(){var x=U._asyncToGenerator(function*(A,B){});return function(A,
B){return x.apply(this,arguments)}}();F.getSymbols=function(){return[]};return v}(u.VisualVariablesMixin(w.JSONSupport));N.__decorate([T.property({type:Number,json:{write:!0}})],w.prototype,"density",void 0);N.__decorate([T.property({type:H,json:{write:{allowNull:!0}}})],w.prototype,"color",void 0);N.__decorate([T.property({type:Number,cast:V.toPt,json:{write:!0}})],w.prototype,"maxPathLength",void 0);N.__decorate([T.property({type:Number,cast:V.toPt,json:{write:!0}})],w.prototype,"trailWidth",void 0);
N.__decorate([T.property({type:Number,json:{write:!0}})],w.prototype,"flowSpeed",void 0);N.__decorate([T.property({type:Number,json:{write:!0}})],w.prototype,"trailLength",void 0);N.__decorate([T.property({type:Number,cast:V.toPt,json:{write:!1}})],w.prototype,"smoothing",void 0);N.__decorate([T.property({type:J.apiValues,json:{type:J.jsonValues,read:{reader:J.read},write:{writer:J.write}}})],w.prototype,"flowRepresentation",void 0);N.__decorate([q.enumeration({flowRenderer:"flow"})],w.prototype,
"type",void 0);N.__decorate([T.property({type:I,json:{write:!0}})],w.prototype,"authoringInfo",void 0);N.__decorate([T.property({type:E.default,json:{write:!0}})],w.prototype,"legendOptions",void 0);return w=L=N.__decorate([m.subclass("esri.renderers.FlowRenderer")],w)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q){var m;H=m=function(u){function I(L){L=u.call(this,L)||this;L.colormapInfos=null;L.type="raster-colormap";return L}U._inheritsLoose(I,u);I.createFromColormap=function(L,c){if(!L)return null;const v=5===L[0].length;L=[...L].sort(F=>F[0][0]-F[1][0]).map(F=>{var x;return K.fromJSON({value:F[0],color:v?F.slice(1,5):F.slice(1,4).concat([255]),label:c?null!=(x=c[F[0]])?x:"":F[0]})});return new m({colormapInfos:L})};I.createFromColorramp=function(L){L=q.convertColorRampToColormap(L,
256);return m.createFromColormap(L)};var E=I.prototype;E.clone=function(){return new m({colormapInfos:this.colormapInfos.map(L=>L.toJSON())})};E.extractColormap=function(){return this.colormapInfos.map(({value:L,color:c})=>[L,c.r,c.g,c.b,1<c.a?c.a:255*c.a&255]).sort((L,c)=>L[0]-c[0])};return I}(H.JSONSupport);N.__decorate([J.property({type:[K],json:{write:!0}})],H.prototype,"colormapInfos",void 0);N.__decorate([R.enumeration({rasterColormap:"raster-colormap"})],H.prototype,"type",void 0);return H=
m=N.__decorate([P.subclass("esri.renderers.RasterColormapRenderer")],H)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(U,N,H,J,w,V,T,R,P){J=function(K){function q(){var m=K.apply(this,arguments)||this;
m.value=null;m.label=null;m.color=null;return m}U._inheritsLoose(q,K);return q}(J.JSONSupport);N.__decorate([w.property({type:Number,json:{write:!0}})],J.prototype,"value",void 0);N.__decorate([w.property({type:String,json:{write:!0}})],J.prototype,"label",void 0);N.__decorate([w.property({type:H,json:{type:[R.Integer],write:!0}})],J.prototype,"color",void 0);return J=N.__decorate([P.subclass("esri.renderers.support.ColormapInfo")],J)})},"esri/renderers/support/colorRampUtils":function(){define(["exports",
"../../Color","../../core/colorUtils"],function(U,N,H){function J(q,m){if(!q||!m||q.length!==m.length)return!1;for(let u=0;u<q.length;u++)if(q[u]>m[u]+2||q[u]<m[u]-2)return!1;return!0}function w(q,m){if(q){m=m?m:P;var u=null,I;"algorithmic"===q.type?m.some(E=>{if(J(q.fromColor.toRgb(),E.fromColor)&&J(q.toColor.toRgb(),E.toColor))return u=E.id,!0}):"multipart"===q.type&&m.some(E=>{if(q.colorRamps&&E.colorRamps&&q.colorRamps.length===E.colorRamps.length&&(I=q.colorRamps,!E.colorRamps.some((L,c)=>{if(!J(I[c].fromColor.toRgb(),
(new N(L.fromColor)).toRgb())||!J(I[c].toColor.toRgb(),(new N(L.toColor)).toRgb()))return!0}))){if(u)return!0;u=E.id}});return u}}function V(q){return(q=w(q))?K[q]:null}function T(q){if(q){var m=q.toJSON();return{Algorithm:(null==m?void 0:m.Algorithm)||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:R(q.fromColor),ToColor:R(q.toColor)}}}function R(q){q=H.toHSV(q);return{type:"HsvColor",Hue:q.h,Saturation:q.s,Value:q.v,AlphaValue:255}}const P=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,
190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,
255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,
130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],
toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,
240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},
{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,
173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,
13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},
{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],
toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,
17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",
type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,
168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",
colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,
0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],K={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",
blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",
cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",
partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",
purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",
redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",
yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"};U.PREDEFINED_COLOR_RAMP_NAME_MAP=K;U.PREDEFINED_JSON_COLOR_RAMPS=P;U.convertColorRampToColormap=function(q,m,u=!1){if(q&&m&&!(1>m)){var I="toJSON"in q?q.toJSON():q,E="multipart"===I.type?I.colorRamps.length:1;q=[];var L=[],c,v,F,x=0;if(1===m){var A="multipart"===I.type?I.colorRamps[0].fromColor:I.fromColor;L.push([0].concat(A));return L}for(let y=0;y<E;y++)q[y]={start:null,end:null},
q[y].start=x,q[y].end=x+1/E,x=q[y].end;for(let y=0;y<m;y++){var B=y/(m-1);q.forEach((b,d)=>{if(B>=b.start&&(B<b.end||y===m-1&&d===E-1)){F=(B-b.start)/(b.end-b.start);"multipart"===I.type?(A=I.colorRamps[d].fromColor,c=I.colorRamps[d].toColor):(A=I.fromColor,c=I.toColor);if(0===y)L.push([y].concat(A.slice(0,3)));else if(y===m-1)L.push([y].concat(c.slice(0,3)));else{var l={r:c[0],g:c[1],b:c[2]};b=F;d=H.toLAB({r:A[0],g:A[1],b:A[2]});l=H.toLAB(l);v=H.toRGB({l:d.l*(1-b)+b*l.l,a:d.a*(1-b)+b*l.a,b:d.b*(1-
b)+b*l.b});L.push([y,v.r,v.g,v.b])}b=null!=A[3]?1<A[3]?A[3]/255:A[3]:1;d=null!=c[3]?1<c[3]?c[3]/255:c[3]:1;u&&L[y].push(Math.min(255,Math.round(255*(b*(1-F)+d*F))))}})}return L}};U.getColorRampId=w;U.getColorRampName=V;U.getRFxArgColorRampValue=function(q){const m=V(q);if(q){if("algorithmic"===q.type)return{...T(q),Name:m};if(q.colorRamps)return q=q.colorRamps.map(T),{type:"MultiPartColorRamp",NumColorRamps:q.length,ArrayOfColorRamp:q,Name:m}}};U.rgbaConvertTo32Bit=function(q){q=q.reverse().map(m=>
{m=m.toString(16);return 2>m.length?"0"+m:m});return 4294967295&Number.parseInt(q.join(""),16)};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(U){function N(K,q){const m=[];let u,I;if(K[0].length!==q.length)throw"dimensions do not match";const E=K.length,L=K[0].length;let c=0;for(u=0;u<E;u++){for(I=c=0;I<L;I++)c+=K[u][I]*q[I];m.push(c)}return m}function H(K){K=[K.r/255,K.g/255,K.b/255].map(q=>.04045>=q?q/12.92:((q+.055)/1.055)**2.4);
K=N(R,K);return{x:100*K[0],y:100*K[1],z:100*K[2]}}function J(K){K=N(P,[K.x/100,K.y/100,K.z/100]).map(q=>Math.min(1,Math.max(.0031308>=q?12.92*q:1.055*q**(1/2.4)-.055,0)));return{r:Math.round(255*K[0]),g:Math.round(255*K[1]),b:Math.round(255*K[2])}}function w(K){K=[K.x/95.047,K.y/100,K.z/108.883].map(q=>q>(6/29)**3?q**(1/3):1/3*(29/6)**2*q+4/29);return{l:116*K[1]-16,a:500*(K[0]-K[1]),b:200*(K[1]-K[2])}}function V(K){const q=K.l;K=[(q+16)/116+K.a/500,(q+16)/116,(q+16)/116-K.b/200].map(m=>m>6/29?m**
3:3*(6/29)**2*(m-4/29));return{x:95.047*K[0],y:100*K[1],z:108.883*K[2]}}function T(K){if("r"in K&&"g"in K&&"b"in K)return K;if("l"in K&&"c"in K&&"h"in K){var q=K.c;var m=K.h;q={l:K.l,a:q*Math.cos(m),b:q*Math.sin(m)};return J(V(q))}if("l"in K&&"a"in K&&"b"in K)return J(V(K));if("x"in K&&"y"in K&&"z"in K)return J(K);if("h"in K&&"s"in K&&"v"in K){{m=(K.h+360)%360/60;q=K.v/100*255;K=K.s/100*q;const u=K*(1-Math.abs(m%2-1));switch(Math.floor(m)){case 0:m={r:K,g:u,b:0};break;case 1:m={r:u,g:K,b:0};break;
case 2:m={r:0,g:K,b:u};break;case 3:m={r:0,g:u,b:K};break;case 4:m={r:u,g:0,b:K};break;case 5:case 6:m={r:K,g:0,b:u};break;default:m={r:0,g:0,b:0}}m.r=Math.round(m.r+q-K);m.g=Math.round(m.g+q-K);m.b=Math.round(m.b+q-K);q=m}return q}return K}const R=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],P=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];U.darken=function(K,q){K=w(H(K));K.l*=1-q;return J(V(K))};U.toHSV=function(K){if("h"in K&&"s"in K&&"v"in K)return K;var q=
T(K);{K=q.r;const m=q.g,u=q.b;q=Math.max(K,m,u);const I=q-Math.min(K,m,u);K=0===I?0:q===K?(m-u)/I%6:q===m?(u-K)/I+2:(K-m)/I+4;0>K&&(K+=6);K={h:60*K,s:100*(0===I?0:I/q),v:100/255*q}}return K};U.toLAB=function(K){return"l"in K&&"a"in K&&"b"in K?K:w(H(T(K)))};U.toLCH=function(K){if(!("l"in K&&"c"in K&&"h"in K)){{var q=w(H(T(K)));K=q.l;var m=q.a;const u=q.b;q=Math.sqrt(m*m+u*u);m=Math.atan2(u,m);m=0<m?m:m+2*Math.PI;K={l:K,c:q,h:m}}}return K};U.toRGB=T;U.toXYZ=function(K){return"x"in K&&"y"in K&&"z"in
K?K:H(T(K))};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(U,N,H,J,w,V,T,R,P,K){var q;
H=q=function(m){function u(E){E=m.call(this,E)||this;E.altitude=45;E.azimuth=315;E.colorRamp=null;E.hillshadeType="multi-directional";E.pixelSizePower=.664;E.pixelSizeFactor=.024;E.scalingType="none";E.type="raster-shaded-relief";E.zFactor=1;return E}U._inheritsLoose(u,m);var I=u.prototype;I.readColorRamp=function(E){return K.fromJSON(E)};I.clone=function(){return new q({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,
pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:J.clone(this.colorRamp)})};return u}(H.JSONSupport);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"altitude",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"azimuth",void 0);N.__decorate([w.property({types:K.types,json:{write:!0}})],H.prototype,"colorRamp",void 0);N.__decorate([R.reader("colorRamp")],H.prototype,"readColorRamp",null);N.__decorate([w.property({type:["traditional",
"multi-directional"],json:{write:!0}})],H.prototype,"hillshadeType",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"pixelSizePower",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"pixelSizeFactor",void 0);N.__decorate([w.property({type:["none","adjusted"],json:{write:!0}})],H.prototype,"scalingType",void 0);N.__decorate([T.enumeration({rasterShadedRelief:"raster-shaded-relief"})],H.prototype,"type",void 0);N.__decorate([w.property({type:Number,
json:{write:!0}})],H.prototype,"zFactor",void 0);return H=q=N.__decorate([P.subclass("esri.renderers.RasterShadedReliefRenderer")],H)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m){var u;H=u=function(I){function E(c){c=I.call(this,c)||this;c.colorRamp=null;c.computeGamma=!1;c.dynamicRangeAdjustment=!1;c.gamma=[];c.maxPercent=null;c.minPercent=null;c.numberOfStandardDeviations=null;c.outputMax=null;c.outputMin=null;c.sigmoidStrengthLevel=null;c.statistics=[];c.histograms=null;c.useGamma=!1;c.stretchType="none";c.type="raster-stretch";return c}U._inheritsLoose(E,I);var L=E.prototype;L.readColorRamp=function(c){if(c)return m.fromJSON(c)};L.writeStatistics=
function(c,v,F){var x;null!=(x=c)&&x.length&&(Array.isArray(c[0])||(c=c.map(A=>[A.min,A.max,A.avg,A.stddev])),v[F]=c)};L.readStretchType=function(c,v){c=v.stretchType;"number"===typeof c&&(c=q.stretchTypeFunctionEnum[c]);return q.stretchTypeJSONDict.read(c)};L.clone=function(){return new u({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:J.clone(this.statistics),gamma:J.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,
numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:J.clone(this.colorRamp),histograms:J.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};return E}(H.JSONSupport);N.__decorate([w.property({types:m.types,json:{write:!0}})],H.prototype,"colorRamp",void 0);N.__decorate([R.reader("colorRamp")],H.prototype,"readColorRamp",null);N.__decorate([w.property({type:Boolean,json:{write:!0}})],H.prototype,"computeGamma",
void 0);N.__decorate([w.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],H.prototype,"dynamicRangeAdjustment",void 0);N.__decorate([w.property({type:[Number],json:{write:!0}})],H.prototype,"gamma",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"maxPercent",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"minPercent",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"numberOfStandardDeviations",
void 0);N.__decorate([w.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],H.prototype,"outputMax",void 0);N.__decorate([w.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],H.prototype,"outputMin",void 0);N.__decorate([w.property({type:Number,json:{write:!0}})],H.prototype,"sigmoidStrengthLevel",void 0);N.__decorate([w.property({json:{type:[[Number]],write:!0}})],H.prototype,"statistics",void 0);N.__decorate([w.property()],H.prototype,"histograms",void 0);
N.__decorate([K.writer("statistics")],H.prototype,"writeStatistics",null);N.__decorate([w.property({type:Boolean,json:{write:!0}})],H.prototype,"useGamma",void 0);N.__decorate([w.property({type:q.stretchTypeJSONDict.apiValues,json:{type:q.stretchTypeJSONDict.jsonValues,write:q.stretchTypeJSONDict.write}})],H.prototype,"stretchType",void 0);N.__decorate([R.reader("stretchType",["stretchType"])],H.prototype,"readStretchType",null);N.__decorate([T.enumeration({rasterStretch:"raster-stretch"})],H.prototype,
"type",void 0);return H=u=N.__decorate([P.subclass("esri.renderers.RasterStretchRenderer")],H)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(U,N){N=new N.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});U.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};
U.stretchTypeJSONDict=N;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../symbols/PictureMarkerSymbol ../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B,y,b,d,l,h,g){var p;const n=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);J=new T.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
T=new T.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});R=p=function(f){function k(r){r=f.call(this,r)||this;r.attributeField="Magnitude";r.flowRepresentation="flow-from";r.rotationType="arithmetic";r.style="single-arrow";r.symbolTileSize=50;r.type="vector-field";return r}U._inheritsLoose(k,f);var a=k.prototype;a.readInputUnit=function(r,D){return n.has(r)?c.unitKebabDict.fromJSON(r):null};a.readOutputUnit=function(r,D){return n.has(r)?c.unitKebabDict.fromJSON(r):null};a.clone=function(){return new p({attributeField:this.attributeField,
flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:P.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})};a.getGraphicsFromPixelData=function(){var r=U._asyncToGenerator(function*(D,M=!1,C=[]){var e;const t=[];var z=c.getUnitConversionFactor(this.inputUnit,this.outputUnit),G=(null==(e=this.rotationVariables[0])?void 0:e.rotationType)||this.rotationType;M=M?c.convertVectorFieldData(D.pixelBlock,
"vector-uv",G,z):c.convertVectorFieldUnit(D.pixelBlock,"vector-magdir",z);if(K.isNone(M))return t;D=D.extent;e=M.mask&&0<M.mask.length;z=0;G=(D.xmax-D.xmin)/M.width;const O=(D.ymax-D.ymin)/M.height;for(let X=0;X<M.height;X++)for(let W=0;W<M.width;W++,z++){let Y=new g({x:D.xmin+W*G+G/2,y:D.ymax-X*O-O/2,spatialReference:D.spatialReference});Y=(yield L.normalizeCentralMeridian(Y))[0];var S=C.some(aa=>aa.intersects(Y));e&&!M.mask[z]||S||(S=new w({geometry:{type:"point",x:Y.x,y:Y.y,spatialReference:D.spatialReference},
attributes:{Magnitude:M.pixels[0][z],Direction:M.pixels[1][z]}}),S.symbol=this._getVisualVariablesAppliedSymbol(S),t.push(S))}return t});return function(D){return r.apply(this,arguments)}}();a.getSymbol=function(r,D){};a.getSymbolAsync=function(){var r=U._asyncToGenerator(function*(D,M){});return function(D,M){return r.apply(this,arguments)}}();a.getSymbols=function(){return[]};a.getClassBreakInfos=function(){var r;return null==(r=this.styleRenderer)?void 0:r.classBreakInfos};a.getDefaultSymbol=function(){var r;
return null==(r=this.styleRenderer)?void 0:r.defaultSymbol};a._getDefaultSymbol=function(r){return new d({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new b({width:0}),size:20,color:r||new H([0,92,230])})};a._getVisualVariablesAppliedSymbol=function(r){if(r){var D=this.styleRenderer&&this.styleRenderer.getSymbol(r);D=D.clone();var M=this.sizeVariables,C=this.rotationVariables;M&&M.length&&this.sizeVariables.forEach(e=>l.applySizesToSymbol(D,y.getAllSizes([e],r)));C&&C.length&&(r.attributes.Direction+=
"flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(e=>l.applyRotationToSymbol(D,y.getRotationAngle(e,r),e.axis)));return D}};a._createStyleRenderer=function(r){let D={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(r){case "single-arrow":D=this._createSingleArrowRenderer();break;case "beaufort-kn":D=this._createBeaufortKnotsRenderer();break;case "beaufort-m":D=this._createBeaufortMeterRenderer();
break;case "beaufort-ft":D=this._createBeaufortFeetRenderer();break;case "beaufort-mi":D=this._createBeaufortMilesRenderer();break;case "beaufort-km":D=this._createBeaufortKilometersRenderer();break;case "ocean-current-m":D=this._createCurrentMeterRenderer();break;case "ocean-current-kn":D=this._createCurrentKnotsRenderer();break;case "simple-scalar":D=this._createSimpleScalarRenderer();break;case "wind-barb":D=this._createWindBarbsRenderer();break;case "classified-arrow":D=this._createClassifiedArrowRenderer()}return new v(D)};
a._createSingleArrowRenderer=function(){return{defaultSymbol:this._getDefaultSymbol()}};a._createBeaufortKnotsRenderer=function(){const r=this._getDefaultSymbol(new H([214,47,39])),D=this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:r,classBreakInfos:D}};a._createBeaufortMeterRenderer=function(){const r=this._getDefaultSymbol(new H([214,
47,39])),D=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:D}};a._createBeaufortFeetRenderer=function(){const r=this._getDefaultSymbol(new H([214,47,39]));var D=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D=D.map(M=>3.28084*M);D=this._getClassBreaks(D,[[69,
117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:D}};a._createBeaufortMilesRenderer=function(){const r=this._getDefaultSymbol(new H([214,47,39]));var D=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D=D.map(M=>2.23694*M);D=this._getClassBreaks(D,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],
[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:D}};a._createBeaufortKilometersRenderer=function(){const r=this._getDefaultSymbol(new H([214,47,39]));var D=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];D=D.map(M=>3.6*M);D=this._getClassBreaks(D,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,
classBreakInfos:D}};a._createCurrentMeterRenderer=function(){const r=this._getDefaultSymbol(new H([177,177,177])),D=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:r,classBreakInfos:D}};a._createCurrentKnotsRenderer=function(){const r=this._getDefaultSymbol(new H([177,177,177])),D=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);
return{defaultSymbol:r,classBreakInfos:D}};a._createClassifiedArrowRenderer=function(){var r;const D=this._getDefaultSymbol(new H([56,168,0]));var M=[0,1E-6,3.5,7,10.5,14];if(null!=(r=this.sizeVariables)&&r.length){const C=this.sizeVariables[0].minDataValue;r=this.sizeVariables[0].maxDataValue;if(C&&r){const e=(r-C)/5;M=Array.from(Array(6).keys()).map(t=>C+e*t)}}M=this._getClassBreaks(M,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:D,classBreakInfos:M}};a._createSimpleScalarRenderer=
function(){return{defaultSymbol:h.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}};a._createWindBarbsRenderer=function(){const r=Array.from(Array(31).keys()).map(e=>5*e),D=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],M=h.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),C=r.map((e,t)=>{if(t!==r.length-1)if(0===t)var z={minValue:e,maxValue:r[t+1],symbol:M};else z=h.fromJSON({type:"esriPMS",imageData:D[t].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),z={minValue:e,maxValue:r[t+1],symbol:z};return new x(z)});return{defaultSymbol:M,classBreakInfos:C}};a._getClassBreaks=function(r,D){return D.map((M,C)=>new x({minValue:r[C],maxValue:r[C+1],symbol:this._getDefaultSymbol(new H(M))}))};U._createClass(k,[{key:"styleRenderer",
get:function(){const r=this.attributeField,D=this._createStyleRenderer(this.style);D.field=r;return D}},{key:"sizeVariables",get:function(){const r=[];if(this.visualVariables)for(var D of this.visualVariables)"size"===D.type&&r.push(D);0===r.length&&(D=new B({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(D):this._set("visualVariables",[D]),r.push(D));return r}},{key:"rotationVariables",get:function(){const r=[];if(this.visualVariables)for(var D of this.visualVariables)"rotation"===
D.type&&r.push(D);0===r.length&&(D=new A({field:"Direction",rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(D):this._set("visualVariables",[D]),r.push(D));return r}}]);return k}(F.VisualVariablesMixin(R.JSONSupport));N.__decorate([q.property({type:String,json:{write:!0}})],R.prototype,"attributeField",void 0);N.__decorate([q.property({type:T.apiValues,json:{type:T.jsonValues,read:{reader:T.read},write:{writer:T.write}}})],R.prototype,"flowRepresentation",void 0);N.__decorate([q.property({type:["geographic",
"arithmetic"],json:{write:!0}})],R.prototype,"rotationType",void 0);N.__decorate([q.property({type:J.apiValues,json:{type:J.jsonValues,read:{reader:J.read},write:{writer:J.write}}})],R.prototype,"style",void 0);N.__decorate([q.property({json:{write:!0}})],R.prototype,"symbolTileSize",void 0);N.__decorate([q.property({type:c.unitKebabDict.apiValues,json:{type:c.unitKebabDict.jsonValues,write:{writer:c.unitKebabDict.write}}})],R.prototype,"inputUnit",void 0);N.__decorate([I.reader("inputUnit")],R.prototype,
"readInputUnit",null);N.__decorate([q.property({type:c.unitKebabDict.apiValues,json:{type:c.unitKebabDict.jsonValues,read:{reader:c.unitKebabDict.read},write:{writer:c.unitKebabDict.write}}})],R.prototype,"outputUnit",void 0);N.__decorate([I.reader("outputUnit")],R.prototype,"readOutputUnit",null);N.__decorate([u.enumeration({vectorField:"vector-field"})],R.prototype,"type",void 0);N.__decorate([q.property({type:v})],R.prototype,"styleRenderer",null);N.__decorate([q.property({type:B})],R.prototype,
"sizeVariables",null);N.__decorate([q.property({type:A})],R.prototype,"rotationVariables",null);return R=p=N.__decorate([E.subclass("esri.renderers.VectorFieldRenderer")],R)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(U,N,H,J,w){function V(b,d){return L.get(b)/L.get(d)||1}function T(b,d="geographic"){const [l,h]=b;b=Math.sqrt(l*l+h*h);let g=Math.atan2(h,l)*c;g=(360+g)%
360;"geographic"===d&&(g=(450-g)%360);return[b,g]}function R(b,d="geographic"){let l=b[1];"geographic"===d&&(l=(450-l)%360);l%=360;b=b[0];return[b*Math.cos(l/c),b*Math.sin(l/c)]}function P(b,d,l="geographic",h=1){if(!w.isValidPixelBlock(b))return b;const {pixels:g,width:p,height:n}=b;var f=p*n;const k=g[0],a=g[1],r=b.pixelType.startsWith("f")?b.pixelType:"f32",D=J.createEmptyBand(r,f);f=J.createEmptyBand(r,f);let M=0;for(let C=0;C<n;C++)for(let e=0;e<p;e++)"vector-uv"===d?([D[M],f[M]]=T([k[M],a[M]],
l),D[M]*=h):([D[M],f[M]]=R([k[M],a[M]],l),D[M]*=h,f[M]*=h),M++;b=new J({pixelType:r,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:[D,f]});b.updateStatistics();return b}function K(b=0,d=Math.PI,l=!0){l&&(d=(2*Math.PI-d)%(2*Math.PI));var h=l?-1:1;l=5*h;const g=20*h,p=25*h;h*=2;let [n,f]=[5,0-g],[k,a]=[n+2,f],[r,D]=[k-0,a+h],[M,C]=[-5,0-p],[e,t]=[M+0,C-h];b=Math.ceil(b/5);let z=Math.floor(b/10);b-=8*z;const G=[],O=[];for(let ca=0;ca<b/2;ca++,
z--){0>=z&&1===b%2&&ca===(b-1)/2&&(M=0,e=M+0,C=(C+f)/2,t=C-h);const [da,ea]=q(M,C,d,45);if(0<z){const [fa,ia]=q(k,C,d,45),[ha,la]=q(n,f,d,45);G.push(fa);G.push(ia);G.push(da);G.push(ea);G.push(ha);G.push(la)}else{const [fa,ia]=q(k,a,d,45),[ha,la]=q(r,D,d,45),[ja,ka]=q(e,t,d,45);O.push(da);O.push(ea);O.push(ja);O.push(ka);O.push(ha);O.push(la);O.push(fa);O.push(ia)}C+=l;f+=l;a+=l;D+=l;t+=l}const [S,X]=q(5,0+g,d,45),[W,Y]=q(7,0+g,d,45),[aa,Q]=q(5,0-p,d,45),[Z,ba]=q(7,0-p,d,45);return{pennants:G,barbs:O,
shaft:[S,X,W,Y,aa,Q,Z,ba]}}function q(b,d,l,h=1){return[Math.sqrt(b*b+d*d)/h,(2*Math.PI+(2*Math.PI+Math.atan2(d,b))%(2*Math.PI)-l)%(2*Math.PI)]}function m(b,d,l,h){l=V(h||"knots",l);for(h=1;h<d.length;h++)if(h===d.length-1){if(b<d[h]*l)break}else if(b<=d[h]*l)break;return Math.min(h-1,d.length-2)}function u(b,d,l,h,g){let p=0;switch(d){case "beaufort_kn":p=m(b,x,"knots",l);break;case "beaufort_km":p=m(b,x,"kilometer-per-hour",l);break;case "beaufort_ft":p=m(b,x,"feet-per-second",l);break;case "beaufort_m":p=
m(b,x,"meter-per-second",l);break;case "classified_arrow":p=m(b,g,h,l);break;case "ocean_current_m":p=m(b,A,"meter-per-second",l);break;case "ocean_current_kn":p=m(b,B,"knots",l)}return p}function I(b,d){const {style:l,inputUnit:h,outputUnit:g,breakValues:p}=d;d=v.fromJSON(h);const n=v.fromJSON(g);let f=0,k=0;const {width:a,height:r,mask:D}=b,M=b.pixels[0];b=b.pixels[1];var C=D?D.filter(G=>0<G).length:a*r;const e=new Float32Array(42*C);C=new Uint32Array(15*C);for(let G=0;G<r;G++)for(let O=0;O<a;O++){var t=
G*a+O;if(!D||D[G*a+O]){var z;const S=null!=(z=(b[t]+360)%360/180*Math.PI)?z:2*Math.PI*Math.random(),X=u(M[t],l,d,n,p);for(let W=0;W<F.length;W+=2)e[f++]=(O+.5)/a,e[f++]=(G+.5)/r,e[f++]=F[W],e[f++]=F[W+1]+S,e[f++]=X,e[f++]=M[t];t=7*(f/42-1);C[k++]=t;C[k++]=t+1;C[k++]=t+2;C[k++]=t+0;C[k++]=t+4;C[k++]=t+3;C[k++]=t+0;C[k++]=t+2;C[k++]=t+3;C[k++]=t+2;C[k++]=t+5;C[k++]=t+3;C[k++]=t+5;C[k++]=t+6;C[k++]=t+3}}return{vertexData:e,indexData:C}}function E(b,d){let l=0,h=0;const {width:g,height:p,mask:n}=b;b=
b.pixels[0];const f=[],k=[];var a=v.fromJSON(d.inputUnit);a=V(a,"knots");d="wind_speed"===d.style?5:Number.MAX_VALUE;for(let D=0;D<p;D++)for(let M=0;M<g;M++){var r=b[D*g+M]*a;if((!n||n[D*g+M])&&r<d){for(let C=0;4>C;C++)f[l++]=(M+.5)/g,f[l++]=(D+.5)/p,f[l++]=2>C?-.5:.5,f[l++]=0===C%2?-.5:.5,f[l++]=0,f[l++]=r;r=4*(l/24-1);k[h++]=r;k[h++]=r+1;k[h++]=r+2;k[h++]=r+1;k[h++]=r+2;k[h++]=r+3}}return{vertexData:new Float32Array(f),indexData:new Uint32Array(k)}}const L=new Map;L.set("meter-per-second",1);L.set("kilometer-per-hour",
.277778);L.set("knots",.514444);L.set("feet-per-second",.3048);L.set("mile-per-hour",.44704);const c=180/Math.PI,v=new N.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),F=function(b=0,d=0,l=Math.PI,h=!0){h&&(l=(2*Math.PI-l)%(2*Math.PI));h=h?-1:1;const g=-7*h,p=-2*h,n=-16*h,[f,k]=q(0,d+13*h,l,21.75),[a,r]=q(b-5.5,d+g,l,21.75),[D,M]=q(b+5.5,d+g,l,21.75),[C,e]=q(b-1.5,d+
p,l,21.75),[t,z]=q(b+1.5,d+p,l,21.75),[G,O]=q(b-1.5,d+n,l,21.75),[S,X]=q(b+1.5,d+n,l,21.75);return[f,k,a,r,C,e,t,z,D,M,G,O,S,X]}(0,0,0),x=[0,1,3,6,10,16,21,27,33,40,47,55,63],A=[0,.5,1,1.5,2],B=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],y=[];U.convertToLocalDirections=function(b,d,l,h="geographic"){if(!w.isValidPixelBlock(b)||H.isNone(l))return b;b="vector-magdir"===d?b.clone():H.unwrap(P(b,d));const g=b.pixels[1];for(let p=0;p<g.length;p++)g[p]="geographic"===h?(g[p]+l[p]+270)%360:(g[p]+360-l[p])%360;return"vector-magdir"===
d?b:P(b,"vector-magdir")};U.convertVectorFieldData=P;U.convertVectorFieldUnit=function(b,d,l=1){if(1===l||!w.isValidPixelBlock(b))return b;b=b.clone();const {pixels:h,width:g,height:p}=b,n=h[0],f=h[1];let k=0;for(let a=0;a<p;a++)for(let r=0;r<g;r++)"vector-uv"===d?(n[k]*=l,f[k]*=l):n[k]*=l,k++;b.updateStatistics();return b};U.createVFMesh=function(b,d){if("simple_scalar"===d.style)var l=E(b,d);else if("wind_speed"===d.style){{if(0===y.length)for(var h=0;30>h;h++)y.push(K(5*h,0));d=v.fromJSON(d.inputUnit);
d=V(d,"knots");const {width:f,height:k,mask:a}=b;h=b.pixels[0];b=b.pixels[1];const r=[],D=[];let M=0,C=0;for(let e=0;e<k;e++)for(let t=0;t<f;t++){var g=e*f+t,p=h[g]*d;if((!a||a[e*f+t])&&5<=p){const z=null!=(l=(b[g]+360)%360/180*Math.PI)?l:2*Math.PI*Math.random(),{pennants:G,barbs:O,shaft:S}=y[Math.min(Math.floor(p/5),29)];if(0===G.length+O.length)continue;g=r.length/6;const X=(t+.5)/f,W=(e+.5)/k;for(var n=0;n<G.length;n+=2)r[M++]=X,r[M++]=W,r[M++]=G[n],r[M++]=G[n+1]+z,r[M++]=0,r[M++]=p;for(n=0;n<
O.length;n+=2)r[M++]=X,r[M++]=W,r[M++]=O[n],r[M++]=O[n+1]+z,r[M++]=0,r[M++]=p;for(n=0;n<S.length;n+=2)r[M++]=X,r[M++]=W,r[M++]=S[n],r[M++]=S[n+1]+z,r[M++]=0,r[M++]=p;for(p=0;p<G.length/6;p++)D[C++]=g,D[C++]=g+1,D[C++]=g+2,g+=3;for(p=0;p<O.length/8;p++)D[C++]=g,D[C++]=g+1,D[C++]=g+2,D[C++]=g+1,D[C++]=g+2,D[C++]=g+3,g+=4;D[C++]=g+0;D[C++]=g+1;D[C++]=g+2;D[C++]=g+1;D[C++]=g+3;D[C++]=g+2;g+=4}}l={vertexData:new Float32Array(r),indexData:new Uint32Array(D)}}}else l=I(b,d);return l};U.createVFMeshScalar=
E;U.getUnitConversionFactor=V;U.sampleVectorField=function(b,d,l,h=[0,0],g=.5){const {width:p,height:n,mask:f}=b,[k,a]=b.pixels,[r,D]=h;b=Math.round((p-r)/l);h=Math.round((n-D)/l);var M=b*h;const C=new Float32Array(M),e=new Float32Array(M);M=new Uint8Array(M);d="vector-uv"===d;for(let z=0;z<h;z++)for(let G=0;G<b;G++){let O=0;const S=z*b+G,X=Math.max(0,z*l+D),W=Math.max(0,G*l+r),Y=Math.min(n,X+l),aa=Math.min(p,W+l);for(let Q=X;Q<Y;Q++)for(let Z=W;Z<aa;Z++){var t=Q*p+Z;if(!f||f[t]){O++;t=d?[k[t],a[t]]:
[k[t],(360+a[t])%360];const [ba,ca]=d?t:R(t);C[S]+=ba;e[S]+=ca}}if(O>=(Y-X)*(aa-W)*(1-g)){M[S]=1;const [Q,Z]=T([C[S]/O,e[S]/O]);C[S]=Q;e[S]=Z}else M[S]=0,C[S]=0,e[S]=0}l=new J({width:b,height:h,pixels:[C,e],mask:M});l.updateStatistics();return l};U.snapImageToSymbolTile=function(b,d,l,h,g){if(!H.isSome(g)||!g.spatialReference.equals(b.spatialReference))return{extent:b,width:Math.round(d/h),height:Math.round(l/h),resolution:b.width/d};const p=g.xmin;g=g.ymax;d=(b.xmax-b.xmin)/d*h;l=(b.ymax-b.ymin)/
l*h;b.xmin=p+Math.floor((b.xmin-p)/d)*d;b.xmax=p+Math.ceil((b.xmax-p)/d)*d;b.ymin=g+Math.floor((b.ymin-g)/l)*l;b.ymax=g+Math.ceil((b.ymax-g)/l)*l;return{extent:b,width:Math.round(b.width/d),height:Math.round(b.height/l),resolution:(d+l)/2}};U.unitKebabDict=v;U.uvComponentToVector=T;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q){var m;const u=T.getLogger("esri.layers.support.PixelBlock");H=m=function(I){function E(c){c=I.call(this,c)||this;c.width=null;c.height=null;c.pixelType="f32";c.validPixelCount=null;c.mask=null;c.maskIsAlpha=!1;c.pixels=null;c.statistics=null;return c}U._inheritsLoose(E,I);E.createEmptyBand=function(c,v){return new (m.getPixelArrayConstructor(c))(v)};E.getPixelArrayConstructor=function(c){let v;switch(c){case "u1":case "u2":case "u4":case "u8":v=Uint8Array;break;case "u16":v=
Uint16Array;break;case "u32":v=Uint32Array;break;case "s8":v=Int8Array;break;case "s16":v=Int16Array;break;case "s32":v=Int32Array;break;case "f32":v=Float32Array;break;case "f64":v=Float64Array;break;case "c64":case "c128":case "unknown":v=Float32Array}return v};var L=E.prototype;L.castPixelType=function(c){if(!c)return"f32";c=c.toLowerCase();-1<["u1","u2","u4"].indexOf(c)?c="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(c)&&(c="f32");return c};L.getPlaneCount=function(){return this.pixels&&
this.pixels.length};L.addData=function(c){if(!c.pixels||c.pixels.length!==this.width*this.height)throw new J("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics||{minValue:null,maxValue:null})};L.getAsRGBA=function(){const c=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(c);
break;default:this._fillFrom8Bit(c)}return new Uint8ClampedArray(c)};L.getAsRGBAFloat=function(){const c=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(c);return c};L.updateStatistics=function(){this.statistics=this.pixels.map(F=>this._calculateBandStatistics(F,this.mask));const c=this.mask;let v=0;if(c)for(let F=0;F<c.length;F++)c[F]&&v++;else v=this.width*this.height;this.validPixelCount=v};L.clamp=function(c){if(c&&"f64"!==c&&"f32"!==c){switch(c){case "u8":var v=[0,255];break;case "u16":v=
[0,65535];break;case "u32":v=[0,4294967295];break;case "s8":v=[-128,127];break;case "s16":v=[-32768,32767];break;case "s32":v=[-2147483648,2147483647];break;default:v=[-3.4*1E39,3.4*1E39]}var [F,x]=v;v=this.pixels;var A=this.width*this.height,B=v.length,y=[];for(let h=0;h<B;h++){var b=m.createEmptyBand(c,A);var d=v[h];for(let g=0;g<A;g++){var l=d[g];b[g]=l>x?x:l<F?F:l}y.push(b)}this.pixels=y;this.pixelType=c}};L.extractBands=function(c){if(R.isNone(c)||0===c.length||null==this.pixels||0===this.pixels.length)return this;
var v=this.pixels.length;const F=c.some(x=>x>=this.pixels.length);v=v===c.length&&!c.some((x,A)=>x!==A);return F||v?this:new m({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:c.map(x=>this.pixels[x]),statistics:this.statistics&&c.map(x=>this.statistics[x])})};L.clone=function(){const c=new m({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
this.mask&&(c.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let v;const F=m.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){c.pixels=[];const x=this.pixels[0].slice;for(v=0;v<this.pixels.length;v++)c.pixels[v]=x?this.pixels[v].slice(0,this.pixels[v].length):new F(this.pixels[v])}if(this.statistics)for(c.statistics=[],v=0;v<this.statistics.length;v++)c.statistics[v]=V.clone(this.statistics[v]);return c};L._fillFrom8Bit=function(c){const {mask:v,
maskIsAlpha:F,pixels:x}=this;if(c&&x&&x.length){var A,B;var y=A=B=x[0];3<=x.length?(A=x[1],B=x[2]):2===x.length&&(A=x[1]);var b=new Uint32Array(c),d=this.width*this.height;if(y.length!==d)u.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(v&&v.length===d)if(F)for(c=0;c<d;c++)v[c]&&(b[c]=v[c]<<24|B[c]<<16|A[c]<<8|y[c]);else for(c=0;c<d;c++)v[c]&&(b[c]=-16777216|B[c]<<16|A[c]<<8|y[c]);else for(c=0;c<d;c++)b[c]=-16777216|B[c]<<16|A[c]<<8|y[c]}else u.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};L._fillFromNon8Bit=function(c){const {pixels:v,mask:F,statistics:x}=this;if(c&&v&&v.length){var A=this.pixelType,B=1,y=0;B=1;x&&0<x.length?(y=x.map(g=>g.minValue).reduce((g,p)=>Math.min(g,p)),B=x.map(g=>g.maxValue-g.minValue).reduce((g,p)=>Math.max(g,p)),B=255/B):(B=255,"s8"===A?(y=-128,B=127):"u16"===A?B=65535:"s16"===A?(y=-32768,B=32767):"u32"===A?B=4294967295:"s32"===A?(y=-2147483648,B=2147483647):"f32"===A?(y=-3.4*1E39,B=3.4*1E39):
"f64"===A&&(y=-Number.MAX_VALUE,B=Number.MAX_VALUE),B=255/(B-y));c=new Uint32Array(c);A=this.width*this.height;var b,d,l;var h=b=d=v[0];if(h.length!==A)return u.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=v.length)if(b=v[1],3<=v.length&&(d=v[2]),F&&F.length===A)for(l=0;l<A;l++)F[l]&&(c[l]=-16777216|(d[l]-y)*B<<16|(b[l]-y)*B<<8|(h[l]-y)*B);else for(l=0;l<A;l++)c[l]=-16777216|(d[l]-y)*B<<16|(b[l]-y)*B<<8|(h[l]-y)*B;else if(F&&F.length===A)for(l=0;l<A;l++)b=(h[l]-
y)*B,F[l]&&(c[l]=-16777216|b<<16|b<<8|b);else for(l=0;l<A;l++)b=(h[l]-y)*B,c[l]=-16777216|b<<16|b<<8|b}else u.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};L._fillFrom32Bit=function(c){const {pixels:v,mask:F}=this;if(!c||!v||!v.length)return u.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let x,A,B,y;x=A=B=v[0];3<=v.length?(A=v[1],B=v[2]):2===v.length&&(A=v[1]);const b=this.width*this.height;if(x.length!==b)return u.error("getAsRGBAFloat()",
"Unable to convert to RGBA. The pixelblock is invalid.");let d=0;if(F&&F.length===b)for(y=0;y<b;y++)c[d++]=x[y],c[d++]=A[y],c[d++]=B[y],c[d++]=F[y]&1;else for(y=0;y<b;y++)c[d++]=x[y],c[d++]=A[y],c[d++]=B[y],c[d++]=1};L._calculateBandStatistics=function(c,v){let F=Infinity,x=-Infinity;const A=c.length;let B,y=0;if(v)for(B=0;B<A;B++)v[B]&&(y=c[B],F=y<F?y:F,x=y>x?y:x);else for(B=0;B<A;B++)y=c[B],F=y<F?y:F,x=y>x?y:x;return{minValue:F,maxValue:x}};return E}(w.JSONSupport);N.__decorate([P.property({json:{write:!0}})],
H.prototype,"width",void 0);N.__decorate([P.property({json:{write:!0}})],H.prototype,"height",void 0);N.__decorate([P.property({json:{write:!0}})],H.prototype,"pixelType",void 0);N.__decorate([K.cast("pixelType")],H.prototype,"castPixelType",null);N.__decorate([P.property({json:{write:!0}})],H.prototype,"validPixelCount",void 0);N.__decorate([P.property({json:{write:!0}})],H.prototype,"mask",void 0);N.__decorate([P.property({json:{write:!0}})],H.prototype,"maskIsAlpha",void 0);N.__decorate([P.property({json:{write:!0}})],
H.prototype,"pixels",void 0);N.__decorate([P.property({json:{write:!0}})],H.prototype,"statistics",void 0);return H=m=N.__decorate([q.subclass("esri.layers.support.PixelBlock")],H)})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],function(U,N,H){function J(c){return N.isSome(c)&&"esri.layers.support.PixelBlock"===c.declaredClass&&c.pixels&&0<c.pixels.length}function w(c,v){c=Math.min(Math.max(c,-100),100);v=Math.min(Math.max(v,
-100),100);let F,x;const A=new Uint8Array(256);for(F=0;256>F;F++)0<c&&100>c?x=(200*F-25500+510*v)/(2*(100-c))+128:0>=c&&-100<c?x=(200*F-25500+510*v)*(100+c)/2E4+128:100===c?(x=200*F-25500+256*(100-c)+510*v,x=0<x?255:0):-100===c&&(x=128),A[F]=255<x?255:0>x?0:x;return A}function V(c,v,F,x,A,B,y,b){return{xmin:A<=F*c?0:A<F*c+c?A-F*c:c,ymin:B<=x*v?0:B<x*v+v?B-x*v:v,xmax:A+y<=F*c?0:A+y<F*c+c?A+y-F*c:c,ymax:B+b<=x*v?0:B+b<x*v+v?B+b-x*v:v}}function T(c,v,F,x,A,B){const {width:y,height:b}=F.block,{x:d,y:l}=
F.offset,{width:h,height:g}=F.mosaic;F=V(y,b,x,A,d,l,h,g);let p=0;var n=0;if(B){var f=B.hasGCSSShiftTransform?360:B.halfWorldWidth,k=y*B.resolutionX,a=B.startX+x*k;k=a+k;a<f&&k>f?n=B.rightPadding:a>=f&&(p=B.leftMargin-B.rightPadding,n=0)}F.xmax-=n;if("number"===typeof v)for(B=F.ymin;B<F.ymax;B++)for(n=(A*b+B-l)*h+(x*y-d)+p,f=F.xmin;f<F.xmax;f++)c[n+f]=v;else for(B=F.ymin;B<F.ymax;B++)for(n=(A*b+B-l)*h+(x*y-d)+p,f=B*y,a=F.xmin;a<F.xmax;a++)c[n+a]=v[f+a]}function R(c,v,F={}){const {clipOffset:x,clipSize:A,
alignmentInfo:B,blockWidths:y}=F;if(y)return P(c,v,{blockWidths:y});var b=c.find(D=>J(D));if(N.isNone(b))return null;F=A?A.width:v.width;const d=A?A.height:v.height;var l=b.width,h=b.height;const g=v.width/l,p=v.height/h;v={offset:x||{x:0,y:0},mosaic:A||v,block:{width:l,height:h}};l=b.pixelType;h=H.getPixelArrayConstructor(l);var n=b.pixels.length;b=[];for(var f=0;f<n;f++){var k=new h(F*d);for(let D=0;D<p;D++)for(let M=0;M<g;M++){var a=c[D*g+M];J(a)&&(a=a.pixels[f],T(k,a,v,M,D,B))}b.push(k)}let r;
if(c.some(D=>N.isNone(D)||D.mask&&0<D.mask.length))for(r=new Uint8Array(F*d),h=0;h<p;h++)for(n=0;n<g;n++)k=c[h*g+n],(f=N.isSome(k)?k.mask:null)?T(r,f,v,n,h,B):k?T(r,1,v,n,h,B):T(r,0,v,n,h,B);c=new H({width:F,height:d,pixels:b,pixelType:l,mask:r});c.updateStatistics();return c}function P(c,v,F){const x=c.find(n=>N.isSome(n));if(!N.isSome(x))return null;var A=c.some(n=>N.isSome(n)?!!n.mask:!0);const {width:B,height:y}=v;v=A?new Uint8Array(B*y):null;({blockWidths:F}=F);const b=[],d=x.getPlaneCount(),
l=H.getPixelArrayConstructor(x.pixelType);if(A)for(let n=0,f=0;n<c.length;f+=F[n],n++)if(A=c[n],J(A)){var h=A.mask;for(var g=0;g<y;g++)for(var p=0;p<F[n];p++)v[g*B+p+f]=null==h?255:h[g*A.width+p]}for(A=0;A<d;A++){h=new l(B*y);for(let n=0,f=0;n<c.length;f+=F[n],n++)if(g=c[n],J(g)&&(p=g.pixels[A],null!=p))for(let k=0;k<y;k++)for(let a=0;a<F[n];a++)h[k*B+a+f]=p[k*g.width+a];b.push(h)}c=new H({width:B,height:y,mask:v,pixels:b,pixelType:x.pixelType});c.updateStatistics();return c}function K(c){if(!J(c))return null;
const v=c.clone(),{width:F,height:x,pixels:A,mask:B}=c;var y=A[0];c=v.pixels[0];for(let l=2;l<x-1;l++){const h=new Map;for(var b=l-2;b<l+2;b++)for(var d=0;4>d;d++){const g=b*F+d;u(h,y[g],B?B[g]:1)}c[l*F]=q(h);c[l*F+1]=c[l*F+2]=c[l*F];for(b=3;b<F-1;b++)d=(l-2)*F+b+1,u(h,y[d],B?B[d]:1),d=(l-1)*F+b+1,u(h,y[d],B?B[d]:1),d=l*F+b+1,u(h,y[d],B?B[d]:1),d=(l+1)*F+b+1,u(h,y[d],B?B[d]:1),d=(l-2)*F+b-3,m(h,y[d],B?B[d]:1),d=(l-1)*F+b-3,m(h,y[d],B?B[d]:1),d=l*F+b-3,m(h,y[d],B?B[d]:1),d=(l+1)*F+b-3,m(h,y[d],B?B[d]:
1),c[l*F+b]=q(h);c[l*F+b+1]=c[l*F+b]}for(y=0;y<F;y++)c[y]=c[F+y]=c[2*F+y],c[(x-1)*F+y]=c[(x-2)*F+y];v.updateStatistics();return v}function q(c){if(0===c.size)return 0;let v=0,F=-1,x=0;const A=c.keys();let B=A.next();for(;!B.done;)x=c.get(B.value),x>v&&(F=B.value,v=x),B=A.next();return F}function m(c,v,F){0!==F&&(F=c.get(v),1===F?c.delete(v):c.set(v,F-1))}function u(c,v,F){0!==F&&c.set(v,c.has(v)?c.get(v)+1:1)}function I(c,v,F){let {x,y:A}=v;const {width:B,height:y}=F;if(0===x&&0===A&&y===c.height&&
B===c.width)return c;const {width:b,height:d}=c;v=Math.max(0,A);const l=Math.max(0,x),h=Math.min(x+B,b),g=Math.min(A+y,d);if(0>h||0>g||!J(c))return null;x=Math.max(0,-x);A=Math.max(0,-A);const {pixels:p,mask:n}=c;var f=B*y,k=p.length;const a=[];for(var r=0;r<k;r++){var D=p[r],M=H.createEmptyBand(c.pixelType,f);for(let C=v;C<g;C++){const e=C*b;let t=(C+A-v)*B+x;for(let z=l;z<h;z++)M[t++]=D[e+z]}a.push(M)}f=new Uint8Array(f);for(k=v;k<g;k++)for(r=k*b,D=(k+A-v)*B+x,M=l;M<h;M++)f[D++]=n?n[r+M]:1;c=new H({width:F.width,
height:F.height,pixelType:c.pixelType,pixels:a,mask:f});c.updateStatistics();return c}function E(c,v=!0){if(!J(c))return null;const {pixels:F,width:x,height:A,mask:B,pixelType:y}=c;c=[];const b=Math.round(x/2),d=Math.round(A/2),l=A-1,h=x-1;for(var g=0;g<F.length;g++){var p=F[g],n=H.createEmptyBand(y,b*d),f=0;for(var k=0;k<A;k+=2)for(var a=0;a<x;a+=2){var r=p[k*x+a];if(v){var D=a===h?r:p[k*x+a+1];const M=k===l?r:p[k*x+a+x],C=a===h?M:k===l?D:p[k*x+a+x+1];n[f++]=(r+D+M+C)/4}else n[f++]=r}c.push(n)}g=
null;if(B)for(g=new Uint8Array(b*d),p=0,n=0;n<A;n+=2)for(f=0;f<x;f+=2)k=B[n*x+f],v?(a=f===h?k:B[n*x+f+1],r=n===l?k:B[n*x+f+x],D=f===h?r:n===l?a:B[n*x+f+x+1],g[p++]=k*a*r*D?1:0):g[p++]=k;return new H({width:b,height:d,pixelType:y,pixels:c,mask:g})}function L(c,v,F,x,A=.5){const {width:B,height:y}=c,{width:b,height:d}=v;c=x.cols;x=x.rows;v=Math.ceil(b/c-.1/c);const l=Math.ceil(d/x-.1/x);let h,g,p,n,f;const k=v*c;var a=k*l*x;const r=new Float32Array(a),D=new Float32Array(a),M=new Uint32Array(a),C=new Uint32Array(a);
let e=0,t,z;for(let S=0;S<l;S++)for(let X=0;X<v;X++){var G=12*(S*v+X);a=F[G];h=F[G+1];g=F[G+2];p=F[G+3];n=F[G+4];f=F[G+5];for(var O=0;O<x;O++){e=(S*x+O)*k+X*c;z=(O+.5)/x;for(let W=0;W<O;W++)t=(W+.5)/c,r[e+W]=(a*t+h*z+g)*B-A,D[e+W]=(p*t+n*z+f)*y-A,M[e+W]=Math.round(r[e+W]),C[e+W]=Math.round(D[e+W])}G+=6;a=F[G];h=F[G+1];g=F[G+2];p=F[G+3];n=F[G+4];f=F[G+5];for(G=0;G<x;G++)for(e=(S*x+G)*k+X*c,z=(G+.5)/x,O=G;O<c;O++)t=(O+.5)/c,r[e+O]=(a*t+h*z+g)*B-A,D[e+O]=(p*t+n*z+f)*y-A,M[e+O]=Math.round(r[e+O]),C[e+
O]=Math.round(D[e+O])}return{offsets_x:r,offsets_y:D,offsets_xi:M,offsets_yi:C,gridWidth:k}}U.approximateTransform=function(c,v,F,x,A="nearest"){if(!J(c))return null;"majority"===A&&(c=K(c));const {pixels:B,mask:y,pixelType:b}=c,d=c.width;var l=c.height;const h=H.getPixelArrayConstructor(b),g=B.length,{width:p,height:n}=v;c=!1;for(let C=0;C<F.length;C+=3)-1===F[C]&&-1===F[C+1]&&-1===F[C+2]&&(c=!0);const {offsets_x:f,offsets_y:k,offsets_xi:a,offsets_yi:r,gridWidth:D}=L({width:d,height:l},v,F,x,"majority"===
A?0:.5);let M;v=(C,e,t)=>{const z=C instanceof Float32Array||C instanceof Float64Array?0:.5;for(let G=0;G<n;G++){M=G*D;for(let O=0;O<p;O++){if(0>f[M]||0>k[M])C[G*p+O]=0;else if(t)C[G*p+O]=e[a[M]+r[M]*d];else{const S=Math.floor(f[M]),X=Math.floor(k[M]),W=Math.ceil(f[M]),Y=Math.ceil(k[M]),aa=f[M]-S,Q=k[M]-X;C[G*p+O]=!y||y[S+X*d]&&y[S+X*d]&&y[S+Y*d]&&y[W+Y*d]?(1-Q)*((1-aa)*e[S+X*d]+aa*e[W+X*d])+Q*((1-aa)*e[S+Y*d]+aa*e[W+Y*d])+z:e[a[M]+r[M]*d]}M++}}};F=[];for(l=0;l<g;l++)x=new h(p*n),v(x,B[l],"nearest"===
A||"majority"===A),F.push(x);A=new H({width:p,height:n,pixelType:b,pixels:F});if(y)A.mask=new Uint8Array(p*n),v(A.mask,y,!0);else if(c)for(A.mask=new Uint8Array(p*n),c=0;c<p*n;c++)A.mask[c]=0>f[c]||0>k[c]?0:1;A.updateStatistics();return A};U.clip=I;U.colorize=function(c,v){if(!J(c)||!v&&(v.indexedColormap||v.indexed2DColormap))return c;const F=c.clone();var x=F.pixels;let A=F.mask;const B=F.width*F.height;if(1!==x.length)return c;const {indexedColormap:y,indexed2DColormap:b,offset:d,alphaSpecified:l}=
v;v=y.length-1;c=0;x=x[0];const h=new Uint8Array(x.length),g=new Uint8Array(x.length),p=new Uint8Array(x.length);let n=0;if(y)if(A)for(c=0;c<B;c++)A[c]&&(n=4*(x[c]-d),n<d||n>v?A[c]=0:(h[c]=y[n],g[c]=y[n+1],p[c]=y[n+2],A[c]=y[n+3]));else{A=new Uint8Array(B);for(c=0;c<B;c++)n=4*(x[c]-d),n<d||n>v?A[c]=0:(h[c]=y[n],g[c]=y[n+1],p[c]=y[n+2],A[c]=y[n+3]);F.mask=A}else if(A)for(c=0;c<B;c++)A[c]&&(v=b[x[c]],h[c]=v[0],g[c]=v[1],p[c]=v[2],A[c]=v[3]);else{A=new Uint8Array(B);for(c=0;c<B;c++)v=b[x[c]],h[c]=v[0],
g[c]=v[1],p[c]=v[2],A[c]=v[3];F.mask=A}F.pixels=[h,g,p];F.statistics=null;F.pixelType="u8";F.maskIsAlpha=l;return F};U.createColormapLUT=function(c){if(c){var v=c.colormap;if(v&&0!==v.length){v=v.sort((l,h)=>l[0]-h[0]);var F=0;0>v[0][0]&&(F=v[0][0]);var x=Math.max(256,v[v.length-1][0]-F+1),A=new Uint8Array(4*x),B=[],y=0,b=0,d=5===v[0].length;if(65536<x)return v.forEach(l=>{B[l[0]-F]=d?l.slice(1):l.slice(1).concat([255])}),{indexed2DColormap:B,offset:F,alphaSpecified:d};if(c.fillUnspecified)for(c=
v[b],y=c[0]-F;y<x;y++)A[4*y]=c[1],A[4*y+1]=c[2],A[4*y+2]=c[3],A[4*y+3]=d?c[4]:255,y===c[0]-F&&(c=b===v.length-1?c:v[++b]);else for(y=0;y<v.length;y++)c=v[y],b=4*(c[0]-F),A[b]=c[1],A[b+1]=c[2],A[b+2]=c[3],A[b+3]=d?c[4]:255;return{indexedColormap:A,offset:F,alphaSpecified:d}}}};U.createContrastBrightnessLUT=w;U.createHistogramEqualizationLUT=function(c,v=256){v=Math.min(v,256);const {size:F,counts:x}=c;c=new Uint8Array(F);var A=x.reduce((l,h)=>l+h/v,0);let B=0;var y=0;let b=0,d=A;for(let l=0;l<F;l++)if(b+=
x[l],!(l<F-1&&b+x[l+1]<d)){for(;B<v-1&&d<b;)B++,d+=A;for(;y<=l;y++)c[y]=B;y=l+1}for(A=y;A<F;A++)c[A]=v-1;return c};U.createStretchLUT=function(c){const {minCutOff:v,maxCutOff:F,gamma:x,pixelType:A}=c,B=c.outMin||0,y=c.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(A))return null;const b=v.length;let d;let l=0;"s8"===A?l=-127:"s16"===A&&(l=-32767);let h=256;-1<["u16","s16"].indexOf(A)&&(h=65536);const g=[],p=y-B;for(d=0;d<b;d++)g[d]=F[d]-v[d];var n=x&&x.length>=b;const f=[];if(n)for(d=0;d<b;d++)f[d]=
1<x[d]?2<x[d]?6.5+(x[d]-2)**2.5:6.5+100*(2-x[d])**4:1;let k;const a=[];let r,D,M;if(n)for(d=0;d<b;d++){M=[];for(n=0;n<h;n++)r=n+l,k=(r-v[d])/g[d],D=1,1<x[d]&&(D-=(1/p)**(k*f[d])),M[n]=r<F[d]&&r>v[d]?Math.floor(D*p*k**(1/x[d]))+B:r>=F[d]?y:B;a[d]=M}else for(d=0;d<b;d++){M=[];for(n=0;n<h;n++)r=n+l,M[n]=r<=v[d]?B:r>=F[d]?y:Math.floor((r-v[d])/g[d]*p)+B;a[d]=M}if(null!=c.contrastOffset)for(c=w(c.contrastOffset,c.brightnessOffset),d=0;d<b;d++)for(M=a[d],n=0;n<h;n++)M[n]=c[M[n]];return{lut:a,offset:l}};
U.estimateStatisticsFromHistograms=function(c){const v=[];for(let B=0;B<c.length;B++){const {min:y,max:b,size:d,counts:l}=c[B];let h=0;var F=0;for(var x=0;x<d;x++)h+=l[x],F+=x*l[x];F/=h;x=0;for(var A=0;A<d;A++)x+=l[A]*(A-F)**2;A=(b-y)/d;v.push({min:y,max:b,avg:(F+.5)*A+y,stddev:Math.sqrt(x/(h-1))*A})}return v};U.estimateStatisticsHistograms=function(c){if(!J(c))return null;c.statistics||c.updateStatistics();const {pixels:v,mask:F,pixelType:x,statistics:A}=c;c=c.width*c.height;const B=v.length;let y,
b;let d;var l;const h=[],g=[];for(d=0;d<B;d++){var p=new Uint32Array(256);var n=v[d];if("u8"===x)if(y=-.5,b=255.5,F)for(l=0;l<c;l++)F[l]&&p[n[l]]++;else for(l=0;l<c;l++)p[n[l]]++;else{y=A[d].minValue;b=A[d].maxValue;var f=(b-y)/256;var k=new Uint32Array(257);if(F)for(l=0;l<c;l++)F[l]&&k[Math.floor((n[l]-y)/f)]++;else for(l=0;l<c;l++)k[Math.floor((n[l]-y)/f)]++;for(l=0;255>l;l++)p[l]=k[l];p[255]=k[255]+k[256]}h.push({min:y,max:b,size:256,counts:p});for(l=n=k=f=0;256>l;l++)f+=p[l],k+=l*p[l];k/=f;for(l=
0;256>l;l++)n+=p[l]*(l-k)**2;p=Math.sqrt(n/(f-1));f=(b-y)/256;l=(k+.5)*f+y;p*=f;g.push({min:y,max:b,avg:l,stddev:p})}return{statistics:g,histograms:h}};U.extractBands=function(c,v){if(null==v||!v.length||!J(c))return c;const F=c.pixels.length;return v&&v.some(x=>x>=F)||1===F&&1===v.length&&0===v[0]||F===v.length&&!v.some((x,A)=>x!==A)?c:new H({pixelType:c.pixelType,width:c.width,height:c.height,mask:c.mask,validPixelCount:c.validPixelCount,maskIsAlpha:c.maskIsAlpha,pixels:v.map(x=>c.pixels[x]),statistics:c.statistics&&
v.map(x=>c.statistics[x])})};U.getClipBounds=V;U.getLocalArithmeticNorthRotations=function(c,v){const {coefficients:F,spacing:x}=v,{offsets_x:A,offsets_y:B,gridWidth:y}=L(c,c,F,{rows:x[0],cols:x[1]},.5),{width:b,height:d}=c;c=new Float32Array(b*d);v=180/Math.PI;for(let g=0;g<d;g++)for(let p=0;p<b;p++){var l=g*y+p,h=0===g?l:l-y;const n=g===d-1?l:l+y;l=A[h]-A[n];h=B[n]-B[h];isNaN(l)||isNaN(h)?c[g*b+p]=90:(h=Math.atan2(h,l)*v,h=(360+h)%360,c[g*b+p]=h)}return c};U.isValidPixelBlock=J;U.lookupPixels=function(c,
v){if(!J(c))return null;const {pixels:F,mask:x}=c,A=c.width*c.height,B=F.length;let y=v.lut;({offset:v}=v);let b,d;y&&1===y[0].length&&(y=F.map(()=>y));const l=[];let h,g,p;if(v)if(null==x)for(b=0;b<B;b++){h=F[b];g=y[b];p=new Uint8Array(A);for(d=0;d<A;d++)p[d]=g[h[d]-v];l.push(p)}else for(b=0;b<B;b++){h=F[b];g=y[b];p=new Uint8Array(A);for(d=0;d<A;d++)x[d]&&(p[d]=g[h[d]-v]);l.push(p)}else if(null==x)for(b=0;b<B;b++){h=F[b];g=y[b];p=new Uint8Array(A);for(d=0;d<A;d++)p[d]=g[h[d]];l.push(p)}else for(b=
0;b<B;b++){h=F[b];g=y[b];p=new Uint8Array(A);for(d=0;d<A;d++)x[d]&&(p[d]=g[h[d]]);l.push(p)}c=new H({width:c.width,height:c.height,pixels:l,mask:x,pixelType:"u8"});c.updateStatistics();return c};U.mosaic=R;U.mosaicPixelData=function(c,v){if(!c||0===c.length)return null;var F=c.find(g=>g.pixelBlock);if(!F||N.isNone(F.pixelBlock))return null;var x=(F.extent.xmax-F.extent.xmin)/F.pixelBlock.width;const A=(F.extent.ymax-F.extent.ymin)/F.pixelBlock.height,B=.01*Math.min(x,A),y=c.sort((g,p)=>Math.abs(g.extent.ymax-
p.extent.ymax)>B?p.extent.ymax-g.extent.ymax:Math.abs(g.extent.xmin-p.extent.xmin)>B?g.extent.xmin-p.extent.xmin:0);var b=Math.min.apply(null,y.map(g=>g.extent.xmin));const d=Math.min.apply(null,y.map(g=>g.extent.ymin)),l=Math.max.apply(null,y.map(g=>g.extent.xmax)),h=Math.max.apply(null,y.map(g=>g.extent.ymax));c={x:Math.round((v.xmin-b)/x),y:Math.round((h-v.ymax)/A)};b={width:Math.round((l-b)/x),height:Math.round((h-d)/A)};x={width:Math.round((v.xmax-v.xmin)/x),height:Math.round((v.ymax-v.ymin)/
A)};if(Math.round(b.width/F.pixelBlock.width)*Math.round(b.height/F.pixelBlock.height)!==y.length||0>c.x||0>c.y||b.width<x.width||b.height<x.height)return null;F=y.map(g=>g.pixelBlock);F=R(F,b,{clipOffset:c,clipSize:x});return{extent:v,pixelBlock:F}};U.remapColor=function(c,v){if(!J(c))return null;c=c.clone();var {pixels:F}=c;const x=c.width*c.height,A=v.length,B=Math.floor(A/2),y=v[Math.floor(B)];F=F[0];let b,d,l,h,g,p,n=!1;const f=new Uint8Array(x),k=new Uint8Array(x),a=new Uint8Array(x);let r=
c.mask;const D=4===v[0].mappedColor.length;r||(r=new Uint8Array(x),r.fill(D?255:1),c.mask=r);for(g=0;g<x;g++)if(r[g]){b=F[g];n=!1;p=B;d=y;l=0;for(h=A-1;1<h-l;){if(b===d.value){n=!0;break}b>d.value?l=p:h=p;p=Math.floor((l+h)/2);d=v[Math.floor(p)]}n||(b===v[l].value?(d=v[l],n=!0):b===v[h].value?(d=v[h],n=!0):b<v[l].value?(n=!1,d=null):b>v[l].value&&(b<v[h].value?(d=v[l],n=!0):h===A-1?(n=!1,d=null):(d=v[h],n=!0)));n?(f[g]=d.mappedColor[0],k[g]=d.mappedColor[1],a[g]=d.mappedColor[2],r[g]=d.mappedColor[3]):
f[g]=k[g]=a[g]=r[g]=0}c.pixels=[f,k,a];c.mask=r;c.pixelType="u8";c.maskIsAlpha=D;return c};U.resampleByMajority=K;U.setValidBoundary=function(c,v,F){if(!J(c))return null;const {width:x,height:A}=c,B=v.x;v=v.y;const y=F.width+B;F=F.height+v;if(0>B||0>v||y>x||F>A||0===B&&0===v&&y===x&&F===A)return c;c.mask||(c.mask=new Uint8Array(x*A));const b=c.mask;for(let d=0;d<A;d++){const l=d*x;for(let h=0;h<x;h++)b[l+h]=d<v||d>=F||h<B||h>=y?0:1}c.updateStatistics();return c};U.split=function(c,v,F){if(!J(c))return null;
const {width:x,height:A}=v;let {width:B,height:y}=c;const b=new Map,d={x:0,y:0};F=null==F?1:1+F;for(let l=0;l<F;l++){const h=Math.ceil(B/x),g=Math.ceil(y/A);for(let p=0;p<g;p++){d.y=p*A;for(let n=0;n<h;n++){d.x=n*x;const f=I(c,d,v);b.set(`${l}/${p}/${n}`,f)}}l<F-1&&(c=E(c));B=Math.round(B/2);y=Math.round(y/2)}return b};U.stretch=function(c,v){if(!J(c))return null;c=c.clone();const {pixels:F,mask:x}=c,{minCutOff:A,maxCutOff:B,gamma:y}=v,b=v.outMin||0;v=v.outMax||255;const d=c.width*c.height,l=F.length;
let h;let g,p,n;const f=v-b,k=[];for(h=0;h<l;h++)k[h]=B[h]-A[h];var a=y&&y.length>=l;const r=[];if(a)for(h=0;h<l;h++)r[h]=1<y[h]?2<y[h]?6.5+(y[h]-2)**2.5:6.5+100*(2-y[h])**4:1;if(a)if(null!=x)for(a=0;a<d;a++){if(x[a])for(h=0;h<l;h++)g=F[h][a],n=(g-A[h])/k[h],p=1,1<y[h]&&(p-=(1/f)**(n*r[h])),F[h][a]=g<B[h]&&g>A[h]?Math.floor(p*f*n**(1/y[h]))+b:g>=B[h]?v:b}else for(a=0;a<d;a++)for(h=0;h<l;h++)g=F[h][a],n=(g-A[h])/k[h],p=1,1<y[h]&&(p-=(1/f)**(n*r[h])),F[h][a]=g<B[h]&&g>A[h]?Math.floor(p*f*n**(1/y[h]))+
b:g>=B[h]?v:b;else if(null!=x)for(a=0;a<d;a++){if(x[a])for(h=0;h<l;h++)g=F[h][a],F[h][a]=g<B[h]&&g>A[h]?Math.floor((g-A[h])/k[h]*f)+b:g>=B[h]?v:b}else for(a=0;a<d;a++)for(h=0;h<l;h++)g=F[h][a],F[h][a]=g<B[h]&&g>A[h]?Math.floor((g-A[h])/k[h]*f)+b:g>=B[h]?v:b;c.pixelType="u8";c.updateStatistics();return c};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u){function I(f){f=f.symbolLayers;if(!f)return null;let k=null;f.forEach(a=>{if("object"!==a.type||null==a.resource.href)k="water"===a.type?R.unwrap(a.color):R.isSome(a.material)?R.unwrap(a.material.color):null});return k?new J(k):null}function E(f,k){if(null==k)return f;f=f.toRgba();f[3]*=k;return new J(f)}function L(f,k,a){if(f=f.symbolLayers){var r=D=>{D=R.isSome(D)?D:null;k=k||D||null!=a&&n;return E(k,a)};f.forEach(D=>{if("object"!==D.type||null==D.resource.href||
k)if("water"===D.type)D.color=r(D.color);else{var M=R.isSome(D.material)?D.material.color:null;M=r(M);R.isNone(D.material)?D.material=new u.Symbol3DMaterial({color:M}):D.material.color=M;null!=a&&"outline"in D&&R.isSome(D.outline)&&R.isSome(D.outline.color)&&(D.outline.color=E(D.outline.color,a))}})}}function c(f,k){return v.apply(this,arguments)}function v(){v=H._asyncToGenerator(function*(f,k){(f=f.symbolLayers)&&(yield V.forEach(f,function(){var a=H._asyncToGenerator(function*(r){return F(r,k)});
return function(r){return a.apply(this,arguments)}}()))});return v.apply(this,arguments)}function F(f,k){return x.apply(this,arguments)}function x(){x=H._asyncToGenerator(function*(f,k){switch(f.type){case "extrude":f.size="number"===typeof k[2]?k[2]:0;break;case "icon":case "line":case "text":k=A(k);R.isSome(k)&&(f.size=k);break;case "path":{const a=b(k,K.ONES,[f.width,void 0,f.height]);f.width=h(k[0],f.width,1,a);f.height=h(k[2],f.height,1,a)}break;case "object":yield B(f,k)}});return x.apply(this,
arguments)}function A(f){for(const k of f)if("number"===typeof k)return k;return null}function B(f,k){return y.apply(this,arguments)}function y(){y=H._asyncToGenerator(function*(f,k){const {resourceSize:a,symbolSize:r}=yield d(f),D=b(k,a,r);f.width=h(k[0],r[0],a[0],D);f.depth=h(k[1],r[1],a[1],D);f.height=h(k[2],r[2],a[2],D)});return y.apply(this,arguments)}function b(f,k,a){for(let r=0;3>r;r++){const D=f[r];switch(D){case "symbol-value":return null!=a[r]?a[r]/k[r]:1;case "proportional":break;default:if(D&&
k[r])return D/k[r]}}return 1}function d(f){return l.apply(this,arguments)}function l(){l=H._asyncToGenerator(function*(f){const k=yield(yield new Promise((e,t)=>U(["./symbolLayerUtils"],e,t))).computeObjectLayerResourceSize(f,10),{width:a,height:r,depth:D}=f;f=[a,D,r];let M=1;for(var C=0;3>C;C++)if(null!=f[C]){M=f[C]/k[C];break}for(C=0;3>C;C++)null==f[C]&&(f[C]=k[C]*M);return{resourceSize:k,symbolSize:f}});return l.apply(this,arguments)}function h(f,k,a,r){switch(f){case "proportional":return a*r;
case "symbol-value":return null!=k?k:a;default:return f}}function g(){g=H._asyncToGenerator(function*(f,k){if(f&&k){if(w.isSymbol3D(f))return c(f,k);if(w.isSymbol2D(f)&&(k=A(k),!R.isNone(k)))switch(f.type){case "simple-marker":f.size=k;break;case "picture-marker":{const a=f.width/f.height;1<a?(f.width=k,f.height=k*a):(f.width=k*a,f.height=k);break}case "simple-line":f.width=k;break;case "text":f.font.size=k}}});return g.apply(this,arguments)}const p=/\/resource\/(.*?)\.svg$/,n=new J("white");N.applyColorToSymbol=
function(f,k,a){if(f&&(k||null!=a))if(k&&(k=new J(k)),w.isSymbol3D(f))L(f,k,a);else if(w.isSymbol2D(f)){if(k=k||f.color)f.color=E(k,a);null!=a&&"outline"in f&&f.outline&&f.outline.color&&(f.outline.color=E(f.outline.color,a))}};N.applyOpacityToColor=E;N.applyRotationToSymbol=function(f,k,a){f&&null!=k&&(w.isSymbol3D(f)?(f=f.symbolLayers)&&f.forEach(r=>{if(r&&"object"===r.type)switch(a){case "tilt":r.tilt=k;break;case "roll":r.roll=k;break;default:r.heading=k}}):!w.isSymbol2D(f)||"simple-marker"!==
f.type&&"picture-marker"!==f.type&&"text"!==f.type||(f.angle=k))};N.applySizesToSymbol=function(f,k){return g.apply(this,arguments)};N.getCSSFilterFromEffectList=function(f){if(!f)return null;f=f.effects.filter(k=>"bloom"!==k.type).map(k=>k.toJSON());return q.effectFunctionsFromJSON(f)};N.getColorFromSymbol=function(f,k){if(!f)return null;let a=null;w.isSymbol3D(f)?a=I(f):w.isSymbol2D(f)&&(a=f.color?new J(f.color):null);return a?E(a,k):null};N.getIconHref=function(f,k){k=k.resource.href;return!T("esri-canvas-svg-support")&&
f.styleOrigin&&p.test(k)?k.replace(p,"/resource/png/$1.png"):k};N.getSymbolOutlineSize=function(f){if(!f)return 0;if(w.isSymbol3D(f)){{const k=f.symbolLayers&&f.symbolLayers.length;k?(f=f.symbolLayers.getItemAt(k-1),f="outline"in f?R.get(f,"outline","size"):void 0):f=void 0}return R.isSome(f)?f:0}return(f=m.getStroke(f))&&P.px2pt(f.width)||0};N.isVolumetricSymbol=function(f){if(R.isNone(f)||!("symbolLayers"in f)||R.isNone(f.symbolLayers))return!1;switch(f.type){case "point-3d":return f.symbolLayers.some(k=>
"object"===k.type);case "line-3d":return f.symbolLayers.some(k=>"path"===k.type);case "polygon-3d":return f.symbolLayers.some(k=>"object"===k.type||"extrude"===k.type);default:return!1}};Object.defineProperty(N,"__esModule",{value:!0})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(U,N,H,J,w,V,T){function R(u){if(!u)return null;let I;switch(u.type){case "simple-fill":case "picture-fill":case "simple-marker":I=
R(u.outline);break;case "simple-line":{const E=V.pt2px(u.width);"none"!==u.style&&0!==E&&(I={color:u.color,style:m(u.style),width:E,cap:u.cap,join:"miter"===u.join?V.pt2px(u.miterLimit):u.join});break}default:I=null}return I}const P={left:"start",center:"middle",right:"end",justify:"start"},K={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},q=new w(1E3),m=function(){const u={};return function(I){if(u[I])return u[I];const E=I.replace(/-/g,"");return u[I]=E}}();
H=new H([128,128,128]);U.defaultThematicColor=H;U.dekebabifyLineStyle=m;U.getFill=function(u){const I=u.style;let E=null;if(u)switch(u.type){case "simple-marker":"cross"!==I&&"x"!==I&&(E=u.color);break;case "simple-fill":"solid"===I?E=u.color:"none"!==I&&(E={type:"pattern",x:0,y:0,src:N.getAssetUrl(`esri/symbols/patterns/${I}.png`),width:5,height:5});break;case "picture-fill":E={type:"pattern",src:u.url,width:V.pt2px(u.width)*u.xscale,height:V.pt2px(u.height)*u.yscale,x:V.pt2px(u.xoffset),y:V.pt2px(u.yoffset)};
break;case "text":E=u.color;break;case "cim":E=T.getCIMSymbolColor(u)}return E};U.getPatternUrlWithColor=function(u,I){const E=u+"-"+I;return void 0!==q.get(E)?Promise.resolve(q.get(E)):J(u,{responseType:"image"}).then(L=>{L=L.data;const c=L.naturalWidth,v=L.naturalHeight,F=document.createElement("canvas");F.width=c;F.height=v;const x=F.getContext("2d");x.fillStyle=I;x.fillRect(0,0,c,v);x.globalCompositeOperation="destination-in";x.drawImage(L,0,0);L=F.toDataURL();q.put(E,L);return L})};U.getSVGAlign=
function(u){return u=(u=u.horizontalAlignment)&&P[u.toLowerCase()]||"middle"};U.getSVGBaseline=function(u){return(u=u.verticalAlignment)&&K[u.toLowerCase()]||"alphabetic"};U.getSVGBaselineShift=function(u){return"bottom"===u.verticalAlignment?"super":null};U.getStroke=R;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(U){return function(){function N(J,w){this._storage=new U.MemCacheStorage;this._storage.maxSize=J;w&&this._storage.registerRemoveFunc("",
w)}var H=N.prototype;H.put=function(J,w){this._storage.put(J,w,1,1)};H.pop=function(J){return this._storage.pop(J)};H.get=function(J){return this._storage.get(J)};H.clear=function(){this._storage.clearAll()};H.destroy=function(){this._storage.destroy()};return N}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(U,N,H){function J(m){m=H.toCIMSymbolJSON(m);if("CIMTextSymbol"===m.type)return m.height;let u=0;if(m.symbolLayers)for(const I of m.symbolLayers)H.isCIMMarker(I)&&
I.size>u?u=I.size:H.isCIMStroke(I)&&I.width>u?u=I.width:H.isCIMFill(I);return u}function w(m,u,I,E){if("CIMTextSymbol"===m.type)m.height*=u;else{if(I&&m.effects)for(const L of m.effects)R(L,u);if(m.symbolLayers)for(const L of m.symbolLayers)switch(L.type){case "CIMPictureMarker":case "CIMVectorMarker":V(L,u,E);break;case "CIMPictureStroke":case "CIMSolidStroke":null!=E&&E.preserveOutlineWidth||!L.width||(L.width*=u);break;case "CIMPictureFill":L.height&&(L.height*=u);L.offsetX&&(L.offsetX*=u);L.offsetY&&
(L.offsetY*=u);break;case "CIMHatchFill":w(L.lineSymbol,u,!0,{...E,preserveOutlineWidth:!1}),L.offsetX&&(L.offsetX*=u),L.offsetY&&(L.offsetY*=u),L.separation&&(L.separation*=u)}}}function V(m,u,I){m.markerPlacement&&T(m.markerPlacement,u);m.offsetX&&(m.offsetX*=u);m.offsetY&&(m.offsetY*=u);m.anchorPoint&&"Absolute"===m.anchorPointUnits&&(m.anchorPoint={x:m.anchorPoint.x*u,y:m.anchorPoint.y*u});m.size*=u;if("CIMVectorMarker"===m.type&&m.markerGraphics)for(const E of m.markerGraphics)m.scaleSymbolsProportionally||
w(E.symbol,u,!0,I)}function T(m,u){H.isCIMMarkerStrokePlacement(m)&&m.offset&&(m.offset*=u);switch(m.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":m.customEndingOffset&&(m.customEndingOffset*=u);m.offsetAlongLine&&(m.offsetAlongLine*=u);if(m.placementTemplate&&m.placementTemplate.length){var I=m.placementTemplate.map(E=>E*u);m.placementTemplate=I}break;case "CIMMarkerPlacementAlongLineVariableSize":m.maxRandomOffset&&(m.maxRandomOffset*=u);m.placementTemplate&&
m.placementTemplate.length&&(I=m.placementTemplate.map(E=>E*u),m.placementTemplate=I);break;case "CIMMarkerPlacementOnLine":m.startPointOffset&&(m.startPointOffset*=u);break;case "CIMMarkerPlacementAtExtremities":m.offsetAlongLine&&(m.offsetAlongLine*=u);break;case "CIMMarkerPlacementAtRatioPositions":m.beginPosition&&(m.beginPosition*=u);m.endPosition&&(m.endPosition*=u);break;case "CIMMarkerPlacementPolygonCenter":m.offsetX&&(m.offsetX*=u);m.offsetY&&(m.offsetY*=u);break;case "CIMMarkerPlacementInsidePolygon":m.offsetX&&
(m.offsetX*=u),m.offsetY&&(m.offsetY*=u),m.stepX&&(m.stepX*=u),m.stepY&&(m.stepY*=u)}}function R(m,u){switch(m.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":m.width&&(m.width*=u);break;case "CIMGeometricEffectBuffer":m.size&&(m.size*=u);break;case "CIMGeometricEffectCut":m.beginCut&&(m.beginCut*=u);m.endCut&&(m.endCut*=u);m.middleCut&&(m.middleCut*=u);break;case "CIMGeometricEffectDashes":m.customEndingOffset&&(m.customEndingOffset*=u);m.offsetAlongLine&&(m.offsetAlongLine*=
u);if(m.dashTemplate&&m.dashTemplate.length){const I=m.dashTemplate.map(E=>E*u);m.dashTemplate=I}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":m.length&&(m.length*=u);break;case "CIMGeometricEffectMove":m.offsetX&&(m.offsetX*=u);m.offsetY&&(m.offsetY*=u);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":m.offset&&(m.offset*=u);break;case "CIMGeometricEffectRegularPolygon":m.radius&&(m.radius*=u);break;case "CIMGeometricEffectTaperedPolygon":m.fromWidth&&
(m.fromWidth*=u);m.length&&(m.length*=u);m.toWidth&&(m.toWidth*=u);break;case "CIMGeometricEffectWave":m.amplitude&&(m.amplitude*=u),m.period&&(m.period*=u)}}function P(m,u){let I;I="CIMTextSymbol"===m.type?m.symbol:m;m="CIMPolygonSymbol"===m.type;if(I.symbolLayers)for(const E of I.symbolLayers)if(!(E.colorLocked||m&&(H.isCIMStroke(E)||H.isCIMMarker(E)&&E.markerPlacement&&H.isCIMMarkerStrokePlacement(E.markerPlacement))))switch(E.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":E.tintColor&&
K(u,E.tintColor);break;case "CIMVectorMarker":E.markerGraphics.forEach(L=>{P(L.symbol,u)});break;case "CIMSolidStroke":case "CIMSolidFill":K(u,E.color);break;case "CIMHatchFill":P(E.lineSymbol,u)}}function K(m,u){for(const I of m)if(I.join(".")===u.join("."))return;m.push(u)}function q(m,u,I){var E="CIMTextSymbol"===m.type?m.symbol:m;m="CIMPolygonSymbol"===E.type?!0:!1;if(E.symbolLayers)for(const L of E.symbolLayers)if(!L.colorLocked){if(m)if(I){if({layersToColor:E}=I,(H.isCIMStroke(L)||H.isCIMMarker(L)&&
L.markerPlacement&&H.isCIMMarkerStrokePlacement(L.markerPlacement))&&"fill"===E||H.isCIMFill(L)&&"outline"===E)continue}else if(H.isCIMStroke(L)||H.isCIMMarker(L)&&L.markerPlacement&&H.isCIMMarkerStrokePlacement(L.markerPlacement))continue;E=u.toArray();switch(L.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":L.tintColor=E;break;case "CIMVectorMarker":L.markerGraphics.forEach(c=>{q(c.symbol,u,I)});break;case "CIMSolidStroke":case "CIMSolidFill":L.color=E;break;case "CIMHatchFill":q(L.lineSymbol,
u,I)}}}U.applyCIMSymbolColor=function(m,u,I){u instanceof N||(u=new N(u));(m=H.toCIMSymbolJSON(m))&&q(m,u,I)};U.applyCIMSymbolRotation=function(m,u,I=!1){m=H.toCIMSymbolJSON(m);I&&0!==u&&(u=360-u);if("CIMTextSymbol"===m.type)m.angle=u;else if("CIMPointSymbol"===m.type&&m.symbolLayers){I=u-(m.angle||0);for(const E of m.symbolLayers)if(H.isCIMMarker(E)){let L=E.rotation||0;L=E.rotateClockwise?L-I:L+I;E.rotation=L}m.angle=u}};U.getCIMSymbolColor=function(m){m=H.toCIMSymbolJSON(m);const u=[];P(m,u);return u.length?
new N(H.fromCIMColor(u[0])):null};U.getCIMSymbolRotation=function(m,u=!1){m=H.toCIMSymbolJSON(m);return"CIMTextSymbol"===m.type||"CIMPointSymbol"===m.type?u&&0!==m.angle?360-m.angle:m.angle||0:0};U.getCIMSymbolSize=J;U.scaleCIMMarker=V;U.scaleCIMSymbolTo=function(m,u,I){const E=H.toCIMSymbolJSON(m);m=J(m);if(0===m)if("CIMTextSymbol"===E.type)E.height=u;else{if(E.symbolLayers)for(const L of E.symbolLayers)switch(L.type){case "CIMPictureMarker":case "CIMVectorMarker":L.size=u;break;case "CIMPictureStroke":case "CIMSolidStroke":L.width=
u}}else w(E,u/m,!1,I)};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(U,N){function H(J,w){"string"!==typeof J&&(J=String(J));switch(w){case "LowerCase":return J.toLowerCase();case "Allcaps":return J.toUpperCase();default:return J}}N._adjustTextCase=H;N.colorToArray=function(J){return[J.r,J.g,J.b,J.a]};N.createLabelOverrideFunction=function(J,w,V){const T=q=>{let m=q.length;for(;m--;)if(-1===" /-,\n".indexOf(q.charAt(m)))return!1;
return!0},R=[];var P=0;let K=-1;do K=w.indexOf("[",P),K>=P&&(K>P&&(P=w.substr(P,K-P),R.push([P,null,T(P)])),P=K+1,K=w.indexOf("]",P),K>=P&&(K>P&&(P=w.substr(P,K-P),(P=J[P])&&R.push([null,P,!1])),P=K+1));while(-1!==K);P<w.length-1&&(J=w.substr(P),R.push([J,null,T(J)]));return q=>{let m="",u=null;for(const I of R){const [E,L,c]=I;if(E)c?u=E:(u&&(m+=u,u=null),m+=E);else{const v=q.attributes[L];v&&(u&&(m+=u,u=null),m+=v)}}return H(m,V)}};N.evaluateValueOrFunction=function(J,w,V,T){return"function"===
typeof J?J(w,V,T):J};N.fromCIMColor=function(J){return J?{r:J[0],g:J[1],b:J[2],a:J[3]/255}:{r:0,g:0,b:0,a:0}};N.getValue=J=>isNaN(J)||!J?0:J;N.importGeometryEngine=function(){return new Promise((J,w)=>U(["../../geometry/geometryEngineJSON"],J,w))};N.isCIMFill=function(J){return"CIMGradientFill"===J.type||"CIMHatchFill"===J.type||"CIMPictureFill"===J.type||"CIMSolidFill"===J.type||"CIMWaterFill"===J.type};N.isCIMMarker=function(J){return"CIMVectorMarker"===J.type||"CIMPictureMarker"===J.type||"CIMBarChartMarker"===
J.type||"CIMCharacterMarker"===J.type||"CIMPieChartMarker"===J.type||"CIMStackedBarChartMarker"===J.type};N.isCIMMarkerStrokePlacement=function(J){return"CIMMarkerPlacementAlongLineRandomSize"===J.type||"CIMMarkerPlacementAlongLineSameSize"===J.type||"CIMMarkerPlacementAlongLineVariableSize"===J.type||"CIMMarkerPlacementAtExtremities"===J.type||"CIMMarkerPlacementAtMeasuredUnits"===J.type||"CIMMarkerPlacementAtRatioPositions"===J.type||"CIMMarkerPlacementOnLine"===J.type||"CIMMarkerPlacementOnVertices"===
J.type};N.isCIMStroke=function(J){return"CIMGradientStroke"===J.type||"CIMPictureStroke"===J.type||"CIMSolidStroke"===J.type};N.isGeometryEngineRequired=J=>{if(!J)return!1;for(const w of J)switch(w.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};N.resampleHermite=function(J,w,V,T,R,P,K=!0){const q=w/R;V/=P;const m=Math.ceil(q/2),u=Math.ceil(V/2);for(let L=0;L<P;L++)for(let c=0;c<R;c++){const v=4*(c+(K?P-L-1:L)*R);var I=0;let F=0,x=0,A=0,B=0,y=0,b=0;const d=
(L+.5)*V;for(let l=Math.floor(L*V);l<(L+1)*V;l++){var E=Math.abs(d-(l+.5))/u;const h=(c+.5)*q;E*=E;for(let g=Math.floor(c*q);g<(c+1)*q;g++){let p=Math.abs(h-(g+.5))/m;I=Math.sqrt(E+p*p);-1<=I&&1>=I&&(I=2*I*I*I-3*I*I+1,0<I&&(p=4*(g+l*w),b+=I*J[p+3],x+=I,255>J[p+3]&&(I=I*J[p+3]/250),A+=I*J[p],B+=I*J[p+1],y+=I*J[p+2],F+=I))}}T[v]=A/F;T[v+1]=B/F;T[v+2]=y/F;T[v+3]=b/x}};N.toCIMSymbolJSON=function(J){var w;return null==(w=J.data)?void 0:w.symbol};Object.defineProperty(N,"__esModule",{value:!0})})},"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/aliasOf ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/RasterJobHandler ../support/TileInfo ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/SpatialReference".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B,y,b,d,l){const h=T.getLogger("esri.layers.mixins.ImageryTileMixin");U.ImageryTileMixin=g=>{g=function(p){function n(){var k=p.apply(this,arguments)||this;k._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};k.bandIds=null;k.copyright=null;k.fullExtent=null;k.interpolation="nearest";k.multidimensionalDefinition=null;k.raster=null;k.rasterInfo=null;k.sourceJSON=null;k.spatialReference=null;k.tileInfo=null;k.symbolizer=null;return k}
N._inheritsLoose(n,p);var f=n.prototype;f.convertVectorFieldData=function(){var k=N._asyncToGenerator(function*(a,r){if(R.isNone(a))return null;const D=this._rasterJobHandler.instance,M=this.rasterInfo.dataType;return D?D.convertVectorFieldData({pixelBlock:a,dataType:M},r):A.convertVectorFieldData(a,M)});return function(a,r){return k.apply(this,arguments)}}();f.createStreamlinesMesh=function(){var k=N._asyncToGenerator(function*(a,r){const D=this._rasterJobHandler.instance;return D?D.createStreamlinesMesh(a,
r):b.createStreamlinesMesh(a.rendererSettings,a.flowData,R.isSome(r.signal)?r.signal:(new AbortController).signal)});return function(a,r){return k.apply(this,arguments)}}();f.normalizeRasterFetchOptions=function(k){var {multidimensionalInfo:a}=this.rasterInfo;if(R.isNone(a))return k;let r=k.multidimensionalDefinition||this.multidimensionalDefinition;if(R.isNone(r)||!r.length)r=this._getDefaultSlice();var D=k.timeExtent||this.timeExtent;if(R.isSome(r)&&R.isSome(D)&&(R.isSome(D.start)||R.isSome(D.end))){var M,
C;r=r.map(O=>O.clone());a=null==(M=a.variables.find(({name:O})=>O===r[0].variableName))?void 0:null==(C=M.dimensions)?void 0:C.find(({name:O})=>"StdTime"===O);M=r.find(({dimensionName:O})=>"StdTime"===O);if(!a||!M)return{...k,multidimensionalDefinition:null};const {start:e,end:t}=D;D=R.isNone(e)?null:e.getTime();C=R.isNone(t)?null:t.getTime();const z=null!=D?D:C,G=null!=C?C:D;if(R.isSome(a.values))a=a.values.filter(O=>{if(Array.isArray(O)){if(z===G)return O[0]<=z&&O[1]>=z;const S=O[0]>=z&&O[1]<=G||
O[0]<z&&O[1]>G;return O[0]<=z&&O[1]>z||O[0]<G&&O[1]>=G||S}return z===G?O===z:O>=z&&O<=G}),a.length?(a=a.sort((O,S)=>{var X,W;if(z===G){var Y,aa;return(null!=(Y=O[0])?Y:O)-(null!=(aa=S[0])?aa:S)}O=Math.abs((null!=(X=O[1])?X:O)-G);S=Math.abs((null!=(W=S[1])?W:S)-G);return O-S})[0],M.values=[a]):r=null;else if(a.hasRegularIntervals&&a.extent){const [O,S]=a.extent;z>S||G<O?r=null:M.values=z===G?[z]:[Math.max(O,z),Math.min(S,G)]}}return{...k,multidimensionalDefinition:r}};f.updateRenderer=function(){var k=
N._asyncToGenerator(function*(){if(this.loaded&&JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer)){var a=this._rasterJobHandler.instance;a&&(this.symbolizer.rendererJSON=B.normalizeRendererJSON(this.renderer.toJSON()),this.symbolizer.bind(),yield a.updateSymbolizer(this.symbolizer),this._cachedRendererJson=this.renderer.toJSON())}});return function(){return k.apply(this,arguments)}}();f.applyRenderer=function(){var k=N._asyncToGenerator(function*(a,r){var D=a&&a.pixelBlock;
if(!(R.isSome(D)&&D.pixels&&0<D.pixels.length))return null;yield this.updateRenderer();D=this._rasterJobHandler.instance;const {bandIds:M}=this;return D?yield D.symbolize({...a,simpleStretchParams:r,bandIds:M}):this.symbolizer.symbolize({...a,simpleStretchParams:r,bandIds:M})});return function(a,r){return k.apply(this,arguments)}}();f.getTileUrl=function(k,a,r){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${k}/${a}/${r}`:""};f.getCompatibleTileInfo=function(k,a,r=!1){if(!this.loaded||
R.isNone(a))return null;if(r&&k.equals(this.spatialReference))return this.tileInfo;r=E.getInfo(k);return x.create({size:256,spatialReference:k,origin:r?{x:r.origin[0],y:r.origin[1]}:{x:a.xmin,y:a.ymax}})};f.getCompatibleFullExtent=function(k){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(k)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(k):null};f.fetchTile=function(){var k=N._asyncToGenerator(function*(a,r,D,M={}){if(M.requestAsImageElement)return a=
this.getTileUrl(a,r,D),V(a,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:M.signal}).then(C=>C.data);if(R.isSome(this.rasterInfo.multidimensionalInfo)&&(M=this.normalizeRasterFetchOptions(M),R.isNone(M.multidimensionalDefinition)))return{extent:this.raster.getTileExtentFromTileInfo(a,r,D,M.tileInfo||this.rasterInfo.storageInfo.tileInfo),pixelBlock:null};yield this._initJobHandler();"raster-shaded-relief"===this.renderer.type&&(M={...M,
buffer:{cols:1,rows:1}});return this.raster.fetchTile(a,r,D,M)});return function(a,r,D){return k.apply(this,arguments)}}();f.fetchPixels=function(){var k=N._asyncToGenerator(function*(a,r,D,M={}){if(R.isSome(this.rasterInfo.multidimensionalInfo)&&(M=this.normalizeRasterFetchOptions(M),R.isNone(M.multidimensionalDefinition)))return{extent:a,pixelBlock:null};yield this._initJobHandler();return this.raster.fetchPixels(a,r,D,M)});return function(a,r,D){return k.apply(this,arguments)}}();f.identify=function(){var k=
N._asyncToGenerator(function*(a,r={}){return R.isSome(this.rasterInfo.multidimensionalInfo)&&(r=this.normalizeRasterFetchOptions(r),R.isNone(r.multidimensionalDefinition))?{location:a,value:null}:this.raster.identify(a,r)});return function(a){return k.apply(this,arguments)}}();f.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};f.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};f.hasStandardTime=
function(){var k;const a=this.rasterInfo.multidimensionalInfo;if(!R.isSome(a)||"standard-time"!==this.rasterInfo.dataType)return!1;const r=null==(k=this.multidimensionalDefinition[0])?void 0:k.variableName;return a.variables.some(D=>D.name===r&&D.dimensions.some(M=>"StdTime"===M.name))};f.getStandardTimeValue=function(k){return(new Date(864E5*(k-25569))).toString()};f._configDefaultSettings=function(){this._configDefaultInterpolation();this.multidimensionalDefinition||(this.multidimensionalDefinition=
this._getDefaultSlice());this._configDefaultRenderer()};f._initJobHandler=function(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const k=new F;this._rasterJobHandler.connectionPromise=k.initialize().then(()=>{this._rasterJobHandler.instance=k;this.raster.rasterJobHandler=k;this.renderer&&this.updateRenderer()}).catch(()=>null);return this._rasterJobHandler.connectionPromise};f._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();
this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this.raster.rasterJobHandler=null};f._configDefaultInterpolation=function(){if(null==this.interpolation){var k;const a=B.getDefaultInterpolation(this.rasterInfo,this.raster.tileType,null==(k=this.sourceJSON)?void 0:k.defaultResamplingMethod);this._set("interpolation",a)}};f._getDefaultSlice=function(){const {multidimensionalInfo:k}=this.raster.rasterInfo;if(!R.isSome(k))return null;
const a=k.variables[0];return a.dimensions.map(r=>{var D,M;return new v({variableName:a.name,dimensionName:r.name,values:[null!=(D=null==(M=r.values)?void 0:M[0])?D:r.extent[0]],isSlice:!0})})};f._configDefaultRenderer=function(){var k=this.raster.rasterInfo;this.bandIds||(this.bandIds=B.getDefaultBandCombination(k));if(!this.renderer){var a;this.renderer=B.createDefaultRenderer(k,{bandIds:this.bandIds,variableName:R.isSome(this.multidimensionalDefinition)?null==(a=this.multidimensionalDefinition[0])?
void 0:a.variableName:null})}this.symbolizer?(this.symbolizer.rendererJSON=B.normalizeRendererJSON(this.renderer.toJSON()),this.symbolizer.rasterInfo=k):this.symbolizer=new y({rendererJSON:this.renderer.toJSON(),rasterInfo:k});k=this.symbolizer.bind();k.success||h.warn("imagery-tile-mixin",k.error||"The given renderer is not supported by the layer.")};N._createClass(n,[{key:"url",set:function(k){this._set("url",L.sanitizeUrl(k,h))}},{key:"renderer",set:function(k){this._set("renderer",k);this.updateRenderer()}}]);
return n}(g);H.__decorate([u.property()],g.prototype,"_cachedRendererJson",void 0);H.__decorate([u.property()],g.prototype,"_compatibleFullExtent",void 0);H.__decorate([u.property()],g.prototype,"_rasterJobHandler",void 0);H.__decorate([u.property()],g.prototype,"bandIds",void 0);H.__decorate([u.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],g.prototype,"copyright",void 0);H.__decorate([u.property({type:d,json:{read:!1}}),P.aliasOf("rasterInfo.extent")],g.prototype,"fullExtent",
void 0);H.__decorate([u.property()],g.prototype,"interpolation",void 0);H.__decorate([u.property()],g.prototype,"ioConfig",void 0);H.__decorate([u.property({type:[v]})],g.prototype,"multidimensionalDefinition",void 0);H.__decorate([u.property()],g.prototype,"raster",void 0);H.__decorate([u.property({readOnly:!0}),P.aliasOf("raster.rasterInfo")],g.prototype,"rasterInfo",void 0);H.__decorate([u.property()],g.prototype,"sourceJSON",void 0);H.__decorate([u.property({type:l,json:{read:!1}}),P.aliasOf("rasterInfo.spatialReference")],
g.prototype,"spatialReference",void 0);H.__decorate([u.property({type:x,json:{read:!1}}),P.aliasOf("rasterInfo.storageInfo.tileInfo")],g.prototype,"tileInfo",void 0);H.__decorate([u.property(c.url)],g.prototype,"url",null);H.__decorate([u.property({types:w.rasterRendererTypes})],g.prototype,"renderer",null);H.__decorate([u.property()],g.prototype,"symbolizer",void 0);return g=H.__decorate([I.subclass("esri.layers.ImageryTileMixin")],g)};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(U,N,H,J,w,V,T){var R;H=R=function(P){function K(q){q=P.call(this,q)||this;q.variableName=null;q.dimensionName=null;q.values=[];q.isSlice=!1;return q}U._inheritsLoose(K,P);K.prototype.clone=function(){return new R({variableName:this.variableName,dimensionName:this.dimensionName,values:J.clone(this.values),isSlice:this.isSlice})};return K}(H.JSONSupport);N.__decorate([w.property({type:String,json:{write:!0}})],H.prototype,"variableName",void 0);N.__decorate([w.property({type:String,json:{write:!0}})],
H.prototype,"dimensionName",void 0);N.__decorate([w.property({type:V.types.array(V.types.oneOf([V.types.native(Number),V.types.array(V.types.native(Number))])),json:{write:!0}})],H.prototype,"values",void 0);N.__decorate([w.property({type:Boolean,json:{write:!0}})],H.prototype,"isSlice",void 0);return H=R=N.__decorate([T.subclass("esri.layers.support.DimensionalDefinition")],H)})},"esri/layers/support/RasterJobHandler":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error",
"../../core/maybe","../../core/workers/workers","./PixelBlock"],function(U,N,H,J,w){return function(){function V(){this._workerThread=null;this._destroyed=!1}var T=V.prototype;T.initialize=function(){var R=U._asyncToGenerator(function*(){const P=yield J.open("RasterWorker");this._destroyed?P.close():this._workerThread=P});return function(){return R.apply(this,arguments)}}();T.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};T.convertVectorFieldData=
function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");return(P=yield this._workerThread.invoke("convertVectorFieldData",{pixelBlock:P.pixelBlock.toJSON(),type:P.dataType},K))?new w(P):null});return function(P,K){return R.apply(this,arguments)}}();T.decode=function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");
return(P=yield this._workerThread.invoke("decode",P,K))?new w(P):null});return function(P,K){return R.apply(this,arguments)}}();T.symbolize=function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");P={extent:P.extent&&P.extent.toJSON(),pixelBlock:H.isSome(P.pixelBlock)&&P.pixelBlock.toJSON(),simpleStretchParams:P.simpleStretchParams,bandIds:P.bandIds};return(K=yield this._workerThread.invoke("symbolize",
P,K))?new w(K):null});return function(P,K){return R.apply(this,arguments)}}();T.updateSymbolizer=function(){var R=U._asyncToGenerator(function*(P,K){var q;if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const m=null==P?void 0:null==(q=P.rendererJSON)?void 0:q.histograms;yield Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:P.toJSON(),histograms:m},K))});return function(P,K){return R.apply(this,arguments)}}();T.stretch=
function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(null==P||!P.pixelBlock)return null;P={srcPixelBlock:P.pixelBlock.toJSON(),stretchParams:P.stretchParams};return(K=yield this._workerThread.invoke("stretch",P,K))?new w(K):null});return function(P,K){return R.apply(this,arguments)}}();T.split=function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection",
"no available worker connection");if(null==P||!P.pixelBlock)return null;P={srcPixelBlock:P.pixelBlock.toJSON(),tileSize:P.tileSize,maximumPyramidLevel:P.maximumPyramidLevel};const q=yield this._workerThread.invoke("split",P,K);q&&q.forEach((m,u)=>{q.set(u,m?w.fromJSON(m):null)});return Promise.resolve(q)});return function(P,K){return R.apply(this,arguments)}}();T.estimateStatisticsHistograms=function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection",
"no available worker connection");if(null==P||!P.pixelBlock)return null;P={srcPixelBlock:P.pixelBlock.toJSON()};K=yield this._workerThread.invoke("estimateStatisticsHistograms",P,K);return Promise.resolve(K)});return function(P,K){return R.apply(this,arguments)}}();T.mosaicAndTransform=function(){var R=U._asyncToGenerator(function*(P,K){var q;if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(null==P||null==(q=P.srcPixelBlocks)||!q.length)return{pixelBlock:null};
P={...P,srcPixelBlocks:P.srcPixelBlocks.map(m=>H.isSome(m)?m.toJSON():null)};K=yield this._workerThread.invoke("mosaicAndTransform",P,K);return{pixelBlock:K.pixelBlock?new w(K.pixelBlock):null,localNorthDirections:K.localNorthDirections}});return function(P,K){return R.apply(this,arguments)}}();T.createStreamlinesMesh=function(){var R=U._asyncToGenerator(function*(P,K){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const q={buffer:P.flowData.data.buffer,
width:P.flowData.width,height:P.flowData.height};P=yield this._workerThread.invoke("createStreamlinesMesh",{flowData:q,rendererSettings:P.rendererSettings},{...K,transferList:[q.buffer]});return{vertexData:new Float32Array(P.vertexBuffer),indexData:new Uint32Array(P.indexBuffer)}});return function(P,K){return R.apply(this,arguments)}}();T.getProjectionOffsetGrid=function(R,P){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const K=H.isSome(R.datumTransformation)?
R.datumTransformation.steps.map(m=>({wkid:m.wkid,wkt:m.wkt,isInverse:m.isInverse})):null,q=H.isSome(R.rasterTransform)?R.rasterTransform.toJSON():null;R={projectedExtent:R.projectedExtent.toJSON(),srcBufferExtent:R.srcBufferExtent.toJSON(),pixelSize:R.pixelSize,hasWrapAround:R.hasWrapAround,spacing:R.spacing,datumTransformationSteps:K,rasterTransform:q,isAdaptive:R.isAdaptive,includeGCSGrid:R.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",R,P)};return V}()})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F){var x;H=new H.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});J=x=function(A){function B(b){b=A.call(this,b)||this;b.dpi=96;b.format=null;b.origin=null;b.minScale=0;b.maxScale=0;b.size=null;b.spatialReference=null;return b}U._inheritsLoose(B,A);B.create=function(b=
{}){const {resolutionFactor:d=1,scales:l,size:h=256,spatialReference:g=E.WebMercator,numLODs:p=24}=b;if(!c.isValid(g)){b=[];if(l)for(var n=0;n<l.length;n++){var f=l[n];b.push({level:n,scale:f,resolution:f})}else for(n=5E-4,f=p-1;0<=f;f--)b.unshift({level:f,scale:n,resolution:n}),n*=2;return new x({dpi:96,lods:b,origin:new I(0,0,g),size:[h,h],spatialReference:g})}n=c.getInfo(g);b=b.origin?new I({x:b.origin.x,y:b.origin.y,spatialReference:g}):n?new I({x:n.origin[0],y:n.origin[1],spatialReference:g}):
new I({x:0,y:0,spatialReference:g});n=1/(39.37*V.getMetersPerUnitForSR(g)*96);f=[];if(l)for(var k=0;k<l.length;k++){var a=l[k];f.push({level:k,scale:a,resolution:a*n})}else{var r=c.isGeographic(g)?512/h*5.916575275917094E8:256/h*5.91657527591555E8;k=Math.ceil(p/d);f.push({level:0,scale:r,resolution:r*n});for(a=1;a<k;a++)r/=2**d,f.push({level:a,scale:r,resolution:r*n})}return new x({dpi:96,lods:f,origin:b,size:[h,h],spatialReference:g})};var y=B.prototype;y.readOrigin=function(b,d){return I.fromJSON({spatialReference:d.spatialReference,
...b})};y.readSize=function(b,d){return[d.cols,d.rows]};y.writeSize=function(b,d){d.cols=b[0];d.rows=b[1]};y.zoomToScale=function(b){const d=this.scales;if(0>=b)return d[0];if(b>=d.length-1)return d[d.length-1];{const l=Math.floor(b);return d[l]/(d[l]/d[l+1])**(b-l)}};y.scaleToZoom=function(b){const d=this.scales,l=d.length-1;let h=0;for(;h<l;h++){const g=d[h],p=d[h+1];if(g<=b)break;if(p===b)return h+1;if(g>b&&p<b)return h+Math.log(g/b)/Math.log(g/p)}return h};y.snapScale=function(b,d=.95){b=this.scaleToZoom(b);
return b%Math.floor(b)>=d?this.zoomToScale(Math.ceil(b)):this.zoomToScale(Math.floor(b))};y.tileAt=function(b,d,l,h){var g=this.lodAt(b);if(!g)return null;let p;if("number"===typeof d)p=d,d=l;else{if(c.equals(d.spatialReference,this.spatialReference))p=d.x,d=d.y;else{h=v.project(d,this.spatialReference);if(w.isNone(h))return null;p=h.x;d=h.y}h=l}l=g.resolution*this.size[0];g=g.resolution*this.size[1];h||(h={id:null,level:0,row:0,col:0,extent:L.create()});h.level=b;h.row=Math.floor((this.origin.y-
d)/g+.001);h.col=Math.floor((p-this.origin.x)/l+.001);this.updateTileInfo(h);return h};y.updateTileInfo=function(b,d=x.ExtrapolateOptions.NONE){var l=this.lodAt(b.level);l||d!==x.ExtrapolateOptions.POWER_OF_TWO||(d=this.lods[this.lods.length-1],d.level<b.level&&(l=d));if(l){var h=b.level-l.level;d=l.resolution*this.size[0]/2**h;l=l.resolution*this.size[1]/2**h;b.id=`${b.level}/${b.row}/${b.col}`;b.extent||(b.extent=L.create());b.extent[0]=this.origin.x+b.col*d;b.extent[1]=this.origin.y-(b.row+1)*
l;b.extent[2]=b.extent[0]+d;b.extent[3]=b.extent[1]+l}};y.upsampleTile=function(b){const d=this._upsampleLevels[b.level];if(!d||-1===d.parentLevel)return!1;b.level=d.parentLevel;b.row=Math.floor(b.row/d.factor+.001);b.col=Math.floor(b.col/d.factor+.001);this.updateTileInfo(b);return!0};y.getTileBounds=function(b,d){var {resolution:l}=this.lodAt(d.level);const h=l*this.size[0];l*=this.size[1];b[0]=this.origin.x+d.col*h;b[1]=this.origin.y-(d.row+1)*l;b[2]=b[0]+h;b[3]=b[1]+l;return b};y.lodAt=function(b){return this._levelToLOD&&
this._levelToLOD[b]||null};y.clone=function(){return x.fromJSON(this.write({}))};y.getOrCreateCompatible=function(b,d){if(256===this.size[0]&&256===this.size[1])return 256===b?this:null;const l=[],h=this.lods.length;for(let g=0;g<h;g++){const p=this.lods[g];l.push(new F({level:p.level,scale:p.scale,resolution:p.resolution*d}))}return new x({size:[b,b],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:l})};y._initializeUpsampleLevels=
function(){const b=this.lods;this._upsampleLevels=[];let d=null;for(let l=0;l<b.length;l++){const h=b[l];this._upsampleLevels[h.level]={parentLevel:d?d.level:-1,factor:d?d.resolution/h.resolution:0};d=h}};U._createClass(B,[{key:"isWrappable",get:function(){const {spatialReference:b,origin:d}=this;if(b&&d){const l=c.getInfo(b);return b.isWrappable&&Math.abs(l.origin[0]-d.x)<=l.dx}return!1}},{key:"lods",set:function(b){let d=0,l=0;const h=[];this._levelToLOD={};b&&(d=-Infinity,l=Infinity,b.forEach(g=>
{h.push(g.scale);d=g.scale>d?g.scale:d;l=g.scale<l?g.scale:l;this._levelToLOD[g.level]=g}));this._set("scales",h);this._set("minScale",d);this._set("maxScale",l);this._set("lods",b);this._initializeUpsampleLevels()}}]);return B}(J.JSONSupport);N.__decorate([T.property({type:Number,json:{write:!0}})],J.prototype,"compressionQuality",void 0);N.__decorate([T.property({type:Number,json:{write:!0}})],J.prototype,"dpi",void 0);N.__decorate([T.property({type:String,json:{read:H.read,write:H.write,origins:{"web-scene":{read:!1,
write:!1}}}})],J.prototype,"format",void 0);N.__decorate([T.property({readOnly:!0})],J.prototype,"isWrappable",null);N.__decorate([T.property({type:I,json:{write:!0}})],J.prototype,"origin",void 0);N.__decorate([q.reader("origin")],J.prototype,"readOrigin",null);N.__decorate([T.property({type:[F],value:null,json:{write:!0}})],J.prototype,"lods",null);N.__decorate([T.property({readOnly:!0})],J.prototype,"minScale",void 0);N.__decorate([T.property({readOnly:!0})],J.prototype,"maxScale",void 0);N.__decorate([T.property({readOnly:!0})],
J.prototype,"scales",void 0);N.__decorate([T.property({cast:A=>Array.isArray(A)?A:"number"===typeof A?[A,A]:[256,256]})],J.prototype,"size",void 0);N.__decorate([q.reader("size",["rows","cols"])],J.prototype,"readSize",null);N.__decorate([u.writer("size",{cols:{type:K.Integer},rows:{type:K.Integer}})],J.prototype,"writeSize",null);N.__decorate([T.property({type:E,json:{write:!0}})],J.prototype,"spatialReference",void 0);J=x=N.__decorate([m.subclass("esri.layers.support.TileInfo")],J);(function(A){A=
A.ExtrapolateOptions||(A.ExtrapolateOptions={});A[A.NONE=0]="NONE";A[A.POWER_OF_TWO=1]="POWER_OF_TWO"})(J||(J={}));return J})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(U,N,H,J,w,V,T,R){var P;H=P=function(K){function q(m){m=
K.call(this,m)||this;m.cols=null;m.level=0;m.levelValue=null;m.origin=null;m.resolution=0;m.rows=null;m.scale=0;return m}U._inheritsLoose(q,K);q.prototype.clone=function(){return new P({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return q}(H.JSONSupport);N.__decorate([J.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"cols",void 0);N.__decorate([J.property({type:T.Integer,
json:{write:!0}})],H.prototype,"level",void 0);N.__decorate([J.property({type:String,json:{write:!0}})],H.prototype,"levelValue",void 0);N.__decorate([J.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"origin",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"resolution",void 0);N.__decorate([J.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,
"rows",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"scale",void 0);return H=P=N.__decorate([R.subclass("esri.layers.support.LOD")],H)})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/maybe ../../core/unitUtils ../../layers/support/Field ../../layers/support/RasterInfo ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./UniqueValueInfo ../../rest/support/AlgorithmicColorRamp ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B){function y(Q,Z){var ba,ca,da,ea;Q=b(Q,null==Z?void 0:Z.variableName);const {bandCount:fa}=Q;let {bandIds:ia,stretchType:ha}=Z||{};null!=(ba=ia)&&ba.some(pa=>pa>=fa)&&(ia=null);let la=J.unwrap(Q.statistics),ja=J.unwrap(Q.histograms);if(1<fa){var ka;ia=null!=(ka=ia)&&ka.length?ia:d(Q);la=null==la?null:ia.map(pa=>la[pa]);ja=null==ja?null:ia.map(pa=>ja[pa])}else ia=[0];null==ha&&(ha=h(Q));ba=!1;switch(ha){case "none":ba=!1;break;case "percent-clip":ba=
!(null!=(ca=ja)&&ca.length);break;default:ba=!(null!=(da=la)&&da.length)}({dataType:ca}=Q);ca=1===(null==(ea=ia)?void 0:ea.length)&&Y.has(ca)?X:null;ea=new c({stretchType:ha,dynamicRangeAdjustment:ba,colorRamp:ca,outputMin:0,outputMax:255,gamma:1===ia.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===ha?ea.maxPercent=ea.minPercent=.25:"standard-deviation"===ha&&(ea.numberOfStandardDeviations=2);if(!ba&&(J.isSome(Q.multidimensionalInfo)||null!=Z&&Z.includeStatisticsInStretch))if("percent-clip"===ha)ea.histograms=
ja;else if("min-max"===ha||"standard-deviation"===ha)ea.statistics=la;return ea}function b(Q,Z){if(null==Z)return Q;let ba=J.unwrap(Q.statistics),ca=J.unwrap(Q.histograms);const {multidimensionalInfo:da}=Q;if(Z&&J.isSome(da)){const {statistics:ea,histograms:fa}=da.variables.find(ia=>ia.name===Z);null!=ea&&ea.length&&(ba=ea);null!=fa&&fa.length&&(ca=fa)}return T.fromJSON({...Q.toJSON(),statistics:ba,histograms:ca})}function d(Q){const Z=Q.bandCount;if(1===Z)return null;if(2===Z)return[0];Q=Q.keyProperties&&
Q.keyProperties.BandProperties;let ba;if(Q&&Q.length===Z){const {red:ca,green:da,blue:ea,nir:fa}=l(Q);null!=ca&&null!=da&&null!=ea?ba=[ca,da,ea]:null!=fa&&null!=ca&&null!=da&&(ba=[fa,ca,da])}!ba&&3<=Z&&(ba=[0,1,2]);return ba}function l(Q){const Z={};for(let ea=0;ea<Q.length;ea++){var ba,ca=Q[ea],da=null==(ba=ca.BandName)?void 0:ba.toLowerCase();"red"===da?Z.red=ea:"green"===da?Z.green=ea:"blue"===da?Z.blue=ea:"nearinfrared"===da||"nearinfrared_1"===da||"nir"===da?Z.nir=ea:ca.WavelengthMax&&ca.WavelengthMin&&
(da=ca.WavelengthMin,ca=ca.WavelengthMax,null==Z.blue&&410<=da&&480>=da&&480<=ca&&540>=ca?Z.blue=ea:null==Z.green&&490<=da&&560>=da&&560<=ca&&610>=ca?Z.green=ea:null==Z.red&&595<=da&&670>=da&&660<=ca&&730>=ca?Z.red=ea:null==Z.nir&&700<=da&&860>=da&&800<=ca&&950>=ca&&(Z.nir=ea))}return Z}function h(Q){let Z="percent-clip";const {pixelType:ba,dataType:ca,histograms:da,statistics:ea}=Q;"u8"!==ba||"processed"!==ca&&J.isSome(da)&&J.isSome(ea)?"u8"===ba||"elevation"===ca||Y.has(ca)?Z="min-max":J.isSome(da)?
Z="percent-clip":J.isSome(ea)&&(Z=Z="min-max"):Z="none";return Z}function g(Q,Z,ba,ca){if(!k(Q,Z))return null;const {attributeTable:da,statistics:ea}=Q,fa=p(da,Z),ia=f(da,"red"),ha=f(da,"green"),la=f(da,"blue");Q=new P;const ja=[],ka=new Set,pa=!!(ia&&ha&&la);if(J.isSome(da))da.features.forEach(na=>{var ma=na.attributes[fa.name];ka.has(na.attributes[fa.name])||null==ma||(ka.add(ma),ma=!pa||"single"!==ia.type&&"double"!==ia.type||"single"!==ha.type&&"double"!==ha.type||"single"!==la.type&&"double"!==
la.type||da.features.some(oa=>1<oa.attributes[ia.name]||1<oa.attributes[ha.name]||1<oa.attributes[la.name])?1:255,ja.push(new m({value:na.attributes[fa.name],label:na.attributes[fa.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:pa?new N([na.attributes[ia.name]*ma,na.attributes[ha.name]*ma,na.attributes[la.name]*ma,1]):new N([0,0,0,0])}})))});else if(null!=ea&&ea[0])for(Z=ea[0].min;Z<=ea[0].max;Z++)ja.push(new m({value:Z,label:Z.toString(),symbol:{type:"simple-fill",style:"solid",
outline:null,color:new N([0,0,0,0])}}));ja.sort((na,ma)=>na.value&&"string"===typeof na.value.valueOf()?0:na.value>ma.value?1:-1);if(!pa){const na=q.convertColorRampToColormap(W,ja.length);ja.forEach((ma,oa)=>ma.symbol.color=new N(na[oa].slice(1,4)));Q.colorRamp=W}if(ba||ca){const na=ba||q.convertColorRampToColormap(ca,ja.length).map(ma=>ma.slice(1));ja.forEach((ma,oa)=>ma.symbol.color=new N(na[oa]));Q.colorRamp=ca}return new v({field:fa.name,uniqueValueInfos:ja,authoringInfo:Q})}function p(Q,Z,ba){let ca;
J.isSome(Q)?(ca=Z?Q.fields.find(da=>Z.toLowerCase()===da.name.toLowerCase()):n(Q.fields),ca||(ba||(ca=Q.fields.find(da=>"string"===da.type)),ca||(ca=f(Q,"value")))):ca=new V({name:"value"});return ca}function n(Q){let Z;for(let ba=0;ba<Q.length;ba++){const ca=Q[ba].name.toLowerCase();if("string"===Q[ba].type){if(ca.startsWith("class")){Z=Q[ba];break}null==Z&&(ca.endsWith("name")||ca.endsWith("type"))&&(Z=Q[ba])}}return Z}function f(Q,Z){return J.isSome(Q)?Q.fields.find(ba=>ba.name.toLowerCase()===
Z):null}function k(Q,Z){const {attributeTable:ba,bandCount:ca}=Q;return!J.isSome(ba)&&e(Q)?!0:!J.isSome(ba)||1<ca||Z&&null==ba.fields.find(da=>da.name.toLowerCase()===Z.toLowerCase())?!1:!0}function a(Q){const {bandCount:Z,colormap:ba}=Q;return J.isSome(ba)&&ba.length&&1===Z}function r(Q){if(!a(Q))return null;let Z;const {attributeTable:ba,colormap:ca}=Q;if(J.isSome(ba)){const da=f(ba,"value"),ea=p(ba,null,!0);"string"===ea.type&&(Z={},ba.features.forEach(fa=>{fa=fa.attributes;Z[fa[da.name]]=ea?fa[ea.name]:
fa[da.name]}))}return F.createFromColormap(J.unwrap(ca),Z)}function D(Q){return"elevation"===Q.dataType}function M(Q){const {attributeTable:Z,bandCount:ba}=Q;return 1===ba&&(J.isSome(Z)||J.isSome(Q.histograms))}function C(Q,Z,ba){let ca=0,da=0;J.isSome(Q.attributeTable)?(Q=Q.attributeTable,ca=da=Q.features[0].attributes[Z.name],Q.features.forEach(ea=>{ea=ea.attributes[Z.name];ea<ca&&(ca=ea);ea>da&&(da=ea)})):J.isSome(Q.histograms)&&(Q=Q.histograms,ca=Q[0].min,da=Q[0].max);return(da-ca)/ba}function e(Q){var Z,
ba,ca;return-1<["u8","s8"].indexOf(Q.pixelType)&&null!=(null==(Z=Q.statistics)?void 0:null==(ba=Z[0])?void 0:ba.min)&&null!=(null==(ca=Q.statistics[0])?void 0:ca.max)&&1===Q.bandCount}function t(Q){({dataType:Q}=Q);return"vector-uv"===Q||"vector-magdir"===Q}function z(Q){({dataType:Q}=Q);return"vector-uv"===Q||"vector-magdir"===Q}function G(Q){if(!t(Q))return null;if(J.isSome(Q.statistics)&&Q.statistics.length&&("vector-magdir"===Q.dataType||"vector-uv"===Q.dataType)){const {minMagnitude:ba,maxMagnitude:ca}=
S(Q.dataType,Q.statistics);var Z=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:ba,maxDataValue:ca}]}Q=J.isSome(Q.multidimensionalInfo)?aa.get(Q.multidimensionalInfo.variables[0].unit):null;Z=new B({visualVariables:Z,inputUnit:Q,rotationType:"geographic"});Z.visualVariables=[...Z.sizeVariables,...Z.rotationVariables];return Z}function O(Q){var Z;return{color:null==(Z=Q.symbolLayers[0].material)?void 0:Z.color,type:"esriSFS",style:"esriSFSSolid"}}function S(Q,Z){if("vector-magdir"===
Q)Q=Z[0].min,Z=Z[0].max;else{const ba=Z[0].min,ca=Z[0].max,da=Z[1].min;Z=Z[1].max;Q=0;Z=Math.max(Math.abs(ba),Math.abs(da),Math.abs(ca),Math.abs(Z))}return{minMagnitude:Q,maxMagnitude:Z}}const X=L.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),W=L.fromJSON(q.PREDEFINED_JSON_COLOR_RAMPS[0]),Y=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),
aa=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);U.createClassBreaksRenderer=function(Q,Z){Q=b(Q,null==Z?void 0:Z.variableName);const {attributeTable:ba}=Q;if(!M(Q))return null;const ca=J.isSome(Q.histograms)?Q.histograms[0]:null,da=isFinite(null==Z?void 0:Z.numClasses)?Z.numClasses:5,ea=new P({classificationMethod:null==Z?void 0:Z.classificationMethod,colorRamp:null==Z?void 0:Z.colorRamp});let fa=(null==Z?
void 0:Z.field)||"value";const ia=[],ha=[],la=J.isSome(ba),ja=la&&ba.fields.find(oa=>"count"===oa.name.toLowerCase()),ka=la&&ba.fields.find(oa=>oa.name.toLowerCase()===fa.toLowerCase());if(ka){fa=ka.name;const oa=ba.features.length;let ta=0;ba.features.forEach(qa=>ta+=(ja?qa.attributes[ja.name]:50)/oa);ba.features.forEach(qa=>{const ra=qa.attributes[ka.name];qa=ja?qa.attributes[ja.name]:50;if(0<qa){ha.push(qa);qa=Math.max(1,Math.round(qa/oa/ta*1E3));for(let sa=0;sa<qa;sa++)ia.push(ra)}})}else{var {pixelType:pa}=
Q;const oa=(ca.max-ca.min)/ca.size,ta=(pa=-1<pa.indexOf("s")||-1<pa.indexOf("u"))&&1===oa?Math.floor(ca.min+.5):ca.min,qa=pa&&1===oa?Math.floor(ca.max-.5):ca.max,ra=ca.size;let sa=0,ua;ca.counts.forEach(va=>sa+=va/ra);ca.counts.forEach((va,wa)=>{if(0<va)for(ha.push(va),va=Math.max(1,Math.round(va/ra/sa*1E3)),ua=la?ba.features[wa].attributes[ka.name]:0===wa?ta:wa===ra-1?qa:ca.min+oa*(wa+.5),wa=0;wa<va;wa++)ia.push(ua)})}pa=(null==Z?void 0:Z.classificationMethod)||"natural-breaks";let na=null==Z?void 0:
Z.definedInterval;"defined-interval"!==pa||na||(na=C(Q,ka,da));Q=E.createGenerateRendererClassBreaks({values:ia,valueFrequency:ha,normalizationTotal:null,definition:new I({classificationMethod:pa,breakCount:da,definedInterval:na})});let ma=null==Z?void 0:Z.colors;ma||(Z=(null==Z?void 0:Z.colorRamp)||X,ea.colorRamp=Z,ma=q.convertColorRampToColormap(Z,Q.classBreaks.length,!0).map(oa=>oa.slice(1)));Z=Q.classBreaks.map((oa,ta)=>new K({minValue:oa.minValue,maxValue:oa.maxValue,label:oa.label,symbol:{type:"simple-fill",
color:ma[ta]}}));return new A({field:fa,classBreakInfos:Z,authoringInfo:ea})};U.createColorRamp=function(Q){const Z=[];for(let ba=0;ba<Q.length-1;ba++)Z[ba]=new u({algorithm:"hsv",fromColor:Q[ba],toColor:Q[ba+1]||new N({r:255,g:255,b:255,a:1})});return 2<Q.length?new L({colorRamps:Z}):Z[0]};U.createColormapRenderer=r;U.createDefaultRenderer=function(Q,Z){const {attributeTable:ba,colormap:ca}=Q;if(t(Q)){var da=G(Q);if(J.isSome(da))return da}return J.isSome(ca)&&(da=r(Q),J.isSome(da))||J.isSome(ba)&&
(da=g(Q),J.isSome(da))?da:y(Q,Z)};U.createFlowRenderer=function(Q){if(!z(Q))return null;let Z;if(J.isSome(Q.statistics)&&0<Q.statistics.length&&("vector-magdir"===Q.dataType||"vector-uv"===Q.dataType)){const {minMagnitude:ba,maxMagnitude:ca}=S(Q.dataType,Q.statistics);Z=[{type:"color",field:"Magnitude",stops:[{value:ba,color:"#1020C0"},{value:ca,color:"#C02010"}]}]}return new R({visualVariables:Z})};U.createShadedReliefRenderer=function(Q,Z){var ba;if(!D(Q))return null;({extent:Q}=Q);Q=Q.width*w.getMetersPerUnitForSR(Q.spatialReference);
Z=null!=(ba=Z)?ba:"multi-directional";return new x({hillshadeType:Z,scalingType:5E6<Q?"adjusted":"none"})};U.createStretchRenderer=y;U.createUVRenderer=g;U.createVectorFieldRenderer=G;U.estimateMagnitudeRange=S;U.getBandNames=function(Q,Z){var ba;const ca=Q.keyProperties&&Q.keyProperties.BandProperties;Z=null!=(ba=Z)&&ba.length?Z:Array.from(Array(Q.bandCount).keys());return Z.map(da=>ca&&ca.length===Q.bandCount?ca[da]&&ca[da].BandName||"band_"+(da+1):"band_"+(da+1))};U.getClassField=p;U.getDefaultBandCombination=
d;U.getDefaultInterpolation=function(Q,Z,ba){const ca=["nearest","bilinear","cubic","majority"].find(da=>da===(null==ba?void 0:ba.toLowerCase()));return"Map"===Z?null!=ca?ca:"bilinear":"standard-time"===Q.dataType?null!=ca?ca:"nearest":"thematic"===Q.dataType||Q.attributeTable||Q.colormap?"nearest"===ca||"majority"===ca?ca:"nearest":null!=ca?ca:"bilinear"};U.getDefinedInterval=C;U.getField=f;U.getSupportedRendererTypes=function(Q){const Z=["raster-stretch"];a(Q)&&Z.push("raster-colormap");k(Q)&&Z.push("unique-value");
M(Q)&&Z.push("class-breaks");D(Q)&&Z.push("raster-shaded-relief");t(Q)&&Z.push("vector-field");z(Q)&&Z.push("flow");return Z};U.getWellKnownBandIndexes=l;U.isClassBreaksSupported=M;U.isColormapRendererSupported=a;U.isFlowRendererSupported=z;U.isShadedReliefRendererSupported=D;U.isSingleBand8BitRasterWithStats=e;U.isUVRendererSupported=k;U.isVectorFieldRendererSupported=t;U.normalizeRendererJSON=function(Q){if("uniqueValue"===Q.type){var Z,ba=Q.uniqueValueInfos,ca=ba[0].symbol;null!=ca&&null!=(Z=ca.symbolLayers)&&
Z.length&&(Q.uniqueValueInfos=ba.map(da=>({value:da.value,label:da.label,symbol:da.symbol?O(da.symbol):null})));return Q}"classBreaks"===Q.type&&(Z=Q.classBreakInfos,ca=Z[0].symbol,null!=ca&&null!=(ba=ca.symbolLayers)&&ba.length&&(Q.classBreakInfos=Z.map(da=>({classMinValue:da.classMinValue,classMaxValue:da.classMaxValue,label:da.label,symbol:da.symbol?O(da.symbol):null}))));return Q};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/RasterInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterStorageInfo".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m){H=function(u){function I(E){E=u.call(this,E)||this;E.attributeTable=null;E.bandCount=null;E.colormap=null;E.extent=null;E.format=void 0;E.height=null;E.width=null;E.histograms=null;E.keyProperties={};E.multidimensionalInfo=null;E.noDataValue=null;E.pixelSize=null;E.pixelType=null;E.isPseudoSpatialReference=!1;E.spatialReference=null;E.statistics=null;E.storageInfo=null;E.transform=null;return E}U._inheritsLoose(I,u);U._createClass(I,[{key:"dataType",get:function(){var E,
L,c;const v=null!=(E=null==(L=this.keyProperties)?void 0:null==(c=L.DataType)?void 0:c.toLowerCase())?E:"generic";return"stdtime"===v?"standard-time":v}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(E){E&&this._set("nativeExtent",E)}},{key:"nativePixelSize",get:function(){if(!J.isSome(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;const E=this.nativeExtent;return{x:E.width/this.width,y:E.height/this.height}}}]);return I}(H.JSONSupport);
N.__decorate([w.property({json:{write:!0}})],H.prototype,"attributeTable",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"bandCount",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"colormap",void 0);N.__decorate([w.property({type:String,readOnly:!0})],H.prototype,"dataType",null);N.__decorate([w.property({type:K,json:{write:!0}})],H.prototype,"extent",void 0);N.__decorate([w.property({type:K,json:{write:!0}})],H.prototype,"nativeExtent",null);N.__decorate([w.property({json:{write:!0}})],
H.prototype,"nativePixelSize",null);N.__decorate([w.property({json:{write:!0}})],H.prototype,"format",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"height",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"width",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"histograms",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"keyProperties",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"multidimensionalInfo",void 0);
N.__decorate([w.property()],H.prototype,"noDataValue",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"pixelSize",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"pixelType",void 0);N.__decorate([w.property()],H.prototype,"isPseudoSpatialReference",void 0);N.__decorate([w.property({type:q,json:{write:!0}})],H.prototype,"spatialReference",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"statistics",void 0);N.__decorate([w.property({type:m,json:{write:!0}})],
H.prototype,"storageInfo",void 0);N.__decorate([w.property({json:{write:!0}})],H.prototype,"transform",void 0);return H=N.__decorate([P.subclass("esri.layers.support.RasterInfo")],H)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P){H=function(K){function q(){var m=K.apply(this,arguments)||this;m.blockWidth=void 0;m.blockHeight=void 0;m.compression=null;m.origin=null;m.firstPyramidLevel=null;m.maximumPyramidLevel=null;m.pyramidScalingFactor=2;m.pyramidBlockWidth=null;m.pyramidBlockHeight=null;m.isVirtualTileInfo=!1;m.tileInfo=null;m.blockBoundary=null;return m}U._inheritsLoose(q,K);return q}(H.JSONSupport);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"blockWidth",void 0);N.__decorate([J.property({type:Number,
json:{write:!0}})],H.prototype,"blockHeight",void 0);N.__decorate([J.property({type:String,json:{write:!0}})],H.prototype,"compression",void 0);N.__decorate([J.property({type:P,json:{write:!0}})],H.prototype,"origin",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"firstPyramidLevel",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"maximumPyramidLevel",void 0);N.__decorate([J.property({json:{write:!0}})],H.prototype,"pyramidResolutions",void 0);
N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"pyramidScalingFactor",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"pyramidBlockWidth",void 0);N.__decorate([J.property({type:Number,json:{write:!0}})],H.prototype,"pyramidBlockHeight",void 0);N.__decorate([J.property({type:Boolean,json:{write:!0}})],H.prototype,"isVirtualTileInfo",void 0);N.__decorate([J.property({json:{write:!0}})],H.prototype,"tileInfo",void 0);N.__decorate([J.property()],H.prototype,
"blockBoundary",void 0);return H=N.__decorate([R.subclass("esri.layers.support.RasterStorageInfo")],H)})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),function(U,N,H,J,w,V,T,R,P){w=new H.JSONMap({esriClassifyEqualInterval:"equal-interval",
esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});H=new H.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});P=function(K){function q(){var m=K.apply(this,arguments)||this;m.breakCount=null;m.classificationField=null;m.classificationMethod=null;m.normalizationField=null;m.normalizationType=
null;m.type="class-breaks-definition";return m}U._inheritsLoose(q,K);U._createClass(q,[{key:"standardDeviationInterval",set:function(m){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",m)}},{key:"definedInterval",set:function(m){"defined-interval"===this.classificationMethod&&this._set("definedInterval",m)}}]);return q}(P);N.__decorate([J.property({json:{write:!0}})],P.prototype,"breakCount",void 0);N.__decorate([J.property({json:{write:!0}})],P.prototype,"classificationField",
void 0);N.__decorate([J.property({type:String,json:{read:w.read,write:w.write}})],P.prototype,"classificationMethod",void 0);N.__decorate([J.property({json:{write:!0}})],P.prototype,"normalizationField",void 0);N.__decorate([J.property({json:{read:H.read,write:H.write}})],P.prototype,"normalizationType",void 0);N.__decorate([J.property({value:null,json:{write:!0}})],P.prototype,"standardDeviationInterval",null);N.__decorate([J.property({value:null,json:{write:!0}})],P.prototype,"definedInterval",
null);N.__decorate([J.property()],P.prototype,"type",void 0);return P=N.__decorate([R.subclass("esri.rest.support.ClassBreaksDefinition")],P)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q){H=new H.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});J=function(m){function u(){var I=m.apply(this,arguments)||this;I.baseSymbol=null;I.colorRamp=null;I.type=null;return I}U._inheritsLoose(u,m);return u}(J.JSONSupport);N.__decorate([w.property({type:q,json:{write:!0}})],J.prototype,"baseSymbol",void 0);N.__decorate([w.property({types:K.types,json:{read:{reader:K.fromJSON},write:!0}})],J.prototype,"colorRamp",void 0);N.__decorate([w.property({json:{read:H.read,
write:H.write}})],J.prototype,"type",void 0);return J=N.__decorate([P.subclass("esri.rest.support.ClassificationDefinition")],J)})},"esri/rest/support/generateRendererUtils":function(){define(["exports"],function(U){function N(q){const {classificationMethod:m,breakCount:u,normalizationType:I,definedInterval:E}=q.definition,L=[];var c=q.values;if(0===c.length)return[];c=c.sort((y,b)=>y-b);var v=c[0],F=c[c.length-1];if("equal-interval"===m)if(c.length>=u){c=(F-v)/u;q=v;for(var x=1;x<u;x++){var A=Number((v+
x*c).toFixed(6));L.push({minValue:q,maxValue:A,label:H(q,A,I)});q=A}L.push({minValue:q,maxValue:F,label:H(q,F,I)})}else c.forEach(y=>{L.push({minValue:y,maxValue:y,label:H(y,y,I)})});else if("natural-breaks"===m){c=J(c);q=w(c.uniqueValues,q.valueFrequency||c.valueFrequency,u);for(x=1;x<u;x++)c.uniqueValues.length>x&&(A=Number(c.uniqueValues[q[x]].toFixed(6)),L.push({minValue:v,maxValue:A,label:H(v,A,I)}),v=A);L.push({minValue:v,maxValue:F,label:H(v,F,I)})}else if("quantile"===m)if(c.length>=u&&v!==
F){q=Math.ceil(c.length/u);x=0;for(A=1;A<u;A++){var B=q+x-1;B>c.length&&(B=c.length-1);0>B&&(B=0);L.push({minValue:v,maxValue:c[B],label:H(v,c[B],I)});v=c[B];x+=q;q=Math.ceil((c.length-x)/(u-A))}L.push({minValue:v,maxValue:F,label:H(v,F,I)})}else for(F=-1,v=0;v<c.length;v++)q=c[v],q!==F&&(F=q,L.push({minValue:F,maxValue:q,label:H(F,q,I)}),F=q);else if("standard-deviation"===m)if(q=R(c),x=P(c,q),0===x)L.push({minValue:c[0],maxValue:c[0],label:H(c[0],c[0],I)});else{c=T(v,F,u,q,x)*x;x=0;for(A=u;1<=A;A--)B=
Number((q-(A-.5)*c).toFixed(6)),L.push({minValue:v,maxValue:B,label:H(v,B,I)}),v=B,x++;A=Number((q+.5*c).toFixed(6));L.push({minValue:v,maxValue:A,label:H(v,A,I)});v=A;x++;for(B=1;B<=u;B++)A=x===2*u?F:Number((q+(B+.5)*c).toFixed(6)),L.push({minValue:v,maxValue:A,label:H(v,A,I)}),v=A,x++}else if("defined-interval"===m){if(!E)return L;F=c[0];c=c[c.length-1];v=Math.ceil((c-F)/E);q=F;for(x=1;x<v;x++)A=Number((F+x*E).toFixed(6)),L.push({minValue:q,maxValue:A,label:H(q,A,I)}),q=A;L.push({minValue:q,maxValue:c,
label:H(q,c,I)})}return L}function H(q,m,u){let I=null;return I=q===m?u&&"percent-of-total"===u?q+"%":q.toString():u&&"percent-of-total"===u?q+"% - "+m+"%":q+" - "+m}function J(q){const m=[],u=[];let I=Number.MIN_VALUE,E=1,L=-1;for(let c=0;c<q.length;c++){const v=q[c];v===I?(E++,u[L]=E):null!==v&&(m.push(v),I=v,E=1,u.push(E),L++)}return{uniqueValues:m,valueFrequency:u}}function w(q,m,u){var I=q.length;const E=[];u>I&&(u=I);for(var L=0;L<u;L++)E.push(Math.round(L*I/u-1));E.push(I-1);L=V(E,q,m,u);{I=
L.mean;L=L.sdcm;var c=u,v=0,F=0;let A=0,B=0,y=!0;for(let b=0;2>b&&y;b++){0===b&&(y=!1);for(var x=0;x<c-1;x++)for(;E[x+1]+1!==E[x+2];)if(E[x+1]+=1,v=K(x,E,q,m),A=v.sbMean,v=v.sbSdcm,F=K(x+1,E,q,m),B=F.sbMean,F=F.sbSdcm,v+F<L[x]+L[x+1])L[x]=v,L[x+1]=F,I[x]=A,I[x+1]=B,y=!0;else{--E[x+1];break}for(x=c-1;0<x;x--)for(;E[x]!==E[x-1]+1;)if(--E[x],v=K(x-1,E,q,m),A=v.sbMean,v=v.sbSdcm,F=K(x,E,q,m),B=F.sbMean,F=F.sbSdcm,v+F<L[x-1]+L[x])L[x-1]=v,L[x]=F,I[x-1]=A,I[x]=B,y=!0;else{E[x]+=1;break}}I=y}I&&(L=V(E,q,
m,u));return E}function V(q,m,u,I){let E=[];var L=[],c=[];let v=0;const F=[],x=[];for(var A=0;A<I;A++){var B=K(A,q,m,u);F.push(B.sbMean);x.push(B.sbSdcm);v+=x[A]}B=v;for(A=!0;A||v<B;){A=!1;E=[];for(L=0;L<I;L++)E.push(q[L]);for(c=0;c<I;c++)for(B=q[c]+1;B<=q[c+1];B++)if(L=m[B],0<c&&B!==q[c+1]&&Math.abs(L-F[c])>Math.abs(L-F[c-1]))q[c]=B;else if(c<I-1&&q[c]!==B-1&&Math.abs(L-F[c])>Math.abs(L-F[c+1])){q[c+1]=B-1;break}B=v;v=0;L=[];c=[];for(let y=0;y<I;y++){L.push(F[y]);c.push(x[y]);const b=K(y,q,m,u);
F[y]=b.sbMean;x[y]=b.sbSdcm;v+=x[y]}}if(v>B){for(m=0;m<I;m++)q[m]=E[m],F[m]=L[m],x[m]=c[m];v=B}return{mean:F,sdcm:x}}function T(q,m,u,I,E){q=Math.max(I-q,m-I)/E/u;return 1<=q?1:.5<=q?.5:.25}function R(q){let m=0;for(let u=0;u<q.length;u++)m+=q[u];return m/=q.length}function P(q,m){let u=0;for(let I=0;I<q.length;I++){const E=q[I];u+=(E-m)*(E-m)}u/=q.length;return Math.sqrt(u)}function K(q,m,u,I){var E=0,L=0;for(var c=m[q]+1;c<=m[q+1];c++){const v=I[c];E+=u[c]*v;L+=v}0>=L&&console.log("Exception in Natural Breaks calculation");
E/=L;L=0;for(c=m[q]+1;c<=m[q+1];c++)L+=I[c]*(u[c]-E)**2;return{sbMean:E,sbSdcm:L}}U.createGenerateRendererClassBreaks=function(q){const {normalizationTotal:m}=q;return{classBreaks:N(q),normalizationTotal:m}};U.createGenerateRendererUniqueValues=function(q){q=J(q);const m=[],u=q.uniqueValues.length;for(let I=0;I<u;I++){const E=q.uniqueValues[I];m.push({value:E,count:q.valueFrequency[I],label:E.toString()})}return{uniqueValues:m}};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E){function L(A,B){const {attributeTable:y,bandCount:b}=A;return!V.isSome(y)||1<b||B&&null==y.fields.find(d=>d.name.toLowerCase()===B.toLowerCase())?!1:!0}function c(A){const {bandCount:B,colormap:y}=A;return V.isSome(y)&&y.length&&1===B}function v(A){return u.isValidPixelBlock(A)&&0!==A.validPixelCount}const F=w.getLogger("esri.renderers.support.RasterSymbolizer"),x={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,
4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};J=function(A){function B(b){return A.call(this,b)||this}U._inheritsLoose(B,A);var y=B.prototype;y.bind=function(){const {rendererJSON:b}=this;if(!b)return{success:!1};this.lookup={rendererJSON:{}};let d;switch(b.type){case "uniqueValue":d=this._updateUVRenderer(b);break;case "rasterColormap":d=this._updateColormapRenderer(b);break;case "rasterStretch":d=this._updateStretchRenderer(b);break;
case "classBreaks":d=this._updateClassBreaksRenderer(b);break;case "rasterShadedRelief":d=this._updateShadedReliefRenderer(b);break;case "vectorField":d=this._updateVectorFieldRenderer();break;case "flowRenderer":d=this._updateFlowRenderer()}return d};y.symbolize=function(b){let d=b&&b.pixelBlock;if(!v(d))return d;if(b.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(d,b.simpleStretchParams);try{3<d.pixels.length&&(d=u.extractBands(d,[0,1,2]));let l;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":l=
this._symbolizeColormap(d);break;case "classBreaks":l=this._symbolizeClassBreaks(d);break;case "rasterStretch":l=this._symbolizeStretch(d,b.bandIds);break;case "rasterShadedRelief":({extent:b}=b),l=this._symbolizeShadedRelief(d,{isGCS:b.spatialReference.isGeographic,resolution:{x:(b.xmax-b.xmin)/d.width,y:(b.ymax-b.ymin)/d.height}})}return l}catch(l){return F.error("symbolize",l.message),d}};y.simpleStretch=function(b,d){if(!v(b))return b;try{return 3<b.pixels.length&&(b=u.extractBands(b,[0,1,2])),
u.stretch(b,d)}catch(l){return F.error("symbolize",l.message),b}};y.generateWebGLParameters=function(b){if(-1<["uniqueValue","rasterColormap","classBreaks"].indexOf(this.rendererJSON.type)){var d;const {indexedColormap:n,offset:f}=(null==(d=this.lookup)?void 0:d.colormapLut)||{};return{colormap:n,colormapOffset:f,type:"lut"}}const {pixelBlock:l,isGCS:h,resolution:g,bandIds:p}=b;({rendererJSON:b}=this);return"rasterStretch"===b.type?this._generateStretchWebGLParams(l,b,p):"rasterShadedRelief"===b.type?
this._generateShadedReliefWebGLParams(b,h,g):"vectorField"===b.type?this._generateVectorFieldWebGLParams(b):null};y._isLUTChanged=function(b){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const d=this.rendererJSON.colorRamp;if(b)return JSON.stringify(d)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)};y._symbolizeColormap=
function(b){return this._isLUTChanged()&&!this.bind().success?b:u.colorize(b,this.lookup.colormapLut)};y._symbolizeClassBreaks=function(b){const d=-1<["u8","u16","s8","s16"].indexOf(this.rasterInfo.pixelType);return this._isLUTChanged()&&!this.bind().success?b:d?u.colorize(b,this.lookup.colormapLut):u.remapColor(b,this.lookup.remapLut)};y._symbolizeStretch=function(b,d){const {pixelType:l,bandCount:h}=this.rasterInfo,g=this.rendererJSON,p=-1<["u8","u16","s8","s16"].indexOf(l);let n;var {dra:f}=g;
var k=g.useGamma?g.gamma:null;if("histogramEqualization"===g.stretchType){var a=f?null:this.lookup.histogramLut;d=this._getStretchCutoff(g,b,d,!a);k=u.stretch(b,{...d,gamma:k});k=u.lookupPixels(k,{lut:f?d.histogramLut:a,offset:0})}else if(p){var r;if(f)f=this._getStretchCutoff(g,b,d),n=u.createStretchLUT({pixelType:l,...f,gamma:k});else{if(this._isLUTChanged()&&!this.bind().success)return b;n=this.lookup?this.lookup.stretchLut:null}if(!n)return b;1<h&&(null==d?void 0:d.length)===(null==(a=V.unwrap(b))?
void 0:a.pixels.length)&&(null==(r=n)?void 0:r.lut.length)===h&&(n={lut:d.map(D=>n.lut[D]),offset:n.offset});k=u.lookupPixels(b,n)}else f=this._getStretchCutoff(g,b,d),k=u.stretch(b,{...f,gamma:k});if(g.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return b;k=u.colorize(k,this.lookup.colormapLut)}return k};y._symbolizeShadedRelief=function(b,d){var l,h,g=this.rendererJSON;d=I.hillshade(b,{...g,...d});if(!g.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return d;g=this.lookup?
this.lookup.hsvMap:null;if(!g)return d;const p=null!=(l=null==(h=V.unwrap(this.rasterInfo.statistics))?void 0:h[0])?l:{min:0,max:8E3};I.tintHillshade(d,b,g,p);return d};y._isVectorFieldData=function(){const {bandCount:b,dataType:d}=this.rasterInfo;return 2===b&&("vector-magdir"===d||"vector-uv"===d)};y._updateVectorFieldRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}};
y._updateFlowRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}};y._updateUVRenderer=function(b){const {bandCount:d,attributeTable:l,pixelType:h}=this.rasterInfo,g=b.field1;if(!g)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const p=b.defaultSymbol;var n=1===d&&["u8","s8"].includes(h);if(!L(this.rasterInfo,g)&&!n)return{success:!1,
error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const f=[];if(l){const k=l.fields.find(a=>"value"===a.name.toLowerCase());if(!k)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};l.features.forEach(a=>{var r,D=b.uniqueValueInfos.find(M=>String(M.value)===String(a.attributes[g]));(D=null==D?void 0:null==(r=D.symbol)?void 0:r.color)?f.push([a.attributes[k.name]].concat(D)):
p&&f.push([a.attributes[k.name]].concat(p.color))})}else{if("value"!==g.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};b.uniqueValueInfos.forEach(k=>{var a;const r=null==k?void 0:null==(a=k.symbol)?void 0:a.color;r?f.push([parseInt(""+k.value,10)].concat(r)):p&&f.push([parseInt(""+k.value,10)].concat(p.color))})}if(0===f.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};
n=u.createColormapLUT({colormap:f});this.lookup={rendererJSON:b,colormapLut:n};this.canRenderInWebGL=!0;return{success:!0}};y._updateColormapRenderer=function(b){if(!c(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};var d=b.colormapInfos.map(l=>[l.value].concat(l.color)).sort((l,h)=>l[0]-h[0]);if(!d||0===d.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};d=u.createColormapLUT({colormap:d});
this.lookup={rendererJSON:b,colormapLut:d};this.canRenderInWebGL=!0;return{success:!0}};y._updateShadedReliefRenderer=function(b){if("elevation"!==this.rasterInfo.dataType)return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation".`};if(b.colorRamp){var d=E.convertColorRampToColormap(b.colorRamp,256,!0);d=u.createColormapLUT({colormap:d});const l=[],h=d.indexedColormap;for(let g=0;g<h.length;g+=4){const p=H.toHSV({r:h[g],g:h[g+1],b:h[g+
2]});l.push([p.h/60,p.s/100,255*p.v/100])}this.lookup={rendererJSON:b,colormapLut:d,hsvMap:l}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}};y._updateClassBreaksRenderer=function(b){var d=-1<["u8","u16","s8","s16"].indexOf(this.rasterInfo.pixelType),l=b.classBreakInfos;if(null==l||!l.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};l=l.sort((f,k)=>f.classMaxValue-k.classMaxValue);const h=l[l.length-1];var g=b.minValue;
if(!d){d=[];for(var p=0;p<l.length;p++){var n;d.push({value:null!=(n=l[p].classMinValue)?n:g,mappedColor:l[p].symbol.color});g=l[p].classMaxValue}d.push({value:h.classMaxValue,mappedColor:h.symbol.color});this.lookup={rendererJSON:b,remapLut:d};this.canRenderInWebGL=!1;return{success:!0}}n=[];g=Math.floor(b.minValue);for(d=0;d<l.length;d++){for(p=l[d];g<p.classMaxValue;g++)n.push([g].concat(p.symbol.color));g=Math.ceil(p.classMaxValue)}h.classMaxValue===g&&n.push([h.classMaxValue].concat(h.symbol.color));
l=u.createColormapLUT({colormap:n,fillUnspecified:!1});this.lookup={rendererJSON:b,colormapLut:l};this.canRenderInWebGL=!0;return{success:!0}};y._isHistogramRequired=function(b){return"percentClip"===b||"histogramEqualization"===b};y._isValidRasterStatistics=function(b){return V.isSome(b)&&0<b.length&&null!=b[0].min&&null!=b[0].max};y._updateStretchRenderer=function(b){var d;let {stretchType:l,dra:h}=b;if(!("none"===l||null!=(d=b.statistics)&&d.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||
h))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var g=V.unwrap(b.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(b.stretchType)||null!=g&&g.length||h||(l="minMax");const {gamma:p,useGamma:n,colorRamp:f}=b;d=this.rasterInfo.pixelType;const k=!h&&-1<["u8","u16","s8","s16"].indexOf(d);"histogramEqualization"===l?(d=g.map(a=>u.createHistogramEqualizationLUT(a)),this.lookup={rendererJSON:b,histogramLut:d}):
k&&(g=this._getStretchCutoff(b),d=u.createStretchLUT({pixelType:d,...g,gamma:n?p:null}),this.lookup={rendererJSON:b,stretchLut:d});f&&(d=E.convertColorRampToColormap(f,256,!0),this.lookup||(this.lookup={rendererJSON:b}),this.lookup.colormapLut=u.createColormapLUT({colormap:d}),this.lookup.rendererJSON=b);this.canRenderInWebGL=!0;return{success:!0}};y._getStretchCutoff=function(b,d=null,l,h){var g,p,n,f=b.stretchType;if(b.dra)if("minMax"===f&&V.isSome(d)&&d.statistics)d=d.statistics.map(z=>[z.minValue,
z.maxValue,0,0]);else{var k=u.estimateStatisticsHistograms(d);d=V.isSome(k)?k.statistics:null;k=V.isSome(k)?k.histograms:null}else{var a;d=0<(null==(a=b.statistics)?void 0:a.length)?b.statistics:V.unwrap(this.rasterInfo.statistics);k=b.histograms||V.unwrap(this.rasterInfo.histograms)}!this._isHistogramRequired(f)||null!=(g=k)&&g.length||(f="minMax");a=(null==(p=d)?void 0:p.length)||(null==(n=k)?void 0:n.length)||this.rasterInfo.bandCount;p=[];n=[];let r;let D,M,C;d&&!Array.isArray(d[0])&&(d=d.map(z=>
[z.min,z.max,z.avg,z.stddev]));switch(f){case "none":d=x[this.rasterInfo.pixelType]||x.f32;for(g=0;g<a;g++)p[g]=d[0],n[g]=d[1];break;case "minMax":for(g=0;g<a;g++)p[g]=d[g][0],n[g]=d[g][1];break;case "standardDeviation":for(g=0;g<a;g++)p[g]=d[g][2]-b.numberOfStandardDeviations*d[g][3],n[g]=d[g][2]+b.numberOfStandardDeviations*d[g][3],p[g]<d[g][0]&&(p[g]=d[g][0]),n[g]>d[g][1]&&(n[g]=d[g][1]);break;case "histogramEqualization":for(g=0;g<a;g++)p[g]=k[g].min,n[g]=k[g].max;break;case "percentClip":for(g=
0;g<k.length;g++){d=k[g];D=new Uint32Array(d.size);var e=[...d.counts];20<=e.length&&(e[0]=e[1]=e[2]=e[e.length-1]=e[e.length-2]=0);r=0;a=(d.max-d.min)/d.size;M=-.5===d.min&&1===a?.5:0;for(C=0;C<d.size;C++)r+=e[C],D[C]=r;e=(b.minPercent||0)*r/100;for(C=0;C<d.size;C++)if(D[C]>e){p[g]=d.min+a*(C+M);break}e=(1-(b.maxPercent||0)/100)*r;for(C=d.size-2;0<=C;C--)if(D[C]<e){n[g]=d.min+a*(C+2-M);break}}break;default:for(g=0;g<a;g++)p[g]=d[g][0],n[g]=d[g][1]}let t;"histogramEqualization"===f?(f=k[0].size||
256,b=0,h&&(t=k.map(z=>u.createHistogramEqualizationLUT(z)))):(f=b.max||255,b=b.min||0);return this._getSelectedBandCutoffs({minCutOff:p,maxCutOff:n,outMax:f,outMin:b,histogramLut:t},l)};y._getSelectedBandCutoffs=function(b,d){if(null==d||0===d.length)return b;const l=Math.max.apply(null,d),{minCutOff:h,maxCutOff:g,outMin:p,outMax:n,histogramLut:f}=b;return h.length===d.length||h.length<=l?b:{minCutOff:d.map(k=>h[k]),maxCutOff:d.map(k=>g[k]),histogramLut:f?d.map(k=>f[k]):null,outMin:p,outMax:n}};
y._generateStretchWebGLParams=function(b,d,l){let h=null,g=null;var p=this.lookup&&this.lookup.colormapLut;d.colorRamp&&p&&(h=p.indexedColormap,g=p.offset);"histogramEqualization"===d.stretchType&&(d={...d,stretchType:"minMax"});({gamma:p}=d);const n=!!(d.useGamma&&p&&p.some(e=>1!==e)),{minCutOff:f,maxCutOff:k,outMin:a,outMax:r}=this._getStretchCutoff(d,b,l);var D=0;V.isSome(b)&&(D=b.getPlaneCount(),2===D&&(b=b.clone(),b.statistics=[b.statistics[0]],b.pixels=[b.pixels[0]]));b=Math.min(3,(null==l?
void 0:l.length)||D||this.rasterInfo.bandCount);l=new Float32Array(b);D=h||n?1:255;let M;for(M=0;M<b;M++)l[M]=(r-a)/(k[M]-f[M])/D;const C=new Float32Array(b);if(n)for(M=0;M<b;M++)C[M]=1<p[M]?2<p[M]?6.5+(p[M]-2)**2.5:6.5+100*(2-p[M])**4:1;return{bandCount:b,outMin:a/D,outMax:r/D,minCutOff:f,maxCutOff:k,factor:l,useGamma:n,gamma:n?p:[1,1,1],gammaCorrection:n?C:[1,1,1],colormap:h,colormapOffset:g,stretchType:d.stretchType,type:"stretch"}};y._generateShadedReliefWebGLParams=function(b,d,l){var h,g,p;
let n=null,f=null;const k=this.lookup&&this.lookup.colormapLut;b.colorRamp&&k&&(n=k.indexedColormap,f=k.offset);d=I.calculateHillshadeParams({...b,isGCS:d,resolution:l});l=null==(h=V.unwrap(this.rasterInfo.statistics))?void 0:h[0];return{...d,minValue:null!=(g=null==l?void 0:l.min)?g:0,maxValue:null!=(p=null==l?void 0:l.max)?p:8E3,hillshadeType:"traditional"===b.hillshadeType?0:1,type:"hillshade",colormap:n,colormapOffset:f}};y._generateVectorFieldWebGLParams=function(b){var d,l,h,g,p,n,f,k;const {style:a,
inputUnit:r,outputUnit:D,visualVariables:M,symbolTileSize:C,flowRepresentation:e}=b;let t;var z=null!=(d=null==(l=this.rasterInfo.statistics)?void 0:l[0].min)?d:0;d=null!=(h=null==(g=this.rasterInfo.statistics)?void 0:g[0].max)?h:50;h=null!=(p=null==M?void 0:M.find(G=>"sizeInfo"===G.type))?p:{type:"sizeInfo",field:"Magnitude",maxDataValue:d,maxSize:.8*C,minDataValue:z,minSize:.2*C};p=null!=(n=h.minDataValue)?n:z;z=null!=(f=h.maxDataValue)?f:d;f=V.isSome(h.maxSize)&&V.isSome(h.minSize)?[h.minSize/
C,h.maxSize/C]:[.2,.8];"wind_speed"===a&&(f[0]=f[1]=(f[0]+f[1])/2);n=V.isSome(p)&&V.isSome(z)?[p,z]:null;if("classified_arrow"===a)if(V.isSome(p)&&V.isSome(z)&&V.isSome(h))for(t=[],p=(h.maxDataValue-h.minDataValue)/5,z=0;6>z;z++)t.push(h.minDataValue+p*z);else t=[0,1E-6,3.5,7,10.5,14];h="flow_to"===e===("ocean_current_kn"===a||"ocean_current_m"===a)?0:Math.PI;p=null==M?void 0:M.find(G=>"rotationInfo"===G.type);b=(null==(k=this.rasterInfo.storageInfo)?0:k.tileInfo)&&"vector-uv"===this.rasterInfo.dataType?
"geographic":(null==p?void 0:p.rotationType)||b.rotationType;return{breakValues:t,dataRange:n,inputUnit:r,outputUnit:D,symbolTileSize:C,symbolPercentRange:f,style:a||"single_arrow",rotation:h,rotationType:b,type:"vectorField"}};return B}(J.JSONSupport);N.__decorate([T.property({json:{write:!0}})],J.prototype,"rendererJSON",void 0);N.__decorate([T.property({type:m,json:{write:!0}})],J.prototype,"rasterInfo",void 0);N.__decorate([T.property({json:{write:!0}})],J.prototype,"lookup",void 0);N.__decorate([T.property()],
J.prototype,"canRenderInWebGL",void 0);return J=N.__decorate([q.subclass("esri.renderers.support.RasterSymbolizer")],J)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","./pixelUtils"],function(U,N,H){function J(w){let {altitude:V,azimuth:T}=w;const {hillshadeType:R,pixelSizePower:P,pixelSizeFactor:K,scalingType:q,isGCS:m,resolution:u}=w;var I="multi-directional"===R?2*w.zFactor:w.zFactor;const {x:E,y:L}=u;w=I/(8*E);var c=I/(8*L);m&&.001<I&&(w/=111E3,
c/=111E3);"adjusted"===q&&(m?(w=111E3*E,c=111E3*L,w=(I+w**P*K)/(8*w),c=(I+c**P*K)/(8*c)):(w=(I+E**P*K)/(8*E),c=(I+L**P*K)/(8*L)));var v=(90-V)*Math.PI/180;I=Math.cos(v);let F=(360-T+90)*Math.PI/180,x=Math.sin(v)*Math.cos(F);v=Math.sin(v)*Math.sin(F);const A=[315,270,225,360,180,0],B=[60,60,60,60,60,90];var y=new Float32Array([3,5,3,2,1,4]);const b=y.reduce((p,n)=>p+n);y=y.map(p=>p/b);const d="multi-directional"===R?A.length:1,l=new Float32Array(6),h=new Float32Array(6),g=new Float32Array(6);if("multi-directional"===
R)for(let p=0;p<d;p++)V=B[p],T=A[p],v=(90-V)*Math.PI/180,I=Math.cos(v),F=(360-T+90)*Math.PI/180,x=Math.sin(v)*Math.cos(F),v=Math.sin(v)*Math.sin(F),l[p]=I,h[p]=x,g[p]=v;else l.fill(I),h.fill(x),g.fill(v);return{resolution:u,factor:[w,c],sinZcosA:x,sinZsinA:v,cosZ:I,sinZcosAs:h,sinZsinAs:g,cosZs:l,weights:y,hillshadeType:["traditional","multi-directional"].indexOf(R)}}U.calculateHillshadeParams=J;U.hillshade=function(w,V){if(!H.isValidPixelBlock(w))return w;const {width:T,height:R,mask:P}=w,K=new Uint8Array(T*
R);P&&K.set(P);const {factor:q,sinZcosA:m,sinZsinA:u,cosZ:I,sinZcosAs:E,sinZsinAs:L,cosZs:c,weights:v}=J(V),[F,x]=q;var {hillshadeType:A}=V;const B=w.pixels[0];V=new Uint8Array(T*R);let y;for(let f=1;f<R-1;f++){const k=f*T;for(let a=1;a<T-1;a++)if(P&&!P[k+a])V[k+a]=0;else{var b=8;if(P&&(b=P[k-T+a-1]+P[k-T+a]+P[k-T+a+1]+P[k+a-1]+P[k+a+1]+P[k+T+a-1]+P[k+T+a]+P[k+T+a+1],7>b)){V[k+a]=0;K[k+a]=0;continue}if(7===b){var d=P[k-T+a-1]?B[k-T+a-1]:B[k+a];var l=P[k-T+a]?B[k-T+a]:B[k+a];var h=P[k-T+a+1]?B[k-T+
a+1]:B[k+a];b=P[k+a-1]?B[k+a-1]:B[k+a];y=P[k+a+1]?B[k+a+1]:B[k+a];var g=P[k+T+a-1]?B[k+T+a-1]:B[k+a];var p=P[k+T+a]?B[k+T+a]:B[k+a];var n=P[k+T+a+1]?B[k+T+a+1]:B[k+a]}else d=B[k-T+a-1],l=B[k-T+a],h=B[k-T+a+1],b=B[k+a-1],y=B[k+a+1],g=B[k+T+a-1],p=B[k+T+a],n=B[k+T+a+1];b=(h+y+y+n-(d+b+b+g))*F;d=(g+p+p+n-(d+l+l+h))*x;l=Math.sqrt(1+b*b+d*d);h=0;if("traditional"===A)b=255*(I+u*d-m*b)/l,0>b&&(b=0),h=b;else for(g=L.length,p=0;p<g;p++)n=255*(c[p]+L[p]*d-E[p]*b)/l,0>n&&(n=0),h+=n*v[p];V[k+a]=h&255}}for(A=
0;A<R;A++)V[A*T]=V[A*T+1],V[(A+1)*T-1]=V[(A+1)*T-2];for(A=1;A<T-1;A++)V[A]=V[A+T],V[A+(R-1)*T]=V[A+(R-2)*T];return new N({width:T,height:R,pixels:[V],mask:P?K:null,pixelType:"u8",validPixelCount:w.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};U.tintHillshade=function(w,V,T,R){if(H.isValidPixelBlock(w)&&H.isValidPixelBlock(V)){var {min:P,max:K}=R;R=w.pixels[0];var {pixels:q,mask:m}=V;V=q[0];var u=255.00001/(K-P),I=new Uint8ClampedArray(V.length),E=new Uint8ClampedArray(V.length),L=new Uint8ClampedArray(V.length),
c=T.length-1;for(let x=0;x<V.length;x++){if(m&&0===m[x])continue;var v=Math.floor((V[x]-P)*u);const [A,B]=T[0>v?0:v>c?c:v];var F=R[x];v=F*B;const y=v*(1-Math.abs(A%2-1));F-=v;switch(Math.floor(A)){case 0:I[x]=v+F;E[x]=y+F;L[x]=F;break;case 1:I[x]=y+F;E[x]=v+F;L[x]=F;break;case 2:I[x]=F;E[x]=v+F;L[x]=y+F;break;case 3:I[x]=F;E[x]=y+F;L[x]=v+F;break;case 4:I[x]=y+F;E[x]=F;L[x]=v+F;break;case 5:case 6:I[x]=v+F,E[x]=F,L[x]=y+F}}w.pixels=[I,E,L];w.updateStatistics()}};Object.defineProperty(U,"__esModule",
{value:!0})})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(U,N,H,J,w,V,T,R,P,K){function q(){q=N._asyncToGenerator(function*(y,b,d){const l=performance.now();var h=m(y,b);const g=performance.now();
h=I(y,h,b.width,b.height);b=performance.now();var p=L(h,!0);h=performance.now();p=c(p);const n=performance.now();y.profile&&B.info("createStreamlinesMesh profile",{"_createFlowFieldFromData()":Math.round(g-l),"_getStreamlines()":Math.round(b-g),"createAnimatedLinesData()":Math.round(h-b),"createLinesMesh()":Math.round(n-h),"Total elapsed time":Math.round(n-l)});yield Promise.resolve();T.throwIfAborted(d);return p});return q.apply(this,arguments)}function m(y,b){const d=E(b.data,b.width,b.height,y.smoothing);
return y.interpolate?(l,h)=>{const g=Math.floor(l),p=Math.floor(h);if(0>g||g>=b.width||0>p||p>=b.height)return[0,0];l-=g;h-=p;const n=g<b.width-1?g+1:g,f=p<b.height-1?p+1:p;return[(d[2*(p*b.width+g)]*(1-h)+d[2*(f*b.width+g)]*h)*(1-l)+(d[2*(p*b.width+n)]*(1-h)+d[2*(f*b.width+n)]*h)*l,(d[2*(p*b.width+g)+1]*(1-h)+d[2*(f*b.width+g)+1]*h)*(1-l)+(d[2*(p*b.width+n)+1]*(1-h)+d[2*(f*b.width+n)+1]*h)*l]}:(l,h)=>{l=Math.round(l);h=Math.round(h);return 0>l||l>=b.width||0>h||h>=b.height?[0,0]:[d[2*(h*b.width+
l)],d[2*(h*b.width+l)+1]]}}function u(y,b,d,l,h,g,p,n,f){const k=[];let a=0,[r,D]=b(d,l);r*=y.velocityScale;D*=y.velocityScale;k.push({x:d,y:l,t:a,speed:Math.sqrt(r*r+D*D)});for(let e=0;e<y.verticesPerLine;e++){let [t,z]=b(d,l);t*=y.velocityScale;z*=y.velocityScale;const G=Math.sqrt(t*t+z*z);if(G<y.minSpeedThreshold)break;const O=t/G,S=z/G;d+=O*y.segmentLength;l+=S*y.segmentLength;a+=y.segmentLength/G;if(Math.acos(O*M+S*C)>y.maxTurnAngle)break;if(y.mergeLines){var M=Math.round(d*f);var C=Math.round(l*
f);if(0>M||M>p-1||0>C||C>n-1)break;const X=g[C*p+M];if(-1!==X&&X!==h)break;g[C*p+M]=h}k.push({x:d,y:l,t:a,speed:G});M=O;C=S}return k}function I(y,b,d,l){const h=[],g=new R,p=1/Math.max(y.lineCollisionWidth,1),n=Math.round(d*p),f=Math.round(l*p),k=new Int32Array(n*f);for(var a=0;a<k.length;a++)k[a]=-1;a=[];for(let r=0;r<l;r+=y.lineSpacing)for(let D=0;D<d;D+=y.lineSpacing)a.push({x:D,y:r,sort:g.getFloat()});a.sort((r,D)=>r.sort-D.sort);for(const {x:r,y:D}of a)g.getFloat()<y.density&&(d=u(y,b,r,D,h.length,
k,n,f,p),2>d.length||h.push(d));return h}function E(y,b,d,l){if(0===l)return y;const h=Math.round(3*l),g=Array(2*h+1);var p=0;for(var n=-h;n<=h;n++){var f=Math.exp(-n*n/(l*l));g[n+h]=f;p+=f}for(l=-h;l<=h;l++)g[l+h]/=p;p=new Float32Array(y.length);for(l=0;l<d;l++)for(n=0;n<b;n++){var k=f=0;for(var a=-h;a<=h;a++)if(!(0>n+a||n+a>=b)){var r=g[a+h];f+=r*y[2*(l*b+(n+a))];k+=r*y[2*(l*b+(n+a))+1]}p[2*(l*b+n)]=f;p[2*(l*b+n)+1]=k}y=new Float32Array(y.length);for(l=0;l<b;l++)for(n=0;n<d;n++){k=f=0;for(a=-h;a<=
h;a++)0>n+a||n+a>=d||(r=g[a+h],f+=r*p[2*((n+a)*b+l)],k+=r*p[2*((n+a)*b+l)+1]);y[2*(n*b+l)]=f;y[2*(n*b+l)+1]=k}return y}function L(y,b){const d=new R;var l=y.reduce((n,f)=>n+f.length,0);l=new Float32Array(4*l);const h=Array(y.length);let g=0,p=0;for(const n of y){y=g;for(const f of n)l[4*g]=f.x,l[4*g+1]=f.y,l[4*g+2]=f.t,l[4*g+3]=f.speed,g++;h[p++]={startVertex:y,numberOfVertices:n.length,totalTime:n[n.length-1].t,timeSeed:b?d.getFloat():0}}return{lineVertices:l,lineDescriptors:h}}function c(y,b=10){function d(M,
C,e,t,z,G,O,S){const X=9*f;let W=0;n[X+W++]=M;n[X+W++]=C;n[X+W++]=1;n[X+W++]=e;n[X+W++]=G;n[X+W++]=O;n[X+W++]=t/2;n[X+W++]=z/2;n[X+W++]=S;f++;n[X+W++]=M;n[X+W++]=C;n[X+W++]=-1;n[X+W++]=e;n[X+W++]=G;n[X+W++]=O;n[X+W++]=-t/2;n[X+W++]=-z/2;n[X+W++]=S;f++}const {lineVertices:l,lineDescriptors:h}=y;var g=y=0;for(var p of h)y+=2*p.numberOfVertices,g+=6*(p.numberOfVertices-1);const n=new Float32Array(9*y);p=new Uint32Array(g);let f=0;y=0;for(const M of h){const {totalTime:C,timeSeed:e}=M;let t=g=null,z=
null;var k=null,a=null,r=null;for(let G=0;G<M.numberOfVertices;G++){k=l[4*(M.startVertex+G)];const O=l[4*(M.startVertex+G)+1],S=l[4*(M.startVertex+G)+2],X=l[4*(M.startVertex+G)+3];let W=null,Y=null;var D=null;let aa=null;0<G&&(W=k-g,Y=O-t,D=Math.sqrt(W*W+Y*Y),W/=D,Y/=D,1<G?(a=W+a,r=Y+r,D=Math.sqrt(a*a+r*r),a/=D,r/=D,D=Math.min(1/(a*W+r*Y),b),a*=D,r*=D,D=-r,aa=a):(D=-Y,aa=W),null!==D&&null!==aa&&(d(g,t,z,D,aa,C,e,X),p[y++]=f-2,p[y++]=f,p[y++]=f-1,p[y++]=f,p[y++]=f+1,p[y++]=f-1));g=k;t=O;z=S;a=W;r=
Y;k=X}d(g,t,z,-r,a,C,e,k)}return{vertexData:n,indexData:p}}function v(y,b){const d=b.pixels,{width:l,height:h}=b;b=new Float32Array(l*h*2);if("vector-uv"===y)for(y=0;y<l*h;y++)b[2*y]=d[0][y],b[2*y+1]=-d[1][y];else if("vector-magdir"===y)for(y=0;y<l*h;y++){const g=d[0][y],p=w.deg2rad(d[1][y]),n=Math.sin(p-Math.PI/2);b[2*y]=Math.cos(p-Math.PI/2)*g;b[2*y+1]=n*g}return{data:b,width:l,height:h}}function F(){F=N._asyncToGenerator(function*(y,b,d,l,h,g){var p=P.getInfo(b.spatialReference);if(!p)return x(y,
b,d,l,h,g);const [n,f]=p.valid;p=Math.ceil(b.width/(f-n));const k=b.width/p,a=Math.round(d/p);let r=b.xmin;const D=[];for(let M=0;M<p;M++){const C=new K({xmin:r,xmax:r+k,ymin:b.ymin,ymax:b.ymax,spatialReference:b.spatialReference});D.push(x(y,C,a,l,h,g));r+=k}b=yield Promise.all(D);l={data:new Float32Array(d*l*2),width:d,height:l};y=0;for(const M of b){for(b=0;b<M.height;b++)for(h=0;h<M.width;h++)y+h>=d||(l.data[2*(b*d+y+h)]=M.data[2*(b*M.width+h)],l.data[2*(b*d+y+h)+1]=M.data[2*(b*M.width+h)+1]);
y+=M.width}return l});return F.apply(this,arguments)}function x(y,b,d,l,h,g){return A.apply(this,arguments)}function A(){A=N._asyncToGenerator(function*(y,b,d,l,h,g){const p={requestProjectedLocalDirections:!0,signal:g};V.isSome(h)&&(p.timeExtent=h);if("imagery"===y.type)return yield y.load({signal:g}),h=y.rasterInfo.dataType,y=yield y.fetchImage(b,d,l,p),!y||V.isNone(y.pixelData)||V.isNone(y.pixelData.pixelBlock)?{data:new Float32Array(d*l*2),width:d,height:l}:v(h,y.pixelData.pixelBlock);yield y.load({signal:g});
h=y.rasterInfo.dataType;y=yield y.fetchPixels(b,d,l,p);return!y||V.isNone(y.pixelBlock)?{data:new Float32Array(d*l*2),width:d,height:l}:v(h,y.pixelBlock)});return A.apply(this,arguments)}const B=J.getLogger("esri.views.2d.engine.flow.dataUtils");U.createAnimatedLinesData=L;U.createLinesMesh=c;U.createStreamlinesMesh=function(y,b,d){return q.apply(this,arguments)};U.fetchPart=x;U.loadImagery=function(y,b,d,l,h,g){return F.apply(this,arguments)};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterEnums":function(){define(["exports",
"../../core/jsonMap"],function(U,N){const H=N.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"});N=N.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});U.interpolationKebab=H;U.noDataInterpretationKebab=N;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),
function(U,N,H,J,w,V,T){const R=new Map;R.set("CRF",{desc:"Cloud Raster Format",constructor:H});R.set("MRF",{desc:"Meta Raster Format",constructor:V});R.set("TIFF",{desc:"GeoTIFF",constructor:T});R.set("RasterTileServer",{desc:"Raster Tile Server",constructor:w});R.set("JPG",{desc:"JPG Raster Format",constructor:J});R.set("PNG",{desc:"PNG Raster Format",constructor:J});R.set("GIF",{desc:"GIF Raster Format",constructor:J});R.set("BMP",{desc:"BMP Raster Format",constructor:J});return function(){function P(){}
P.open=function(){var K=U._asyncToGenerator(function*(q){const {url:m,ioConfig:u,sourceJSON:I}=q;let E=q.datasetFormat;null==E&&m.lastIndexOf(".")&&(E=m.slice(m.lastIndexOf(".")+1).toUpperCase());if("OVR"===E||"TIF"===E)E="TIFF";else if("JPG"===E||"JPEG"===E||"JFIF"===E)E="JPG";-1<m.toLowerCase().indexOf("/imageserver")&&-1===m.toLowerCase().indexOf("/wcsserver")&&(E="RasterTileServer");const L={bandIds:null,sampling:null},c={url:m,sourceJSON:I,datasetFormat:E,ioConfig:u||L};let v,F;if(this.supportedFormats.has(E))return v=
R.get(E).constructor,F=new v(c),yield F.open({signal:q.signal}),F;if(E)throw new N("rasterfactory:open","not a supported format "+E);const x=Array.from(R.keys());let A=0;const B=function(){E=x[A++];if(!E)return null;v=R.get(E).constructor;F=new v(c);return F.open({signal:q.signal}).then(()=>F).catch(()=>B())};return B()});return function(q){return K.apply(this,arguments)}}();P.register=function(K,q,m){R.has(K.toUpperCase())||R.set(K.toUpperCase(),{desc:q,constructor:m})};U._createClass(P,null,[{key:"supportedFormats",
get:function(){const K=new Set;R.forEach((q,m)=>K.add(m));return K}}]);return P}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x){const A=new Map;A.set("int16","esriFieldTypeSmallInteger");A.set("int32","esriFieldTypeInteger");A.set("int64","esriFieldTypeInteger");A.set("float32","esriFieldTypeSingle");A.set("float64","esriFieldTypeDouble");A.set("text","esriFieldTypeString");H=function(B){function y(){var d=B.apply(this,arguments)||this;d.storageInfo=null;d.datasetFormat="CRF";return d}U._inheritsLoose(y,B);var b=y.prototype;b.open=function(){var d=U._asyncToGenerator(function*(l){yield this.init();
({data:l}=yield this.request(this.url+"/conf.json",{signal:null==l?void 0:l.signal}));if(!this._validateHeader(l))throw new J("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:h,rasterInfo:g}=this._parseHeader(l);"thematic"===g.dataType&&(l=yield this._fetchAuxiliaryInformation(),g.attributeTable=l);this._set("storageInfo",h);this._set("rasterInfo",g);this.ioConfig.retryCount=this.ioConfig.retryCount||0});return function(l){return d.apply(this,
arguments)}}();b.fetchRawTile=function(){var d=U._asyncToGenerator(function*(l,h,g,p={}){l=this.rasterInfo.storageInfo.maximumPyramidLevel-l;if(0>l)return null;l=this._buildCacheFilePath(l,h,g,p.multidimensionalDefinition);h=this._getIndexRecordFromBundle(h,g);g=yield this.request(l,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:p.signal});if(!g)return null;g=new Uint8Array(g.data);h=this._getTileEndAndContentType(g,h);return 0===h.recordSize?null:(p=yield this.request(l,
{range:{from:h.position,to:h.position+h.recordSize},responseType:"array-buffer",signal:p.signal}))?this.decodePixelBlock(p.data,{width:this.rasterInfo.storageInfo.tileInfo.size[0],height:this.rasterInfo.storageInfo.tileInfo.size[1],planes:null,pixelType:null}):null});return function(l,h,g){return d.apply(this,arguments)}}();b._validateHeader=function(d){const l="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");return d&&
"RasterInfo"===d.type&&!l.some(h=>!d[h])};b._parseHeader=function(d){var l,h;const g="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[d.pixelType],{bandCount:p,histograms:n,colormap:f,blockWidth:k,blockHeight:a,firstPyramidLevel:r,maximumPyramidLevel:D}=d,M=d.statistics&&d.statistics.map(ba=>({min:ba.min,max:ba.max,avg:ba.mean,stddev:ba.standardDeviation,median:ba.median,mode:ba.mode}));var C=d.extent.spatialReference,e=null==(l=d.geodataXform)?void 0:l.spatialReference;l=new v(null!=C&&C.wkid||
null!=C&&C.wkt?C:e);C=new F({xmin:d.extent.xmin,ymin:d.extent.ymin,xmax:d.extent.xmax,ymax:d.extent.ymax,spatialReference:l});e=new x({x:d.pixelSizeX,y:d.pixelSizeY,spatialReference:l});const t=Math.round((C.xmax-C.xmin)/e.x),z=Math.round((C.ymax-C.ymin)/e.y),G=this._parseTransform(d.geodataXform),O=G?C:null;G&&(C=G.forwardTransform(C),e.x=(C.xmax-C.xmin)/t,e.y=(C.ymax-C.ymin)/z);const S=null!=(h=d.properties)?h:{};var X=d.format.toLowerCase().replace("cache/","");h=new x(d.origin.x,d.origin.y,l);
let W,Y;if(f&&f.colors)for(W=[],Y=0;Y<f.colors.length;Y++){var aa=f.colors[Y];var Q=f.values?f.values[Y]:Y;W.push([Q,aa&255,aa<<16>>>24,aa<<8>>>24,aa>>>24])}aa=d.LODInfos;Q=[];for(Y=0;Y<aa.levels.length;Y++)Q.push({level:aa.levels[Y],resolution:aa.resolutions[Y],scale:96/.0254*aa.resolutions[Y]});aa=new u({dpi:96,lods:Q,format:X,origin:h,size:[k,a],spatialReference:l});X={recordSize:8,packetSize:d.packetSize,headerSize:d.packetSize*d.packetSize*8+64};Q=[{maxCol:Math.ceil(t/k)-1,maxRow:Math.ceil(z/
a)-1,minCol:0,minRow:0}];let Z=2;if(0<D)for(Y=0;Y<D;Y++)Q.push({maxCol:Math.ceil(t/Z/k)-1,maxRow:Math.ceil(z/Z/a)-1,minCol:0,minRow:0}),Z*=2;d=new q({width:t,height:z,pixelType:g,bandCount:p,extent:C,nativeExtent:O,transform:G,spatialReference:l,pixelSize:e,keyProperties:S,statistics:M,histograms:n,multidimensionalInfo:d.mdInfo,colormap:W,storageInfo:new m({blockWidth:k,blockHeight:a,pyramidBlockWidth:k,pyramidBlockHeight:a,origin:h,tileInfo:aa,firstPyramidLevel:r,maximumPyramidLevel:D,blockBoundary:Q})});
return{storageInfo:X,rasterInfo:d}};b._parseTransform=function(d){var l,h;if(!L.isTransformSupported(d))throw new J("cloudraster:open","the data contains unsupported geodata transform types");d=L.readTransform(d);if("identity"===d.type)return null;if("polynomial"!==d.type||null==(l=d.forwardCoefficients)||!l.length||null==(h=d.inverseCoefficients)||!h.length)throw new J("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");
return d};b._fetchAuxiliaryInformation=function(){var d=U._asyncToGenerator(function*(l){var h=this.request(this.url+"/conf.vat.json",{signal:l}).then(p=>p.data).catch(()=>null);l=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:l}).then(p=>p.data).catch(()=>null);h=yield Promise.all([h,l]);let g;if(h[0]){l=h[0].fields;const p=h[0].values;if(l&&p){l=l.map(f=>({type:"OID"===f.name?"esriFieldTypeOID":A.get(f.type),name:f.name,alias:f.alias||f.name}));const n=p.map(f=>({attributes:f}));
l&&p&&(g={fields:l,features:n})}}!g&&h[1]&&(g=E.parse(h[1]).recordSet);return c.fromJSON(g)});return function(l){return d.apply(this,arguments)}}();b._buildCacheFilePath=function(d,l,h,g){var p=this.storageInfo.packetSize;h=Math.floor(h/p)*p;l="R"+this._toHexString4(Math.floor(l/p)*p)+"C"+this._toHexString4(h);p="L";p=10<=d?p+d.toString():p+("0"+d.toString());({multidimensionalInfo:d}=this.rasterInfo);const n=null==g?void 0:g[0];if(!w.isSome(d)||!n)return`${this.url}/_alllayers/${p}/${l}.bundle`;
g=d.variables.find(f=>f.name===n.variableName).dimensions[0].values.indexOf(n.values[0]).toString(16);d=4-g.length;for(h=0;h<d;h++)g="0"+g;return`${this.url}/_alllayers/${n.variableName}/${"S"+g}/${p}/${l}.bundle`};b._getIndexRecordFromBundle=function(d,l){const h=this.storageInfo.packetSize;d=d%h*h+l%h;if(0>d)throw"Invalid level / row / col";return d*this.storageInfo.recordSize+64};b._getTileEndAndContentType=function(d,l){d=d.subarray(l,l+8);l=0;let h;for(h=0;5>h;h++)l|=(d[h]&255)<<8*h;const g=
l&0xffffffffff;l=0;for(h=5;8>h;h++)l|=(d[h]&255)<<8*(h-5);return{position:g,recordSize:l&0xffffffffff}};b._toHexString4=function(d){d=d.toString(16);if(4!==d.length){let l=4-d.length;for(;0<l--;)d="0"+d}return d};return y}(I);N.__decorate([V.property({readOnly:!0})],H.prototype,"storageInfo",void 0);N.__decorate([V.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=N.__decorate([K.subclass("esri.layers.support.rasterDatasets.CloudRaster")],H)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../RasterStorageInfo ../TileInfo ./RawBlockCache ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B,y,b,d,l){H=function(h){function g(){var n=h.apply(this,arguments)||this;n.rasterJobHandler=null;n.datasetName=null;n.datasetFormat=null;n.rasterInfo=null;n.ioConfig={sampling:"closest"};return n}U._inheritsLoose(g,h);var p=g.prototype;p.init=function(){var n=U._asyncToGenerator(function*(){const f=y.load();this.addResolvingPromise(f);yield this.when()});return function(){return n.apply(this,arguments)}}();p.normalizeCtorArgs=function(n){n&&n.ioConfig&&
(n={...n,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:F.create(),...n.ioConfig}});return n};p.open=function(){var n=U._asyncToGenerator(function*(f){throw new w("BaseRaster:open-not-implemented","open() is not implemented");});return function(f){return n.apply(this,arguments)}}();p.fetchTile=function(){var n=U._asyncToGenerator(function*(f,k,a,r={}){const D=r.tileInfo||this.rasterInfo.storageInfo.tileInfo;f=this.getTileExtentFromTileInfo(f,k,a,D);return this.fetchPixels(f,D.size[0],
D.size[1],r)});return function(f,k,a){return n.apply(this,arguments)}}();p.identify=function(){var n=U._asyncToGenerator(function*(f,k={}){k=this._getRequestOptionsWithSliceId(k);const {spatialReference:a,extent:r}=this.rasterInfo;var {datumTransformation:D}=k;D=y.projectPoint(f,a,D);if(!r.intersects(D)||R.isSome(this.rasterInfo.transform)&&(D=this.rasterInfo.transform.inverseTransform(D),!this.rasterInfo.nativeExtent.intersects(D)))return{location:D,value:null};let M=0;if(k.srcResolution)M=y.snapPyramid(k.srcResolution,
this.rasterInfo,this.ioConfig.sampling).pyramidLevel;else if(M=yield this.computeBestPyramidLevelForLocation(f,k),null==M)return{location:D,value:null};f=this.identifyPixelLocation(D,M,null);if(null===f)return{location:D,value:null};const {row:C,col:e,rowOffset:t,colOffset:z}=f;f=x.getRasterId(this.url,k.sliceId);const G=`${M}/${C}/${e}`;let O=x.getBlock(f,null,G);R.isNone(O)&&(O=this.fetchRawTile(M,C,e,k),x.putBlock(f,null,G,O));k=yield O;if(R.isNone(k)||!k.pixels||0===k.pixels.length)return{location:D,
value:null};const S=t*this.rasterInfo.storageInfo.blockHeight+z;k=!k.mask||k.mask[S]?k.pixels.map(X=>X[S]):null;f=this.rasterInfo.dataType;return("vector-magdir"===f||"vector-uv"===f)&&1<(null==k?void 0:k.length)?(f="vector-magdir"===f?[k[0],k[1]]:b.uvComponentToVector([k[0],k[1]]),{location:D,value:k,magdirValue:f,pyramidLevel:M}):{location:D,value:k,pyramidLevel:M}});return function(f){return n.apply(this,arguments)}}();p.fetchPixels=function(){var n=U._asyncToGenerator(function*(f,k,a,r={}){f=
y.snapExtent(f);r=this._getRequestOptionsWithSliceId(r);if(r.requestRawData)return this._fetchPixels(f,k,a,r);var D=y.getWorldWidth(f.spatialReference),M=y.getWorldWrapCount(f);if(R.isNone(D)||0===M||1===M&&this._isGlobalWrappableSource)return this._fetchPixels(f,k,a,r);if(3<=M)return{extent:f,pixelBlock:null};const C=[],{xmin:e,xmax:t}=f,z=Math.round(D/(t-e)*k),G=z-Math.round((D/2-e)/(t-e)*k);let O=0;const S=[];for(let W=0;W<=M;W++){var X=new l({xmin:0===W?e:-D/2,xmax:W===M?t-D*W:D/2,ymin:f.ymin,
ymax:f.ymax,spatialReference:f.spatialReference});const Y=0===W?z-G:W===M?k-O:z;O+=Y;S.push(Y);X=r.disableWrapAround&&0<W?null:this._fetchPixels(X,Y,a,r);C.push(X)}D=(yield Promise.all(C)).map(W=>null==W?void 0:W.pixelBlock);M=null;k={width:k,height:a};M=this.rasterJobHandler?(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:D,srcMosaicSize:k,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:S},r)).pixelBlock:B.mosaic(D,k,{blockWidths:S});
r=y.projectExtent(f,this.rasterInfo.spatialReference,r.datumTransformation);return{extent:f,srcExtent:r,pixelBlock:M}});return function(f,k,a){return n.apply(this,arguments)}}();p.fetchRawPixels=function(){var n=U._asyncToGenerator(function*(f,k,a,r={}){k={x:Math.floor(k.x),y:Math.floor(k.y)};const D=yield this._fetchRawTiles(f,k,a,r),{nativeExtent:M,nativePixelSize:C,storageInfo:e}=this.rasterInfo;var t=2**f,z=C.x*t;t*=C.y;z=new l({xmin:M.xmin+z*k.x,xmax:M.xmin+z*(k.x+a.width-1),ymin:M.ymax-t*(k.y+
a.height-1),ymax:M.ymax-t*k.y,spatialReference:M.spatialReference});if(!D)return{extent:z,srcExtent:z,pixelBlock:null};const {pixelBlocks:G,mosaicSize:O}=D;if(1===G.length&&R.isSome(G[0])&&G[0].width===a.width&&G[0].height===a.height)return{extent:z,srcExtent:z,pixelBlock:D.pixelBlocks[0]};f={x:k.x%(0<f?e.pyramidBlockWidth:e.blockWidth),y:k.y%(0<f?e.pyramidBlockHeight:e.blockHeight)};a=this.rasterJobHandler?(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:G,srcMosaicSize:O,destDimension:a,
clipOffset:f,clipSize:a,coefs:null,sampleSpacing:null,interpolation:r.interpolation,alignmentInfo:null,blockWidths:null},r)).pixelBlock:B.mosaic(G,O,{clipOffset:f,clipSize:a});return{extent:z,srcExtent:z,pixelBlock:a}});return function(f,k,a){return n.apply(this,arguments)}}();p.fetchRawTile=function(n,f,k,a){throw new w("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");};p.computeExtent=function(n){return y.projectExtent(this.rasterInfo.extent,n)};p.decodePixelBlock=function(n,
f){return!this.rasterJobHandler||f.useCanvas?A.decode(n,f):this.rasterJobHandler.decode({data:n,options:f})};p.request=function(){var n=U._asyncToGenerator(function*(f,k,a){var r,D;const {customFetchParameters:M}=this.ioConfig,{range:C,query:e,headers:t}=k;a=null!=(r=null!=(D=a)?D:k.retryCount)?r:this.ioConfig.retryCount;r=C?{Range:`bytes=${C.from}-${C.to}`}:null;try{return yield J(f,{...k,query:{...e,...M},headers:{...t,...r}})}catch(z){if(0<a)return a--,this.request(f,k,a);throw z;}});return function(f,
k,a){return n.apply(this,arguments)}}();p.getSliceIndex=function(n){const {multidimensionalInfo:f}=this.rasterInfo;if(!R.isSome(f)||!R.isSome(n)||0===n.length)return null;let k=0;const a=n[0].variableName;for(let M=0;M<f.variables.length;M++){var r=f.variables[M];const C=r.dimensions;if(r.name!==a){k+=C.map(t=>this._getDimensionValuesCount(t)).reduce((t,z)=>t+z);break}r=C.map(t=>this._getDimensionValuesCount(t));const e=C.length;for(let t=0;t<e;t++){var D=n.find(z=>z.dimensionName===C[t].name);if(null==
D)return null;D=Array.isArray(D.values[0])?D.values[0][0]:D.values[0];D=this._getIndexFromDimensions(D,C[t]);if(-1===D)return null;r.shift();k=t===e-1?k+D:k+D*r.reduce((z,G)=>z+G)}}return k};p.getTileExtentFromTileInfo=function(n,f,k,a){n=a.lodAt(n);return this.getTileExtent({x:n.resolution,y:n.resolution},f,k,a.origin,a.spatialReference,a.size)};p.updateTileInfo=function(){const {storageInfo:n,spatialReference:f,extent:k,pixelSize:a}=this.rasterInfo;if(!n.tileInfo){const D=[];var r=n.maximumPyramidLevel||
0;let M=Math.max(a.x,a.y),C=1/.0254*96*M;for(let e=0;e<=r;e++)D.push({level:r-e,resolution:M,scale:C}),M*=2,C*=2;r=new d({x:k.xmin,y:k.ymax,spatialReference:f});n.tileInfo=new F({origin:r,size:[n.blockWidth,n.blockHeight],spatialReference:f,lods:D});n.isVirtualTileInfo=!0}};p.createRemoteDatasetStorageInfo=function(n,f=512,k=512,a){const {width:r,height:D,nativeExtent:M,pixelSize:C,spatialReference:e}=n,t=new d({x:M.xmin,y:M.ymax,spatialReference:e});null==a&&(a=Math.max(0,Math.round(Math.log(Math.max(r,
D))/Math.LN2-8)));const z=this.computeBlockBoundary(M,512,512,{x:M.xmin,y:M.ymax},[C],a);n.storageInfo=new v({blockWidth:f,blockHeight:k,pyramidBlockWidth:f,pyramidBlockHeight:k,origin:t,firstPyramidLevel:1,maximumPyramidLevel:a,blockBoundary:z})};p.computeBestPyramidLevelForLocation=function(){var n=U._asyncToGenerator(function*(f,k){return 0});return function(f){return n.apply(this,arguments)}}();p.computeBlockBoundary=function(n,f,k,a,r,D=0,M=2){if(1===r.length&&0<D){r=[...r];let {x:t,y:z}=r[0];
for(let G=0;G<D;G++)t*=M,z*=M,r.push({x:t,y:z})}D=[];const {x:C,y:e}=a;for(a=0;a<r.length;a++){const {x:t,y:z}=r[a];D.push({minCol:Math.floor((n.xmin-C+.1*t)/f/t),maxCol:Math.floor((n.xmax-C-.1*t)/f/t),minRow:Math.floor((e-n.ymax+.1*z)/k/z),maxRow:Math.floor((e-n.ymin-.1*z)/k/z)})}return D};p.getPyramidPixelSize=function(n){const {nativePixelSize:f}=this.rasterInfo,{pyramidResolutions:k,pyramidScalingFactor:a}=this.rasterInfo.storageInfo;if(0===n)return f;if(R.isSome(k)&&k.length)return k[n-1];n=
a**n;return{x:f.x*n,y:f.y*n}};p.identifyPixelLocation=function(n,f,k){const {spatialReference:a,nativeExtent:r}=this.rasterInfo,{blockWidth:D,blockHeight:M,maximumPyramidLevel:C,origin:e}=this.rasterInfo.storageInfo;n=y.projectPoint(n,a,k);if(!r.intersects(n)||0>f||f>C)return null;k=this.getPyramidPixelSize(f);const {x:t,y:z}=k;k=(e.y-n.y)/z/M;const G=(n.x-e.x)/t/D;return{pyramidLevel:f,row:Math.floor(k),col:Math.floor(G),rowOffset:Math.min(M-1,Math.floor((k-Math.floor(k))*M)),colOffset:Math.min(D-
1,Math.floor((G-Math.floor(G))*D)),srcLocation:n}};p.getTileExtent=function(n,f,k,a,r,D){const [M,C]=D;k=a.x+k*M*n.x;f=a.y-f*C*n.y;return new l({xmin:k,xmax:k+M*n.x,ymin:f-C*n.y,ymax:f,spatialReference:r})};p.getBlockWidthHeight=function(n){return{blockWidth:0<n?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<n?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}};p.isBlockOutside=function(n,f,k){n=this.rasterInfo.storageInfo.blockBoundary[n];
return!n||n.maxRow<f||n.maxCol<k||n.minRow>f||n.minCol>k};p._fetchPixels=function(){var n=U._asyncToGenerator(function*(f,k,a,r={}){var D=y.getWorldWrapCount(f);if(2<=D)return{extent:f,pixelBlock:null};var M=this._getSourceDataInfo(f,k,a,r);const {pyramidLevel:C,pyramidResolution:e,srcResolution:t,srcExtent:z,srcWidth:G,srcHeight:O}=M;if(0===G||0===O)return{extent:f,srcExtent:z,pixelBlock:null};var S=R.unwrap(this.rasterInfo.transform),X="gcs-shift"===(null==S?void 0:S.type),W=R.isSome(y.getWorldWidth(f.spatialReference));
if(X||!W)D=y.getWorldWrapCount(M.srcExtent,X);var Y=this.rasterInfo.storageInfo,aa={x:Math.floor((z.xmin-Y.origin.x)/e.x+.1),y:Math.floor((Y.origin.y-z.ymax)/e.y+.1)};M=yield this._fetchRawTiles(C,aa,{width:G,height:O,wrapCount:D},r);if(!M)return{extent:f,srcExtent:z,pixelBlock:null};X=0<C?Y.pyramidBlockWidth:Y.blockWidth;const Q=0<C?Y.pyramidBlockHeight:Y.blockHeight,Z=X===G&&Q===O&&0===aa.x%X&&0===aa.y%Q;aa=new d({x:(f.xmax-f.xmin)/k,y:(f.ymax-f.ymin)/a,spatialReference:f.spatialReference});const ba=
!f.spatialReference.equals(this.rasterInfo.spatialReference);({datumTransformation:Y}=r);if(!ba&&Z&&1===M.pixelBlocks.length&&X===k&&Q===a&&t.x===aa.x&&t.y===aa.y)return{extent:f,srcExtent:z,pixelBlock:M.pixelBlocks[0]};X=W&&R.isSome(y.getWorldWidth(z.spatialReference));(W=r.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&(yield y.load());D=this.rasterJobHandler?yield this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:f,srcBufferExtent:M.extent,
pixelSize:aa.toJSON(),datumTransformation:Y,rasterTransform:S,hasWrapAround:0<D||X,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:W},r):y.getProjectionOffsetGrid({projectedExtent:f,srcBufferExtent:M.extent,pixelSize:aa,datumTransformation:Y,rasterTransform:S,hasWrapAround:0<D||X,isAdaptive:!1,includeGCSGrid:W});S=!r.requestRawData;X={rows:D.spacing[0],cols:D.spacing[1]};aa=R.unwrap(this._getRasterTileAlignmentInfo(C,M.extent.xmin));const {pixelBlocks:ca,mosaicSize:da,isPartiallyFilled:ea}=
M;M=null;this.rasterJobHandler?(k=yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:ca,srcMosaicSize:da,destDimension:S?{width:k,height:a}:null,coefs:S?D.coefficients:null,sampleSpacing:S?X:null,projectDirections:W,gcsGrid:W?D.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:r.interpolation,alignmentInfo:aa,blockWidths:null},r),{pixelBlock:S,localNorthDirections:M}=k):(aa=B.mosaic(ca,da,{alignmentInfo:aa}),S=S?B.approximateTransform(aa,{width:k,height:a},D.coefficients,
X,r.interpolation):aa,W&&D.gcsGrid&&(M=B.getLocalArithmeticNorthRotations({width:k,height:a},D.gcsGrid),S=b.convertToLocalDirections(S,this.rasterInfo.dataType,M)));return r.requestRawData||W?{srcExtent:z,pixelBlock:S,transformGrid:D,localNorthDirections:M,extent:f,isPartiallyFilled:ea}:{srcExtent:z,extent:f,pixelBlock:S}});return function(f,k,a){return n.apply(this,arguments)}}();p._fetchRawTiles=function(){var n=U._asyncToGenerator(function*(f,k,a,r){const {origin:D,blockBoundary:M}=this.rasterInfo.storageInfo,
{blockWidth:C,blockHeight:e}=this.getBlockWidthHeight(f);let {x:t,y:z}=k,{width:G,height:O,wrapCount:S}=a;var X=this._getRasterTileAlignmentInfo(f,0);r.buffer&&(t-=r.buffer.cols,z-=r.buffer.rows,G+=2*r.buffer.cols,O+=2*r.buffer.rows);var W=0,Y=0;let aa=0;S&&R.isSome(X)&&({worldColumnCountFromOrigin:Y,originColumnOffset:aa,rightPadding:W}=X,Y*X.blockWidth-W>=t+G&&(W=0));k=Math.floor(t/C);a=Math.floor(z/e);const Q=Math.floor((t+G+W-1)/C);W=Math.floor((z+O+W-1)/e);var Z=M[f];if(!Z)return null;const {minRow:ba,
minCol:ca,maxCol:da,maxRow:ea}=Z;if(0===S&&(W<ba||Q<ca||a>ea||k>da))return null;Z=[];let fa=!1;const ia=null==this.ioConfig.allowPartialFill?r.allowPartialFill:this.ioConfig.allowPartialFill;for(let ja=a;ja<=W;ja++)for(let ka=k;ka<=Q;ka++){let pa=ka;!r.disableWrapAround&&S&&R.isSome(X)&&Y<=ka&&(pa=ka-Y-aa);if(ja>=ba&&pa>=ca&&ea>=ja&&da>=pa){const na=this._fetchRawTile(f,ja,pa,r);ia?Z.push(new Promise(ma=>{na.then(oa=>ma(oa)).catch(()=>{fa=!0;ma(null)})})):Z.push(na)}else Z.push(null)}if(0===Z.length)return null;
r=yield Promise.all(Z);X={height:(W-a+1)*e,width:(Q-k+1)*C};({spatialReference:Y}=this.rasterInfo);f=this.getPyramidPixelSize(f);const {x:ha,y:la}=f;return{extent:new l({xmin:D.x+k*C*ha,xmax:D.x+(Q+1)*C*ha,ymin:D.y-(W+1)*e*la,ymax:D.y-a*e*la,spatialReference:Y}),pixelBlocks:r,mosaicSize:X,isPartiallyFilled:fa}});return function(f,k,a,r){return n.apply(this,arguments)}}();p._fetchRawTile=function(n,f,k,a){var r=this.rasterInfo.storageInfo.blockBoundary[n];if(!r)return Promise.resolve(null);const {minRow:D,
minCol:M,maxCol:C,maxRow:e}=r;if(f<D||k<M||f>e||k>C)return Promise.resolve(null);const t=x.getRasterId(this.url,a.sliceId),z=`${n}/${f}/${k}`;r=x.getBlock(t,a.registryId,z);if(R.isNone(r)){const G=new AbortController;r=this.fetchRawTile(n,f,k,{...a,signal:G.signal});x.putBlock(t,a.registryId,z,r,G);r.catch(()=>x.deleteBlock(t,a.registryId,z))}if(a.signal)K.onAbort(a,()=>{x.decreaseRefCount(t,a.registryId,z)});return r};p._getIndexFromDimensions=function(n,f){const {extent:k,interval:a,unit:r,values:D}=
f;if(null!=D&&D.length)return Array.isArray(D[0])?D.findIndex(t=>t[0]<=n&&t[1]>=n):D.indexOf(n);if(n>k[1])return-1;const M=k[0];let C=-1;if("ISO8601"===r){var e;switch((null==(e=f.intervalUnit)?void 0:e.toLowerCase())||"seconds"){case "seconds":C=Math.round((n-M)/1E3/a);break;case "minutes":C=Math.round((n-M)/6E4/a);break;case "hours":C=Math.round((n-M)/36E5/a);break;case "days":C=Math.round((n-M)/864E5/a);break;case "years":C=Math.round(((new Date(n)).getUTCFullYear()-(new Date(M)).getUTCFullYear())/
a);break;case "decades":C=Math.round(((new Date(n)).getUTCFullYear()-(new Date(M)).getUTCFullYear())/10/a)}return C}return Math.round((n-M)/a)};p._getDimensionValuesCount=function(n){const {extent:f,interval:k,unit:a,values:r}=n;let D=(null==r?void 0:r.length)||0;if(D)return D;const M=f[0];if(0===D&&"ISO8601"===a){var C;switch((null==(C=n.intervalUnit)?void 0:C.toLowerCase())||"seconds"){case "seconds":D=Math.round((f[1]-f[0])/1E3/k);break;case "minutes":D=Math.round((f[1]-f[0])/6E4/k);break;case "hours":D=
Math.round((f[1]-f[0])/36E5/k);break;case "days":D=Math.round((f[1]-f[0])/864E5/k);break;case "years":D=Math.round(((new Date(f[1])).getUTCFullYear()-(new Date(M)).getUTCFullYear())/k);break;case "decades":D=Math.round(((new Date(f[1])).getUTCFullYear()-(new Date(M)).getUTCFullYear())/10/k)}return D}return Math.round((f[1]-f[0])/k)};p._getRasterTileAlignmentInfo=function(n,f){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=y.getRasterDatasetAlignmentInfo(this.rasterInfo));return R.isSome(this._rasterTileAlighmentInfo.pyramidsInfo)?
{startX:f,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[n]}:null};p._getSourceDataInfo=function(n,f,k,a={}){const r={datumTransformation:a.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0};a.srcResolution&&(r.srcResolution=a.srcResolution,this._updateSourceDataInfo(n,r));var D=this.rasterInfo.storageInfo.maximumPyramidLevel||
0;const {srcWidth:M,srcHeight:C,pyramidLevel:e}=r;var t=M/f;const z=C/k,G=e<D&&16<=t*z;if(G||e===D&&(8<t||8<z)||0===M||0===C){var O=new d({x:(n.xmax-n.xmin)/f,y:(n.ymax-n.ymin)/k,spatialReference:n.spatialReference});O=y.projectResolution(O,this.rasterInfo.spatialReference,n,r.datumTransformation);const S=!O||a.srcResolution&&O.x+O.y<a.srcResolution.x+a.srcResolution.y;G&&a.srcResolution&&S&&(t=Math.round(Math.log(Math.max(t,z))/Math.LN2)-1,D-e+3>=t&&(D=2**t,O={x:a.srcResolution.x*D,y:a.srcResolution.y*
D}));O&&(r.srcResolution=O,this._updateSourceDataInfo(n,r))}if(8<r.srcWidth/f||8<r.srcHeight/k)r.srcWidth=0,r.srcHeight=0;return r};p._updateSourceDataInfo=function(n,f){f.srcWidth=0;f.srcHeight=0;var k=this.rasterInfo.spatialReference;const {srcResolution:a,datumTransformation:r}=f,{pyramidLevel:D,pyramidResolution:M,excessiveReading:C}=y.snapPyramid(a,this.rasterInfo,this.ioConfig.sampling);C||(n=f.srcExtent||y.projectExtent(n,k,r),null!=n&&((k=R.unwrap(this.rasterInfo.transform))&&(n=k.inverseTransform(n)),
f.srcExtent=n,k=Math.ceil((n.xmax-n.xmin)/M.x-.1),n=Math.ceil((n.ymax-n.ymin)/M.y-.1),f.pyramidLevel=D,f.pyramidResolution=M,f.srcWidth=k,f.srcHeight=n))};p._getRequestOptionsWithSliceId=function(n){R.isSome(this.rasterInfo.multidimensionalInfo)&&null==n.sliceId&&(n={...n,sliceId:this.getSliceIndex(n.multidimensionalDefinition)});return n};U._createClass(g,[{key:"_isGlobalWrappableSource",get:function(){const {rasterInfo:n}=this,f=y.getWorldWidth(n.spatialReference);return R.isSome(f)&&n.extent.width>=
f/2}},{key:"url",set:function(n){this._set("url",L.sanitizeUrl(n,T.getLogger(this.declaredClass)))}}]);return g}(P.EsriPromiseMixin(V.JSONSupport));N.__decorate([q.property()],H.prototype,"_rasterTileAlighmentInfo",void 0);N.__decorate([q.property({readOnly:!0})],H.prototype,"_isGlobalWrappableSource",null);N.__decorate([q.property(c.url)],H.prototype,"url",null);N.__decorate([q.property({type:String,json:{write:!0}})],H.prototype,"datasetName",void 0);N.__decorate([q.property({type:String,json:{write:!0}})],
H.prototype,"datasetFormat",void 0);N.__decorate([q.property()],H.prototype,"rasterInfo",void 0);N.__decorate([q.property()],H.prototype,"ioConfig",void 0);N.__decorate([q.property()],H.prototype,"sourceJSON",void 0);return H=N.__decorate([E.subclass("esri.layers.support.rasterDatasets.BaseRaster")],H)})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define("exports ../../../geometry ../../../core/maybe ./EphemeralBlockCache ../rasterFunctions/rasterProjectionHelper ../../../geometry/Point".split(" "),
function(U,N,H,J,w,V){function T(K,q){if(!R.has(K))return null;K=R.get(K);return null==K[q]?null:K[q]}const R=new Map,P=new J;U.decreaseRefCount=function(K,q,m){if(!R.has(K))return null==q?P.decreaseRefCount(K,m):0;const u=R.get(K);if(null==u[q])return P.decreaseRefCount(K,m);q=u[q].cache;if(q.has(m)){K=q.get(m);K.refCount--;if(0===K.refCount){q.delete(m);for(q=0;q<u.length;q++)u[q]&&u[q].cache.has(m)&&u[q].cache.delete(m);K.controller&&K.controller.abort()}return K.refCount}return 0};U.deleteBlock=
function(K,q,m){if(R.has(K)){var u=R.get(K);null==u[q]?P.deleteBlock(K,m):u[q].cache.delete(m)}else null==q&&P.deleteBlock(K,m)};U.deleteRaster=function(K){R.delete(K)};U.getBlock=function(K,q,m){if(!R.has(K))return null==q?P.getBlock(K,m):null;var u=R.get(K);if(null==u[q]){for(q=0;q<u.length;q++)if(u[q]&&u[q].cache.has(m))return m=u[q].cache.get(m),m.refCount++,m.block;return P.getBlock(K,m)}K=u[q].cache;if(K.has(m))return m=K.get(m),m.refCount++,m.block;for(let I=0;I<u.length;I++)if(I!==q&&u[I]&&
u[I]&&u[I].cache.has(m))return u=u[I].cache.get(m),u.refCount++,K.set(m,u),u.block;return null};U.getRasterId=function(K,q){return null==q?K:`${K}?sliceId=${q}`};U.putBlock=function(K,q,m,u,I=null){if(R.has(K)){var E=R.get(K);if(null==E[q])P.putBlock(K,m,u,I);else{var L={refCount:1,block:u,isResolved:!1,isRejected:!1,controller:I};u.then(()=>L.isResolved=!0).catch(()=>L.isRejected=!0);E[q].cache.set(m,L)}}else null==q&&P.putBlock(K,m,u,I)};U.register=function(K,q){q={extent:null,rasterInfo:q,cache:new Map};
if(R.has(K))return K=R.get(K),K.push(q),K.length-1;R.set(K,[q]);return 0};U.unregister=function(K,q){if(R.has(K)){const m=R.get(K);m[q]=null;m.some(u=>null!=u)||R.delete(K)}};U.update=function(K,q,m,u,I,E,L=null){K=T(K,q);q=K.extent;const {cache:c,rasterInfo:v}=K;if(!q||q.xmin!==m.xmin||q.xmax!==m.xmax||q.ymin!==m.ymin||q.ymax!==m.ymax){q=m.clone().normalize();var {spatialReference:F,transform:x}=v,A=new Set;for(let h=0;h<q.length;h++){var B=q[h];if(B.xmax-B.xmin<=u||B.ymax-B.ymin<=u)continue;var y=
w.projectExtent(B,F,L);H.isSome(x)&&(y=x.inverseTransform(y));var b=new V({x:u,y:u,spatialReference:B.spatialReference});if(null==I&&(I=w.projectResolution(b,F,B,L),!I))return;const {pyramidLevel:g,pyramidResolution:p,excessiveReading:n}=w.snapPyramid(I,v,E||"closest");if(n)return;({storageInfo:B}=v);var {origin:d}=B;b=Math.max(0,Math.floor((y.xmin-d.x)/p.x));d=Math.max(0,Math.floor((d.y-y.ymax)/p.y));const f=0<g?B.pyramidBlockWidth:B.blockWidth,k=0<g?B.pyramidBlockHeight:B.blockHeight;B=Math.max(0,
Math.floor(b/f)-1);var l=Math.max(0,Math.floor(d/k)-1);b=Math.floor((b+Math.ceil((y.xmax-y.xmin)/p.x-.1)-1)/f)+1;y=Math.floor((d+Math.ceil((y.ymax-y.ymin)/p.y-.1)-1)/k)+1;for(d=l;d<=y;d++)for(l=B;l<=b;l++)A.add(`${g}/${d}/${l}`)}c.forEach((h,g)=>{A.has(g)||(h=c.get(g),(null==h||h.isResolved||h.isRejected)&&c.delete(g))});K.extent={xmin:m.xmin,ymin:m.ymin,xmax:m.xmax,ymax:m.ymax}}};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(function(){return function(){function U(H=
15E3,J=5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=H;this._interval=Math.min(H,J)}var N=U.prototype;N.decreaseRefCount=function(H,J){H=H+"/"+J;J=this._cachedBlocks;if(J.has(H)){const w=J.get(H);w.refCount--;0>=w.refCount&&(J.delete(H),w.controller&&w.controller.abort());return w.refCount}return 0};N.getBlock=function(H,J){H=H+"/"+J;J=this._cachedBlocks;if(J.has(H)){const w=J.get(H);w.ts=Date.now();w.refCount++;J.delete(H);J.set(H,w);return w.block}return null};N.putBlock=
function(H,J,w,V=null){const T=this._cachedBlocks;H=H+"/"+J;T.has(H)?(w=T.get(H),w.ts=Date.now(),w.refCount++):T.set(H,{block:w,ts:Date.now(),refCount:1,controller:V});this._trim();this._updateTimer()};N.deleteBlock=function(H,J){const w=this._cachedBlocks;H=H+"/"+J;w.has(H)&&w.delete(H)};N.updateMaxSize=function(H){this._size=H;this._trim()};N.empty=function(){this._cachedBlocks.clear();this._clearTimer()};N.getCurrentSize=function(){return this._cachedBlocks.size};N._updateTimer=function(){if(null==
this._timer){var H=this._cachedBlocks;this._timer=setInterval(()=>{const J=Array.from(H),w=Date.now();for(let V=0;V<J.length;V++)if(J[V][1].ts<=w-this._duration)H.delete(J[V][0]);else break;0===H.size&&this._clearTimer()},this._interval)}};N._trim=function(){const H=this._cachedBlocks;if(!(-1===this._size||this._size>=H.size)){var J=Array.from(H);for(let w=0;w<J.length-this._size;w++)H.delete(J[w][0])}};N._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return U}()})},
"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/SpatialReference".split(" "),function(U,N,H,J,w,V,T,R,P,K,q){function m(e,t,z){return!R.canProjectWithoutEngine(e,t,z)}function u(e,t,z){if((e=m(e,t,z))&&!R.isLoaded())throw new J("rasterprojectionhelper-project",
"projection engine is not loaded");return e}function I(){I=N._asyncToGenerator(function*(){if(R.isLoaded())return null;yield R.load()});return I.apply(this,arguments)}function E(e,t,z,G=null){const O=e.spatialReference;if(O.equals(t))return e;u(O,t,G);z=z.center;z=new P({xmin:z.x-e.x/2,xmax:z.x+e.x/2,ymin:z.y-e.y/2,ymax:z.y+e.y/2,spatialReference:O});G=R.project(z,t,G);if(w.isNone(G))return null;G={x:G.xmax-G.xmin,y:G.ymax-G.ymin};z=g(t);w.isSome(z)&&G.x>=z&&(t=V.getMetersPerUnitForSR(O)/V.getMetersPerUnitForSR(t),
G.x=e.x*t,G.y=e.y*t);return G}function L(e,t=.01){return V.getMetersPerUnitForSR(e)?t/V.getMetersPerUnitForSR(e):0}function c(e,t,z=null,G=!0){var O=e.spatialReference;if(O.equals(t))return e;u(O,t,z);z=R.project(e,t,z);if(!G||!z)return z;G=p(O,!0);t=p(t,!0);(O=L(O))&&w.isSome(G)&&w.isSome(t)&&(0<z.x&&Math.abs(e.x-G[0])<O?z.x-=t[1]-t[0]:0>z.x&&Math.abs(e.x-G[1])<O&&(z.x+=t[1]-t[0]));return z}function v(e){const {inSR:t,outSR:z,datumTransformation:G,preferPE:O}=e;if(t.equals(z))return{points:e}=y(e,
null),e;if(t.isWebMercator&&z.isWGS84||t.isWGS84&&z.isWebMercator){{const {cols:aa,rows:Q,xres:Z,yres:ba,usePixelCenter:ca,inSR:da,outSR:ea}=e;let {xmin:fa,ymax:ia}=e;ca&&(fa+=Z/2,ia-=ba/2);e=[];var S=[],X=Math.max(aa,Q);for(var W=0;W<X;W++){var Y=R.project(new K({x:fa+Z*Math.min(aa,W),y:ia-ba*Math.min(Q,W),spatialReference:da}),ea);W<=aa&&e.push(Y.x);W<=Q&&S.push(Y.y)}X=[];for(W=0;W<aa;W++)for(Y=0;Y<Q;Y++)X.push([e[W],S[Y]]);e=X}return e}if(u(t,z,G)&&O){if(t.isGeographic)return x(e);S=A(t);if(w.isSome(S))return x(e)}return F(e)}
function F(e){var {points:t}=y(e,null);t=t.map(z=>new K(z[0],z[1],e.inSR));return R.project(t,e.outSR,e.datumTransformation).map(z=>z?[z.x,z.y]:[NaN,NaN])}function x(e){const {inSR:t,outSR:z,datumTransformation:G}=e,O=A(t),{points:S,mask:X}=y(e,O);t.isGeographic||(e=t.wkid?T.PeFactory.coordsys(t.wkid):T.PeFactory.fromString(t.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,t.wkt),T.PeCSTransformations.projToGeog(e,S.length,S));w.isSome(G)&&G.steps.length&&G.steps.forEach(W=>{const Y=
W.wkid?T.PeFactory.geogtran(W.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_GEOGTRAN,W.wkt);T.PeGTTransformations.geogToGeog(Y,S.length,S,null,W.isInverse?T.PeDefs.PE_TRANSFORM_2_TO_1:T.PeDefs.PE_TRANSFORM_1_TO_2)});z.isGeographic||(e=A(z,!0),e=w.isSome(e)&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90],b(S,e),e=z.wkid?T.PeFactory.coordsys(z.wkid):T.PeFactory.fromString(z.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,z.wkt),T.PeCSTransformations.geogToProj(e,S.length,S));e=S;if(X&&S.length!==
X.length){e=[];for(let W=0,Y=0;W<X.length;W++)X[W]?e.push(S[Y++]):e.push([NaN,NaN])}return e}function A(e,t=!1){var z=e.wkid||e.wkt;if(!z||e.isGeographic)return null;z=String(z);if(M.has(z))return z=M.get(z),t?null==z?void 0:z.gcs:null==z?void 0:z.pcs;var G=e.wkid?T.PeFactory.coordsys(e.wkid):T.PeFactory.fromString(e.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,e.wkt);e=L(e,1E-4);e=B(G,e);G=B(G,0,!0);M.set(z,{pcs:e,gcs:G});return t?G:e}function B(e,t=0,z=!1){var G=T.PePCSInfo.generate(e),
O=z?e.horizonGcsGenerate():e.horizonPcsGenerate();if(null==O||!O.length)return null;z=!1;e=O.find(aa=>1===aa.getInclusive()&&1===aa.getKind());if(!e){e=O.find(aa=>1===aa.getInclusive()&&0===aa.getKind());if(!e)return null;z=!0}G=G.isPannableRectangle();e=e.getCoord();if(z)return{isEnvelope:z,isPannable:G,vertices:e,coef:null,bbox:[e[0][0]-t,e[0][1]-t,e[1][0]+t,e[1][1]+t]};t=0;z=[];let [S,X]=e[0],[W,Y]=e[0];for(let aa=0,Q=e.length;aa<Q;aa++){t++;t===Q&&(t=0);const [Z,ba]=e[aa],[ca,da]=e[t];if(da===
ba)z.push([Z,ca,ba,da,2]);else{O=(ca-Z)/(da-ba||1E-4);const ea=Z-O*ba;ba<da?z.push([O,ea,ba,da,0]):z.push([O,ea,da,ba,1])}S=S<Z?S:Z;X=X<ba?X:ba;W=W>Z?W:Z;Y=Y>ba?Y:ba}return{isEnvelope:!1,isPannable:G,vertices:e,coef:z,bbox:[S,X,W,Y]}}function y(e,t){const z=[],{cols:G,rows:O,xres:S,yres:X,usePixelCenter:W}=e;let {xmin:Y,ymax:aa}=e;W&&(Y+=S/2,aa-=X/2);if(!w.isSome(t)){for(e=0;e<G;e++)for(t=0;t<O;t++)z.push([Y+S*e,aa-X*t]);return{points:z}}e=new Uint8Array(G*O);if(t.isEnvelope){const {bbox:[fa,ia,ha,
la]}=t;for(let ja=0,ka=0;ja<G;ja++){var Q=Y+S*ja,Z=t.isPannable||Q>=fa&&Q<=ha;for(var ba=0;ba<O;ba++,ka++){var ca=aa-X*ba;Z&&ca>=ia&&ca<=la&&(z.push([Q,ca]),e[ka]=1)}}return{points:z,mask:e}}({coef:Q}=t);t=[];for(Z=0;Z<O;Z++){var da=aa-X*Z;ba=[];ca=[];for(var ea=0;ea<Q.length;ea++){const [fa,ia,ha,la,ja]=Q[ea];da===ha&&ha===la?(ba.push(fa),ba.push(ia),ca.push(2),ca.push(2)):da>=ha&&da<=la&&(ba.push(fa*da+ia),ca.push(ja))}da=ba;if(2<ba.length){ea=2===ca[0]?0:ca[0];let fa=ba[0];da=[];for(let ia=1;ia<
ca.length;ia++)if(2!==ca[ia]||ia===ca.length-1)ca[ia]!==ea&&(da.push(0===ea?Math.min(fa,ba[ia-1]):Math.max(fa,ba[ia-1])),ea=ca[ia],fa=ba[ia]),ia===ca.length-1&&da.push(0===ca[ia]?Math.min(fa,ba[ia]):Math.max(fa,ba[ia]));da.sort((ia,ha)=>ia-ha)}else ba[0]>ba[1]&&(da=[ba[1],ba[0]]);t.push(da)}for(let fa=0,ia=0;fa<G;fa++)for(Q=Y+S*fa,Z=0;Z<O;Z++,ia++)if(ba=aa-X*Z,ca=t[Z],2===ca.length)Q>=ca[0]&&Q<=ca[1]&&(z.push([Q,ba]),e[ia]=1);else if(2<ca.length){da=!1;for(ea=0;ea<ca.length;ea+=2)if(Q>=ca[ea]&&Q<=
ca[ea+1]){da=!0;break}da&&(z.push([Q,ba]),e[ia]=1)}return{points:z,mask:e}}function b(e,t){const [z,G]=t;for(t=0;t<e.length;t++){const O=e[t][1];if(O<z||O>G)e[t]=[NaN,NaN]}}function d(e){const t=g(e[0].spatialReference);if(2>e.length||!w.isSome(t))return e[0];let {xmin:z,xmax:G,ymin:O,ymax:S}=e[0];for(let X=1;X<e.length;X++){const W=e[X];G=W.xmax+t*X;O=Math.min(O,W.ymin);S=Math.max(S,W.ymax)}return new P({xmin:z,xmax:G,ymin:O,ymax:S,spatialReference:e[0].spatialReference})}function l(e,t,z=null,G=
!0){if(e.spatialReference.equals(t))return e;const O=f(e),S=g(e.spatialReference,!0);var X=g(t);if(0===O||w.isNone(S)||w.isNone(X))return h(e,t,z,G);X=e.clone().normalize();if(1===X.length&&e.xmax<S&&e.xmax-S/2>L(e.spatialReference)){const {xmin:W,xmax:Y}=e;for(let aa=0;aa<=O;aa++)X[aa]=new P({xmin:0===aa?W:-S/2,xmax:aa===O?Y-S*aa:S/2,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference})}e=X.map(W=>h(W,t,z,G));return d(e.filter(W=>!!W))}function h(e,t,z=null,G=!0,O=!0){const S=e.spatialReference;
if(S.equals(t))return e;u(S,t,z);const X=R.project(e,t,z);if(O&&t.isWebMercator&&X&&(X.ymax=Math.min(2.0037508342787E7,X.ymax),X.ymin=Math.max(-2.0037508342787E7,X.ymin),X.ymin>=X.ymax))return null;if(!G||!X)return X;var W=p(S,!0);G=p(t,!0);if(w.isNone(W)||w.isNone(G))return X;O=L(S,.001);const Y=L(S,500);var aa=L(t,.001);if(Math.abs(X.xmin-G[0])<aa&&Math.abs(X.xmax-G[1])<aa){aa=Math.abs(e.xmin-W[0]);W=Math.abs(W[1]-e.xmax);if(aa<O&&W>Y){X.xmin=G[0];var Q=[];Q.push(new K(e.xmax,e.ymin,S));Q.push(new K(e.xmax,
(e.ymin+e.ymax)/2,S));Q.push(new K(e.xmax,e.ymax,S));Q=Q.map(Z=>c(Z,t,z)).filter(Z=>!isNaN(null==Z?void 0:Z.x)).map(Z=>Z.x);X.xmax=Math.max.apply(null,Q)}W<O&&aa>Y&&(X.xmax=G[1],G=[],G.push(new K(e.xmin,e.ymin,S)),G.push(new K(e.xmin,(e.ymin+e.ymax)/2,S)),G.push(new K(e.xmin,e.ymax,S)),e=G.map(Z=>c(Z,t,z)).filter(Z=>!isNaN(null==Z?void 0:Z.x)).map(Z=>Z.x),X.xmin=Math.min.apply(null,e))}else e=L(t,.001),Math.abs(X.xmin-G[0])<e&&(X.xmin=G[0]),Math.abs(X.xmax-G[1])<e&&(X.xmax=G[1]);return X}function g(e,
t=!1){return e.isWebMercator?2*(t?2.0037508342787E7:2.0037508342788905E7):e.wkid&&e.isGeographic?360:2*D[e.wkid]||null}function p(e,t=!1){if(e.isGeographic)return[-180,180];e=g(e,t);return w.isSome(e)?[-e/2,e/2]:null}function n(e,t,z,G){e=(e-t)/z;0!==e-Math.floor(e)?e=Math.floor(e):G&&--e;return e}function f(e,t=!1){var z=g(e.spatialReference);if(!w.isSome(z))return 0;const G=t?0:-(z/2),O=L(e.spatialReference),S=!t&&Math.abs(e.xmin+z/2)<O?-z/2:e.xmin;e=n(!t&&Math.abs(e.xmax-z/2)<O?z/2:e.xmax,G,z,
!0);z=n(S,G,z,!1);return e-z}function k(e){const {projectedExtent:t,srcBufferExtent:z,pixelSize:G,datumTransformation:O,rasterTransform:S}=e;var X=t.spatialReference;const W=z.spatialReference;u(X,W);const {xmin:Y,ymin:aa,xmax:Q,ymax:Z}=t,ba=g(W),ca=w.isSome(ba)&&(e.hasWrapAround||"gcs-shift"===(null==S?void 0:S.type));e=e.spacing||[32,32];var da=e[0]*G.x,ea=e[1]*G.y;const fa=1===e[0],ia=Math.ceil((Q-Y)/da-.1/e[0])+(fa?0:1),ha=Math.ceil((Z-aa)/ea-.1/e[1])+(fa?0:1);X=v({cols:ia,rows:ha,xmin:Y,ymax:Z,
xres:da,yres:ea,inSR:X,outSR:W,datumTransformation:O,preferPE:4>=e[0],usePixelCenter:fa});da=[];let la;ea=0;const ja=fa?-1:NaN,{xmin:ka,xmax:pa,ymax:na,width:ma,height:oa}=z,ta=L(W,500);for(let ra=0;ra<ia;ra++){const sa=[];for(let ua=0;ua<ha;ua++){var qa=X[ra*ha+ua];ca&&qa[0]>pa&&qa[0]>ba/2-ta&&(qa[0]-=ba);!qa||isNaN(qa[0])||isNaN(qa[1])?(da.push(ja),da.push(ja),sa.push(null),ea++):(S&&(qa=S.inverseTransform(new K({x:qa[0],y:qa[1],spatialReference:W})),qa=[qa.x,qa.y]),sa.push(qa),0<ra&&ca&&la[ua]&&
qa[0]<la[ua][0]&&(qa[0]+=ba),da.push((qa[0]-ka)/ma),da.push((na-qa[1])/oa))}la=sa}return{offsets:da,error:null,coefficients:null,outofBoundPointCount:ea,spacing:e,size:fa?[ia,ha]:[ia-1,ha-1]}}function a(e,t,z){const {cols:G,rows:O}=t;t=new Float32Array((G-1)*(O-1)*12);const S=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),X=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let ba=0;ba<G-1;ba++){for(var W=0;W<O-1;W++){var Y=ba*O*2+2*W,aa=e[Y];const ca=e[Y+1];var Q=e[Y+2],Z=e[Y+3];Y+=2*O;const da=e[Y],ea=e[Y+
1],fa=e[Y+2];Y=e[Y+3];let ia=0,ha=12*(W*(G-1)+ba);for(let la=0;3>la;la++)t[ha++]=S[ia++]*aa+S[ia++]*Q+S[ia++]*fa;ia=0;for(Q=0;3>Q;Q++)t[ha++]=S[ia++]*ca+S[ia++]*Z+S[ia++]*Y;ia=0;for(Z=0;3>Z;Z++)t[ha++]=X[ia++]*aa+X[ia++]*da+X[ia++]*fa;ia=0;for(aa=0;3>aa;aa++)t[ha++]=X[ia++]*ca+X[ia++]*ea+X[ia++]*Y}if(z)for(W=0;W<t.length;W++)isNaN(t[W])&&(t[W]=-1)}return t}const r=function(e,t,z,G=0){if(1===z[0])return[0,0];var O=1,S=-1,X=1,W=-1;for(var Y=0;Y<e.length;Y+=2)isNaN(e[Y])||(O=O>e[Y]?e[Y]:O,S=S>e[Y]?S:
e[Y],X=X>e[Y+1]?e[Y+1]:X,W=W>e[Y+1]?W:e[Y+1]);const {cols:aa,rows:Q}=t;t=(S-O)/aa/z[0];z=(W-X)/Q/z[1];G*=2;X=0;W=!1;O=[0,0];for(S=0;S<aa-3;S++){for(Y=0;Y<Q-3;Y++){var Z=S*Q*2+2*Y;const ba=Math.abs(((e[Z]+e[Z+4]+e[Z+4*Q]+e[Z+4*Q+4])/4-e[Z+2*Q+2])/t);Z=Math.abs(((e[Z+1]+e[Z+5]+e[Z+4*Q+1]+e[Z+4*Q+5])/4-e[Z+2*Q+3])/z);ba+Z>X&&(X=ba+Z,O=[ba,Z]);if(G&&X>G){W=!0;break}}if(W)break}return O},D={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,
4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,
54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},M=new Map,C=new Map;U.computeProjectedScales=function(e,t,z=512,G=!0){const {extent:O,spatialReference:S,pixelSize:X}=e,W=E(new K({x:X.x,y:X.y,spatialReference:S}),t,O);if(null==W)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var Y=(W.x+W.y)/2,aa=V.getMetersPerUnitForSR(t);Y=Y*aa*96*39.37;const Q=t.isGeographic?256/z*2.958287637958547E8:256/z*5.91657527591555E8;
z="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const Z=l(O,t);z||G&&(t.isGeographic||t.isWebMercator)&&(z=0>Z.xmin*Z.xmax);G=Y;if(z)G=Q,e=t.isGeographic?1.341104507446289E-6:.29858214164761665,aa=96*e*aa*39.37,t=E(new K({x:e,y:e,spatialReference:{wkid:t.isGeographic?4326:3857}}),S,Z),t.x*=G/aa,t.y*=G/aa;else{t={x:X.x,y:X.y};e=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);for(aa=0;G<.5005*Q&&aa<e;)aa++,G*=2,t.x*=2,t.y*=2;1.001>=Math.max(G,Q)/Math.min(G,Q)&&(G=Q)}e=[G];aa=[{x:t.x,
y:t.y}];for(Y=Math.min(70.5310735,Y)/1.001;G>=Y;)G/=2,t.x/=2,t.y/=2,e.push(G),aa.push({x:t.x,y:t.y});return{projectedPixelSize:W,scales:e,srcResolutions:aa,isCustomTilingScheme:!z}};U.defaultGridSpacing=32;U.defaultProjectionToleranceInPixels=4;U.getDefaultDatumTransformationForDataset=function(e,t,z){return u(e.spatialReference,t)?z?R.getTransformation(t,e.spatialReference,e):R.getTransformation(e.spatialReference,t,e):null};U.getProjectedGridPoints=v;U.getProjectionOffsetGrid=function(e){var t=
e.isAdaptive&&null==e.spacing;let z=e.spacing||[32,32],G=k(e);var O={cols:G.size[0]+1,rows:G.size[1]+1};const S=0<G.outofBoundPointCount&&G.outofBoundPointCount<G.offsets.length/2;let X=G.outofBoundPointCount===G.offsets.length/2||t&&S?[0,0]:r(G.offsets,O,z,4);const W=(X[0]+X[1])/2;var Y=e.projectedExtent.spatialReference;const aa=e.srcBufferExtent.spatialReference;t&&(S||4<W)&&(m(Y,aa,e.datumTransformation)&&(Y.isGeographic||w.isSome(A(Y))),z=[4,4],G=k({...e,spacing:z}),O={cols:G.size[0]+1,rows:G.size[1]+
1},X=r(G.offsets,O,z,4));G.error=X;1<z[0]&&(G.coefficients=a(G.offsets,O,S));!e.includeGCSGrid||Y.isGeographic||Y.isWebMercator||(aa.isGeographic?G.gcsGrid={offsets:G.offsets,coefficients:G.coefficients,spacing:z}:(t=A(Y),w.isSome(t)&&!t.isEnvelope&&(Y&&!Y.isGeographic&&(t=String(Y.wkid||Y.wkt),C.has(t)?Y=C.get(t):(Y=(Y.wkid?T.PeFactory.coordsys(Y.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_PROJCS,Y.wkt)).getGeogcs().getCode(),C.set(t,Y)),Y=new q({wkid:Y})),Y=l(e.projectedExtent,Y),{offsets:e}=
k({...e,srcBufferExtent:Y,spacing:z}),O=a(e,O,S),G.gcsGrid={offsets:e,coefficients:O,spacing:z})));return G};U.getRasterDatasetAlignmentInfo=function(e){const t=e.storageInfo.origin.x;var z=g(e.spatialReference,!0);if(!w.isSome(z))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const G=z/2,{nativePixelSize:O,storageInfo:S,extent:X}=e,{maximumPyramidLevel:W,blockWidth:Y,pyramidScalingFactor:aa}=S;let Q=O.x;const Z=[];e=w.isSome(e.transform)&&"gcs-shift"===e.transform.type;const ba=t+(e?0:G);
z=e?z-t:G-t;for(let ca=0;ca<=W;ca++){const da=(X.xmax-t)/Q/Y,ea=z/Q/Y;Z.push({resolutionX:Q,blockWidth:Y,datsetColumnCount:0===da-Math.floor(da)?da:Math.ceil(da),worldColumnCountFromOrigin:0===ea-Math.floor(ea)?ea:Math.ceil(ea),leftMargin:Math.round(ba/Q)%Y,rightPadding:(Y-Math.round(z/Q)%Y)%Y,originColumnOffset:Math.floor(ba/Q/Y)});Q*=aa}return{originX:t,halfWorldWidth:G,pyramidsInfo:Z,hasGCSSShiftTransform:e}};U.getWorldWidth=g;U.getWorldWrapCount=f;U.load=function(){return I.apply(this,arguments)};
U.minimumGridSpacing=4;U.projectExtent=l;U.projectPoint=c;U.projectResolution=E;U.requirePE=m;U.snapExtent=function(e){e=e.clone().normalize();return 1===e.length?e[0]:d(e)};U.snapPyramid=function(e,t,z){const {storageInfo:G,pixelSize:O}=t;let S=!1;var {pyramidResolutions:X}=G;if(w.isSome(X)&&X.length){e=(e.x+e.y)/2;var W=X[X.length-1];W=(W.x+W.y)/2;var Y=(O.x+O.y)/2;if(e<=Y)var aa=0;else if(e>=W)aa=X.length,S=8<e/W;else{W=Y;for(let Q=1;Q<=X.length;Q++){Y=(X[Q-1].x+X[Q-1].y)/2;if(e<=Y){e===Y?aa=Q:
"down"===z?(aa=Q-1,S=8<e/W):aa="up"===z?Q:e-W>Y-e||2<e/W?Q:Q-1;break}W=Y}}z=0===aa?O:X[aa-1];return{pyramidLevel:aa,pyramidResolution:new K({x:z.x,y:z.y,spatialReference:t.spatialReference}),excessiveReading:S}}aa=Math.log(e.x/O.x)/Math.LN2;e=Math.log(e.y/O.y)/Math.LN2;X=t.storageInfo.maximumPyramidLevel||0;aa="down"===z?Math.floor(Math.min(aa,e)):"up"===z?Math.ceil(Math.max(aa,e)):Math.round((aa+e)/2);0>aa?aa=0:aa>X&&(S=aa>X+3,aa=X);z=2**aa;t=new K({x:z*t.nativePixelSize.x,y:z*t.nativePixelSize.y,
spatialReference:t.spatialReference});return{pyramidLevel:aa,pyramidResolution:t,excessiveReading:S}};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(U,N,H,J,w,V,T,R,P,K,q,m){function u(a,r){return I.apply(this,arguments)}function I(){I=
N._asyncToGenerator(function*(a,r){var D;if(!m.isPlatformLittleEndian)throw new H("rasterCoded:decode","lerc decoder is not supported on big endian platform");yield T.load();const {offset:M,noDataValue:C}=r;(r=null==(D=r.pixelType)?void 0:D.toUpperCase())&&!k.has(r)&&(r=null);const {width:e,height:t,pixelType:z,statistics:G,pixels:O,mask:S}=T.decode(a,{inputOffset:M,noDataValue:C,pixelType:r});return new J({width:e,height:t,pixelType:z.toLowerCase(),pixels:O,mask:S,statistics:G})});return I.apply(this,
arguments)}function E(a,r){return L.apply(this,arguments)}function L(){L=N._asyncToGenerator(function*(a,r){a=yield q.decode(a,r.pyramidLevel||0);a=new J({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});a.updateStatistics();return a});return L.apply(this,arguments)}function c(a,r){return v.apply(this,arguments)}function v(){v=N._asyncToGenerator(function*(a,r){a=yield q.decodeTileOrStrip(a,r.customOptions);a=new J({width:a.width,height:a.height,
pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});a.updateStatistics();return a});return v.apply(this,arguments)}function F(a,r){const D=r.pixelType||"u8",M=J.getPixelArrayConstructor(D),C="u8"===D?a:new M(a.buffer),e=[],t=r.planes||1;if(1===t)e.push(C);else for(let z=0;z<t;z++){const G=(r.width||1)*(r.height||a.length),O=new M(G);for(let S=0;S<G;S++)O[S]=C[S*t+z];e.push(O)}a=new J({width:r.width||1,height:r.height||a.length,pixels:e,pixelType:D,statistics:null});a.updateStatistics();
return a}function x(a,r){a=(new P.Zlib(new Uint8Array(a))).getBytes();return F(a,r)}function A(a,r){a=R.decode(a,r.offset,r.eof,!r.isInputBigEndian);return F(a,r)}function B(a){a=V.decode(a);a=new J({width:a.width,height:a.height,pixels:a.pixels,pixelType:"U8",mask:a.mask,statistics:null});a.updateStatistics();return a}function y(a,r){a=new Uint8Array(a);a=new n(a);const {width:D,height:M}=r;r=D*M;a=a.decode();let C=0;var e=0;let t;e=new Uint8Array(r);for(C=0;C<r;C++)e[C]=a[4*C+3];const z=new J({width:D,
height:M,pixels:[],pixelType:"U8",mask:e,statistics:[]});for(C=0;3>C;C++){t=new Uint8Array(r);for(e=0;e<r;e++)t[e]=a[4*e+C];z.addData({pixels:t})}z.updateStatistics();return z}function b(a,r,D,M){return d.apply(this,arguments)}function d(){d=N._asyncToGenerator(function*(a,r,D,M){a=yield(new w).decode(a,{applyJpegMask:!1,format:r,...D},M);a=new J(a);a.updateStatistics();return a});return d.apply(this,arguments)}function l(a){if(null==a)throw new H("rasterCodec:decode","parameter encodeddata is required.");
a=new Uint8Array(a,0,10);let r="";255===a[0]&&216===a[1]?r="jpg":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]?r="png":67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9]?r="lerc":76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5]?r="lerc2":73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3]||73===a[0]&&73===a[1]&&43===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&43===a[3]?r="tiff":71===
a[0]&&73===a[1]&&70===a[2]?r="gif":66===a[0]&&77===a[1]?r="bmp":-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error")&&(r="error");return r}function h(a){let r=null;switch(a){case "lerc":case "lerc2":r=u;break;case "jpg":r=B;break;case "png":r=y;break;case "bsq":case "bip":r=(D,M)=>{{var C=M.pixelType;var e=null;let t=null;switch(C?C.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":t=255;e=Uint8Array;break;case "u16":t=t||65535;e=Uint16Array;break;case "u32":t=t||2**32-1;
e=Uint32Array;break;case "s8":t=t||-128;e=Int8Array;break;case "s16":t=t||-32768;e=Int16Array;break;case "s32":t=t||-(2**31);e=Int32Array;break;default:e=Float32Array}C={pixelTypeCtor:e,noDataValue:t}}({pixelTypeCtor:C}=C);e=K.decode;D=e(D,{width:M.width,height:M.height,pixelType:C,format:a});M=new J({width:M.width,height:M.height,pixels:D.pixels,pixelType:M.pixelType,mask:D.mask,statistics:null});M.updateStatistics();return M};break;case "tiff":r=E;break;case "deflate":r=x;break;case "lzw":r=A;break;
case "error":r=()=>{throw new H("rasterCodec:decode","input data contains error");};break;default:r=()=>{throw new H("rasterCodec:decode","unsupported raster format");}}return r}function g(a,r=1){if(a){var {pixels:D,width:M,height:C,mask:e}=a;if(D&&0!==D.length){var t=D.length,z=M-1,G=C-1,O=[],S,X,W=J.getPixelArrayConstructor(a.pixelType);if(0===r){for(r=0;r<t;r++){var Y=D[r];var aa=new W(z*G);for(S=0;S<G;S++){var Q=S*M;for(X=0;X<z;X++)aa[S*z+X]=Y[Q+X]}O.push(aa)}if(e){var Z=new Uint8Array(z*G);for(S=
0;S<G;S++)for(Q=S*M,X=0;X<z;X++)Z[S*z+X]=e[Q+X]}}else{for(r=0;r<t;r++){Y=D[r];aa=new W(z*G);for(S=0;S<G;S++)for(Q=S*M,X=0;X<z;X++)aa[S*z+X]=(Y[Q+X]+Y[Q+X+1]+Y[Q+M+X]+Y[Q+M+X+1])/4;O.push(aa)}if(e)for(Z=new Uint8Array(z*G),S=0;S<G;S++)for(Q=S*M,X=0;X<z;X++)Z[S*z+X]=Math.min.apply(null,[e[Q+X],e[Q+X+1],e[Q+M+X],e[Q+M+X+1]])}a.width=z;a.height=G;a.mask=Z;a.pixels=O}}}function p(){p=N._asyncToGenerator(function*(a,r={},D){if(null==a)throw new H("rasterCodec:decode","missing encodeddata parameter.");let M=
r.format&&r.format.toLowerCase();if(!("bsq"!==M&&"bip"!==M||null!=r.width&&null!=r.height))throw new H("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===M&&r.customOptions)return c(a,r);if(!M||"bsq"!==M&&"bip"!==M&&"deflate"!==M&&"lzw"!==M)M=l(a);r.useCanvas&&f.has(M)?a=yield b(a,M,r,D):(D=h(M),r.isPoint&&(r={...r},r.width++,r.height++),a=yield D(a,r),r.isPoint&&g(a));return a});return p.apply(this,arguments)}var n=function(a){function r(e){var t,z;this.data=e;this.pos=
8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(z=null;;){var G=this.readUInt32();var O=e=void 0;e=[];for(O=0;4>O;++O)e.push(String.fromCharCode(this.data[this.pos++]));e=e.join("");switch(e){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];
break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(G);break;case "fcTL":z&&this.animation.frames.push(z);this.pos+=4;z={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};e=this.readUInt16();G=this.readUInt16()||100;z.delay=1E3*e/G;z.disposeOp=this.data[this.pos++];z.blendOp=this.data[this.pos++];z.data=[];break;case "IDAT":case "fdAT":"fdAT"===e&&
(this.pos+=4,G-=4);e=(null!=z?z.data:void 0)||this.imgData;for(O=0;0<=G?O<G:O>G;0<=G?++O:--O)e.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(G);G=255-this.transparency.indexed.length;if(0<G)for(e=0;0<=G?e<G:e>G;0<=G?++e:--e)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(G)[0];break;case 2:this.transparency.rgb=this.read(G)}break;case "tEXt":O=this.read(G);G=O.indexOf(0);e=
String.fromCharCode.apply(String,O.slice(0,G));this.text[e]=String.fromCharCode.apply(String,O.slice(G+1));break;case "IEND":z&&this.animation.frames.push(z);a:{switch(this.colorType){case 0:case 3:case 4:z=1;break a;case 2:case 6:z=3;break a}z=void 0}this.colors=z;this.hasAlphaChannel=4===(t=this.colorType)||6===t;t=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*t;a:{switch(this.colors){case 1:t="DeviceGray";break a;case 3:t="DeviceRGB";break a}t=void 0}this.colorSpace=t;this.imgData=
new Uint8Array(this.imgData);return;default:this.pos+=G}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var D;r.load=function(e,t,z){"function"===typeof t&&(z=t);var G=new XMLHttpRequest;G.open("GET",e,!0);G.responseType="arraybuffer";G.onload=function(){var O=new Uint8Array(G.response||G.mozResponseArrayBuffer);O=new r(O);"function"===typeof(null!=t?t.getContext:void 0)&&O.render(t);return"function"===typeof z?z(O):void 0};return G.send(null)};r.prototype.read=
function(e){var t;var z=[];for(t=0;0<=e?t<e:t>e;0<=e?++t:--t)z.push(this.data[this.pos++]);return z};r.prototype.readUInt32=function(){var e=this.data[this.pos++]<<24;var t=this.data[this.pos++]<<16;var z=this.data[this.pos++]<<8;var G=this.data[this.pos++];return e|t|z|G};r.prototype.readUInt16=function(){var e=this.data[this.pos++]<<8;var t=this.data[this.pos++];return e|t};r.prototype.decodePixels=function(e){var t,z,G,O,S,X,W,Y;null==e&&(e=this.imgData);if(0===e.length)return new Uint8Array(0);
e=new P.Zlib(e);e=e.getBytes();var aa=this.pixelBitlength/8;var Q=aa*this.width;var Z=new Uint8Array(Q*this.height);var ba=e.length;for(z=O=S=0;O<ba;){switch(e[O++]){case 0:for(G=t=0;t<Q;G=t+=1)Z[z++]=e[O++];break;case 1:for(G=X=0;X<Q;G=X+=1){t=e[O++];var ca=G<aa?0:Z[z-aa];Z[z++]=(t+ca)%256}break;case 2:for(G=ca=0;ca<Q;G=ca+=1){t=e[O++];var da=(G-G%aa)/aa;X=S&&Z[(S-1)*Q+da*aa+G%aa];Z[z++]=(X+t)%256}break;case 3:for(G=Y=0;Y<Q;G=Y+=1)t=e[O++],da=(G-G%aa)/aa,ca=G<aa?0:Z[z-aa],X=S&&Z[(S-1)*Q+da*aa+G%
aa],Z[z++]=(t+Math.floor((ca+X)/2))%256;break;case 4:for(G=Y=0;Y<Q;G=Y+=1){t=e[O++];da=(G-G%aa)/aa;ca=G<aa?0:Z[z-aa];0===S?X=W=0:(X=Z[(S-1)*Q+da*aa+G%aa],W=da&&Z[(S-1)*Q+(da-1)*aa+G%aa]);var ea=ca+X-W;G=Math.abs(ea-ca);da=Math.abs(ea-X);ea=Math.abs(ea-W);ca=G<=da&&G<=ea?ca:da<=ea?X:W;Z[z++]=(t+ca)%256}break;default:throw Error("Invalid filter algorithm: "+e[O-1]);}S++}return Z};r.prototype.decodePalette=function(){var e,t,z,G,O;var S=this.palette;var X=this.transparency.indexed||[];var W=new Uint8Array((X.length||
0)+S.length);var Y=z=e=t=0;for(G=S.length;z<G;Y=z+=3)W[t++]=S[Y],W[t++]=S[Y+1],W[t++]=S[Y+2],W[t++]=null!=(O=X[e++])?O:255;return W};r.prototype.copyToImageData=function(e,t){var z,G;var O=this.colors;var S=null;var X=this.hasAlphaChannel;this.palette.length&&(S=null!=(z=this._decodedPalette)?z:this._decodedPalette=this.decodePalette(),O=4,X=!0);e=e.data||e;var W=e.length;var Y=S||t;z=G=0;if(1===O)for(;z<W;)O=S?4*t[z/4]:G,G=Y[O++],e[z++]=G,e[z++]=G,e[z++]=G,e[z++]=X?Y[O++]:this.transparency.grayscale&&
this.transparency.grayscale===G?0:255,G=O;else for(;z<W;)O=S?4*t[z/4]:G,e[z++]=Y[O++],e[z++]=Y[O++],e[z++]=Y[O++],e[z++]=X?Y[O++]:this.transparency.rgb&&this.transparency.rgb[1]===Y[O-3]&&this.transparency.rgb[3]===Y[O-2]&&this.transparency.rgb[5]===Y[O-1]?0:255,G=O};r.prototype.decode=function(){var e=new Uint8Array(this.width*this.height*4);this.copyToImageData(e,this.decodePixels());return e};var M=(D=a.document&&a.document.createElement("canvas"))&&D.getContext("2d");var C=function(e){M.width=
e.width;M.height=e.height;M.clearRect(0,0,e.width,e.height);M.putImageData(e,0,0);e=new Image;e.src=D.toDataURL();return e};r.prototype.decodeFrames=function(e){var t,z;if(this.animation){var G=this.animation.frames;var O=[];var S=t=0;for(z=G.length;t<z;S=++t){S=G[S];var X=e.createImageData(S.width,S.height);var W=this.decodePixels(new Uint8Array(S.data));this.copyToImageData(X,W);S.imageData=X;O.push(S.image=C(X))}return O}};r.prototype.renderFrame=function(e,t){var z=this.animation.frames;var G=
z[t];z=z[t-1];0===t&&e.clearRect(0,0,this.width,this.height);1===(null!=z?z.disposeOp:void 0)?e.clearRect(z.xOffset,z.yOffset,z.width,z.height):2===(null!=z?z.disposeOp:void 0)&&e.putImageData(z.imageData,z.xOffset,z.yOffset);0===G.blendOp&&e.clearRect(G.xOffset,G.yOffset,G.width,G.height);return e.drawImage(G.image,G.xOffset,G.yOffset)};r.prototype.animate=function(e){var t,z=this;var G=0;var O=this.animation;var S=O.numFrames;var X=O.frames;var W=O.numPlays;return(t=function(){var Y=G++%S;var aa=
X[Y];z.renderFrame(e,Y);if(1<S&&G/S<W)return z.animation._timeout=setTimeout(t,aa.delay)})()};r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)};r.prototype.render=function(e){e._png&&e._png.stopAnimation();e._png=this;e.width=this.width;e.height=this.height;e=e.getContext("2d");if(this.animation)return this.decodeFrames(e),this.animate(e);var t=e.createImageData(this.width,this.height);this.copyToImageData(t,this.decodePixels());return e.putImageData(t,
0,0)};return r}(self);const f=new Set(["jpg","png","bmp","gif"]),k=new Set("S8 U8 S16 U16 S32 U32 F32 F64".split(" "));U.decode=function(a){return p.apply(this,arguments)};U.getFormat=function(a){a=l(a);"lerc2"===a?a="lerc":"error"===a&&(a="");return a};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(U,N,H){return function(){function J(w){w&&
(this.canvas=w.canvas,this.ctx=w.ctx||w.canvas&&w.canvas.getContext("2d"))}J.prototype.decode=function(w,V,T){if(!w||10>w.byteLength)throw new U("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:R,height:P,format:K}=V;const {applyJpegMask:q}=V;if(q&&(!R||!P))throw new U("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((m,u)=>{let I=null;"jpg"===K&&q&&(I=J._getMask(w,{width:R,height:P}));const E=
new Blob([new Uint8Array(w)],{type:"jpg"==="image/"+K?"jpeg":K}),L=URL.createObjectURL(E),c=new Image;let v;c.src=L;c.onload=()=>{URL.revokeObjectURL(L);if(N.isAborted(T))u(N.createAbortError());else{R=c.width;P=c.height;if(this.canvas){if(this.canvas.width!==R||this.canvas.height!==P)this.canvas.width=R,this.canvas.height=P;this.ctx.clearRect(0,0,R,P)}else this.canvas=document.createElement("canvas"),this.canvas.width=R,this.canvas.height=P,this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(c,
0,0);var F=this.ctx.getImageData(0,0,R,P);v=F.data;var x;if(V.renderOnCanvas){if(I)for(x=0;x<I.length;x++)v[4*x+3]=I[x]?255:0;this.ctx.putImageData(F,0,0);m(null)}else{F=R*P;var A=new Uint8Array(F),B=new Uint8Array(F),y=new Uint8Array(F);if(I)for(x=0;x<F;x++)A[x]=v[4*x],B[x]=v[4*x+1],y[x]=v[4*x+2];else for(I=new Uint8Array(F),x=0;x<F;x++)A[x]=v[4*x],B[x]=v[4*x+1],y[x]=v[4*x+2],I[x]=v[4*x+3];m({width:R,height:P,pixels:[A,B,y],mask:I,pixelType:"u8"})}}};c.onerror=()=>{URL.revokeObjectURL(L);u("cannot load image")}})};
J._getMask=function(w,V){let T=null;try{var R=new Uint8Array(w);w=0;var P=R.length-2;for(w=Math.ceil(R.length/2);w<P&&(255!==R[w]||217!==R[w+1]);w++);w+=2;if(w<R.length-1){const K=(new H.Zlib(R.subarray(w))).getBytes();T=new Uint8Array(V.width*V.height);V=0;for(R=0;R<K.length;R++)for(P=7;0<=P;P--)T[V++]=K[R]>>P&1}}catch(K){}return T};return J}()})},"esri/chunks/Zlib":function(){define(["exports"],function(U){var N={exports:{}};(function(H){(function(J){J=J();void 0!==J&&(H.exports=J)})(function(){var J=
function(){function w(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}w.prototype={ensureBuffer:function(V){var T=this.buffer,R=T?T.byteLength:0;if(V<R)return T;for(var P=512;P<V;)P<<=1;V=new Uint8Array(P);for(P=0;P<R;++P)V[P]=T[P];return this.buffer=V},getByte:function(){for(var V=this.pos;this.bufferLength<=V;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(V){var T=this.pos;if(V){this.ensureBuffer(T+V);for(V=T+V;!this.eof&&this.bufferLength<
V;)this.readBlock();var R=this.bufferLength;V>R&&(V=R)}else{for(;!this.eof;)this.readBlock();V=this.bufferLength}this.pos=V;return this.buffer.subarray(T,V)},lookChar:function(){for(var V=this.pos;this.bufferLength<=V;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var V=this.pos;this.bufferLength<=V;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(V,T,R){for(var P=
V+T;this.bufferLength<=P&&!this.eof;)this.readBlock();return new Stream(this.buffer,V,T,R)},skip:function(V){V||(V=1);this.pos+=V},reset:function(){this.pos=0}};return w}();return function(){function w(m){throw Error(m);}function V(m){var u=0,I=m[u++],E=m[u++];-1!=I&&-1!=E||w("Invalid header in flate stream");8!=(I&15)&&w("Unknown compression method in flate stream");0!=((I<<8)+E)%31&&w("Bad FCHECK in flate stream");E&32&&w("FDICT bit set in flate stream");this.bytes=m;this.bytesPos=u;this.codeBuf=
this.codeSize=0;J.call(this)}if(!self||!self.Uint32Array)return null;var T=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),P=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,
794625,798721,868353,876545]),K=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,
524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,
524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,
524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,
524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,
524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,
524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,
524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],q=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];V.prototype=Object.create(J.prototype);V.prototype.getBits=function(m){for(var u=this.codeSize,I=this.codeBuf,E=this.bytes,L=this.bytesPos,c;u<m;)"undefined"==
typeof(c=E[L++])&&w("Bad encoding in flate stream"),I|=c<<u,u+=8;this.codeBuf=I>>m;this.codeSize=u-=m;this.bytesPos=L;return I&(1<<m)-1};V.prototype.getCode=function(m){var u=m[0],I=m[1];m=this.codeSize;for(var E=this.codeBuf,L=this.bytes,c=this.bytesPos;m<I;){var v;"undefined"==typeof(v=L[c++])&&w("Bad encoding in flate stream");E|=v<<m;m+=8}I=u[E&(1<<I)-1];u=I>>16;I&=65535;(0==m||m<u||0==u)&&w("Bad encoding in flate stream");this.codeBuf=E>>u;this.codeSize=m-u;this.bytesPos=c;return I};V.prototype.generateHuffmanTable=
function(m){for(var u=m.length,I=0,E=0;E<u;++E)m[E]>I&&(I=m[E]);for(var L=1<<I,c=new Uint32Array(L),v=1,F=0,x=2;v<=I;++v,F<<=1,x<<=1)for(var A=0;A<u;++A)if(m[A]==v){var B=0,y=F;for(E=0;E<v;++E)B=B<<1|y&1,y>>=1;for(E=B;E<L;E+=x)c[E]=v<<16|A;++F}return[c,I]};V.prototype.readBlock=function(){function m(B,y,b,d,l){for(B=B.getBits(b)+d;0<B--;)y[F++]=l}var u=this.getBits(3);u&1&&(this.eof=!0);u>>=1;if(0==u){var I=this.bytes,E=this.bytesPos,L;"undefined"==typeof(L=I[E++])&&w("Bad block header in flate stream");
var c=L;"undefined"==typeof(L=I[E++])&&w("Bad block header in flate stream");c|=L<<8;"undefined"==typeof(L=I[E++])&&w("Bad block header in flate stream");u=L;"undefined"==typeof(L=I[E++])&&w("Bad block header in flate stream");(u|L<<8)!=(~c&65535)&&w("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;L=this.bufferLength;u=this.ensureBuffer(L+c);this.bufferLength=c=L+c;for(var v=L;v<c;++v){if("undefined"==typeof(L=I[E++])){this.eof=!0;break}u[v]=L}this.bytesPos=E}else{if(1==
u)E=K,L=q;else if(2==u){u=this.getBits(5)+257;L=this.getBits(5)+1;I=this.getBits(4)+4;E=Array(T.length);for(var F=0;F<I;)E[T[F++]]=this.getBits(3);E=this.generateHuffmanTable(E);F=I=0;L=u+L;for(c=Array(L);F<L;)v=this.getCode(E),16==v?m(this,c,2,3,I):17==v?m(this,c,3,3,I=0):18==v?m(this,c,7,11,I=0):c[F++]=I=v;E=this.generateHuffmanTable(c.slice(0,u));L=this.generateHuffmanTable(c.slice(u,L))}else w("Unknown block type in flate stream");c=(u=this.buffer)?u.length:0;for(v=this.bufferLength;;){var x=
this.getCode(E);if(256>x)v+1>=c&&(u=this.ensureBuffer(v+1),c=u.length),u[v++]=x;else{if(256==x){this.bufferLength=v;break}x-=257;x=R[x];var A=x>>16;0<A&&(A=this.getBits(A));I=(x&65535)+A;x=this.getCode(L);x=P[x];A=x>>16;0<A&&(A=this.getBits(A));x=(x&65535)+A;v+I>=c&&(u=this.ensureBuffer(v+I),c=u.length);for(A=0;A<I;++A,++v)u[v]=u[v-x]}}}};return V}()})})(N);U.Zlib=N.exports})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(U,N){return function(){function H(){}
H.decode=function(J){var w=new Uint8Array(J);J=new U.JpegImage;J.parse(w);const {width:V,height:T,numComponents:R,eof:P}=J;J=J.getData(V,T,!0);let K;const q=V*T;let m=0;var u=0,I=0;if(P<w.length-1)for(w=(new N.Zlib(w.subarray(P))).getBytes(),K=new Uint8Array(q),m=u=0;m<w.length;m++)for(I=7;0<=I;I--)K[u++]=w[m]>>I&1;w=null;if(1===R)w=[J,J,J];else{w=[];for(m=0;3>m;m++)I=new Uint8Array(q),w.push(I);for(u=I=0;u<q;u++)for(m=0;3>m;m++)w[m][u]=J[I++]}return{width:V,height:T,pixels:w,mask:K}};return H}()})},
"esri/chunks/Jpg":function(){define(["exports"],function(U){var N={exports:{}};(function(H){(function(J){J=J();void 0!==J&&(H.exports=J)})(function(){var J=function(){function w(V){this.message="JPEG error: "+V}w.prototype=Error();w.prototype.name="JpegError";return w.constructor=w}();return function(){function w(){this.decodeTransform=null;this.colorTransform=-1}function V(q,m){for(var u=0,I=[],E,L,c=16;0<c&&!q[c-1];)c--;I.push({children:[],index:0});var v=I[0],F;for(E=0;E<c;E++){for(L=0;L<q[E];L++){v=
I.pop();for(v.children[v.index]=m[u];0<v.index;)v=I.pop();v.index++;for(I.push(v);I.length<=E;)I.push(F={children:[],index:0}),v.children[v.index]=F.children,v=F;u++}E+1<c&&(I.push(F={children:[],index:0}),v.children[v.index]=F.children,v=F)}return I[0].children}function T(q,m,u,I,E,L,c,v,F){function x(){if(0<k)return k--,f>>k&1;f=q[m++];if(255===f){var Y=q[m++];if(Y)throw new J("unexpected marker "+(f<<8|Y).toString(16));}k=7;return f>>>7}function A(Y){for(;;){Y=Y[x()];if("number"===typeof Y)return Y;
if("object"!==typeof Y)throw new J("invalid huffman sequence");}}function B(Y){for(var aa=0;0<Y;)aa=aa<<1|x(),Y--;return aa}function y(Y){if(1===Y)return 1===x()?1:-1;var aa=B(Y);return aa>=1<<Y-1?aa:aa+(-1<<Y)+1}function b(Y,aa){var Q=A(Y.huffmanTableDC);Q=0===Q?0:y(Q);Y.blockData[aa]=Y.pred+=Q;for(Q=1;64>Q;){var Z=A(Y.huffmanTableAC),ba=Z&15;Z>>=4;if(0===ba){if(15>Z)break;Q+=16}else Q+=Z,Y.blockData[aa+K[Q]]=y(ba),Q++}}function d(Y,aa){var Q=A(Y.huffmanTableDC);Q=0===Q?0:y(Q)<<F;Y.blockData[aa]=
Y.pred+=Q}function l(Y,aa){Y.blockData[aa]|=x()<<F}function h(Y,aa){if(0<a)a--;else for(var Q=L;Q<=c;){var Z=A(Y.huffmanTableAC),ba=Z&15;Z>>=4;if(0===ba){if(15>Z){a=B(Z)+(1<<Z)-1;break}Q+=16}else Q+=Z,Y.blockData[aa+K[Q]]=y(ba)*(1<<F),Q++}}function g(Y,aa){for(var Q=L,Z=0,ba;Q<=c;){ba=K[Q];switch(r){case 0:Z=A(Y.huffmanTableAC);ba=Z&15;Z>>=4;if(0===ba)15>Z?(a=B(Z)+(1<<Z),r=4):(Z=16,r=1);else{if(1!==ba)throw new J("invalid ACn encoding");D=y(ba);r=Z?2:3}continue;case 1:case 2:Y.blockData[aa+ba]?Y.blockData[aa+
ba]+=x()<<F:(Z--,0===Z&&(r=2===r?3:0));break;case 3:Y.blockData[aa+ba]?Y.blockData[aa+ba]+=x()<<F:(Y.blockData[aa+ba]=D<<F,r=0);break;case 4:Y.blockData[aa+ba]&&(Y.blockData[aa+ba]+=x()<<F)}Q++}4===r&&(a--,0===a&&(r=0))}var p=u.mcusPerLine,n=m,f=0,k=0,a=0,r=0,D,M=I.length,C,e,t,z;v=u.progressive?0===L?0===v?d:l:0===v?h:g:b;var G=0;u=1===M?I[0].blocksPerLine*I[0].blocksPerColumn:p*u.mcusPerColumn;for(var O,S;G<u;){var X=E?Math.min(u-G,E):u;for(C=0;C<M;C++)I[C].pred=0;a=0;if(1===M){var W=I[0];for(z=
0;z<X;z++)v(W,64*((W.blocksPerLine+1)*(G/W.blocksPerLine|0)+G%W.blocksPerLine)),G++}else for(z=0;z<X;z++){for(C=0;C<M;C++)for(W=I[C],O=W.h,S=W.v,e=0;e<S;e++)for(t=0;t<O;t++)v(W,64*((W.blocksPerLine+1)*((G/p|0)*W.v+e)+(G%p*W.h+t)));G++}k=0;(W=P(q,m))&&W.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+W.invalid),m=W.offset);W=W&&W.marker;if(!W||65280>=W)throw new J("marker was not found");if(65488<=W&&65495>=W)m+=2;else break}(W=P(q,m))&&W.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+
W.invalid),m=W.offset);return m-n}function R(q,m){q=m.blocksPerLine;for(var u=m.blocksPerColumn,I=new Int16Array(64),E=0;E<u;E++)for(var L=0;L<q;L++){var c=void 0,v=void 0,F=void 0,x=void 0,A=void 0,B=void 0,y=void 0,b=void 0,d=A=B=x=v=c=void 0,l=void 0,h=void 0,g=void 0,p=64*((m.blocksPerLine+1)*E+L),n=I,f=m.quantizationTable,k=m.blockData;if(!f)throw new J("missing required Quantization Table.");for(var a=0;64>a;a+=8)c=k[p+a],b=k[p+a+1],y=k[p+a+2],B=k[p+a+3],A=k[p+a+4],x=k[p+a+5],F=k[p+a+6],v=k[p+
a+7],c*=f[a],0===(b|y|B|A|x|F|v)?(c=5793*c+512>>10,n[a]=c,n[a+1]=c,n[a+2]=c,n[a+3]=c,n[a+4]=c,n[a+5]=c,n[a+6]=c,n[a+7]=c):(b*=f[a+1],y*=f[a+2],B*=f[a+3],A*=f[a+4],x*=f[a+5],F*=f[a+6],v*=f[a+7],g=5793*c+128>>8,h=5793*A+128>>8,l=y,d=F,A=2896*(b-v)+128>>8,v=2896*(b+v)+128>>8,B<<=4,x<<=4,g=g+h+1>>1,h=g-h,c=3784*l+1567*d+128>>8,l=1567*l-3784*d+128>>8,d=c,A=A+x+1>>1,x=A-x,v=v+B+1>>1,B=v-B,g=g+d+1>>1,d=g-d,h=h+l+1>>1,l=h-l,c=2276*A+3406*v+2048>>12,A=3406*A-2276*v+2048>>12,v=c,c=799*B+4017*x+2048>>12,B=4017*
B-799*x+2048>>12,x=c,n[a]=g+v,n[a+7]=g-v,n[a+1]=h+x,n[a+6]=h-x,n[a+2]=l+B,n[a+5]=l-B,n[a+3]=d+A,n[a+4]=d-A);for(f=0;8>f;++f)c=n[f],b=n[f+8],y=n[f+16],B=n[f+24],A=n[f+32],x=n[f+40],F=n[f+48],v=n[f+56],0===(b|y|B|A|x|F|v)?(c=5793*c+8192>>14,c=-2040>c?0:2024<=c?255:c+2056>>4,k[p+f]=c,k[p+f+8]=c,k[p+f+16]=c,k[p+f+24]=c,k[p+f+32]=c,k[p+f+40]=c,k[p+f+48]=c,k[p+f+56]=c):(g=5793*c+2048>>12,h=5793*A+2048>>12,l=y,d=F,A=2896*(b-v)+2048>>12,v=2896*(b+v)+2048>>12,g=(g+h+1>>1)+4112,h=g-h,c=3784*l+1567*d+2048>>
12,l=1567*l-3784*d+2048>>12,d=c,A=A+x+1>>1,x=A-x,v=v+B+1>>1,B=v-B,g=g+d+1>>1,d=g-d,h=h+l+1>>1,l=h-l,c=2276*A+3406*v+2048>>12,A=3406*A-2276*v+2048>>12,v=c,c=799*B+4017*x+2048>>12,B=4017*B-799*x+2048>>12,x=c,c=g+v,v=g-v,b=h+x,F=h-x,y=l+B,x=l-B,B=d+A,A=d-A,c=16>c?0:4080<=c?255:c>>4,b=16>b?0:4080<=b?255:b>>4,y=16>y?0:4080<=y?255:y>>4,B=16>B?0:4080<=B?255:B>>4,A=16>A?0:4080<=A?255:A>>4,x=16>x?0:4080<=x?255:x>>4,F=16>F?0:4080<=F?255:F>>4,v=16>v?0:4080<=v?255:v>>4,k[p+f]=c,k[p+f+8]=b,k[p+f+16]=y,k[p+f+24]=
B,k[p+f+32]=A,k[p+f+40]=x,k[p+f+48]=F,k[p+f+56]=v)}return m.blockData}function P(q,m,u){var I=q.length-1;u=u<m?u:m;if(m>=I)return null;var E=q[m]<<8|q[m+1];if(65472<=E&&65534>=E)return{invalid:null,marker:E,offset:m};for(m=q[u]<<8|q[u+1];!(65472<=m&&65534>=m);){if(++u>=I)return null;m=q[u]<<8|q[u+1]}return{invalid:E.toString(16),marker:m,offset:u}}if(!self||!self.Uint8ClampedArray)return null;var K=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,
28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);w.prototype={parse:function(q){function m(){var f=q[E]<<8|q[E+1];E+=2;return f}function u(){var f=m();f=E+f-2;var k=P(q,f,E);k&&k.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+k.invalid),f=k.offset);f=q.subarray(E,f);E+=f.length;return f}function I(f){for(var k=Math.ceil(f.samplesPerLine/8/f.maxH),a=Math.ceil(f.scanLines/8/f.maxV),r=0;r<f.components.length;r++){n=f.components[r];
var D=Math.ceil(Math.ceil(f.samplesPerLine/8)*n.h/f.maxH),M=Math.ceil(Math.ceil(f.scanLines/8)*n.v/f.maxV);n.blockData=new Int16Array(64*a*n.v*(k*n.h+1));n.blocksPerLine=D;n.blocksPerColumn=M}f.mcusPerLine=k;f.mcusPerColumn=a}var E=0,L=null,c=null,v=[],F=[],x=[],A=m();if(65496!==A)throw new J("SOI not found");for(A=m();65497!==A;){switch(A){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var B=
u();65504===A&&74===B[0]&&70===B[1]&&73===B[2]&&70===B[3]&&0===B[4]&&(L={version:{major:B[5],minor:B[6]},densityUnits:B[7],xDensity:B[8]<<8|B[9],yDensity:B[10]<<8|B[11],thumbWidth:B[12],thumbHeight:B[13],thumbData:B.subarray(14,14+3*B[12]*B[13])});65518===A&&65===B[0]&&100===B[1]&&111===B[2]&&98===B[3]&&101===B[4]&&(c={version:B[5]<<8|B[6],flags0:B[7]<<8|B[8],flags1:B[9]<<8|B[10],transformCode:B[11]});break;case 65499:A=m()+E-2;for(var y;E<A;){var b=q[E++],d=new Uint16Array(64);if(0===b>>4)for(B=
0;64>B;B++)y=K[B],d[y]=q[E++];else if(1===b>>4)for(B=0;64>B;B++)y=K[B],d[y]=m();else throw new J("DQT - invalid table spec");v[b&15]=d}break;case 65472:case 65473:case 65474:if(l)throw new J("Only single frame JPEGs supported");m();var l={};l.extended=65473===A;l.progressive=65474===A;l.precision=q[E++];l.scanLines=m();l.samplesPerLine=m();l.components=[];l.componentIds={};B=q[E++];for(A=d=b=0;A<B;A++){y=q[E];var h=q[E+1]>>4;var g=q[E+1]&15;b<h&&(b=h);d<g&&(d=g);h=l.components.push({h,v:g,quantizationId:q[E+
2],quantizationTable:null});l.componentIds[y]=h-1;E+=3}l.maxH=b;l.maxV=d;I(l);break;case 65476:y=m();for(A=2;A<y;){b=q[E++];d=new Uint8Array(16);for(B=h=0;16>B;B++,E++)h+=d[B]=q[E];g=new Uint8Array(h);for(B=0;B<h;B++,E++)g[B]=q[E];A+=17+h;(0===b>>4?x:F)[b&15]=V(d,g)}break;case 65501:m();var p=m();break;case 65498:m();y=q[E++];B=[];for(A=0;A<y;A++){b=l.componentIds[q[E++]];var n=l.components[b];b=q[E++];n.huffmanTableDC=x[b>>4];n.huffmanTableAC=F[b&15];B.push(n)}A=q[E++];y=q[E++];b=q[E++];A=T(q,E,
l,B,p,A,y,b>>4,b&15);E+=A;break;case 65535:255!==q[E]&&E--;break;default:if(255===q[E-3]&&192<=q[E-2]&&254>=q[E-2])E-=3;else throw new J("unknown marker "+A.toString(16));}A=m()}this.width=l.samplesPerLine;this.height=l.scanLines;this.jfif=L;this.eof=E;this.adobe=c;this.components=[];for(A=0;A<l.components.length;A++){n=l.components[A];if(L=v[n.quantizationId])n.quantizationTable=L;this.components.push({output:R(l,n),scaleX:n.h/l.maxH,scaleY:n.v/l.maxV,blocksPerLine:n.blocksPerLine,blocksPerColumn:n.blocksPerColumn})}this.numComponents=
this.components.length},_getLinearizedBlockData:function(q,m){var u=this.width/q,I=this.height/m,E,L,c=0,v=this.components.length,F=q*m*v,x=new Uint8ClampedArray(F),A=new Uint32Array(q);for(L=0;L<v;L++){var B=this.components[L];var y=B.scaleX*u;var b=B.scaleY*I;c=L;var d=B.output;var l=B.blocksPerLine+1<<3;for(E=0;E<q;E++)B=0|E*y,A[E]=(B&4294967288)<<3|B&7;for(y=0;y<m;y++)for(B=0|y*b,B=l*(B&4294967288)|(B&7)<<3,E=0;E<q;E++)x[c]=d[B+A[E]],c+=v}if(m=this.decodeTransform)for(L=0;L<F;)for(q=B=0;B<v;B++,
L++,q+=2)x[L]=(x[L]*m[q]>>8)+m[q+1];return x},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(q){for(var m,u,I,E=0,L=q.length;E<L;E+=3)m=q[E],u=q[E+1],I=q[E+2],q[E]=m-179.456+1.402*I,q[E+1]=m+135.459-.344*u-.714*I,q[E+2]=m-226.816+1.772*u;return q},_convertYcckToRgb:function(q){for(var m,u,I,E,L=0,c=0,v=q.length;c<v;c+=4)m=q[c],u=q[c+1],I=q[c+2],E=q[c+3],q[L++]=
-122.67195406894+u*(-6.60635669420364E-5*u+4.37130475926232E-4*I-5.4080610064599E-5*m+4.8449797120281E-4*E-.154362151871126)+I*(-9.57964378445773E-4*I+8.17076911346625E-4*m-.00477271405408747*E+1.53380253221734)+m*(9.61250184130688E-4*m-.00266257332283933*E+.48357088451265)+E*(-3.36197177618394E-4*E+.484791561490776),q[L++]=107.268039397724+u*(2.19927104525741E-5*u-6.40992018297945E-4*I+6.59397001245577E-4*m+4.26105652938837E-4*E-.176491792462875)+I*(-7.78269941513683E-4*I+.00130872261408275*m+7.70482631801132E-4*
E-.151051492775562)+m*(.00126935368114843*m-.00265090189010898*E+.25802910206845)+E*(-3.18913117588328E-4*E-.213742400323665),q[L++]=-20.810012546947+u*(-5.70115196973677E-4*u-2.63409051004589E-5*I+.0020741088115012*m-.00288260236853442*E+.814272968359295)+I*(-1.53496057440975E-5*I-1.32689043961446E-4*m+5.60833691242812E-4*E-.195152027534049)+m*(.00174418132927582*m-.00255243321439347*E+.116935020465145)+E*(-3.43531996510555E-4*E+.24165260232407);return q},_convertYcckToCmyk:function(q){for(var m,
u,I,E=0,L=q.length;E<L;E+=4)m=q[E],u=q[E+1],I=q[E+2],q[E]=434.456-m-1.402*I,q[E+1]=119.541-m+.344*u+.714*I,q[E+2]=481.816-m-1.772*u;return q},_convertCmykToRgb:function(q){for(var m,u,I,E,L=0,c=1/255,v=0,F=q.length;v<F;v+=4)m=q[v]*c,u=q[v+1]*c,I=q[v+2]*c,E=q[v+3]*c,q[L++]=255+m*(-4.387332384609988*m+54.48615194189176*u+18.82290502165302*I+212.25662451639585*E-285.2331026137004)+u*(1.7149763477362134*u-5.6096736904047315*I-17.873870861415444*E-5.497006427196366)+I*(-2.5217340131683033*I-21.248923337353073*
E+17.5119270841813)-E*(21.86122147463605*E+189.48180835922747),q[L++]=255+m*(8.841041422036149*m+60.118027045597366*u+6.871425592049007*I+31.159100130055922*E-79.2970844816548)+u*(-15.310361306967817*u+17.575251261109482*I+131.35250912493976*E-190.9453302588951)+I*(4.444339102852739*I+9.8632861493405*E-24.86741582555878)-E*(20.737325471181034*E+187.80453709719578),q[L++]=255+m*(.8842522430003296*m+8.078677503112928*u+30.89978309703729*I-.23883238689178934*E-14.183576799673286)+u*(10.49593273432072*
u+63.02378494754052*I+50.606957656360734*E-112.23884253719248)+I*(.03296041114873217*I+115.60384449646641*E-193.58209356861505)-E*(22.33816807309886*E+180.12613974708367);return q},getData:function(q,m,u){if(4<this.numComponents)throw new J("Unsupported color mode");q=this._getLinearizedBlockData(q,m);if(1===this.numComponents&&u){u=q.length;m=new Uint8ClampedArray(3*u);for(var I=0,E=0;E<u;E++){var L=q[E];m[I++]=L;m[I++]=L;m[I++]=L}return m}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(q);
if(4===this.numComponents){if(this._isColorConversionNeeded())return u?this._convertYcckToRgb(q):this._convertYcckToCmyk(q);if(u)return this._convertCmykToRgb(q)}return q}};return w}()})})(N);U.JpegImage=N.exports})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(U,N,H){function J(P){const {_malloc:K,_free:q,_lerc_getBlobInfo:m,_lerc_getDataRanges:u,_lerc_decode_4D:I,asm:E}=P;let L;const c=Object.values(E).find(F=>F&&"buffer"in F&&F.buffer===
P.HEAPU8.buffer),v=F=>{F=F.map(B=>(B>>3<<3)+16);var x=F.reduce((B,y)=>B+y),A=K(x);L=new Uint8Array(c.buffer);x=F[0];F[0]=A;for(A=1;A<F.length;A++){const B=F[A];F[A]=F[A-1]+x;x=B}return F};R.getBlobInfo=F=>{var x=new Uint8Array(48),A=new Uint8Array(24);const [B,y,b]=v([F.length,x.length,A.length]);L.set(F,B);L.set(x,y);L.set(A,b);var d=m(B,F.length,y,b,12,3);if(d)throw q(B),`lerc-getBlobInfo: error code is ${d}`;L=new Uint8Array(c.buffer);x.set(L.slice(y,y+x.length));A.set(L.slice(b,b+A.length));x=
new Uint32Array(x.buffer);var l=new Float64Array(A.buffer);const [h,g,p,n,f,k,a,r,D,,M]=x;A={version:h,dimCount:p,width:n,height:f,validPixelCount:a,bandCount:k,blobSize:r,maskCount:D,dataType:g,minValue:l[0],maxValue:l[1],maxZerror:l[2],statistics:[],bandCountWithNoData:M};if(M)return A;if(1===p&&1===k)return q(B),A.statistics.push({minValue:l[0],maxValue:l[1]}),A;var C=p*k*8,e=new Uint8Array(C),t=new Uint8Array(C);x=B;l=0;let z=!1;L.byteLength<B+2*C?(q(B),z=!0,[x,l,G]=v([F.length,C,C]),L.set(F,
x)):[l,G]=v([C,C]);L.set(e,l);L.set(t,G);if(d=u(B,F.length,p,k,l,G))throw q(x),z||q(l),`lerc-getDataRanges: error code is ${d}`;L=new Uint8Array(c.buffer);e.set(L.slice(l,l+C));t.set(L.slice(G,G+C));F=new Float64Array(e.buffer);d=new Float64Array(t.buffer);t=A.statistics;for(C=0;C<k;C++)if(1<p){e=F.slice(C*p,(C+1)*p);var G=d.slice(C*p,(C+1)*p);const O=Math.min.apply(null,e),S=Math.max.apply(null,G);t.push({minValue:O,maxValue:S,dimStats:{minValues:e,maxValues:G}})}else t.push({minValue:F[C],maxValue:d[C]});
q(x);z||q(l);return A};R.decode=(F,x)=>{const {maskCount:A,dimCount:B,bandCount:y,width:b,height:d,dataType:l,bandCountWithNoData:h}=x;var g=w[l],p=b*d;x=new Uint8Array(p*y);const n=p*B*y*g.size;g=new Uint8Array(n);const f=new Uint8Array(y),k=8*y,a=new Uint8Array(k),[r,D,M,C,e]=v([F.length,x.length,g.length,f.length,a.length]);L.set(F,r);L.set(x,D);L.set(g,M);L.set(f,C);L.set(a,e);if(F=I(r,F.length,A,D,B,b,d,y,l,M,C,e))throw q(r),`lerc-decode: error code is ${F}`;L=new Uint8Array(c.buffer);g.set(L.slice(M,
M+n));x.set(L.slice(D,D+p));F=null;if(h)for(f.set(L.slice(C,C+y)),a.set(L.slice(e,e+k)),F=[],p=0;p<f.length;p++)F.push(f[p]?a[p]:null);q(r);return{data:g,maskData:x,noDataValues:F}}}const w=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,128]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let V=null,T=!1;const R={getBlobInfo:null,decode:null};N.decode=function(P,K={}){var q,m=null!=(q=K.inputOffset)?q:0;q=P instanceof Uint8Array?P.subarray(m):new Uint8Array(P,m);P=R.getBlobInfo(q);const {data:u,maskData:I}=R.decode(q,P),{width:E,height:L,bandCount:c,
dimCount:v,dataType:F,maskCount:x,statistics:A}=P;q=w[F];var B=new q.ctor(u.buffer);m=[];const y=[],b=E*L;var d=b*v;for(var l=0;l<c;l++){var h=B.subarray(l*d,(l+1)*d);if(K.returnPixelInterleavedDims)m.push(h);else{a:{var g=b,p=v;if(2>p)break a;const n=new q.ctor(g*p);for(let f=0,k=0;f<g;f++)for(let a=0,r=f;a<p;a++,r+=g)n[r]=h[k++];h=n}m.push(h)}y.push(I.subarray(l*d,(l+1)*d))}B=0===x?null:1===x?y[0]:new Uint8Array(b);if(1<x)for(B.set(y[0]),d=1;d<y.length;d++)for(l=y[d],h=0;h<b;h++)B[h]&=l[h];({noDataValue:d}=
K);d=null!=d&&q.range[0]<=d&&q.range[1]>=d;if(0<x&&d)for({noDataValue:d}=K,l=0;l<c;l++)for(h=m[l],g=y[l]||B,p=0;p<b;p++)0===g[p]&&(h[p]=d);return{width:E,height:L,bandCount:c,pixelType:K.pixelType&&0===P.version?K.pixelType:q.pixelType,dimCount:v,statistics:A,pixels:m,mask:B,bandMasks:x===c&&1<c?y:null}};N.getBlobInfo=function(P,K={}){var q,m;P=P instanceof Uint8Array?P.subarray(null!=(q=K.inputOffset)?q:0):new Uint8Array(P,null!=(m=K.inputOffset)?m:0);return R.getBlobInfo(P)};N.isLoaded=function(){return T};
N.load=function(){return V?V:V=(new Promise((P,K)=>U(["../../../chunks/lerc-wasm"],P,K))).then(P=>P.lercWasm).then(({default:P})=>P({locateFile:K=>H.getAssetUrl(`esri/layers/support/rasterFormats/${K}`)})).then(P=>{J(P);T=!0})};Object.defineProperty(N,"__esModule",{value:!0})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(U){function N(V,T,R,P=!0){if(0!==T%4||0!==R%4){var K=new ArrayBuffer(4*Math.ceil(R/4));K=new Uint8Array(K);V=new Uint8Array(V,T,R);if(P)for(P=
0;P<K.length;P+=4)K[P]=V[P+3],K[P+1]=V[P+2],K[P+2]=V[P+1],K[P+3]=V[P];else K.set(V);return new Uint32Array(K.buffer)}if(P){P=new Uint8Array(V,T,R);K=new Uint8Array(P.length);for(V=0;V<K.length;V+=4)K[V]=P[V+3],K[V+1]=P[V+2],K[V+2]=P[V+1],K[V+3]=P[V];return new Uint32Array(K.buffer)}return new Uint32Array(V,T,R/4)}function H(){const V=[];for(let T=0;257>=T;T++)V[T]=[T];return V}function J(V,T){for(let R=0;R<T.length;R++)V.push(T[R])}const w=new Set;w.add(511);w.add(1023);w.add(2047);w.add(4095);w.add(8191);
U.decode=function(V,T,R,P=!0){V=N(V,T,R,P);T=9;P=H();let K=32,q=P.length,m=[],u=1,I=V[0],E=0;const L=V.length;R=8*(4*L-R);const c=[];for(;null!=I;){if(K>=T)K-=T,E=I>>>32-T,I<<=T;else{E=I>>>32-K;I=V[u++];var v=T-K;K=32-v;E=(E<<v)+(I>>>K);I<<=v}if(257===E)break;if(256===E)T=9,P=H(),q=P.length,m=[];else{v=P[E];if(null==v){if(E>P.length)throw"data integrity issue: code does not exist on code page";m.push(m[0]);P[q++]=m.slice();J(c,m)}else J(c,v),m.push(v[0]),1<m.length&&(P[q++]=m.slice()),m=v.slice();
w.has(q)&&T++;0===K&&(I=V[u++],K=32);if(u>L||u===L&&K<=R)break}}return new Uint8Array(c)};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const U=function(N){let H=1;switch(N){case Uint8Array:case Int8Array:H=1;break;case Uint16Array:case Int16Array:H=2;break;case Uint32Array:case Int32Array:case Float32Array:H=4;break;case Float64Array:H=8}return H};return function(){function N(){}N.decode=function(H,J){var w=J.pixelType;const V=
[],T=J.width*J.height;var R=Math.floor(H.byteLength/(J.width*J.height*U(J.pixelType)));const {bandIds:P,format:K}=J;J=P&&P.length||Math.floor(H.byteLength/(J.width*J.height*U(J.pixelType)));var q=H.byteLength-H.byteLength%(T*U(w));const m=new w(H,0,T*R);let u,I;let E,L;if("bip"===K)for(u=0;u<J;u++){E=new w(T);L=P?P[u]:u;for(I=0;I<T;I++)E[I]=m[I*R+L];V.push(E)}else if("bsq"===K)for(u=0;u<J;u++)L=P?P[u]:u,V.push(m.subarray(L*T,(L+1)*T));if(q<H.byteLength-1)if(H=H.slice(q),8*H.byteLength<T)var c=null;
else{H=new Uint8Array(H,0,Math.ceil(T/8));w=new Uint8Array(T);for(J=q=J=c=R=0;J<H.length-1;J++)for(c=H[J],q=7;0<=q;q--)w[R++]=c>>q&1;for(q=7;R<T-1;)c=H[H.length-1],w[R++]=c>>q&1,q--;c=w}return{pixels:V,mask:c}};return N}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(U,N,H,J,w,V,T,R,P){function K(C,
e){let t="unknown";3===C?t="f32":1===C?1===e?t="u1":2===e?t="u2":4===e?t="u4":8>=e?t="u8":16>=e?t="u16":32>=e&&(t="u32"):2===C&&(8>=e?t="s8":16>=e?t="s16":32>=e&&(t="s32"));return t}function q(C){let e=null;switch(C?C.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":e=Uint8Array;break;case "u16":e=Uint16Array;break;case "u32":e=Uint32Array;break;case "s8":e=Int8Array;break;case "s16":e=Int16Array;break;case "s32":e=Int32Array;break;default:e=Float32Array}return e}function m(C,e){return{x:e[0]*
C.x+e[1]*C.y+e[2],y:e[3]*C.x+e[4]*C.y+e[5]}}function u(C,e){var t;return null==(t=C.get(e))?void 0:t.values}function I(C,e){var t;return null==(t=C.get(e))?void 0:t.values}function E(C,e){var t;return null==(t=C.get(e))?void 0:t.values[0]}function L(C,e){var t;return null==(t=C.get(e))?void 0:t.values[0]}function c(C,e,t,z=0,G=T.TIFF_TAGS,O=4){var S=8===O;const X=S?l(new DataView(C,t,8),0,e):(new DataView(C,t,2)).getUint16(0,e),W=4+2*O;var Y=S?8:2;S=Y+X*W;if(t+S>C.byteLength)return{success:!1,ifd:null,
nextIFD:null,requiredBufferSize:S};const aa=t+S+4<=C.byteLength?h(new DataView(C,t+S,8===O?8:4),0,e,8===O):null;t+=Y;Y=new Map;let Q,Z,ba,ca,da;for(let fa=0;fa<X;fa++){var ea=new DataView(C,t+W*fa,W);Q=ea.getUint16(0,e);ba=ea.getUint16(2,e);Z=T.getTagName(Q,G);const ia=[];2===O?(ca=ea.getUint16(4,e),da=ea.getUint16(6,e)):4===O?(ca=ea.getUint32(4,e),da=ea.getUint32(8,e)):8===O&&(ca=h(ea,4,e,!0),da=h(ea,12,e,!0),ia.push(ea.getUint32(12,e)),ia.push(ea.getUint32(16,e)));ea={id:Q,type:ba,valueCount:ca,
valueOffset:da,valueOffsets:ia,values:null};B(C,e,ea,z,!1,O);Y.set(Z,ea)}return{success:!0,ifd:Y,nextIFD:aa,requiredBufferSize:S}}function v(C,e,t,z,G){return F.apply(this,arguments)}function F(){F=N._asyncToGenerator(function*(C,e,t,z,G){var O,S,X=R.isPlatformLittleEndian===e,W=L(t,"BITSPERSAMPLE");const Y=null!=(O=L(t,"SAMPLEFORMAT"))?O:1;O=K(Y,W);W=null!=(S=L(t,"COMPRESSION"))?S:1;S=q(O);if(34887===W)return yield w.load(),w.decode(C,{inputOffset:z}).pixels[0];if(1===W){var aa=C.slice(z,z+G);var Q=
new Uint8Array(aa)}else if(8===W||32946===W)Q=new Uint8Array(C,z,G),Q=new P.Zlib(Q),C=Q.getBytes(),aa=new ArrayBuffer(C.length),Q=new Uint8Array(aa),Q.set(C);else if(6===W)Q=new Uint8Array(C,z,G),aa=new J.JpegImage,aa.parse(Q),C=aa.getData(aa.width,aa.height,!0),aa=new ArrayBuffer(C.length),Q=new Uint8Array(aa),Q.set(C);else if(7===W){e=t.get("JPEGTABLES").values;aa=e.length-2;Q=new Uint8Array(aa+G-2);for(t=0;t<aa;t++)Q[t]=e[t];C=new Uint8Array(C,z+2,G-2);for(z=0;z<C.length;z++)Q[aa+z]=C[z];aa=new J.JpegImage;
aa.parse(Q);C=aa.getData(aa.width,aa.height,!0);aa=new ArrayBuffer(C.length);Q=new Uint8Array(aa);Q.set(C)}else 5===W&&(Q=V.decode(C,z,G,e),aa=Q.buffer);if("u8"!==O&&"s8"!==O&&!X)switch(aa=new ArrayBuffer(Q.length),X=new Uint8Array(aa),O){case "u16":case "s16":for(O=0;O<Q.length;O+=2)X[O]=Q[O+1],X[O+1]=Q[O];break;case "u32":case "s32":case "f32":for(O=0;O<Q.length;O+=4)X[O]=Q[O+3],X[O+1]=Q[O+2],X[O+2]=Q[O+1],X[O+3]=Q[O]}return new S(aa)});return F.apply(this,arguments)}function x(C,e,t){return A.apply(this,
arguments)}function A(){A=N._asyncToGenerator(function*(C,e,t){var z;const G=I(t,"TILEOFFSETS");if(void 0===G)return null;const O=I(t,"TILEBYTECOUNTS"),{width:S,height:X,pixelType:W,tileWidth:Y,tileHeight:aa}=y([t]);var Q=b(t,e);const Z=e.planes;var ba=S*X,ca=L(t,"BITSPERSAMPLE"),da=34887===(null!=(z=L(t,"COMPRESSION"))?z:1),ea=q(W);z=[];for(var fa=0;fa<Z;fa++)z.push(new ea(ba));let ia,ha,la,ja,ka,pa,na,ma;ba=Math.ceil(S/Y);if(0===ca%8)if(da&&Q&&1<Z)for(Q=Math.round(G.length/Z),ca=0;ca<Q;ca++){var oa=
Math.floor(ca/ba)*aa;la=ca%ba*Y;ea=oa*S+la;for(da=0;da<Z;da++)for(fa=ca*Z+da,fa=yield v(C,e.littleEndian,t,G[fa],O[fa]),ka=0,ja=ea,na=Math.min(Y,S-la),pa=Math.min(aa,X-oa),ma=z[da],ia=0;ia<pa;ia++)for(ja=ea+ia*S,ka=ia*Y,ha=0;ha<na;ha++,ja++,ka++)ma[ja]=fa[ka]}else for(ca=0;ca<G.length;ca++)for(oa=Math.floor(ca/ba)*aa,la=ca%ba*Y,ea=oa*S+la,fa=yield v(C,e.littleEndian,t,G[ca],O[ca]),ka=0,ja=ea,na=Math.min(Y,S-la),pa=Math.min(aa,X-oa),oa=0;oa<Z;oa++)if(ma=z[oa],Q||da)for(ia=0;ia<pa;ia++)for(ja=ea+ia*
S,ka=Y*aa*oa+ia*Y,ha=0;ha<na;ha++,ja++,ka++)ma[ja]=fa[ka];else for(ia=0;ia<pa;ia++)for(ja=ea+ia*S,ka=ia*Y*Z+oa,ha=0;ha<na;ha++,ja++,ka+=Z)ma[ja]=fa[ka];return{width:S,height:X,pixelType:W,pixels:z}});return A.apply(this,arguments)}function B(C,e,t,z=0,G=!1,O=4){if(t.values)return!0;var S=t.type,X=t.valueCount,W=t.valueOffset;let Y=[];var aa=a[S],Q=8*aa,Z=X*aa,ba=X*a[S]*8,ca=8===O?64:32;O=t.valueOffsets;if(ba>ca&&Z>(G?C.byteLength:C?C.byteLength-W+z:0))return t.offlineOffsetSize=[W,Z],t.values=null,
!1;if(ba<=ca)if(e||(32>=ca?W>>>=32-ba:(C=null!=O&&O.length?O[0]:W>>>0,e=null!=O&&O.length?O[1]:Math.round((W-C)/4294967296),32>=ba?(W=C>>>32-ba,O[0]=W):(W=C*2**(32-ba)+(e>>>32-ba),O[0]=C,O[1]=e>>>32-ba))),1===X&&Q===ca)Y=[W];else if(64===ca)for(C=null!=O&&O.length?O[0]:W>>>0,W=null!=O&&O.length?O[1]:Math.round((W-C)/4294967296),e=C,aa=32,C=1;C<=X;C++)Z=32-Q*C%32,aa<Q?(Z=e<<Z>>>32-aa,ba=W<<32-aa>>>32-aa,e=W,Y.push(Z+ba*2**(Q-aa)),aa-=32-(Q-aa)):(Y.push(e<<Z>>>32-Q),aa-=Q),0===aa&&(aa=32,e=W);else for(C=
1;C<=X;C++)Y.push(W<<32-Q*C>>>32-Q);else for(W-=z,G&&(W=0),X=W;X<W+Z;X+=aa){switch(S){case 1:Q=(new DataView(C,X,1)).getUint8(0);break;case 2:Q=(new DataView(C,X,1)).getUint8(0);break;case 3:Q=(new DataView(C,X,2)).getUint16(0,e);break;case 4:case 13:Q=(new DataView(C,X,4)).getUint32(0,e);break;case 5:Q=(new DataView(C,X,4)).getUint32(0,e)/(new DataView(C,X+4,4)).getUint32(0,e);break;case 6:Q=(new DataView(C,X,1)).getInt8(0);break;case 7:Q=(new DataView(C,X,1)).getUint8(0);break;case 8:Q=(new DataView(C,
X,2)).getInt16(0,e);break;case 9:Q=(new DataView(C,X,4)).getInt32(0,e);break;case 10:Q=(new DataView(C,X,4)).getInt32(0,e)/(new DataView(C,X+4,4)).getInt32(0,e);break;case 11:Q=(new DataView(C,X,4)).getFloat32(0,e);break;case 12:Q=(new DataView(C,X,8)).getFloat64(0,e);break;case 16:case 18:Q=l(new DataView(C,X,8),0,e);break;case 17:O=new DataView(C,X,8);ba=(Q=e)?O.getInt32(0,Q):O.getUint32(0,Q);O=Q?O.getUint32(4,Q):O.getInt32(4,Q);ca=0<=(Q?ba:O)?1:-1;Q?ba*=ca:O*=ca;Q=ca*(Q?4294967296*O+ba:4294967296*
ba+O);break;default:Q=null}Y.push(Q)}if(2===S){S="";W=Y;Y=[];for(C=0;C<W.length;C++)0===W[C]&&""!==S?(Y.push(S),S=""):S+=String.fromCharCode(W[C]);""===S&&0!==Y.length||Y.push(S)}t.values=Y;return!0}function y(C){var e,t,z=C[0];const G=L(z,"TILEWIDTH"),O=L(z,"TILELENGTH"),S=L(z,"IMAGEWIDTH"),X=L(z,"IMAGELENGTH");var W=L(z,"BITSPERSAMPLE");const Y=L(z,"SAMPLESPERPIXEL");var aa=null!=(e=L(z,"SAMPLEFORMAT"))?e:1;e=K(aa,W);const Q=b(z);var Z=u(z,"GDAL_NODATA");let ba;null!=Z&&Z.length&&(ba=Z.map(ma=>
parseFloat(ma)),ba.some(ma=>isNaN(ma))&&(ba=null));var ca=null!=(t=L(z,"COMPRESSION"))?t:1;switch(ca){case 1:t="NONE";break;case 2:case 3:case 4:case 32771:t="CCITT";break;case 5:t="LZW";break;case 6:case 7:t="JPEG";break;case 32773:t="PACKBITS";break;case 8:case 32946:t="DEFLATE";break;case 34712:t="JPEG2000";break;case 34887:t="LERC";break;default:t=String(ca)}Z=!0;let da="";r.has(ca)||(Z=!1,da+="unsupported tag compression "+ca);3<aa&&(Z=!1,da+="unsupported tag sampleFormat "+aa);0!==W%8&&(Z=!1,
da+="unsupported tag bitsPerSample "+W);W=E(z,"GEOASCIIPARAMS");if(W){var ea=(ea=W.split("|").find(ma=>-1<ma.indexOf("ESRI PE String \x3d ")))?ea.replace("ESRI PE String \x3d ",""):"";ea=ea.startsWith("COMPD_CS")||ea.startsWith("PROJCS")||ea.startsWith("GEOGCS")?{wkid:null,wkt:ea}:null}aa=I(z,"GEOTIEPOINTS");W=I(z,"GEOPIXELSCALE");ca=I(z,"GEOTRANSMATRIX");var fa=z.has("GEOKEYDIRECTORY")?z.get("GEOKEYDIRECTORY").data:null;z=!1;if(fa){z=2===L(fa,"GTRasterTypeGeoKey");var ia=L(fa,"GTModelTypeGeoKey");
2===ia?(fa=L(fa,"GeographicTypeGeoKey"),1024<=fa&&32766>=fa&&(ea={wkid:fa})):1===ia&&(fa=L(fa,"ProjectedCSTypeGeoKey"),1024<=fa&&32766>=fa&&(ea={wkid:fa}))}let ha;W&&aa&&6<=aa.length?(ha=[W[0],0,aa[3]-aa[0]*W[0],0,-Math.abs(W[1]),aa[4]-aa[1]*W[1]],z&&(ha[2]-=.5*ha[0]+.5*ha[1],ha[5]-=.5*ha[3]+.5*ha[4])):ca&&16===ca.length&&(ha=z?[ca[0],ca[1],ca[3]-.5*ca[0],ca[4],ca[5],ca[7]-.5*ca[5]]:[ca[0],ca[1],ca[3],ca[4],ca[5],ca[7]]);if(ha){z=[{x:0,y:X},{x:0,y:0},{x:S,y:X},{x:S,y:0}];fa=ca=Number.POSITIVE_INFINITY;
let ma=ia=Number.NEGATIVE_INFINITY;for(let oa=0;oa<z.length;oa++)aa=m(z[oa],ha),ca=aa.x>ca?ca:aa.x,ia=aa.x<ia?ia:aa.x,fa=aa.y>fa?fa:aa.y,ma=aa.y<ma?ma:aa.y;ea={xmin:ca,xmax:ia,ymin:fa,ymax:ma,spatialReference:ea}}else ea={xmin:-.5,ymin:.5-X,xmax:S-.5,ymax:.5,spatialReference:ea};z=C.filter(ma=>1===E(ma,"NEWSUBFILETYPE"));let la,ja,ka;if(0<z.length){la=Math.round(Math.log(S/L(z[0],"IMAGEWIDTH"))/Math.LN2);var pa=z[z.length-1];ja=Math.round(Math.log(S/L(pa,"IMAGEWIDTH"))/Math.LN2);ka=L(pa,"TILEWIDTH");
pa=L(pa,"TILELENGTH")}ka=0<ja?ka||G:null;pa=0<ja?pa||O:null;let na;G&&(na=[{maxCol:Math.ceil(S/G)-1,maxRow:Math.ceil(X/O)-1,minRow:0,minCol:0}],z.forEach(ma=>{na.push({maxCol:Math.ceil(L(ma,"IMAGEWIDTH")/L(ma,"TILEWIDTH"))-1,maxRow:Math.ceil(L(ma,"IMAGELENGTH")/L(ma,"TILELENGTH"))-1,minRow:0,minCol:0})}));z=E(C[0],"GDAL_METADATA");z=M(z);da+=" "+n({width:S,height:X,tileWidth:G,tileHeight:O,planes:Y,ifds:C});return{width:S,height:X,tileWidth:G,tileHeight:O,planes:Y,isBSQ:Q,pixelType:e,compression:t,
noData:ba,isSupported:Z,message:da,extent:ea,affine:W?null:ha,firstPyramidLevel:la,maximumPyramidLevel:ja,pyramidBlockWidth:ka,pyramidBlockHeight:pa,tileBoundary:na,metadata:z}}function b(C,e){return(C=u(C,"PLANARCONFIGURATION"))?2===C[0]:e?e.isBSQ:!1}function d(C){const {littleEndian:e,isBigTiff:t,firstIFD:z}=g(C);var G=z;const O=[];do if(G=p(C,e,G,0,T.TIFF_TAGS,t?8:4),G.success)O.push(G.ifd),G=G.nextIFD;else break;while(0<G);return{...y(O),littleEndian:e,isBigTiff:t,ifds:O}}function l(C,e,t){const z=
C.getUint32(e,t);C=C.getUint32(e+4,t);return t?4294967296*C+z:4294967296*z+C}function h(C,e,t,z){return z?l(C,e,t):C.getUint32(e,t)}function g(C){var e=new DataView(C,0,16),t=e.getUint16(0,!1);C=null;if(18761===t)C=!0;else if(19789===t)C=!1;else throw"unexpected endianess byte";var z=e.getUint16(2,C);if(42!==z&&43!==z)throw"unexpected tiff identifier";t=4;if(z=43===z){const G=e.getUint16(t,C);t+=2;if(8!==G)throw"unsupported bigtiff version";if(0!==e.getUint16(t,C))throw"unsupported bigtiff version";
t+=2}e=h(e,t,C,z);return{littleEndian:C,isBigTiff:z,firstIFD:e}}function p(C,e,t,z=0,G=T.TIFF_TAGS,O=4){t=c(C,e,t,z,G,O);let S;const X=t.ifd;X&&(T.ifdTags.forEach((W,Y)=>{X.has(Y)&&(S=X.get(Y),S.data=c(C,e,S.valueOffset-z,z,W).ifd)}),X.has("GEOKEYDIRECTORY")&&(S=X.get("GEOKEYDIRECTORY"),(G=S.values)&&4<G.length&&(G=G[0]+"."+G[1]+"."+G[2],S.data=c(C,e,S.valueOffset+6-z,z,T.GEO_KEYS,2).ifd,S.data&&S.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[G]}))),X.has("XMP")&&(S=
X.get("XMP"),G=S.values,"number"===typeof G[0]&&7===S.type&&(S.values=[H.bytesToUTF8(new Uint8Array(G))])));return t}function n(C){const {width:e,height:t,tileHeight:z,tileWidth:G}=C,O=C.planes,S=G?G*z:e*t;C=L(C.ifds[0],"BITSPERSAMPLE");let X="";S*O>2**30/(8<C?C/8:1)&&(X=G?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return X}function f(){f=N._asyncToGenerator(function*(C,e){var t;const {headerInfo:z,ifd:G,offsets:O,sizes:S}=e;
var X=[];for(var W=0;W<O.length;W++){var Y=yield v(C,z.littleEndian,G,O[W],S[W]||C.byteLength);X.push(Y)}var aa=b(G,z);const {pixelType:Q,planes:Z}=z;var ba=q(Q);C=L(G,"TILEWIDTH");W=L(G,"TILELENGTH");var ca=null!=(t=L(G,"COMPRESSION"))?t:1;t=C*W;Y=[];let da=X[0];const ea=34887===ca;for(let ha=0;ha<Z;ha++){ca=new ba(t);if(aa&&ea){da=X[ha];for(var fa=0;fa<t;fa++)ca[fa]=da[ha][fa+ha]}else if(aa||ea&&!aa)ca=da.slice(t*ha,t*(ha+1));else for(fa=0;fa<t;fa++)ca[fa]=da[fa*Z+ha];Y.push(ca)}X=z.noData?z.noData[0]:
null;aa=(ba=z.metadata?z.metadata.statistics:null)?ba.map(ha=>ha.min):null;ba=ba?ba.map(ha=>ha.max):null;let ia;if(null!=X)if(ia=new Uint8Array(t),1E24<Math.abs(X))for(e=0;e<t;e++)ia[e]=1E-6>Math.abs((Y[0][e]-X)/X)?0:1;else for(e=0;e<t;e++)ia[e]=Y[0][e]===X?0:1;else aa&&ba&&e.applyMinMaxConstraint&&(ia=D(Y,aa,ba));return{pixelType:Q,width:C,height:W,pixels:Y,mask:ia,noDataValue:X}});return f.apply(this,arguments)}function k(){k=N._asyncToGenerator(function*(C,e=0,t){t=t||d(C);const {ifds:z,noData:G}=
t;if(0===z.length)throw"no valid image file directory";var O=n(t);if(O)throw O;var S=-1===e?z[z.length-1]:z[e];e=G?G[0]:null;if(t.tileWidth)t=yield x(C,t,S);else{{var X=t,W;const pa=R.isPlatformLittleEndian===X.littleEndian,na=I(S,"STRIPOFFSETS");if(void 0===na)C=null;else{var {width:Y,height:aa,pixelType:Q}=y([S]);t=X.planes;O=Y*aa;var Z=L(S,"BITSPERSAMPLE"),ba=q(Q),ca=new ba(O*t),da=I(S,"STRIPBYTECOUNTS"),ea=L(S,"ROWSPERSTRIP");S=null!=(W=L(S,"COMPRESSION"))?W:1;var fa=ea;if(0===Z%8)for(W=0;W<na.length;W++){var ia=
W*ea*Y*t;fa=(W+1)*ea>aa?aa-W*ea:ea;if("u8"===Q||"s8"===Q||pa)if(8===S||32946===S){var ha=new Uint8Array(C,na[W],da[W]);ha=new P.Zlib(ha);var la=ha.getBytes();var ja=new ArrayBuffer(la.length);ha=new Uint8Array(ja);ha.set(la);ha.length!==fa*Y*t*Z/8&&console.log("strip byte counts is different than expected")}else 6===S?(ha=new Uint8Array(C,na[W],da[W]),ja=new J.JpegImage,ja.parse(ha),fa=ja.getData(ja.width,ja.height,!0),ja=new ArrayBuffer(fa.length),ha=new Uint8Array(ja),ha.set(fa)):5===S?(ha=V.decode(C,
na[W],da[W],X.littleEndian),ja=ha.buffer):1===S&&(da[W]!==fa*Y*t*Z/8&&console.log("strip byte counts is different than expected"),ja=C.slice(na[W],na[W]+da[W]));else{if(6===S||8===S||32946===S){ha=new Uint8Array(C,na[W],da[W]);ha=new P.Zlib(ha);ha=ha.getBytes();ja=new ArrayBuffer(ha.length);var ka=new Uint8Array(ja);ha.length!==fa*Y*t*Z/8&&console.log("strip byte counts is different than expected")}else 1===S&&(da[W]!==fa*Y*t*Z/8&&console.log("strip byte counts is different than expected"),ja=new ArrayBuffer(da[W]),
ha=new Uint8Array(C,na[W],da[W]),ka=new Uint8Array(ja));switch(Q){case "u16":case "s16":for(fa=0;fa<ha.length;fa+=2)ka[fa]=ha[fa+1],ka[fa+1]=ha[fa];break;case "u32":case "s32":case "f32":for(fa=0;fa<ha.length;fa+=4)ka[fa]=ha[fa+3],ka[fa+1]=ha[fa+2],ka[fa+2]=ha[fa+1],ka[fa+3]=ha[fa]}}fa=new ba(ja);ca.set(fa,ia)}ha=[];if(1===t)ha.push(ca);else for(W=0;W<t;W++){ka=new ba(O);for(C=0;C<O;C++)ka[C]=ca[C*t+W];ha.push(ka)}C={width:Y,height:aa,pixelType:Q,pixels:ha}}}t=yield C}if(null!==e){t.mask=new Uint8Array(t.width*
t.height);if(1E24<Math.abs(e))for(C=0;C<t.width*t.height;C++)t.mask[C]=1E-6>Math.abs((t.pixels[0][C]-e)/e)?0:1;else for(C=0;C<t.width*t.height;C++)t.mask[C]=t.pixels[0][C]===e?0:1;t.noDataValue=e}return t});return k.apply(this,arguments)}const a=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],r=new Set([1,5,6,7,8,34712,34887]),D=function(C,e,t){if(!(C&&0<C.length&&e&&t))return null;let z,G,O;const S=C[0].length,X=C.length,W=new Uint8Array(S);for(let aa=0;aa<X;aa++)if(z=C[aa],G=e[aa],O=t[aa],0===aa)for(var Y=
0;Y<S;Y++)W[Y]=z[Y]<G||z[Y]>O?0:1;else for(Y=0;Y<S;Y++)W[Y]&&(W[Y]=z[Y]<G||z[Y]>O?0:1);return W},M=function(C){if(!C)return null;var e=C.match(/<Item(.*?)Item>/gi);if(!e||0===e.length)return null;C=new Map;var t;for(var z=0;z<e.length;z++){var G=e[z];var O=G.slice(6,G.indexOf("\x3e"));var S=G.indexOf("sample\x3d");-1<S&&(t=G.slice(S+8,G.indexOf('"',S+8)));S=G.indexOf("name\x3d");-1<S&&(O=G.slice(S+6,G.indexOf('"',S+6)));O&&(G=G.slice(G.indexOf("\x3e")+1,G.indexOf("\x3c/Item\x3e")).trim(),null!=t?
C.has(O)?C.get(O)[t]=G:C.set(O,[G]):C.set(O,G));t=null}e=C.get("STATISTICS_MINIMUM");O=C.get("STATISTICS_MAXIMUM");z=C.get("STATISTICS_MEAN");G=C.get("STATISTICS_STDDEV");t=null;if(e&&O)for(t=[],S=0;S<e.length;S++)t.push({min:parseFloat(e[S]),max:parseFloat(O[S]),avg:z&&parseFloat(z[S]),stddev:G&&parseFloat(G[S])});O=C.get("BandName");z=C.get("WavelengthMin");G=C.get("WavelengthMax");e=null;if(O)for(e=[],S=0;S<O.length;S++)e.push({BandName:O[S],WavelengthMin:z&&parseFloat(z[S]),WavelengthMax:G&&parseFloat(G[S])});
O=C.get("DataType");return{statistics:t,bandProperties:e,dataType:O,rawMetadata:C}};U.decode=function(C){return k.apply(this,arguments)};U.decodeTileOrStrip=function(C,e){return f.apply(this,arguments)};U.getImageInfo=y;U.isBSQConfig=b;U.parseFieldValues=B;U.parseHeader=d;U.parseIFD=p;U.parseSignature=g;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(U){U.bytesToUTF8=function(N,H){let J=0,w="",V=0,T=0;
const R=N.length;for(;J<R;)if(T=N[J++],V=T>>4,8>V?V=1:15===V?(V=4,T=(T&7)<<18|(N[J++]&63)<<12|(N[J++]&63)<<6|N[J++]&63):14===V?(V=3,T=(T&15)<<12|(N[J++]&63)<<6|N[J++]&63):(V=2,T=(T&31)<<6|N[J++]&63),0!==T||H)w+=String.fromCharCode(T);return w};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const U=(()=>{const w=[];w[254]="NEWSUBFILETYPE";w[255]="SUBFILETYPE";w[256]="IMAGEWIDTH";w[257]="IMAGELENGTH";w[258]="BITSPERSAMPLE";
w[259]="COMPRESSION";w[262]="PHOTOMETRICINTERPRETATION";w[263]="THRESHHOLDING";w[264]="CELLWIDTH";w[265]="CELLLENGTH";w[266]="FILLORDER";w[269]="DOCUMENTNAME";w[270]="IMAGEDESCRIPTION";w[271]="MAKE";w[272]="MODEL";w[273]="STRIPOFFSETS";w[274]="ORIENTATION";w[277]="SAMPLESPERPIXEL";w[278]="ROWSPERSTRIP";w[279]="STRIPBYTECOUNTS";w[280]="MINSAMPLEVALUE";w[281]="MAXSAMPLEVALUE";w[282]="XRESOLUTION";w[283]="YRESOLUTION";w[284]="PLANARCONFIGURATION";w[285]="PAGENAME";w[286]="XPOSITION";w[287]="YPOSITION";
w[288]="FREEOFFSETS";w[289]="FREEBYTECOUNTS";w[290]="GRAYRESPONSEUNIT";w[291]="GRAYRESPONSECURVE";w[292]="T4OPTIONS";w[293]="T6OPTIONS";w[296]="RESOLUTIONUNIT";w[297]="PAGENUMBER";w[300]="COLORRESPONSEUNIT";w[301]="TRANSFERFUNCTION";w[305]="SOFTWARE";w[306]="DATETIME";w[315]="ARTIST";w[316]="HOSTCOMPUTER";w[317]="PREDICTOR";w[318]="WHITEPOINT";w[319]="PRIMARYCHROMATICITIES";w[320]="COLORMAP";w[321]="HALFTONEHINTS";w[322]="TILEWIDTH";w[323]="TILELENGTH";w[324]="TILEOFFSETS";w[325]="TILEBYTECOUNTS";
w[326]="BADFAXLINES";w[327]="CLEANFAXDATA";w[328]="CONSECUTIVEBADFAXLINES";w[330]="SUBIFD";w[332]="INKSET";w[333]="INKNAMES";w[334]="NUMBEROFINKS";w[336]="DOTRANGE";w[337]="TARGETPRINTER";w[338]="EXTRASAMPLES";w[339]="SAMPLEFORMAT";w[340]="SMINSAMPLEVALUE";w[341]="SMAXSAMPLEVALUE";w[342]="TRANSFERRANGE";w[347]="JPEGTABLES";w[512]="JPEGPROC";w[513]="JPEGIFOFFSET";w[514]="JPEGIFBYTECOUNT";w[515]="JPEGRESTARTINTERVAL";w[517]="JPEGLOSSLESSPREDICTORS";w[518]="JPEGPOINTTRANSFORM";w[519]="JPEGQTABLES";w[520]=
"JPEGDCTABLES";w[521]="JPEGACTABLES";w[529]="YCBCRCOEFFICIENTS";w[530]="YCBCRSUBSAMPLING";w[531]="YCBCRPOSITIONING";w[532]="REFERENCEBLACKWHITE";w[700]="XMP";w[33550]="GEOPIXELSCALE";w[33922]="GEOTIEPOINTS";w[33432]="COPYRIGHT";w[42112]="GDAL_METADATA";w[42113]="GDAL_NODATA";w[50844]="RPCCOEFFICIENT";w[34264]="GEOTRANSMATRIX";w[34735]="GEOKEYDIRECTORY";w[34736]="GEODOUBLEPARAMS";w[34737]="GEOASCIIPARAMS";w[34665]="EXIFIFD";w[34853]="GPSIFD";w[40965]="INTEROPERABILITYIFD";return w})(),N=(()=>{const w=
[].concat(U);w[36864]="ExifVersion";w[40960]="FlashpixVersion";w[40961]="ColorSpace";w[42240]="Gamma";w[37121]="ComponentsConfiguration";w[37122]="CompressedBitsPerPixel";w[40962]="PixelXDimension";w[40963]="PixelYDimension";w[37500]="MakerNote";w[37510]="UserComment";w[40964]="RelatedSoundFile";w[36867]="DateTimeOriginal";w[36868]="DateTimeDigitized";w[36880]="OffsetTime";w[36881]="OffsetTimeOriginal";w[36882]="OffsetTimeDigitized";w[37520]="SubSecTime";w[37521]="SubSecTimeOriginal";w[37522]="SubSecTimeDigitized";
w[37888]="Temperature";w[37889]="Humidity";w[37890]="Pressure";w[37891]="WaterDepth";w[37892]="Acceleration";w[37893]="CameraElevationAngle";w[42016]="ImageUniqueID";w[42032]="CameraOwnerName";w[42033]="BodySerialNumber";w[42034]="LensSpecification";w[42035]="LensMake";w[42036]="LensModel";w[42037]="LensSerialNumber";w[33434]="ExposureTime";w[33437]="FNumber";w[34850]="ExposureProgram";w[34852]="SpectralSensitivity";w[34855]="PhotographicSensitivity";w[34856]="OECF";w[34864]="SensitivityType";w[34865]=
"StandardOutputSensitivity";w[34866]="RecommendedExposureIndex";w[34867]="ISOSpeed";w[34868]="ISOSpeedLatitudeyyy";w[34869]="ISOSpeedLatitudezzz";w[37377]="ShutterSpeedValue";w[37378]="ApertureValue";w[37379]="BrightnessValue";w[37380]="ExposureBiasValue";w[37381]="MaxApertureValue";w[37382]="SubjectDistance";w[37383]="MeteringMode";w[37384]="LightSource";w[37385]="Flash";w[37386]="FocalLength";w[37396]="SubjectArea";w[41483]="FlashEnergy";w[41484]="SpatialFrequencyResponse";w[41486]="FocalPlaneXResolution";
w[41487]="FocalPlaneYResolution";w[41488]="FocalPlaneResolutionUnit";w[41492]="SubjectLocation";w[41493]="ExposureIndex";w[41495]="SensingMethod";w[41728]="FileSource";w[41729]="SceneType";w[41730]="CFAPattern";w[41985]="CustomRendered";w[41986]="ExposureMode";w[41987]="WhiteBalance";w[41988]="DigitalZoomRatio";w[41989]="FocalLengthIn35mmFilm";w[41990]="SceneCaptureType";w[41991]="GainControl";w[41992]="Contrast";w[41993]="Saturation";w[41994]="Sharpness";w[41995]="DeviceSettingDescription";w[41996]=
"SubjectDistanceRange";return w})(),H=(()=>{const w=[];w[1024]="GTModelTypeGeoKey";w[1025]="GTRasterTypeGeoKey";w[1026]="GTCitationGeoKey";w[2048]="GeographicTypeGeoKey";w[2049]="GeogCitationGeoKey";w[2050]="GeogGeodeticDatumGeoKey";w[2051]="GeogPrimeMeridianGeoKey";w[2052]="GeogLinearUnitsGeoKey";w[2053]="GeogLinearUnitSizeGeoKey";w[2054]="GeogAngularUnitsGeoKey";w[2055]="GeogAngularUnitSizeGeoKey";w[2056]="GeogEllipsoidGeoKey";w[2057]="GeogSemiMajorAxisGeoKey";w[2058]="GeogSemiMinorAxisGeoKey";
w[2059]="GeogInvFlatteningGeoKey";w[2061]="GeogPrimeMeridianLongGeoKey";w[2060]="GeogAzimuthUnitsGeoKey";w[3072]="ProjectedCSTypeGeoKey";w[3073]="PCSCitationGeoKey";w[3074]="ProjectionGeoKey";w[3075]="ProjCoordTransGeoKey";w[3076]="ProjLinearUnitsGeoKey";w[3077]="ProjLinearUnitSizeGeoKey";w[3078]="ProjStdParallel1GeoKey";w[3079]="ProjStdParallel2GeoKey";w[3080]="ProjNatOriginLongGeoKey";w[3081]="ProjNatOriginLatGeoKey";w[3082]="ProjFalseEastingGeoKey";w[3083]="ProjFalseNorthingGeoKey";w[3084]="ProjFalseOriginLongGeoKey";
w[3085]="ProjFalseOriginLatGeoKey";w[3086]="ProjFalseOriginEastingGeoKey";w[3087]="ProjFalseOriginNorthingGeoKey";w[3088]="ProjCenterLongGeoKey";w[3090]="ProjCenterEastingGeoKey";w[3091]="ProjCenterNorthingGeoKey";w[3092]="ProjScaleAtNatOriginGeoKey";w[3093]="ProjScaleAtCenterGeoKey";w[3094]="ProjAzimuthAngleGeoKey";w[3095]="ProjStraightVertPoleLongGeoKey";w[4096]="VerticalCSTypeGeoKey";w[4097]="VerticalCitationGeoKey";w[4098]="VerticalDatumGeoKey";w[4099]="VerticalUnitsGeoKey";return w})(),J=new Map;
J.set("EXIFIFD",N);J.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:U,ifdTags:J,GEO_KEYS:H,getTagName:function(w,V){V=(V||U)[w];void 0===V&&(V="unknown"+String(w));return V}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(U){{var N=new ArrayBuffer(4);const H=new Uint8Array(N);(new Uint32Array(N))[0]=1;N=1===H[0]}U.isPlatformLittleEndian=N;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["../../../chunks/_rollupPluginBabelHelpers","./byteStreamUtils"],
function(U,N){function H(J){var w=J.fields;J=J.records;const V=w.some(q=>"oid"===q.name.toLowerCase())?"OBJECTID":"OID";w=[{name:V,type:"esriFieldTypeOID",alias:"OID"}].concat(w.map(q=>({name:q.name,type:"esriFieldType"+q.typeName,alias:q.name})));const T=w.map(q=>q.name),R=[];let P=0,K=0;J.forEach(q=>{const m={};m[V]=P++;for(K=1;K<T.length;K++)m[T[K]]=q[K-1];R.push({attributes:m})});return{displayFieldName:"",fields:w,features:R}}return function(){function J(){}J.parse=function(w){var V=new DataView(w),
T=V.getUint8(0)&3;if(3!==T)return{header:{version:T},recordSet:null};const R=V.getUint32(4,!0);var P=V.getUint16(8,!0);const K=V.getUint16(10,!0);P={version:T,recordCount:R,headerByteCount:P,recordByteCount:K};let q=32;const m=[],u=[];if(3===T){for(;13!==V.getUint8(q);)T=String.fromCharCode(V.getUint8(q+11)).trim(),m.push({name:N.bytesToUTF8(new Uint8Array(w,q,11)),type:T,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(T)],length:V.getUint8(q+16)}),q+=32;
q+=1;if(0<m.length)for(;u.length<R&&w.byteLength-q>K;){const I=[];32===V.getUint8(q)?(q+=1,m.forEach(E=>{if("C"===E.type)I.push(N.bytesToUTF8(new Uint8Array(w,q,E.length)).trim());else if("N"===E.type)I.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(w,q,E.length)).trim(),10));else if("F"===E.type)I.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(w,q,E.length)).trim()));else if("D"===E.type){const L=String.fromCharCode.apply(null,new Uint8Array(w,q,E.length)).trim();I.push(new Date(parseInt(L.substring(0,
4),10),parseInt(L.substring(4,6),10)-1,parseInt(L.substring(6,8),10)))}q+=E.length}),u.push(I)):q+=K}}V=H({fields:m,records:u});return{header:P,fields:m,records:u,recordSet:V}};U._createClass(J,null,[{key:"supportedVersions",get:function(){return[5]}}]);return J}()})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(U,N,H,J){const w={GCSShiftXform:N,IdentityXform:H,PolynomialXform:J},V=Object.keys(w);
U.isTransformSupported=function(T){const R=null==T?void 0:T.type;return!T||V.includes(R)};U.readTransform=function(T){if(null==T||!T.type)return null;var R=w[null==T?void 0:T.type];return R?(R=new R,R.read(T),R):null};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(U,N,H,J,w,V,T,R,P){J=function(K){function q(){var u=K.apply(this,arguments)||this;u.type="gcs-shift";u.tolerance=1E-8;return u}U._inheritsLoose(q,K);var m=q.prototype;m.forwardTransform=function(u){u=u.clone();if("point"===u.type)return u.x>180+this.tolerance&&(u.x-=360),u;u.xmin>=180-this.tolerance?(u.xmax-=360,u.xmin-=360):u.xmax>180+this.tolerance&&(u.xmin=-180,u.xmax=180);return u};m.inverseTransform=function(u){u=u.clone();if("point"===u.type)return u.x<-this.tolerance&&(u.x+=360),u;
u.xmin<-this.tolerance&&(u.xmin+=360,u.xmax+=360);return u};return q}(P);N.__decorate([T.enumeration({GCSShiftXform:"gcs-shift"})],J.prototype,"type",void 0);N.__decorate([H.property()],J.prototype,"tolerance",void 0);return J=N.__decorate([R.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],J)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(U,N,H,J,w,V,T,R){H=function(P){function K(){return P.apply(this,arguments)||this}U._inheritsLoose(K,P);var q=K.prototype;q.forwardTransform=function(m){return m};q.inverseTransform=function(m){return m};U._createClass(K,[{key:"affectsPixelSize",get:function(){return!1}}]);return K}(H.JSONSupport);N.__decorate([J.property()],H.prototype,"affectsPixelSize",null);N.__decorate([J.property({json:{write:!0}})],H.prototype,"spatialReference",void 0);return H=N.__decorate([R.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],
H)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/set ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(U,N,H,J,w,V,T,R,P,K){H=function(q){function m(){var u=q.apply(this,
arguments)||this;u.type="identity";return u}U._inheritsLoose(m,q);return m}(K);N.__decorate([R.enumeration({IdentityXform:"identity"})],H.prototype,"type",void 0);return H=N.__decorate([P.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],H)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I){function E(c,v,F){const {x,y:A}=v;if(2>F)return{x:c[0]+x*c[2]+A*c[4],y:c[1]+x*c[3]+A*c[5]};if(2===F){v=x*x;F=A*A;var B=x*A;return{x:c[0]+x*c[2]+A*c[4]+v*c[6]+B*c[8]+F*c[10],y:c[1]+x*c[3]+A*c[5]+v*c[7]+B*c[9]+F*c[11]}}v=x*x;F=A*A;B=x*A;const y=v*x,b=v*A,d=x*F,l=A*F;return{x:c[0]+x*c[2]+A*c[4]+v*c[6]+B*c[8]+F*c[10]+y*c[12]+b*c[14]+d*c[16]+l*c[18],y:c[1]+x*c[3]+A*c[5]+v*c[7]+B*c[9]+F*c[11]+y*c[13]+b*c[15]+d*c[17]+l*c[19]}}function L(c,v,F){const {xmin:x,ymin:A,xmax:B,
ymax:y,spatialReference:b}=v;v=[];if(2>F)v.push({x,y}),v.push({x:B,y}),v.push({x,y:A}),v.push({x:B,y:A});else{var d=10;for(var l=0;l<d;l++)v.push({x,y:A+(y-A)*l/(d-1)}),v.push({x:B,y:A+(y-A)*l/(d-1)});d=8;for(l=1;l<=d;l++)v.push({x:x+(B-x)*l/d,y:A}),v.push({x:x+(B-x)*l/d,y})}v=v.map(h=>E(c,h,F));d=v.map(h=>h.x);v=v.map(h=>h.y);return new I({xmin:Math.min.apply(null,d),xmax:Math.max.apply(null,d),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:b})}H=function(c){function v(){var x=
c.apply(this,arguments)||this;x.polynomialOrder=1;x.type="polynomial";return x}U._inheritsLoose(v,c);var F=v.prototype;F.readForwardCoefficients=function(x,A){const {coeffX:B,coeffY:y}=A;if(null==B||!B.length||null==y||!y.length||B.length!==y.length)return null;x=[];for(A=0;A<B.length;A++)x.push(B[A]),x.push(y[A]);return x};F.writeForwardCoefficients=function(x,A,B){B=[];const y=[];for(let b=0;b<(null==x?void 0:x.length);b++)0===b%2?B.push(x[b]):y.push(x[b]);A.coeffX=B;A.coeffY=y};F.readInverseCoefficients=
function(x,A){const {inverseCoeffX:B,inverseCoeffY:y}=A;if(null==B||!B.length||null==y||!y.length||B.length!==y.length)return null;x=[];for(A=0;A<B.length;A++)x.push(B[A]),x.push(y[A]);return x};F.writeInverseCoefficients=function(x,A,B){B=[];const y=[];for(let b=0;b<(null==x?void 0:x.length);b++)0===b%2?B.push(x[b]):y.push(x[b]);A.inverseCoeffX=B;A.inverseCoeffY=y};F.forwardTransform=function(x){if("point"===x.type){const A=E(this.forwardCoefficients,x,this.polynomialOrder);return new u({x:A.x,y:A.y,
spatialReference:x.spatialReference})}return L(this.forwardCoefficients,x,this.polynomialOrder)};F.inverseTransform=function(x){if("point"===x.type){const A=E(this.inverseCoefficients,x,this.polynomialOrder);return new u({x:A.x,y:A.y,spatialReference:x.spatialReference})}return L(this.inverseCoefficients,x,this.polynomialOrder)};U._createClass(v,[{key:"inverseCoefficients",get:function(){var x=this._get("inverseCoefficients"),A=this._get("forwardCoefficients");if(!x&&A&&2>this.polynomialOrder){{const [B,
y,b,d,l,h]=A;x=b*h-l*d;A=l*d-b*h;x=[(l*y-B*h)/x,(b*y-B*d)/A,h/x,d/A,-l/x,-b/A]}}return x},set:function(x){this._set("inverseCoefficients",x)}},{key:"affectsPixelSize",get:function(){return 0<this.polynomialOrder}}]);return v}(m);N.__decorate([J.property({json:{write:!0}})],H.prototype,"polynomialOrder",void 0);N.__decorate([J.property()],H.prototype,"forwardCoefficients",void 0);N.__decorate([P.reader("forwardCoefficients",["coeffX","coeffY"])],H.prototype,"readForwardCoefficients",null);N.__decorate([q.writer("forwardCoefficients")],
H.prototype,"writeForwardCoefficients",null);N.__decorate([J.property({json:{write:!0}})],H.prototype,"inverseCoefficients",null);N.__decorate([P.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],H.prototype,"readInverseCoefficients",null);N.__decorate([q.writer("inverseCoefficients")],H.prototype,"writeInverseCoefficients",null);N.__decorate([J.property()],H.prototype,"affectsPixelSize",null);N.__decorate([R.enumeration({PolynomialXform:"polynomial"})],H.prototype,"type",void 0);return H=
N.__decorate([K.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],H)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F){H=function(x){function A(){return x.apply(this,arguments)||this}U._inheritsLoose(A,x);var B=A.prototype;B.open=function(){var y=U._asyncToGenerator(function*(b){yield this.init();var d=yield this._fetchData(b);let {spatialReference:l,statistics:h,histograms:g,transform:p}=yield this._fetchAuxiliaryData(b);(b=!l)&&(l=new v({wkid:3857}));null!=g&&g.length&&null==h&&(h=L.estimateStatisticsFromHistograms(g));const {width:n,height:f}=d;let k=new F({xmin:-.5,
ymin:.5-f,xmax:n-.5,ymax:.5,spatialReference:l});const a=p?p.forwardTransform(k):k;var r=!0;p&&(r=(r=p.forwardCoefficients)&&0===r[1]&&0===r[2])&&(p=null,k=a);d=new u({data:{extent:a,nativeExtent:k,transform:p,pixelBlock:d,statistics:h,histograms:g,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:b}});yield d.open();this._set("rasterInfo",d.rasterInfo);this._inMemoryRaster=d});return function(b){return y.apply(this,arguments)}}();B.fetchRawTile=function(y,b,d,l={}){return this._inMemoryRaster.fetchRawTile(y,
b,d,l)};B._fetchData=function(){var y=U._asyncToGenerator(function*(b){({data:b}=yield this.request(this.url,{responseType:"array-buffer",signal:null==b?void 0:b.signal}));const d=E.getFormat(b).toUpperCase();if("JPG"===d||"PNG"===d||"GIF"===d||"BMP"===d)this._set("datasetFormat",d);else throw new J("image-aux-raster:open","the data is not a supported format");return yield this.decodePixelBlock(b,{format:"jpg",width:1,height:1,useCanvas:!0})});return function(b){return y.apply(this,arguments)}}();
B._fetchAuxiliaryData=function(){var y=U._asyncToGenerator(function*(b){var d,l;b=w.unwrap(null==b?void 0:b.signal);var h=null!=(d=this.ioConfig.skipExtensions)?d:[];d=-1<h.indexOf("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:b});var g=this.datasetFormat;g="JPG"===g?"jgw":"PNG"===g?"pgw":"BMP"===g?"bpw":null;h=-1<h.indexOf(g)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+g,{responseType:"text",signal:b});h=yield V.eachAlways([d,h]);if(null!=b&&b.aborted)throw V.createAbortError();
b=I.parsePAMInfo(null==(l=h[0].value)?void 0:l.data);b.transform||(l=h[1].value?h[1].value.data.split("\n").slice(0,6).map(p=>Number(p)):null,b.transform=6===(null==l?void 0:l.length)?new c({forwardCoefficients:[l[4],l[5],l[0],-l[1],l[2],-l[3]]}):null);return b});return function(b){return y.apply(this,arguments)}}();return A}(m);N.__decorate([T.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=N.__decorate([q.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],
H)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L){H=function(c){function v(){var x=c.apply(this,arguments)||this;x.datasetFormat="MEMORY";return x}U._inheritsLoose(v,c);var F=v.prototype;F.open=function(){var x=U._asyncToGenerator(function*(A){var B;yield this.init();const {pixelBlock:y,statistics:b,histograms:d,name:l,keyProperties:h,nativeExtent:g,transform:p}=this.data,{width:n,height:f,pixelType:k}=y,a=this.data.extent||new E({xmin:-.5,ymin:.5,xmax:n-.5,ymax:f-.5,spatialReference:new L({wkid:3857})}),
r=null!=(B=this.data.isPseudoSpatialReference)?B:!this.data.extent;B=new m({width:n,height:f,pixelType:k,extent:a,nativeExtent:g,transform:p,pixelSize:{x:a.width/n,y:a.height/f},spatialReference:a.spatialReference,bandCount:3,keyProperties:h||{},statistics:b,isPseudoSpatialReference:r,histograms:d});this.createRemoteDatasetStorageInfo(B,512,512);this._set("rasterInfo",B);this.updateTileInfo();yield this._buildInMemoryRaster(y,{width:512,height:512},A);this.datasetName=l;this.url="/InMemory/"+l});
return function(A){return x.apply(this,arguments)}}();F.fetchRawTile=function(x,A,B,y){x=this._pixelBlockTiles.get(`${x}/${A}/${B}`);return Promise.resolve(x)};F._buildInMemoryRaster=function(){var x=U._asyncToGenerator(function*(A,B,y){var b=this.rasterInfo.storageInfo.maximumPyramidLevel;const d=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:A,tileSize:B,maximumPyramidLevel:b},y):Promise.resolve(I.split(A,B,b));B=w.isSome(this.rasterInfo.statistics);b=w.isSome(this.rasterInfo.histograms);
A=B&&b?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:A},y):Promise.resolve(I.estimateStatisticsHistograms(A));A=yield V.eachAlways([d,A]);if(!A[0].value&&A[1].value)throw new J("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=A[0].value;if(!B){var l;this.rasterInfo.statistics=null==(l=A[1].value)?void 0:l.statistics}if(b){var h;this.rasterInfo.histograms=null==(h=A[1].value)?void 0:
h.histograms}});return function(A,B,y){return x.apply(this,arguments)}}();return v}(u);N.__decorate([T.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);N.__decorate([T.property()],H.prototype,"data",void 0);return H=N.__decorate([q.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],H)})},"esri/layers/support/rasterDatasets/pamParser":function(){define(["exports","../../../geometry","./xmlUtilities","../rasterTransforms/PolynomialTransform","../../../geometry/SpatialReference"],
function(U,N,H,J,w){function V(q,m){if(!q||!m)return null;const u=[];for(let I=0;I<q.length;I++)u.push(q[I]),u.push(m[I]);return u}function T(q){var m,u=H.getElement(q,"GeodataXform");q=H.getElementNumericValue(u,"SpatialReference/WKID")||H.getElementValue(u,"SpatialReference/WKT");q=P(q);if("typens:PolynomialXform"!==u.getAttribute("xsi:type"))return{spatialReference:q,transform:null};var I=null!=(m=H.getElementNumericValue(u,"PolynomialOrder"))?m:1,E=H.getElementNumericValues(u,"CoeffX/Double");
const L=H.getElementNumericValues(u,"CoeffY/Double");m=H.getElementNumericValues(u,"InverseCoeffX/Double");u=H.getElementNumericValues(u,"InverseCoeffY/Double");E=V(E,L);u=V(m,u);I=new J({spatialReference:q,polynomialOrder:I,forwardCoefficients:E,inverseCoefficients:u});return{spatialReference:q,transform:I}}function R(q){var m;const u=H.getElementNumericValue(q,"NoDataValue");var I=H.getElement(q,"Histograms/HistItem");const E=H.getElementNumericValue(I,"HistMin"),L=H.getElementNumericValue(I,"HistMax"),
c=H.getElementNumericValue(I,"BucketCount");I=null==(m=H.getElementValue(I,"HistCounts"))?void 0:m.split("|").map(B=>Number(B));let v,F,x,A;H.getElements(q,"Metadata/MDI").forEach(B=>{var y;const b=Number(null!=(y=B.textContent)?y:B.nodeValue);switch(B.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":v=b;break;case "STATISTICS_MAXIMUM":F=b;break;case "STATISTICS_MEAN":x=b;break;case "STATISTICS_STDDEV":A=b}});q=H.getElementNumericValue(q,"Metadata/SourceBandIndex");return{noDataValue:u,
histogram:null!=I&&I.length&&null!=v&&null!=F?{min:E,max:L,size:c||I.length,counts:I}:null,sourceBandIndex:q,statistics:null!=v&&null!=F?{min:v,max:F,avg:x,stddev:A}:null}}function P(q){if(!q)return null;var m=Number(q);if(!isNaN(m)&&0!==m)return new w({wkid:m});q=String(q);if(q.startsWith("COMPD_CS")){if(!q.includes("VERTCS")||!q.includes("GEOGCS")&&!q.startsWith("PROJCS"))return null;m=q.indexOf("VERTCS");var u=q.indexOf("PROJCS");u=-1<u?u:q.indexOf("GEOGCS");if(-1===u)return null;u=q.slice(u,q.lastIndexOf("]",
m)+1).trim();q=q.slice(m,q.lastIndexOf("]")).trim();m=(m=K(u))?new w({wkid:m}):new w({wkt:u});if(q=K(q))m.vcsWkid=q;return m}if(!q.startsWith("GEOGCS")&&!q.startsWith("PROJCS"))return null;m=K(q);return 0!==m?new w({wkid:m}):new w({wkt:q})}function K(q){var m,u=q.replace(/\]/g,"[").replace(/"/g,"").split("[").map(E=>E.trim()).filter(E=>""!==E);u=u[u.length-1].split(",");const I=null==(m=u[0])?void 0:m.toLowerCase();return"epsg"!==I&&"esri"!==I||!q.endsWith('"]]')||(q=Number(u[1]),isNaN(q)||0===q)?
0:q}U.parsePAMInfo=function(q){var m;if("pamdataset"!==(null==q?void 0:null==(m=q.documentElement.tagName)?void 0:m.toLowerCase()))return{};const u={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};q.documentElement.childNodes.forEach(I=>{if(1===I.nodeType)if(H.isSameTagIgnoreNS(I,"SRS"))u.spatialReference||(I=H.getElementValue(I),u.spatialReference=P(I));else if(H.isSameTagIgnoreNS(I,"Metadata"))if("xml:ESRI"===I.getAttribute("domain")){const {spatialReference:E,
transform:L}=T(I);u.transform=L;u.spatialReference||(u.spatialReference=E)}else H.getElements(I,"MDI").forEach(E=>u.metadata[E.getAttribute("key")]=H.getElementValue(E));else H.isSameTagIgnoreNS(I,"PAMRasterBand")&&(I=R(I),null!=I.sourceBandIndex&&null==u.rasterBands[I.sourceBandIndex]?u.rasterBands[I.sourceBandIndex]=I:u.rasterBands.push(I))});if(q=u.rasterBands)u.statistics=q[0].statistics?q.map(I=>I.statistics):null,u.histograms=q[0].histogram?q.map(I=>I.histogram):null;return u};U.parseSpatialReference=
P;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(U){function N(V,T){if(!V||!T)return[];var R=T;-1<T.indexOf("/")?(R=T.slice(0,T.indexOf("/")),T=T.slice(T.indexOf("/")+1)):T="";const P=[];if(T){V=N(V,R);for(R=0;R<V.length;R++)N(V[R],T).forEach(K=>P.push(K));return P}T=V.getElementsByTagNameNS("*",R);if(!T||0===T.length)return[];for(V=0;V<T.length;V++)P.push(T[V]||T.item[V]);return P}function H(V,T){if(!V||
!T)return null;let R=T;-1<T.indexOf("/")?(R=T.slice(0,T.indexOf("/")),T=T.slice(T.indexOf("/")+1)):T="";V=N(V,R);return 0<V.length?T?H(V[0],T):V[0]:null}function J(V,T=null){if(V=T?H(V,T):V)if(V=V.textContent||V.nodeValue)return V.trim();return null}function w(V,T){V=N(V,T);T=[];let R;for(let P=0;P<V.length;P++)if(R=V[P].textContent||V[P].nodeValue)R=R.trim(),""!==R&&T.push(R);return T}U.getElement=H;U.getElementNumericValue=function(V,T){V=J(V,T);return Number(V)};U.getElementNumericValues=function(V,
T){return w(V,T).map(R=>Number(R))};U.getElementValue=J;U.getElementValues=w;U.getElements=N;U.getNodeNameIgnoreNS=function(V){return V.nodeName.slice(V.nodeName.lastIndexOf(":")+1)};U.getSpaceDelimitedNumericValues=function(V,T=null){V=J(V,T);return null==V?void 0:V.split(" ").map(R=>Number(R))};U.isSameTagIgnoreNS=function(V,T){var R;V=null==V?void 0:null==(R=V.nodeName)?void 0:R.toLowerCase();T=T.toLowerCase();return V.slice(V.lastIndexOf(":")+1)===T};Object.defineProperty(U,"__esModule",{value:!0})})},
"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../serviceTileInfoProperty ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B,y){H=function(b){function d(){var h=b.apply(this,arguments)||this;h._levelOffset=0;h._slices=null;h._tilemapCache=null;h.datasetFormat="RasterTileServer";return h}U._inheritsLoose(d,b);var l=d.prototype;l.open=function(){var h=U._asyncToGenerator(function*(g){yield this.init();g=g&&g.signal;var p=this.sourceJSON?{data:this.sourceJSON}:yield this.request(this.url,{query:{f:"json"},signal:g});p.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));
const n=p.data;this.sourceJSON=n;if(!n)throw new J("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!n.tileInfo)throw new J("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();p="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=n.cacheType;null==this.tileType&&(-1<p.indexOf(n.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===n.tileInfo.format.toLowerCase()?this.tileType="Elevation":
this.tileType="Raster");this.datasetName=n.name.slice(n.name.indexOf("/")+1);g=yield this._fetchRasterInfo({signal:g});if(w.isSome(g)){p="Map"===this.tileType?I.readServiceTileInfo(n.tileInfo,n):E.fromJSON(n.tileInfo);const {extent:k,pixelSize:a}=g,r=.5/g.width*a.x;let D,M;var f=p.lodAt(Math.max.apply(null,p.lods.map(S=>S.level)));"Map"!==this.tileType&&0!==n.maxScale&&("Raster"===this.tileType?(D=p.lods.find(S=>S.resolution===a.x))||(D=p.lods[p.lods.length-1]):(D=p.lods.find(S=>Math.abs(S.scale-
n.maxScale)<r))||(D=p.lods.filter(S=>S.scale>n.maxScale).sort((S,X)=>S.scale>X.scale?1:-1)[0]),a.x=a.y=D.resolution,g.width=Math.ceil((k.xmax-k.xmin)/a.x-.1),g.height=Math.ceil((k.ymax-k.ymin)/a.y-.1));D||(D=f);f=p.lodAt(Math.min.apply(null,p.lods.map(S=>S.level)));"Map"===this.tileType?this._levelOffset=p.lods[0].level:0!==n.minScale&&"Elevation"===this.tileType&&(M=p.lods.find(S=>Math.abs(S.scale-n.minScale)<r),this._levelOffset=M.level-f.level);M||(M=f);const C=Math.max(a.x,a.y);if(Math.abs(a.x-
a.y)>r||!p.lods.some(S=>Math.abs(S.resolution-C)<r))a.x=a.y=D.resolution,g.width=Math.ceil((k.xmax-k.xmin)/a.x-.1),g.height=Math.ceil((k.ymax-k.ymin)/a.y-.1);f=D.level-M.level;const [e,t]=p.size,z=[];p.lods.forEach(S=>{S.level>=M.level&&S.level<=D.level&&z.push({x:S.resolution,y:S.resolution})});z.sort((S,X)=>S.x-X.x);const G=this.computeBlockBoundary(k,e,t,p.origin,z,f),O=1<z.length?z.slice(1):null;g.storageInfo=new u({blockWidth:p.size[0],blockHeight:p.size[1],pyramidBlockWidth:p.size[0],pyramidBlockHeight:p.size[1],
pyramidResolutions:O,compression:p.format,origin:p.origin,firstPyramidLevel:1,maximumPyramidLevel:f,tileInfo:p,blockBoundary:G});this._fixGCSShift(g);this._set("rasterInfo",g)}else throw new J("image-server-raster:open","cannot initialize image service");-1<n.capabilities.toLowerCase().indexOf("tilemap")&&(g={tileInfo:g.storageInfo.tileInfo,parsedUrl:V.urlToObject(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new L.TilemapCache({layer:g}))});return function(g){return h.apply(this,
arguments)}}();l.fetchRawTile=function(){var h=U._asyncToGenerator(function*(g,p,n,f={}){if(this._slices&&null==f.sliceId)return null;const {storageInfo:k,extent:a}=this.rasterInfo;({data:f}=yield this.request(`${this.url}/tile/${k.maximumPyramidLevel-g+this._levelOffset}/${p}/${n}`,{query:this._slices?{sliceId:f.sliceId||0}:null,responseType:"array-buffer",signal:f.signal}));if(!f)return null;f=yield this.decodePixelBlock(f,{width:k.tileInfo.size[0],height:k.tileInfo.size[1],planes:null,pixelType:null,
isPoint:"Elevation"===this.tileType});const r=k.blockBoundary[g];if("jpg"!==k.compression||n>r.minCol&&n<r.maxCol&&p>r.minRow&&p<r.maxRow)return f;const {origin:D,blockWidth:M,blockHeight:C}=k,{x:e,y:t}=this.getPyramidPixelSize(g);var z=Math.round((a.xmin-D.x)/e)%M;g=Math.round((a.xmax-D.x)/e)%M||M;var G=Math.round((D.y-a.ymax)/t)%C;const O=Math.round((D.y-a.ymin)/t)%C||C;z=n===r.minCol?z:0;G=p===r.minRow?G:0;v.setValidBoundary(f,{x:z,y:G},{width:(n===r.maxCol?g:M)-z,height:(p===r.maxRow?O:C)-G});
return f});return function(g,p,n){return h.apply(this,arguments)}}();l.getSliceIndex=function(h){if(!this._slices||w.isNone(h)||0===h.length)return null;for(let g=0;g<this._slices.length;g++){const p=this._slices[g].multidimensionalDefinition;if(p.length===h.length&&!p.some(n=>{var f=h.find(a=>n.variableName===a.variableName&&a.dimensionName===n.dimensionName);if(!f)return!0;const k=Array.isArray(n.values[0])?`${n.values[0][0]}-${n.values[0][1]}`:n.values[0];f=Array.isArray(f.values[0])?`${f.values[0][0]}-${f.values[0][1]}`:
f.values[0];return k!==f}))return g}return null};l.fetchVariableStatisticsHistograms=function(){var h=U._asyncToGenerator(function*(g,p){var n=this.request(this.url+"/statistics",{query:{variable:g,f:"json"},signal:p}).then(f=>{var k;return null==(k=f.data)?void 0:k.statistics});g=this.request(this.url+"/histograms",{query:{variable:g,f:"json"},signal:p}).then(f=>{var k;return null==(k=f.data)?void 0:k.histograms});n=yield Promise.all([n,g]);n[0]&&n[0].forEach(f=>{f.avg=f.mean;f.stddev=f.standardDeviation});
return{statistics:n[0]||null,histograms:n[1]||null}});return function(g,p){return h.apply(this,arguments)}}();l.computeBestPyramidLevelForLocation=function(){var h=U._asyncToGenerator(function*(g,p={}){if(!this._tilemapCache)return 0;g=this.identifyPixelLocation(g,0,w.unwrap(p.datumTransformation));if(null===g)return null;let n=0;var {maximumPyramidLevel:f}=this.rasterInfo.storageInfo;f=f-n+this._levelOffset;const k=g.srcLocation;for(;0<=f;){try{if("available"===(yield this._tilemapCache.fetchAvailability(f,
g.row,g.col,p)))break}catch{}f--;n++;g=this.identifyPixelLocation(k,n,w.unwrap(p.datumTransformation));if(null===g)return null}return-1===f||null==g?null:n});return function(g){return h.apply(this,arguments)}}();l._fetchRasterInfo=function(){var h=U._asyncToGenerator(function*(g){const p=this.sourceJSON,n=Math.ceil((p.extent.xmax-p.extent.xmin)/p.pixelSizeX-.1),f=Math.ceil((p.extent.ymax-p.extent.ymin)/p.pixelSizeY-.1),k=A.fromJSON(p.spatialReference||p.extent.spatialReference);if("Map"===this.tileType)return new m({width:n,
height:f,bandCount:3,extent:B.fromJSON(p.extent),spatialReference:k,pixelSize:new y({x:p.pixelSizeX,y:p.pixelSizeY,spatialReference:k}),pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}});const {slice:a,signal:r}=g;g=p.hasRasterAttributeTable?this.request(this.url+"/rasterAttributeTable",{query:{slice:a,f:"json"},signal:r}).then(z=>x.fromJSON(z.data)).catch(()=>null):!1;const D=p.hasColormap?this.request(this.url+"/colormap",{query:{slice:a,f:"json"},signal:r}).then(z=>{var G;return null==
(G=z.data)?void 0:G.colormap}):!1,M=p.hasHistograms?this.request(this.url+"/histograms",{query:{slice:a,f:"json"},signal:r}).then(z=>{var G;return null==(G=z.data)?void 0:G.histograms}):!1,C=this.request(this.url+"/keyProperties",{query:{f:"json"},signal:r}).then(z=>z.data).catch(()=>{}),e=p.hasMultidimensions?this._fetchMultidimensionalInfo():!1,t=p.hasMultidimensions?this.request(this.url+"/slices",{query:{f:"json"},signal:r}).then(z=>z.data&&z.data.slices).catch(()=>{}):!1;return Promise.all([g,
D,M,C,e,t]).then(z=>{let G=null;if(p.minValues&&p.minValues.length===p.bandCount){G=[];for(let O=0;O<p.minValues.length;O++)G.push({min:p.minValues[O],max:p.maxValues[O],avg:p.meanValues[O],stddev:p.stdvValues[O]})}this._slices=z[5]||null;return new m({width:n,height:f,bandCount:p.bandCount,extent:B.fromJSON(p.extent),spatialReference:k,pixelSize:new y({x:p.pixelSizeX,y:p.pixelSizeY,spatialReference:k}),pixelType:p.pixelType.toLowerCase(),statistics:G,attributeTable:z[0]||null,colormap:z[1]||null,
histograms:z[2]||null,keyProperties:z[3]||{},multidimensionalInfo:z[4]||null})})});return function(g){return h.apply(this,arguments)}}();l._fetchMultidimensionalInfo=function(){var h=U._asyncToGenerator(function*(g){var p;g=yield this.request(this.url+"/multidimensionalInfo",{query:{f:"json"},signal:g}).then(n=>{var f;return null==(f=n.data)?void 0:f.multidimensionalInfo});null!=(p=g.variables)&&p.length&&g.variables.forEach(n=>{var f;null!=(f=n.statistics)&&f.length&&n.statistics.forEach(k=>{k.avg=
k.mean;k.stddev=k.standardDeviation})});return g});return function(g){return h.apply(this,arguments)}}();l._fixScaleInServiceInfo=function(){const {sourceJSON:h}=this;h.minScale&&0>h.minScale&&(h.minScale=0);h.maxScale&&0>h.maxScale&&(h.maxScale=0)};l._fixGCSShift=function(h){const {extent:g,spatialReference:p}=h;0===g.xmin&&360===g.xmax&&p.wkid&&p.isGeographic&&(h.nativeExtent=h.extent,h.transform=new F,h.extent=h.transform.forwardTransform(g))};return d}(c);N.__decorate([T.property({type:String,
json:{write:!0}})],H.prototype,"datasetFormat",void 0);N.__decorate([T.property()],H.prototype,"tileType",void 0);return H=N.__decorate([q.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],H)})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(U,N){function H(w,V,T,R){if(!w)return null;const {minScale:P,maxScale:K,minLOD:q,maxLOD:m}=V;if(null!=q&&null!=m)return R&&R.ignoreMinMaxLOD?N.fromJSON(w):N.fromJSON({...w,lods:w.lods.filter(({level:u})=>
null!=u&&u>=q&&u<=m)});if(0!==P&&0!==K){const u=P?Math.round(1E4*P)/1E4:Infinity,I=K?Math.round(1E4*K)/1E4:-Infinity;return N.fromJSON({...w,lods:w.lods.filter(E=>{E=Math.round(1E4*E.scale)/1E4;return E<=u&&E>=I})})}return N.fromJSON(w)}const J={type:N,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:H}}}}};U.readServiceTileInfo=H;U.serviceTileInfoProperty=J;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/byteSizeEstimations ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./Tilemap".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A){var B;const y=P.getLogger("esri.layers.support.TilemapCache");U.TilemapCache=B=function(b){function d(h){h=b.call(this,h)||this;h._pendingTilemapRequests={};h._availableLevels={};h.levels=5;h.cacheByteSize=2*V.ByteSizeUnit.MEGABYTES;h.request=J;h._prefetchingEnabled=!0;return h}N._inheritsLoose(d,b);var l=d.prototype;l.initialize=function(){this._tilemapCache=new K(this.cacheByteSize);this.handles.add([this.watch(["layer.parsedUrl","layer.tileServers?",
"layer.apiKey?","layer.customParameters?"],()=>this._initializeTilemapDefinition()),u.watch(()=>{var h,g;return null==(h=this.layer)?void 0:null==(g=h.tileInfo)?void 0:g.lods},h=>this._initializeAvailableLevels(h),u.syncAndInitial)]);this._initializeTilemapDefinition()};l.castLevels=function(h){return 2>=h?(y.error("Minimum levels for Tilemap is 3, but got ",h),3):h};l.fetchTilemap=function(h,g,p,n){if(!this._availableLevels[h])return Promise.reject(new T("tilemap-cache:level-unavailable",`Level ${h} is unavailable in the service`));
const f=this._tmpTilemapDefinition;if(h=this._tilemapFromCache(h,g,p,f))return Promise.resolve(h);const k=n&&n.signal;n={...n,signal:null};return new Promise((a,r)=>{m.onAbort(k,()=>r(m.createAbortError()));const D=A.tilemapDefinitionId(f);let M=this._pendingTilemapRequests[D];if(!M){M=A.Tilemap.fromDefinition(f,n).then(e=>{this._tilemapCache.put(D,e,e.byteSize);return e});const C=()=>delete this._pendingTilemapRequests[D];this._pendingTilemapRequests[D]=M;M.then(C,C)}M.then(a,r)})};l.getAvailability=
function(h,g,p){return this._availableLevels[h]?(h=this._tilemapFromCache(h,g,p,this._tmpTilemapDefinition))?h.getAvailability(g,p):"unknown":"unavailable"};l.fetchAvailability=function(h,g,p,n){return this._availableLevels[h]?this.fetchTilemap(h,g,p,n).catch(f=>f).then(f=>{if(f instanceof A.Tilemap)return f=f.getAvailability(g,p),"unavailable"===f?Promise.reject(new T("tile-map:tile-unavailable","Tile is not available",{level:h,row:g,col:p})):f;if(m.isAbortError(f))throw f;return"unknown"}):Promise.reject(new T("tilemap-cache:level-unavailable",
`Level ${h} is unavailable in the service`))};l.fetchAvailabilityUpsample=function(h,g,p,n,f){n.level=h;n.row=g;n.col=p;const k=this.layer.tileInfo;k.updateTileInfo(n);const a=this.fetchAvailability(h,g,p,f).catch(r=>{if(m.isAbortError(r))throw r;if(k.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n);throw r;});this._fetchAvailabilityUpsamplePrefetch(n.id,h,g,p,f,a);return a};l._fetchAvailabilityUpsamplePrefetch=function(){var h=N._asyncToGenerator(function*(g,p,n,f,k,a){if(this._prefetchingEnabled){var r=
`prefetch-${g}`;if(!this.handles.has(r)){var D=new AbortController;a.then(()=>D.abort(),()=>D.abort());var M=!1;this.handles.add({remove(){M||(M=!0,D.abort())}},r);yield I.waitTicks(10,D.signal).catch(()=>{});M||(M=!0,this.handles.remove(r));if(!m.isAborted(D))for(g={id:g,level:p,row:n,col:f},k={...k,signal:D.signal},p=this.layer.tileInfo,n=0;B._prefetches.length<B._maxPrefetch&&p.upsampleTile(g);++n){const C=this.fetchAvailability(g.level,g.row,g.col,k);B._prefetches.push(C);f=()=>{B._prefetches.removeUnordered(C)};
C.then(f,f)}}}});return function(g,p,n,f,k,a){return h.apply(this,arguments)}}();l._initializeTilemapDefinition=function(){var h;if(this.layer.parsedUrl){var {parsedUrl:g,apiKey:p,customParameters:n}=this.layer;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:g.path,query:E.objectToQuery({...g.query,...n,token:null!=p?p:null==(h=g.query)?void 0:h.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,
col:0}}};l._tilemapFromCache=function(h,g,p,n){n.level=h;n.row=g-g%this.size;n.col=p-p%this.size;h=A.tilemapDefinitionId(n);return this._tilemapCache.get(h)};l._initializeAvailableLevels=function(h){this._availableLevels={};h&&h.forEach(g=>this._availableLevels[g.level]=!0)};N._createClass(d,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const h=this;return{get prefetchingEnabled(){return h._prefetchingEnabled},set prefetchingEnabled(g){h._prefetchingEnabled=g},hasTilemap(g,
p,n){return!!h._tilemapFromCache(g,p,n,h._tmpTilemapDefinition)}}}}]);return d}(R.HandleOwnerMixin(w));U.TilemapCache._maxPrefetch=4;U.TilemapCache._prefetches=new q({initialSize:B._maxPrefetch});H.__decorate([L.property({constructOnly:!0,type:Number})],U.TilemapCache.prototype,"levels",void 0);H.__decorate([F.cast("levels")],U.TilemapCache.prototype,"castLevels",null);H.__decorate([L.property({readOnly:!0,type:Number})],U.TilemapCache.prototype,"size",null);H.__decorate([L.property({constructOnly:!0,
type:Number})],U.TilemapCache.prototype,"cacheByteSize",void 0);H.__decorate([L.property({constructOnly:!0})],U.TilemapCache.prototype,"layer",void 0);H.__decorate([L.property({constructOnly:!0})],U.TilemapCache.prototype,"request",void 0);U.TilemapCache=B=H.__decorate([x.subclass("esri.layers.support.TilemapCache")],U.TilemapCache);Object.defineProperty(U,"__esModule",{value:!0})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(U){function N(H){return 32+H.length}U.ByteSizeUnit=
void 0;(function(H){H[H.KILOBYTES=1024]="KILOBYTES";H[H.MEGABYTES=1048576]="MEGABYTES";H[H.GIGABYTES=1073741824]="GIGABYTES"})(U.ByteSizeUnit||(U.ByteSizeUnit={}));U.estimateAttributesObjectSize=function(H){if(!H)return 0;let J=32;for(const w in H)if(H.hasOwnProperty(w)){const V=H[w];switch(typeof V){case "string":J+=N(V);break;case "number":J+=16;break;case "boolean":J+=4}}return J};U.estimateFixedArraySize=function(H,J){return 32+H.length*J};U.estimateNumberByteSize=function(){return 16};U.estimateStringByteSize=
N;Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/arrayUtils","../../core/Error","../../core/lang"],function(U,N,H,J,w){function V(R){if("vector-tile"===R.service.type)var P=`${R.service.url}/tilemap/${R.level}/${R.row}/${R.col}/${R.width}/${R.height}`;else P=R.service.tileServers,P=`${P&&P.length?P[R.row%P.length]:R.service.url}/tilemap/${R.level}/${R.row}/${R.col}/${R.width}/${R.height}`;(R=R.service.query)&&
(P=`${P}?${R}`);return P}let T=function(){function R(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var P=R.prototype;P.getAvailability=function(K,q){if("unknown"!==this._allAvailability)return this._allAvailability;K=(K-this.location.top)*this.location.width+(q-this.location.left);q=K>>3;const m=this._tileAvailabilityBitSet;return 0>q||q>m.length?"unknown":m[q]&1<<K%8?"available":"unavailable"};P._updateFromData=function(K){let q=!0,m=!0;const u=
new Uint8Array(Math.ceil(this.location.width*this.location.height/8));let I=0;for(let E=0;E<K.length;E++){const L=E%8;K[E]?(m=!1,u[I]|=1<<L):q=!1;7===L&&++I}m?this._allAvailability="unavailable":q?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=u,this.byteSize+=u.length)};R.fromDefinition=function(K,q){const m=K.service.request||N,{row:u,col:I,width:E,height:L}=K,c={query:{f:"json"}};q=q?{...c,...q}:c;return m(V(K),q).then(v=>v.data).catch(v=>{if(v&&
v.details&&422===v.details.httpStatus)return{location:{top:u,left:I,width:E,height:L},valid:!0,data:H.constant(E*L,0)};throw v;}).then(v=>{if(v.location&&(v.location.top!==u||v.location.left!==I||v.location.width!==E||v.location.height!==L))throw new J("tilemap:location-mismatch","Tilemap response for different location than requested",{response:v,definition:{top:u,left:I,width:E,height:L}});return R.fromJSON(v)})};R.fromJSON=function(K){R._validateJSON(K);const q=new R;q.location=Object.freeze(w.clone(K.location));
q._updateFromData(K.data);return Object.freeze(q)};R._validateJSON=function(K){if(!K||!K.location)throw new J("tilemap:missing-location","Location missing from tilemap response");if(!1===K.valid)throw new J("tilemap:invalid","Tilemap response was marked as invalid");if(!K.data)throw new J("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(K.data))throw new J("tilemap:data-mismatch","Data must be an array of numbers");if(K.data.length!==K.location.width*K.location.height)throw new J("tilemap:data-mismatch",
"Number of data items does not match width/height of tilemap");};return R}();U.Tilemap=T;U.default=T;U.tilemapDefinitionId=function(R){return`${R.level}/${R.row}/${R.col}/${R.width}/${R.height}`};Object.defineProperty(U,"__esModule",{value:!0})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/pixelUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A){const B=new Map;B.set("Int8","s8");B.set("UInt8","u8");B.set("Int16","s16");B.set("UInt16","u16");B.set("Int32","s32");B.set("UInt32","u32");B.set("Float32","f32");B.set("Float64","f32");B.set("Double64","f32");const y=new Map;y.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});y.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});y.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
y.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});H=function(b){function d(){var h=b.apply(this,arguments)||this;h._files=null;h._storageIndex=null;h.datasetFormat="MRF";return h}U._inheritsLoose(d,b);var l=d.prototype;l.open=function(){var h=U._asyncToGenerator(function*(g){var p;yield this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var n=g?w.unwrap(g.signal):null,f=yield this.request(this.url,{responseType:"xml",signal:n});const {rasterInfo:k,files:a}=
this._parseHeader(f.data);if(-1===(null==(p=this.ioConfig.skipExtensions)?void 0:p.indexOf("aux.xml"))&&(g=yield this._fetchAuxiliaryData(g),null!=g)){var r;k.statistics=null!=(r=g.statistics)?r:k.statistics;(k.histograms=g.histograms)&&!w.isSome(k.statistics)&&(k.statistics=v.estimateStatisticsFromHistograms(g.histograms))}this._set("rasterInfo",k);this._files=a;n=yield this.request(a.index,{responseType:"array-buffer",signal:n});this._storageIndex=this._parseIndex(n.data);const {blockWidth:D,blockHeight:M}=
this.rasterInfo.storageInfo;n=this.rasterInfo.storageInfo.pyramidScalingFactor;const {width:C,height:e}=this.rasterInfo;r=[];g=this._getBandSegmentCount();p=0;for(f=-1;p<this._storageIndex.length;){f++;const t=Math.ceil(C/D/n**f)-1,z=Math.ceil(e/M/n**f)-1;p+=(t+1)*(z+1)*g*4;r.push({maxRow:z,maxCol:t,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=r;0<f&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=f);this.updateTileInfo()});return function(g){return h.apply(this,
arguments)}}();l.fetchRawTile=function(){var h=U._asyncToGenerator(function*(g,p,n,f={}){const {blockWidth:k,blockHeight:a,blockBoundary:r}=this.rasterInfo.storageInfo;var D=r[g];if(!D||D.maxRow<p||D.maxCol<n||D.minRow>p||D.minCol>n)return null;const {bandCount:M,pixelType:C}=this.rasterInfo,{ranges:e,actualTileWidth:t,actualTileHeight:z}=this._getTileLocation(g,p,n);if(!e||0===e.length)return null;if(0===e[0].from&&0===e[0].to)return g=new Uint8Array(k*a),new q({width:k,height:a,pixels:null,mask:g,
validPixelCount:0});({bandIds:p}=this.ioConfig);n=this._getBandSegmentCount();D=[];for(g=g=0;g<n;g++)(!p||-1<p.indexOf[g])&&D.push(this.request(this._files.data,{range:{from:e[g].from,to:e[g].to},responseType:"array-buffer",signal:f.signal}));f=yield Promise.all(D);g=f.map(O=>O.data.byteLength).reduce((O,S)=>O+S);D=new Uint8Array(g);let G=0;for(g=0;g<n;g++)D.set(new Uint8Array(f[g].data),G),G+=f[g].data.byteLength;g=y.get(this.rasterInfo.storageInfo.compression).decoderFormat;p=yield this.decodePixelBlock(D.buffer,
{width:k,height:a,format:g,planes:(null==p?void 0:p.length)||M,pixelType:C});if(w.isSome(this.rasterInfo.noDataValue)&&"lerc"!==g&&!p.mask&&(f=this.rasterInfo.noDataValue[0],null!=f)){n=p.width*p.height;D=new Uint8Array(n);if(1E24<Math.abs(f))for(g=0;g<n;g++)1E-6<Math.abs((p.pixels[0][g]-f)/f)&&(D[g]=1);else for(g=0;g<n;g++)p.pixels[0][g]!==f&&(D[g]=1);p.mask=D}n=f=0;if(t!==k||z!==a)if(D=p.mask)for(g=0;g<a;g++)for(n=g*k,f=g<z?t:0;f<k;f++)D[n+f]=0;else for(D=new Uint8Array(k*a),p.mask=D,g=0;g<z;g++)for(n=
g*k,f=0;f<t;f++)D[n+f]=1;return p});return function(g,p,n){return h.apply(this,arguments)}}();l._parseIndex=function(h){if(0<h.byteLength%16)throw"invalid array buffer must be multiples of 16";let g,p,n,f,k;if(c.isPlatformLittleEndian){g=new Uint8Array(h);n=new ArrayBuffer(h.byteLength);p=new Uint8Array(n);for(f=0;f<h.byteLength/4;f++)for(k=0;4>k;k++)p[4*f+k]=g[4*f+3-k];h=new Uint32Array(n)}else h=new Uint32Array(h);return h};l._getBandSegmentCount=function(){return y.get(this.rasterInfo.storageInfo.compression).isOneSegment?
1:this.rasterInfo.bandCount};l._getTileLocation=function(h,g,p){const {blockWidth:n,blockHeight:f,pyramidScalingFactor:k}=this.rasterInfo.storageInfo,{width:a,height:r}=this.rasterInfo,D=this._getBandSegmentCount();let M,C;var e,t=0;let z=0;for(e=0;e<h;e++)z=k**e,M=Math.ceil(a/n/z),C=Math.ceil(r/f/z),t+=M*C;z=k**h;M=Math.ceil(a/n/z);C=Math.ceil(r/f/z);t=4*(t+(g*M+p))*D;h=this._storageIndex.subarray(t,t+4*D);t=e=0;const G=[];for(let O=0;O<D;O++)e=h[4*O]*2**32+h[4*O+1],t=e+h[4*O+2]*2**32+h[4*O+3],G.push({from:e,
to:t});return{ranges:G,actualTileWidth:p<M-1?n:Math.ceil(a/z)-n*(M-1),actualTileHeight:g<C-1?f:Math.ceil(r/z)-f*(C-1)}};l._parseHeader=function(h){var g=L.getElement(h,"MRF_META/Raster");if(!g)throw new J("mrf:open","not a valid MRF format");var p=L.getElement(g,"Size"),n=parseInt(p.getAttribute("x"),10),f=parseInt(p.getAttribute("y"),10);const k=parseInt(p.getAttribute("c"),10);p=(L.getElementValue(g,"Compression")||"none").toLowerCase();if(!y.has(p))throw new J("mrf:open","currently does not support compression "+
p);var a=L.getElementValue(g,"DataType")||"UInt8";const r=B.get(a);if(null==r)throw new J("mrf:open","currently does not support pixel type "+a);var D=L.getElement(g,"PageSize");a=parseInt(D.getAttribute("x"),10);D=parseInt(D.getAttribute("y"),10);g=L.getElement(g,"DataValues");let M;g&&(g=g.getAttribute("NoData"),null!=g&&(M=g.trim().split(" ").map(O=>parseFloat(O))));if(L.getElement(h,"MRF_META/CachedSource"))throw new J("mrf:open","currently does not support MRF referencing other data files");
var C=L.getElement(h,"MRF_META/GeoTags"),e=L.getElement(C,"BoundingBox");g=!1;if(null!=e){var t=parseFloat(e.getAttribute("minx"));var z=parseFloat(e.getAttribute("miny"));const O=parseFloat(e.getAttribute("maxx"));e=parseFloat(e.getAttribute("maxy"));C=L.getElementValue(C,"Projection")||"";var G;"LOCAL_CS[]"!==C?C.toLowerCase().startsWith("epsg:")?(C=Number(C.slice(5)),isNaN(C)||0===C||(G=new F({wkid:C}))):G=E.parseSpatialReference(C):(g=!0,G=new F({wkid:3857}));t=new x(t,z,O,e);t.spatialReference=
G}else g=!0,t=new x({xmin:-.5,ymin:.5-f,xmax:n-.5,ymax:.5,spatialReference:new F({wkid:3857})});G=L.getElement(h,"MRF_META/Rsets");z=parseInt(G&&G.getAttribute("scale")||"2",10);G=t.spatialReference;a=new u({origin:new A({x:t.xmin,y:t.ymax,spatialReference:G}),blockWidth:a,blockHeight:D,pyramidBlockWidth:a,pyramidBlockHeight:D,compression:p,pyramidScalingFactor:z});D=new A({x:t.width/n,y:t.height/f,spatialReference:G});n=new m({width:n,height:f,extent:t,isPseudoSpatialReference:g,spatialReference:G,
bandCount:k,pixelType:r,pixelSize:D,noDataValue:M,storageInfo:a});f=L.getElementValue(h,"datafile");h=L.getElementValue(h,"IndexFile");h={mrf:this.url,index:h||this.url.replace(".mrf",".idx"),data:f||this.url.replace(".mrf",y.get(p).blobExtension)};return{rasterInfo:n,files:h}};l._fetchAuxiliaryData=function(){var h=U._asyncToGenerator(function*(g){try{const {data:p}=yield this.request(this.url+".aux.xml",{responseType:"xml",signal:null==g?void 0:g.signal});return E.parsePAMInfo(p)}catch{return null}});
return function(g){return h.apply(this,arguments)}}();return d}(I);N.__decorate([V.property()],H.prototype,"_files",void 0);N.__decorate([V.property()],H.prototype,"_storageIndex",void 0);N.__decorate([V.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=N.__decorate([K.subclass("esri.layers.support.rasterIO.MRFRaster")],H)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/pixelUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(U,N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A){const B=function(b,d){return(b=b.get(d))&&b.values},y=function(b,d){return(b=b.get(d))&&b.values[0]};H=function(b){function d(){var h=b.apply(this,arguments)||this;h._files=null;h._headerInfo=null;h._bufferSize=1048576;h.datasetFormat="TIFF";return h}U._inheritsLoose(d,b);var l=d.prototype;l.open=function(){var h=U._asyncToGenerator(function*(g){var p,n,f;yield this.init();var k=g?w.unwrap(g.signal):null,{data:a}=yield this.request(this.url,{range:{from:0,
to:this._bufferSize},responseType:"array-buffer",signal:k});if(!a)throw new J("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {littleEndian:r,firstIFD:D,isBigTiff:M}=E.parseSignature(a),C=[];yield this._readIFDs(C,a,r,D,0,M?8:4,k);k=E.getImageInfo(C);const {width:e,height:t,tileWidth:z,tileHeight:G,planes:O,pixelType:S,compression:X,firstPyramidLevel:W,maximumPyramidLevel:Y,pyramidBlockWidth:aa,pyramidBlockHeight:Q,tileBoundary:Z,
affine:ba,metadata:ca}=k;a=(null==(p=k.extent.spatialReference)?void 0:p.wkt)||(null==(n=k.extent.spatialReference)?void 0:n.wkid);p=I.parseSpatialReference(a);a=!1;null==p&&(a=!0,p=new F({wkid:3857}));var da=(n=new x({...k.extent,spatialReference:p}),new A({x:n.xmin,y:n.ymax,spatialReference:p}));da=new m({blockWidth:z,blockHeight:G,pyramidBlockWidth:aa,pyramidBlockHeight:Q,compression:X,origin:da,firstPyramidLevel:W,maximumPyramidLevel:Y,blockBoundary:Z});const ea=new A({x:(n.xmax-n.xmin)/e,y:(n.ymax-
n.ymin)/t,spatialReference:p});a=new q({width:e,height:t,bandCount:O,pixelType:S,compression:X,pixelSize:ea,storageInfo:da,spatialReference:p,isPseudoSpatialReference:a,keyProperties:ca?{BandProperties:ca.bandProperties,DataType:ca.dataType}:{},extent:n,statistics:ca?ca.statistics:null});null!=ba&&ba.length&&(a.nativeExtent=new x({xmin:-.5,ymin:.5-t,xmax:e-.5,ymax:.5,spatialReference:p}),a.transform=new v({polynomialOrder:1,forwardCoefficients:[ba[2]+ba[0]/2,ba[5]-ba[3]/2,ba[0],ba[3],-ba[1],-ba[4]]}),
a.extent=a.transform.forwardTransform(a.nativeExtent),a.pixelSize=new A({x:(n.xmax-n.xmin)/e,y:(n.ymax-n.ymin)/t,spatialReference:p}),da.origin.x=-.5,da.origin.y=.5);if(null==(f=this.ioConfig.skipExtensions)||!f.includes("aux.xml"))if(g=yield this._fetchAuxiliaryData(g),null!=g){var fa;a.statistics=null!=(fa=g.statistics)?fa:a.statistics;(a.histograms=g.histograms)&&!w.isSome(a.statistics)&&(a.statistics=c.estimateStatisticsFromHistograms(g.histograms));g.transform&&!ba&&(a.transform=g.transform,
a.nativeExtent=a.extent,fa=a.transform.forwardTransform(a.nativeExtent),a.pixelSize=new A({x:(fa.xmax-fa.xmin)/e,y:(fa.ymax-fa.ymin)/t,spatialReference:p}),a.extent=fa);a.spatialReference||(a.spatialReference=g.spatialReference)}this._set("rasterInfo",a);this._headerInfo={littleEndian:r,isBigTiff:M,ifds:C,...k};if(!this._headerInfo.isSupported)throw new J("tiffraster:open","this tiff is not supported: "+this._headerInfo.message);this.updateTileInfo()});return function(g){return h.apply(this,arguments)}}();
l.fetchRawTile=function(){var h=U._asyncToGenerator(function*(g,p,n,f={}){var k;if(null==(k=this._headerInfo)||!k.isSupported||this.isBlockOutside(g,p,n))return null;p=this._getTileLocation(g,p,n);if(!p)return null;const {ranges:a,actualTileWidth:r,actualTileHeight:D,ifd:M}=p;p=a.map(z=>this.request(this.url,{range:z,responseType:"array-buffer",signal:f.signal}));p=yield Promise.all(p);n=p.map(z=>z.data.byteLength).reduce((z,G)=>z+G);n=1===p.length?p[0].data:new ArrayBuffer(n);k=[0];var C=[0];if(1<
p.length){const z=new Uint8Array(n);for(let G=0,O=0;G<p.length;G++){const S=p[G].data;z.set(new Uint8Array(S),O);k[G]=O;O+=S.byteLength;C[G]=S.byteLength}}const {blockWidth:e,blockHeight:t}=this.getBlockWidthHeight(g);g=yield this.decodePixelBlock(n,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:M,offsets:k,sizes:C},width:e,height:t,planes:null,pixelType:null});if(r!==e||D!==t)if(C=g.mask)for(p=0;p<t;p++)for(k=p*e,n=p<D?r:0;n<e;n++)C[k+n]=0;else for(C=new Uint8Array(e*t),g.mask=C,p=
0;p<D;p++)for(k=p*e,n=0;n<r;n++)C[k+n]=1;return g});return function(g,p,n){return h.apply(this,arguments)}}();l._readIFDs=function(){var h=U._asyncToGenerator(function*(g,p,n,f,k,a=4,r){if(!f)return null;if(f>=p.byteLength||0>f)p=(yield this.request(this.url,{range:{from:f+k,to:f+k+this._bufferSize},responseType:"array-buffer",signal:r})).data,k=f+k,f=0;f=yield this._readIFD(p,n,f,k,L.TIFF_TAGS,a,r);g.push(f.ifd);if(!f.nextIFD)return null;yield this._readIFDs(g,p,n,f.nextIFD-k,k,a,r)});return function(g,
p,n,f,k){return h.apply(this,arguments)}}();l._readIFD=function(){var h=U._asyncToGenerator(function*(g,p,n,f,k=L.TIFF_TAGS,a=4,r){if(!g)return null;n=E.parseIFD(g,p,n,f,k,a);if(n.success){const D=[];n.ifd.forEach(M=>{M.values||D.push(M)});0<D.length&&(a=D.map(M=>M.offlineOffsetSize),k=Math.min.apply(null,a.map(M=>M[0])),Math.min.apply(null,a.map(M=>M[0]+M[1]))-k<=this._bufferSize&&({data:a}=yield this.request(this.url,{range:{from:k,to:k+this._bufferSize},responseType:"array-buffer",signal:r}),g=
a,f=k,D.forEach(M=>E.parseFieldValues(g,p,M,f))));n.ifd.has("GEOKEYDIRECTORY")&&(k=n.ifd.get("GEOKEYDIRECTORY"),(a=k.values)&&4<a.length&&(a=a[0]+"."+a[1]+"."+a[2],r=yield this._readIFD(g,p,k.valueOffset+6-f,f,L.GEO_KEYS,2,r),k.data=r.ifd,k.data&&k.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[a]})));return n}if(n.requiredBufferSize&&n.requiredBufferSize!==g.byteLength)return g=(yield this.request(this.url,{range:{from:f,to:f+n.requiredBufferSize+4},responseType:"array-buffer",
signal:r})).data,g.byteLength<n.requiredBufferSize?null:this._readIFD(g,p,0,f,L.TIFF_TAGS,4,r)});return function(g,p,n,f){return h.apply(this,arguments)}}();l._getTileLocation=function(h,g,p){const {firstPyramidLevel:n,blockBoundary:f}=this.rasterInfo.storageInfo;var k=0===h?0:h-(n-1);h=this._headerInfo.ifds[k];if(!h)return null;var a=E.isBSQConfig(h,this._headerInfo);const r=B(h,"TILEOFFSETS");if(void 0===r)return null;var D=B(h,"TILEBYTECOUNTS");const {minRow:M,minCol:C,maxRow:e,maxCol:t}=f[k];
if(g>e||p>t||g<M||p<C)return null;k=y(h,"IMAGEWIDTH");const z=y(h,"IMAGELENGTH"),G=y(h,"TILEWIDTH"),O=y(h,"TILELENGTH"),S=a?this.rasterInfo.bandCount:1,X=S*g*(t+1)+p,W=[{from:r[X],to:r[X+S-1]+D[X+S-1]-1}];if(a){a=!0;for(let Y=0;Y<S;Y++)if(r[X+Y]+D[X+Y]!==r[X+Y+1]){a=!1;break}if(!a)for(a=0;a<S;a++)W[a]={from:r[X+a],to:r[X+a]+D[X+a]-1}}D=D[X];return null==r[X]||null==D?null:{ranges:W,ifd:h,actualTileWidth:p===t?k%G:G,actualTileHeight:g===e?z%O:O}};l._fetchAuxiliaryData=function(){var h=U._asyncToGenerator(function*(g){try{const {data:p}=
yield this.request(this.url+".aux.xml",{responseType:"xml",signal:null==g?void 0:g.signal});return I.parsePAMInfo(p)}catch{return null}});return function(g){return h.apply(this,arguments)}}();return d}(u);N.__decorate([V.property()],H.prototype,"_files",void 0);N.__decorate([V.property()],H.prototype,"_headerInfo",void 0);N.__decorate([V.property()],H.prototype,"_bufferSize",void 0);N.__decorate([V.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=N.__decorate([K.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],
H)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../rasterRenderers ../core/Error ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ./Layer ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/rasterDatasets/RasterFactory ../support/popupUtils".split(" "),function(U,
N,H,J,w,V,T,R,P,K,q,m,u,I,E,L,c,v,F,x,A,B,y,b,d,l,h,g,p){T=function(n){function f(...a){a=n.call(this,...a)||this;a.bandIds=null;a.interpolation=null;a.legendEnabled=!0;a.isReference=null;a.listMode="show";a.sourceJSON=null;a.version=null;a.title=null;a.type="imagery-tile";a.operationalLayerType="ArcGISTiledImageServiceLayer";a.popupEnabled=!0;a.popupTemplate=null;a.fields=null;return a}U._inheritsLoose(f,n);var k=f.prototype;k.normalizeCtorArgs=function(a,r){return"string"===typeof a?{url:a,...r}:
a};k.load=function(a){const r=V.isSome(a)?a.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},a).catch(R.throwIfAbortError).then(()=>this._openRaster(r)));return Promise.resolve(this)};k.readRenderer=function(a,r,D){a=J.read(r&&r.layerDefinition&&r.layerDefinition.drawingInfo&&r.layerDefinition.drawingInfo.renderer,D)||void 0;if(null!=a)return a};k.createPopupTemplate=function(a){return p.createPopupTemplate({fields:this.rasterFields,title:this.title},a)};
k.write=function(a,r){const {raster:D}=this;if(this.loaded?"RasterTileServer"===D.datasetFormat&&("Raster"===D.tileType||"Map"===D.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return n.prototype.write.call(this,a,r);r&&r.messages&&r.messages.push(new w("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${r.origin}/${r.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null};k._openRaster=
function(){var a=U._asyncToGenerator(function*(r){this.raster?(this.raster.rasterInfo||(yield this.raster.open()),this.url=this.raster.url):this.raster=yield g.open({url:this.url,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:r});({rasterInfo:r}=this.raster);if(!r)throw new w("imagery-tile-layer:load","cannot load resources on "+this.url);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON&&this.read("Map"===
this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"});null==this.title&&(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.watch("customParameters",D=>this.raster.ioConfig.customFetchParameters=D)});return function(r){return a.apply(this,arguments)}}();U._createClass(f,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},
{key:"rasterFields",get:function(){var a,r;let D=[new l({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})];const M=null==(a=this.rasterInfo)?void 0:null==(r=a.attributeTable)?void 0:r.fields;M&&(a=M.filter(e=>"oid"!==e.type&&"value"!==e.name.toLowerCase()).map(e=>{const t=e.clone();t.name="Raster."+e.name;return t}),D=D.concat(a));a=this.rasterInfo.dataType;if(("vector-magdir"===a||"vector-uv"===a)&&V.isSome(this.rasterInfo.multidimensionalInfo)){var C;
a=null==(C=this.rasterInfo.multidimensionalInfo.variables[0].unit)?void 0:C.trim();D.push(new l({name:"Raster.Magnitude",alias:"Magnitude"+(a?` (${a})`:""),domain:null,editable:!1,type:"double"}));D.push(new l({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"}))}return D}},{key:"renderer",set:function(a){this._set("renderer",a);this.updateRenderer()}}]);return f}(c.BlendLayer(y.ScaleRangeLayer(x.OperationalLayer(A.PortalLayer(v.CustomParametersMixin(F.ImageryTileMixin(b.TemporalLayer(B.RefreshableLayer(T.MultiOriginJSONMixin(L))))))))));
N.__decorate([P.property({type:[m.Integer],json:{write:{overridePolicy(){var n;return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==(null==(n=this.bandIds)?void 0:n.join(","))}}}}})],T.prototype,"bandIds",void 0);N.__decorate([P.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),u.enumeration(h.interpolationKebab)],T.prototype,"interpolation",void 0);N.__decorate([P.property({json:{write:!0}})],
T.prototype,"multidimensionalDefinition",void 0);N.__decorate([P.property(d.legendEnabled)],T.prototype,"legendEnabled",void 0);N.__decorate([P.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],T.prototype,"isReference",void 0);N.__decorate([P.property({type:["show","hide"]})],T.prototype,"listMode",void 0);N.__decorate([P.property()],T.prototype,"sourceJSON",void 0);N.__decorate([P.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],
T.prototype,"version",void 0);N.__decorate([P.property()],T.prototype,"title",void 0);N.__decorate([P.property({readOnly:!0,json:{read:!1}})],T.prototype,"type",void 0);N.__decorate([P.property({type:["ArcGISTiledImageServiceLayer"]})],T.prototype,"operationalLayerType",void 0);N.__decorate([P.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(n,f){return!f.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},
writer(n,f,k){f[k]=!n}}}})],T.prototype,"popupEnabled",void 0);N.__decorate([P.property({type:H,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],T.prototype,"popupTemplate",void 0);N.__decorate([P.property({readOnly:!0})],T.prototype,"defaultPopupTemplate",null);N.__decorate([P.property({readOnly:!0,type:[l]})],T.prototype,"fields",void 0);N.__decorate([P.property({readOnly:!0,type:[l]})],T.prototype,"rasterFields",
null);N.__decorate([P.property({types:J.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){var n;const f="raster-stretch"===(null==(n=this.renderer)?void 0:n.type)&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!f}}},origins:{"web-scene":{types:J.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(n){return{enabled:n&&"vector-field"!==n.type&&
"flow"!==n.type}}}}}}})],T.prototype,"renderer",null);N.__decorate([I.reader("renderer")],T.prototype,"readRenderer",null);return T=N.__decorate([E.subclass("esri.layers.ImageryTileLayer")],T)});