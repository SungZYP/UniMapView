// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/vectorTiles/TileHandler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/workers/workers ./GlyphMosaic ./GlyphSource ./SpriteMosaic ./decluttering/debugging ../../tiling/TileKey".split(" "),function(A,C,v,x,f,q,c,e,b,a){let d=function(){function h(n,k,t){this._layer=n;this._styleRepository=k;this.devicePixelRatio=t;this._connection=this._glyphMosaic=this._spriteMosaic=
null}var m=h.prototype;m.destroy=function(){this._connection&&(this._connection.close(),this._connection=null);this._layer=this._styleRepository=null;this._spriteMosaic&&(this._spriteMosaic=null);this._glyphMosaic&&(this._glyphMosaic=null)};m.start=function(){var n=C._asyncToGenerator(function*(k){this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,k);this._spriteSourcePromise.then(w=>{this._spriteMosaic=new e(1024,1024,250);this._spriteMosaic.setSpriteSource(w)});const t=
new c(this._layer.currentStyleInfo.glyphsUrl?x.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new q(1024,1024,t);this._broadcastPromise=f.open("WorkerTileHandler",{client:this,schedule:k.schedule,signal:k.signal}).then(w=>{this._connection=w;return Promise.all(this._connection.broadcast("setStyle",this._layer.currentStyleInfo.style,k))})});return function(k){return n.apply(this,arguments)}}();m.updateStyle=
function(){var n=C._asyncToGenerator(function*(k){yield this._broadcastPromise;return this._broadcastPromise=Promise.all(this._connection.broadcast("updateStyle",k))});return function(k){return n.apply(this,arguments)}}();m.setSpriteSource=function(n){const k=new e(1024,1024,250);k.setSpriteSource(n);this._spriteMosaic=k;this._spriteSourcePromise=Promise.resolve(n);return k};m.setStyle=function(){var n=C._asyncToGenerator(function*(k,t){yield this._broadcastPromise;this._styleRepository=k;this._spriteSourcePromise=
this._layer.loadSpriteSource(this.devicePixelRatio,null);this._spriteSourcePromise.then(w=>{this._spriteMosaic=new e(1024,1024,250);this._spriteMosaic.setSpriteSource(w)});k=new c(this._layer.currentStyleInfo.glyphsUrl?x.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new q(1024,1024,k);return this._broadcastPromise=Promise.all(this._connection.broadcast("setStyle",t))});return function(k,t){return n.apply(this,
arguments)}}();m.fetchTileData=function(n,k){return this._getRefKeys(n,k).then(t=>{const w=this._layer.sourceNameToSource,l=[];for(const u in w)l.push(u);return this._getSourcesData(l,t,k)})};m.parseTileData=function(n,k){const t=n&&n.data;if(!t)return Promise.resolve(null);const {sourceName2DataAndRefKey:w,transferList:l}=t;return 0===Object.keys(w).length?Promise.resolve(null):this._broadcastPromise.then(()=>this._connection.getAvailableClient().then(u=>u.invoke("createTileAndParse",{key:n.key.id,
sourceName2DataAndRefKey:w,styleLayerUIDs:n.styleLayerUIDs},{...k,transferList:l})))};m.getSprites=function(){var n=C._asyncToGenerator(function*(k){yield this._spriteSourcePromise;return this._spriteMosaic.getSpriteItems(k)});return function(k){return n.apply(this,arguments)}}();m.getGlyphs=function(n){return this._glyphMosaic.getGlyphItems(n.font,n.codePoints)};m.perfReport=function({key:n,milliseconds:k}){b.perfAdd(n,k,"ms")};m._getTilePayload=function(){var n=C._asyncToGenerator(function*(k,t,
w){k=a.pool.acquire(k.id);const l=this._layer.sourceNameToSource[t],{level:u,row:D,col:I}=k;a.pool.release(k);try{return{protobuff:yield l.requestTile(u,D,I,w),sourceName:t}}catch(H){if(v.isAbortError(H))throw H;return{protobuff:null,sourceName:t}}});return function(k,t,w){return n.apply(this,arguments)}}();m._getRefKeys=function(n,k){const t=this._layer.sourceNameToSource,w=[];for(const l in t){const u=t[l].getRefKey(n,k);w.push(u)}return v.eachAlways(w)};m._getSourcesData=function(n,k,t){const w=
[];for(let l=0;l<k.length;l++)if(null==k[l].value||null==n[l])w.push(null);else{const u=this._getTilePayload(k[l].value,n[l],t);w.push(u)}return v.eachAlways(w).then(l=>{const u={},D=[];for(let I=0;I<l.length;I++)l[I].value&&l[I].value&&l[I].value.protobuff&&0<l[I].value.protobuff.byteLength&&(u[l[I].value.sourceName]={refKey:k[I].value.id,protobuff:l[I].value.protobuff},D.push(l[I].value.protobuff));return{sourceName2DataAndRefKey:u,transferList:D}})};C._createClass(h,[{key:"spriteMosaic",get:function(){return this._spriteSourcePromise.then(()=>
this._spriteMosaic)}},{key:"glyphMosaic",get:function(){return this._glyphMosaic}}]);return h}();A.TileHandler=d;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/GlyphMosaic":function(){define(["./RectangleBinPack","../webgl/Rect","../../../webgl/enums","../../../webgl/Texture"],function(A,C,v,x){return function(){function f(c,e,b){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=
new Map;this.width=c;this.height=e;this._glyphSource=b;this._binPack=new A(c-4,e-4);this._glyphData.push(new Uint8Array(c*e));this._dirties.push(!0);this._textures.push(void 0)}var q=f.prototype;q.getGlyphItems=function(c,e){const b=[],a=this._glyphSource,d=new Set,h=1/256;for(const n of e)d.add(Math.floor(n*h));const m=[];d.forEach(n=>{if(256>=n){const k=c+n;this._rangePromises.has(k)?m.push(this._rangePromises.get(k)):(n=a.getRange(c,n).then(()=>{this._rangePromises["delete"](k)},()=>{this._rangePromises["delete"](k)}),
this._rangePromises.set(k,n),m.push(n))}});return Promise.all(m).then(()=>{let n=this._glyphIndex[c];n||(n={},this._glyphIndex[c]=n);for(const u of e){var k=n[u];if(k){b[u]={sdf:!0,rect:k.rect,metrics:k.metrics,page:k.page,code:u};continue}var t=a.getGlyph(c,u);if(!t||!t.metrics)continue;k=t.metrics;let D;if(0===k.width)D=new C(0,0,0,0);else{const I=k.width+6,H=k.height+6;var w=I%4?4-I%4:4,l=H%4?4-H%4:4;1===w&&(w=5);1===l&&(l=5);D=this._binPack.allocate(I+w,H+l);D.isEmpty&&(this._dirties[this._currentPage]||
(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new A(this.width-4,this.height-4),D=this._binPack.allocate(I+w,H+l));w=this._glyphData[this._currentPage];t=t.bitmap;let B;if(t)for(let y=0;y<H;y++){l=I*y;B=this.width*(D.y+y+1)+D.x;for(let F=0;F<I;F++)w[B+F+1]=t[l+F]}}n[u]={rect:D,metrics:k,tileIDs:null,page:this._currentPage};b[u]={sdf:!0,
rect:D,metrics:k,page:this._currentPage,code:u};this._dirties[this._currentPage]=!0}return b})};q.removeGlyphs=function(c){for(const e in this._glyphIndex){const b=this._glyphIndex[e];if(!b)continue;let a;for(const d in b)if(a=b[d],a.tileIDs["delete"](c),0===a.tileIDs.size){const h=this._glyphData[a.page],m=a.rect;let n,k;for(let t=0;t<m.height;t++)for(n=this.width*(m.y+t)+m.x,k=0;k<m.width;k++)h[n+k]=0;delete b[d];this._dirties[a.page]=!0}}};q.bind=function(c,e,b,a=0){this._textures[b]||(this._textures[b]=
new x.Texture(c,{pixelFormat:v.PixelFormat.ALPHA,dataType:v.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));const d=this._textures[b];d.setSamplingMode(e);this._dirties[b]&&d.setData(this._glyphData[b]);c.bindTexture(d,a);this._dirties[b]=!1};q.dispose=function(){this._binPack=null;for(const c of this._textures)c&&c.dispose();this._textures.length=0};return f}()})},"esri/views/2d/engine/vectorTiles/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../webgl/Rect"],function(A,C){return function(){function v(f,q){this._height=this._width=0;this._free=[];this._width=f;this._height=q;this._free.push(new C(0,0,f,q))}var x=v.prototype;x.allocate=function(f,q){if(f>this._width||q>this._height)return new C;let c=null,e=-1;for(let b=0;b<this._free.length;++b){const a=this._free[b];f<=a.width&&q<=a.height&&(null===c||a.y<=c.y&&a.x<=c.x)&&(c=a,e=b)}if(null===c)return new C;this._free.splice(e,1);c.width<c.height?(c.width>f&&this._free.push(new C(c.x+
f,c.y,c.width-f,q)),c.height>q&&this._free.push(new C(c.x,c.y+q,c.width,c.height-q))):(c.width>f&&this._free.push(new C(c.x+f,c.y,c.width-f,c.height)),c.height>q&&this._free.push(new C(c.x,c.y+q,f,c.height-q)));return new C(c.x,c.y,f,q)};x.release=function(f){for(let q=0;q<this._free.length;++q){const c=this._free[q];if(c.y===f.y&&c.height===f.height&&c.x+c.width===f.x)c.width+=f.width;else if(c.x===f.x&&c.width===f.width&&c.y+c.height===f.y)c.height+=f.height;else if(f.y===c.y&&f.height===c.height&&
f.x+f.width===c.x)c.x=f.x,c.width+=f.width;else if(f.x===c.x&&f.width===c.width&&f.y+f.height===c.y)c.y=f.y,c.height+=f.height;else continue;this._free.splice(q,1);this.release(f)}this._free.push(f)};A._createClass(v,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return v}()})},"esri/views/2d/engine/vectorTiles/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(A,C){let v=function(){function f(c){this._metrics=
[];this._bitmaps=[];if(c)for(;c.next();)switch(c.tag()){case 1:{const e=c.getMessage();for(;e.next();)switch(e.tag()){case 3:{const b=e.getMessage();let a,d,h,m,n,k,t;for(;b.next();)switch(b.tag()){case 1:a=b.getUInt32();break;case 2:d=b.getBytes();break;case 3:h=b.getUInt32();break;case 4:m=b.getUInt32();break;case 5:n=b.getSInt32();break;case 6:k=b.getSInt32();break;case 7:t=b.getUInt32();break;default:b.skip()}b.release();a&&(this._metrics[a]={width:h,height:m,left:n,top:k,advance:t},this._bitmaps[a]=
d);break}default:e.skip()}e.release();break}default:c.skip()}}var q=f.prototype;q.getMetrics=function(c){return this._metrics[c]};q.getBitmap=function(c){return this._bitmaps[c]};return f}(),x=function(){function f(){this._ranges=[]}var q=f.prototype;q.getRange=function(c){return this._ranges[c]};q.addRange=function(c,e){this._ranges[c]=e};return f}();return function(){function f(c){this._glyphInfo={};this._baseURL=c}var q=f.prototype;q.getRange=function(c,e){const b=this._getFontStack(c);if(b.getRange(e))return Promise.resolve();
const a=256*e,d=a+255;c=this._baseURL.replace("{fontstack}",c).replace("{range}",a+"-"+d);return A(c,{responseType:"array-buffer"}).then(h=>{b.addRange(e,new v(new C(new Uint8Array(h.data),new DataView(h.data))))}).catch(()=>{b.addRange(e,new v)})};q.getGlyph=function(c,e){if(c=this._getFontStack(c)){var b=Math.floor(e/256);if(!(256<b)&&(c=c.getRange(b)))return{metrics:c.getMetrics(e),bitmap:c.getBitmap(e)}}};q._getFontStack=function(c){let e=this._glyphInfo[c];e||(e=this._glyphInfo[c]=new x);return e};
return f}()})},"esri/views/2d/engine/vectorTiles/SpriteMosaic":function(){define(["../../../../symbols/cim/CIMSymbolHelper","./RectangleBinPack","../webgl/Rect","../../../webgl/enums","../../../webgl/Texture"],function(A,C,v,x,f){return function(){function q(e,b,a=0){this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=e||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");
this._pageWidth=e;this._pageHeight=b;0<a&&(this._maxItemSize=a);this._binPack=new C(e-4,b-4)}var c=q.prototype;c.dispose=function(){this._binPack=null;this._mosaicRects={};for(const e of this._textures)e&&e.dispose();this._textures.length=0};c.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]};c.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]};c.getPageSize=function(e){return e>=this._size.length?null:this._size[e]};c.setSpriteSource=function(e){this.dispose();
this.pixelRatio=e.devicePixelRatio;if(0===this._mosaicsData.length){this._binPack=new C(this._pageWidth-4,this._pageHeight-4);const b=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));this._mosaicsData[0]=b;this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}this._sprites=e};c.getSpriteItem=function(e,b=!1){var a=this._mosaicRects[e];if(a)return a;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;let d;e&&
e.startsWith("dasharray-")?([a,d]=this._rasterizeDash(e),b=!0):a=this._sprites.getSpriteInfo(e);if(!a||!a.width||!a.height||0>a.width||0>a.height)return null;const h=a.width,m=a.height,[n,k,t]=this._allocateImage(h,m);if(0>=n.width)return null;this._copy(n,a,k,t,b,d);a={rect:n,width:h,height:m,sdf:a.sdf,simplePattern:!1,pixelRatio:a.pixelRatio,page:k};return this._mosaicRects[e]=a};c.getSpriteItems=function(e){const b={};for(const a of e)b[a.name]=this.getSpriteItem(a.name,a.repeat);return b};c.getMosaicItemPosition=
function(e,b){b=(e=this.getSpriteItem(e,b))&&e.rect;if(!b)return null;b.width=e.width;b.height=e.height;return{tl:[b.x+2,b.y+2],br:[b.x+2+e.width,b.y+2+e.height],page:e.page}};c.bind=function(e,b,a=0,d=0){this._textures[a]||(this._textures[a]=new f.Texture(e,{pixelFormat:x.PixelFormat.RGBA,dataType:x.PixelType.UNSIGNED_BYTE,wrapMode:x.TextureWrapMode.CLAMP_TO_EDGE,width:this._size[a][0],height:this._size[a][1]},new Uint8Array(this._mosaicsData[a].buffer)));const h=this._textures[a];h.setSamplingMode(b);
this._dirties[a]&&h.setData(new Uint8Array(this._mosaicsData[a].buffer));e.bindTexture(h,d);this._dirties[a]=!1};q._copyBits=function(e,b,a,d,h,m,n,k,t,w,l){let u=d*b+a;n=k*m+n;if(l)for(n-=m,l=-1;l<=w;l++,u=((l+w)%w+d)*b+a,n+=m)for(k=-1;k<=t;k++)h[n+k]=e[u+(k+t)%t];else for(a=0;a<w;a++){for(d=0;d<t;d++)h[n+d]=e[u+d];u+=b;n+=m}};c._copy=function(e,b,a,d,h,m){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(a>=this._mosaicsData.length)){var n=new Uint32Array(m?m.buffer:this._sprites.image.buffer),
k=this._mosaicsData[a];k&&n||console.error("Source or target images are uninitialized!");q._copyBits(n,m?b.width:this._sprites.width,b.x,b.y,k,d[0],e.x+2,e.y+2,b.width,b.height,h);this._dirties[a]=!0}};c._allocateImage=function(e,b){e+=2;b+=2;var a=Math.max(e,b);if(this._maxItemSize&&this._maxItemSize<a)return a=new v(0,0,e,b),this._mosaicsData.push(new Uint32Array(e*b)),this._dirties.push(!0),this._size.push([e,b]),this._textures.push(void 0),[a,this._mosaicsData.length-1,[e,b]];a=e%4?4-e%4:4;let d=
b%4?4-b%4:4;1===a&&(a=5);1===d&&(d=5);a=this._binPack.allocate(e+a,b+d);return 0>=a.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new C(this._pageWidth-4,this._pageHeight-4),this._allocateImage(e,b)):[a,this._currentPage,[this._pageWidth,
this._pageHeight]]};c._rasterizeDash=function(e){var b=e.match(/\[(.*?)\]/);if(!b)return null;b=b[1].split(",").map(Number);e=e.slice(e.lastIndexOf("-")+1);const [a,d,h]=A.SymbolHelper.rasterizeDash(b,e);e=new Uint8Array(a.buffer);return[{x:0,y:0,width:d,height:h,sdf:!0,pixelRatio:1},e]};return q}()})},"esri/views/2d/engine/vectorTiles/decluttering/debugging":function(){define(["exports"],function(A){function C(v,x){return`${Math.round(10*v)/10}${x}`}A.drawColliders=function(v,x){const f=window.COLLISION_XRAY;
for(let m=0;m<x.length;++m){const n=!x[m].unique.show;if(f||!n)for(const k of x[m].colliders){if(!k.enabled)continue;var q=!x[m].unique.parts[k.partIndex].show;if(!f&&q)continue;var c=k.xScreen,e=k.yScreen;const t=k.dxScreen,w=k.dyScreen;v.globalAlpha=n||q?.2:1;q=v;var b=c-1,a=e-1;q.fillStyle="green";q.fillRect(b,a,3,3);q=v;b=c+t;a=e+w;var d=k.width,h=k.height;q.strokeStyle="red";q.strokeRect(b,a,d,h);q=v;c=c+t-1;e=e+w-1;q.fillStyle="blue";q.fillRect(c,e,3,3);v.globalAlpha=1}}};A.drawGridIndex=function(v,
x){v.strokeStyle="black";const f=x.cellSize,q=x.rows,c=x.columns;for(let e=0;e<q;e++){const b=x.cells[e],a=e*f,d=(e+1)*f;for(let h=0;h<c;h++){const m=b[h],n=h*f;v.strokeRect(n,a,(h+1)*f-n,d-a);v.fillText(`cells:${m.length}`,n+4,a+12)}}};A.perfAdd=function(v,x,f){if(window.PERFORMANCE_RECORDING_STORAGE){var q=window.PERFORMANCE_RECORDING_STORAGE;q.perf=q.perf||{};q=q.perf;q[v]=q[v]||{start:null,time:0,min:void 0,max:void 0,samples:[],unit:f};q[v].time+=x;q[v].samples.push(x);if(null==q[v].min||x<q[v].min)q[v].min=
x;if(null==q[v].max||x>q[v].max)q[v].max=x}};A.perfClear=function(){window.PERFORMANCE_RECORDING_STORAGE&&(window.PERFORMANCE_RECORDING_STORAGE.perf={})};A.perfElement=function(v){if(!window.PERFORMANCE_RECORDING_STORAGE){var x=document.createElement("div");x.innerHTML="No recorded data is present because performance recording is disabled.";return x}x=document.createElement("div");var f=window.PERFORMANCE_RECORDING_STORAGE.perf;var q='\x3ctable style\x3d"border-collapse: collapse;"\x3e'+`<tr style="text-weight: bold; border-bottom: 1px solid "${v}";"><td>Name</td><td>Total</td><td>Runs</td><td>Average</td><td>Min</td><td>Distribution</td><td>Max</td><td>Histogram (${50} bins)</td></tr>`;
const c=[];for(var e in f)c.push({name:e,value:f[e].time/f[e].samples.length,sortkey:f[e].max});c.sort((n,k)=>-(n.sortkey-k.sortkey));e=c.map(n=>n.name);for(var b of e)q+="\x3ctr\x3e",q+=`<td>${b}</td>`,q+=`<td>${C(f[b].time,f[b].unit)}</td>`,q+=`<td>${f[b].samples.length}</td>`,q+=`<td>${C(f[b].time/f[b].samples.length,f[b].unit)}</td>`,q+=`<td style="text-align: right;">${C(f[b].min,f[b].unit)}</td>`,q+="\x3ctd data-distribution\x3d'1'\x3e\x3c/td\x3e",q+=`<td>${C(f[b].max,f[b].unit)}</td>`,q+="\x3ctd data-histogram\x3d'1'\x3e\x3c/td\x3e",
q+="\x3c/tr\x3e";x.innerHTML=q+"\x3ctable\x3e";q=x.querySelectorAll("td[data-distribution\x3d'1']");b=x.querySelectorAll("td[data-histogram\x3d'1']");for(let n=0;n<q.length;n++){let k=q[n];var a=document.createElement("canvas");a.height=10;a.width=100;var d=a.getContext("2d");d.strokeStyle=v;d.beginPath();d.moveTo(0,5);d.lineTo(100,5);if(f[e[n]].max>f[e[n]].min+.001)for(const t of f[e[n]].samples){var h=(t-f[e[n]].min)/(f[e[n]].max-f[e[n]].min);d.moveTo(100*h,3);d.lineTo(100*h,7)}d.stroke();d.strokeRect((c[n].value-
f[e[n]].min)/(f[e[n]].max-f[e[n]].min)*100-2,0,4,9);k.appendChild(a);k=b[n];{a=Array(50);for(d=0;d<a.length;d++)a[d]=0;for(const w of f[e[n]].samples)d=(w-f[e[n]].min)/(f[e[n]].max-f[e[n]].min),a[1===d?a.length-1:Math.floor(d*a.length)]++;d=document.createElement("canvas");d.height=30;d.width=120;h=d.getContext("2d");h.strokeStyle=v;h.fillStyle=v;let t=0;for(var m=0;m<a.length;m++)t=Math.max(t,a[m]);for(m=0;m<a.length;m++){const w=a[m];h.fillRect(m*d.width/a.length,d.height*(1-w/t),d.width/a.length,
w/t*d.height)}h.beginPath();h.moveTo(0,d.height);h.lineTo(d.width,d.height);h.stroke();k.appendChild(d)}}v=x.querySelectorAll("td");for(f=0;f<v.length;f++)v[f].style.padding="5px";return x};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/TileManager":function(){define(["exports","../../../../core/LRUCache","../../../../core/maybe","../../tiling/TileCoverage","../../tiling/TileKey"],function(A,C,v,x,f){const q=(e,b)=>e+1/(1<<2*b);let c=function(){function e(a,
d){this._tiles=new Map;this._tileCache=new C(40,h=>h.dispose());this._viewSize=[0,0];this._visibleTiles=new Map;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this._container=d}var b=e.prototype;b.destroy=function(){for(const [,a]of this._tiles)a.dispose();this._tiles=null;this._tileCache.clear();this._tileCache=null};b.update=function(a){this._updateCacheSize(a);const d=this.tileInfoView;a=d.getTileCoverage(a.state,0,"smallest");const {spans:h,lodInfo:m}=
a,{level:n}=m,k=this._tiles,t=new Set,w=new Set;for(const {row:u,colFrom:D,colTo:I}of h)for(let H=D;H<=I;H++){const B=f.getId(n,u,m.normalizeCol(H),m.getWorldForColumn(H)),y=this._getOrAcquireTile(B);t.add(B);y.processed()?this._addToContainer(y):w.add(new f(B))}for(const [u,D]of k)D.isCoverage=t.has(u);for(var l of w)this._findPlaceholdersForMissingTiles(l,t);l=!1;for(const [u,D]of k)D.neededForCoverage=t.has(u),D.neededForCoverage||D.isHoldingForFade&&d.intersects(a,D.key)&&t.add(u),D.isFading&&
(l=!0);for(const [u]of this._tiles)t.has(u)||this._releaseTile(u);x.pool.release(a);return!l};b.clear=function(){this._tiles.clear();this._tileCache.clear();this._visibleTiles.clear()};b.clearCache=function(){this._tileCache.clear()};b._findPlaceholdersForMissingTiles=function(a,d){var h=[];for(const [,m]of this._tiles)this._addPlaceholderChild(h,m,a,d);h=h.reduce(q,0);1E-6>Math.abs(1-h)||this._addPlaceholderParent(a.id,d)};b._addPlaceholderChild=function(a,d,h,m){if(!(d.key.level<=h.level)&&d.hasData()){{var n=
d.key;const k=n.level-h.level;n=h.row===n.row>>k&&h.col===n.col>>k&&h.world===n.world}n&&(this._addToContainer(d),m.add(d.id),a.push(d.key.level-h.level))}};b._addPlaceholderParent=function(a,d){const h=this._tiles;for(;;){{const [n,k,t,w]=a.split("/");a=parseInt(n,10);a=0===a?null:`${a-1}/${parseInt(k,10)>>1}/${parseInt(t,10)>>1}/${parseInt(w,10)}`}if(!a||d.has(a))break;const m=h.get(a);if(m&&m.hasData()){this._addToContainer(m);d.add(m.id);break}}};b._getOrAcquireTile=function(a){let d=this._tiles.get(a);
if(d)return d;(d=this._tileCache.pop(a))||(d=this.acquireTile(new f(a)));this._tiles.set(a,d);return d};b._releaseTile=function(a){const d=this._tiles.get(a);this.releaseTile(d);this._removeFromContainer(d);this._tiles.delete(a);d.hasData()?this._tileCache.put(a,d,1):d.dispose()};b._addToContainer=function(a){let d;const h=[],m=this._container;if(!m.contains(a)){var n=this._visibleTiles;for(const [,k]of n)this._canConnectDirectly(a,k)&&h.push(k),v.isNone(d)&&this._canConnectDirectly(k,a)&&(d=k);if(v.isSome(d)){for(const k of h)d.childrenTiles.delete(k),
a.childrenTiles.add(k),k.parentTile=a;d.childrenTiles.add(a);a.parentTile=d}else for(const k of h)a.childrenTiles.add(k),k.parentTile=a;n.set(a.id,a);m.addChild(a)}};b._removeFromContainer=function(a){this._visibleTiles.delete(a.id);this._container.removeChild(a);if(v.isSome(a.parentTile)){a.parentTile.childrenTiles.delete(a);for(const d of a.childrenTiles)v.isSome(a.parentTile)&&a.parentTile.childrenTiles.add(d)}for(const d of a.childrenTiles)d.parentTile=a.parentTile;a.parentTile=null;a.childrenTiles.clear()};
b._canConnectDirectly=function(a,d){a=a.key;let {level:h,row:m,col:n,world:k}=d.key;for(d=this._visibleTiles;0<h;){h--;m>>=1;n>>=1;if(a.level===h&&a.row===m&&a.col===n&&a.world===k)return!0;if(d.has(`${h}/${m}/${n}/${k}`))break}return!1};b._updateCacheSize=function(a){a=a.state.size;if(a[0]!==this._viewSize[0]||a[1]!==this._viewSize[1]){var d=Math.ceil(a[0]/512)+1,h=Math.ceil(a[1]/512)+1;this._viewSize[0]=a[0];this._viewSize[1]=a[1];this._tileCache.maxSize=5*d*h}};return e}();A.TileManager=c;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/VectorTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./enums ./RenderBucket ./decluttering/config ../webgl/TiledDisplayObject".split(" "),function(A,C,v,x,f,q,c,e,b){b=function(d){function h(n,k,t,w,l,u,D=null){k=d.call(this,n,k,t,w,l,4096,4096)||this;k._memCache=D;k.type="vector-tile";k._referenced=0;k._hasSymbolBuckets=!1;k._memoryUsedByLayerData=
0;k.layerData=new Map;k.layerCount=0;k.status="loading";k.allSymbolsFadingOut=!1;k.lastOpacityUpdate=0;k.symbols=new Map;k.isCoverage=!1;k.neededForCoverage=!1;k.decluttered=!1;k.invalidating=!1;k.parentTile=null;k.childrenTiles=new Set;k._processed=!1;k._referenced=1;k.styleRepository=u;k.id=n.id;return k}C._inheritsLoose(h,d);var m=h.prototype;m.setData=function(n){this.changeDataImpl(n);this.requestRender();this.ready();this.invalidating=!1;this._processed=!0};m.deleteLayerData=function(n){let k=
!1;for(const t of n)this.layerData.has(t)&&(n=this.layerData.get(t),this._memoryUsedByLayerData-=n.memoryUsed,n.type===q.BucketType.SYMBOL&&this.symbols.has(t)&&(this.symbols.delete(t),k=!0),n.destroy(),this.layerData.delete(t),this.layerCount--);v.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData);k&&this.emit("symbols-changed");this.requestRender()};m.processed=function(){return this._processed};m.hasData=function(){return 0<this.layerCount};m.dispose=
function(){"unloaded"!==this.status&&(a.delete(this),h._destroyRenderBuckets(this.layerData),this.layerData=null,this._memoryUsedByLayerData=this.layerCount=0,this.destroy(),this.status="unloaded")};m.release=function(){return 0===--this._referenced?(this.dispose(),this.stage=null,!0):!1};m.retain=function(){++this._referenced};m.changeDataImpl=function(n){let k=!1;if(n){const {bucketsWithData:t,emptyBuckets:w}=n;n=this._createRenderBuckets(t);if(w&&0<w.byteLength){const l=new Uint32Array(w);for(const u of l)this._deleteLayerData(u)}for(const [l,
u]of n)this._deleteLayerData(l),u.type===q.BucketType.SYMBOL&&(this.symbols.set(l,u.symbols),k=!0),this._memoryUsedByLayerData+=u.memoryUsed,this.layerData.set(l,u),this.layerCount++;v.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const [,t]of this.layerData)t.type===q.BucketType.SYMBOL&&(this._hasSymbolBuckets=!0);k&&this.emit("symbols-changed")};m.attachWithContext=function(n){this.stage={context:n,trashDisplayObject(k){k.processDetach()},
untrashDisplayObject(){return!1}}};m.setTransform=function(n,k){d.prototype.setTransform.call(this,n,k);var t=k/(n.resolution*n.pixelRatio);k=this.width/this.rangeX*t;t*=this.height/this.rangeY;const w=[0,0];n.toScreen(w,[this.x,this.y]);const l=this.transforms.tileUnitsToPixels;x.identity(l);x.translate(l,l,w);x.rotate(l,l,Math.PI*n.rotation/180);x.scale(l,l,[k,t,1])};m._createTransforms=function(){return{dvs:f.create(),tileMat3:f.create(),tileUnitsToPixels:f.create()}};h._destroyRenderBuckets=function(n){if(n){var k=
new Set;n.forEach(t=>{k.has(t)||(t.destroy(),k.add(t))});n.clear()}};m._createRenderBuckets=function(n){const k=new Map,t=new Map;for(const w of n){n=this._deserializeBucket(w,t);for(const l of n.layerUIDs)k.set(l,n)}return k};m._deserializeBucket=function(n,k){let t=k.get(n);if(t)return t;switch((new Uint32Array(n))[0]){case q.BucketType.FILL:t=new c.FillRenderBucket(n,this.styleRepository);break;case q.BucketType.LINE:t=new c.LineRenderBucket(n,this.styleRepository);break;case q.BucketType.SYMBOL:t=
new c.SymbolRenderBucket(n,this.styleRepository,this);break;case q.BucketType.CIRCLE:t=new c.CircleRenderBucket(n,this.styleRepository)}k.set(n,t);return t};m._deleteLayerData=function(n){if(this.layerData.has(n)){var k=this.layerData.get(n);this._memoryUsedByLayerData-=k.memoryUsed;k.destroy();this.layerData.delete(n);this.layerCount--}};C._createClass(h,[{key:"hasSymbolBuckets",get:function(){return this._hasSymbolBuckets}},{key:"isFading",get:function(){return this._hasSymbolBuckets&&performance.now()-
this.lastOpacityUpdate<e.FADE_DURATION}},{key:"isHoldingForFade",get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<e.FADE_DURATION)}},{key:"wasRequested",get:function(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status}},{key:"referenced",get:function(){return this._referenced}},{key:"memoryUsage",get:function(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}}]);return h}(b.TiledDisplayObject);
const a=new Map;A.VectorTile=b;A.printAllocations=function(){a.forEach((d,h)=>{console.log(`\n${h.key}:`);d[0].forEach(m=>console.log(m));console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");d[1].forEach(m=>console.log(m))})};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/RenderBucket":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./enums ./decluttering/util ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(A,C,v,x,f,q,c,e){let b=function(){function n(t,w){this.layerUIDs=[];this.isDestroyed=!1;this.data=t;this.memoryUsed=t.byteLength;let l=1;t=new Uint32Array(t);this.layerUIDs=[];const u=t[l++];for(let D=0;D<u;D++)this.layerUIDs[D]=t[l++];this.bufferDataOffset=l;w&&(this.layer=w.getStyleLayerByUID(this.layerUIDs[0]))}var k=n.prototype;k.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)};k.prepareForRendering=function(t){v.isNone(this.data)||(this.doPrepareForRendering(t,
this.data,this.bufferDataOffset),this.data=null)};C._createClass(n,[{key:"isPreparedForRendering",get:function(){return v.isNone(this.data)}},{key:"offset",get:function(){return this.bufferDataOffset}}]);return n}(),a=function(n){function k(w,l){l=n.call(this,w,l)||this;l.type=x.BucketType.LINE;l.lineIndexStart=0;l.lineIndexCount=0;w=new Uint32Array(w);let u=l.bufferDataOffset;l.lineIndexStart=w[u++];l.lineIndexCount=w[u++];const D=w[u++];if(0<D){const I=new Map;for(let H=0;H<D;H++){const B=w[u++],
y=w[u++],F=w[u++];I.set(B,[y,F])}l.patternMap=I}l.bufferDataOffset=u;return l}C._inheritsLoose(k,n);var t=k.prototype;t.hasData=function(){return 0<this.lineIndexCount};t.triangleCount=function(){return this.lineIndexCount/3};t.doDestroy=function(){v.isSome(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose();v.isSome(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose();v.isSome(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose();this.lineIndexBuffer=this.lineVertexBuffer=this.lineVertexArrayObject=
null;this.memoryUsed=0};t.doPrepareForRendering=function(w,l,u){l=new Uint32Array(l);var D=new Int32Array(l.buffer);const I=l[u++];this.lineVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;D=l[u++];this.lineIndexBuffer=q.BufferObject.createIndex(w,c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,D));u+=D;u=this.layer.lineMaterial;this.lineVertexArrayObject=new e.VertexArrayObject(w,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.lineVertexBuffer},
this.lineIndexBuffer)};return k}(b),d=function(n){function k(w,l){l=n.call(this,w,l)||this;l.type=x.BucketType.FILL;l.fillIndexStart=0;l.fillIndexCount=0;l.outlineIndexStart=0;l.outlineIndexCount=0;w=new Uint32Array(w);let u=l.bufferDataOffset;l.fillIndexStart=w[u++];l.fillIndexCount=w[u++];l.outlineIndexStart=w[u++];l.outlineIndexCount=w[u++];const D=w[u++];if(0<D){const I=new Map;for(let H=0;H<D;H++){const B=w[u++],y=w[u++],F=w[u++];I.set(B,[y,F])}l.patternMap=I}l.bufferDataOffset=u;return l}C._inheritsLoose(k,
n);var t=k.prototype;t.hasData=function(){return 0<this.fillIndexCount||0<this.outlineIndexCount};t.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3};t.doDestroy=function(){v.isSome(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose();v.isSome(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose();v.isSome(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose();this.fillIndexBuffer=this.fillVertexBuffer=this.fillVertexArrayObject=null;v.isSome(this.outlineVertexArrayObject)&&
this.outlineVertexArrayObject.dispose();v.isSome(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose();v.isSome(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose();this.outlineIndexBuffer=this.outlineVertexBuffer=this.outlineVertexArrayObject=null;this.memoryUsed=0};t.doPrepareForRendering=function(w,l,u){l=new Uint32Array(l);var D=new Int32Array(l.buffer),I=l[u++];this.fillVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;I=l[u++];
this.fillIndexBuffer=q.BufferObject.createIndex(w,c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,I));u+=I;I=l[u++];this.outlineVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;D=l[u++];this.outlineIndexBuffer=q.BufferObject.createIndex(w,c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,D));u+=D;l=this.layer;u=l.fillMaterial;l=l.outlineMaterial;this.fillVertexArrayObject=new e.VertexArrayObject(w,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.fillVertexBuffer},
this.fillIndexBuffer);this.outlineVertexArrayObject=new e.VertexArrayObject(w,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)};return k}(b),h=function(n){function k(w,l,u){l=n.call(this,w,l)||this;l.type=x.BucketType.SYMBOL;l.iconPerPageElementsMap=new Map;l.glyphPerPageElementsMap=new Map;l.symbolInstances=[];l.isIconSDF=!1;l.opacityChanged=!1;l.lastOpacityUpdate=0;l.symbols=[];const D=new Uint32Array(w),I=new Int32Array(w);w=new Float32Array(w);
let H=l.bufferDataOffset;l.isIconSDF=!!D[H++];var B=D[H++];for(var y=0;y<B;y++){var F=D[H++],N=D[H++],Q=D[H++];l.iconPerPageElementsMap.set(F,[N,Q])}B=D[H++];for(y=0;y<B;y++)F=D[H++],N=D[H++],Q=D[H++],l.glyphPerPageElementsMap.set(F,[N,Q]);B=D[H++];y=D[H++];l.iconOpacity=new Int32Array(B);l.textOpacity=new Int32Array(y);H=f.deserializeSymbols(D,I,w,H,l.symbols,u);l.bufferDataOffset=H;return l}C._inheritsLoose(k,n);var t=k.prototype;t.hasData=function(){return 0<this.iconPerPageElementsMap.size||0<
this.glyphPerPageElementsMap.size};t.triangleCount=function(){let w=0;for(const [,l]of this.iconPerPageElementsMap)w+=l[1];for(const [,l]of this.glyphPerPageElementsMap)w+=l[1];return w/3};t.doDestroy=function(){v.isSome(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose();v.isSome(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose();v.isSome(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose();v.isSome(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose();this.iconIndexBuffer=
this.iconOpacityBuffer=this.iconVertexBuffer=this.iconVertexArrayObject=null;v.isSome(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose();v.isSome(this.textVertexBuffer)&&this.textVertexBuffer.dispose();v.isSome(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose();v.isSome(this.textIndexBuffer)&&this.textIndexBuffer.dispose();this.textIndexBuffer=this.textOpacityBuffer=this.textVertexBuffer=this.textVertexArrayObject=null;this.memoryUsed=0};t.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=
!1;var w=v.unwrap(this.iconOpacity),l=v.unwrap(this.iconOpacityBuffer);0<w.length&&w.byteLength===l.size&&l.setSubData(w);w=v.unwrap(this.textOpacity);l=v.unwrap(this.textOpacityBuffer);0<w.length&&w.byteLength===l.size&&l.setSubData(w)}};t.doPrepareForRendering=function(w,l,u){l=new Uint32Array(l);var D=new Int32Array(l.buffer),I=l[u++];this.iconVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;I=l[u++];this.iconIndexBuffer=q.BufferObject.createIndex(w,
c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,I));u+=I;I=l[u++];this.textVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;D=l[u++];this.textIndexBuffer=q.BufferObject.createIndex(w,c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,D));u+=D;this.iconOpacityBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,v.unwrap(this.iconOpacity).buffer);this.textOpacityBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,v.unwrap(this.textOpacity).buffer);
l=this.layer;u=l.iconMaterial;l=l.textMaterial;this.iconVertexArrayObject=new e.VertexArrayObject(w,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer);this.textVertexArrayObject=new e.VertexArrayObject(w,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)};return k}(b),m=function(n){function k(w,l){l=n.call(this,w,l)||this;l.type=x.BucketType.CIRCLE;
l.circleIndexStart=0;l.circleIndexCount=0;w=new Uint32Array(w);let u=l.bufferDataOffset;l.circleIndexStart=w[u++];l.circleIndexCount=w[u++];l.bufferDataOffset=u;return l}C._inheritsLoose(k,n);var t=k.prototype;t.hasData=function(){return 0<this.circleIndexCount};t.triangleCount=function(){return this.circleIndexCount/3};t.doDestroy=function(){v.isSome(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose();v.isSome(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose();v.isSome(this.circleIndexBuffer)&&
this.circleIndexBuffer.dispose();this.circleIndexBuffer=this.circleVertexBuffer=this.circleVertexArrayObject=null;this.memoryUsed=0};t.doPrepareForRendering=function(w,l,u){l=new Uint32Array(l);var D=new Int32Array(l.buffer);const I=l[u++];this.circleVertexBuffer=q.BufferObject.createVertex(w,c.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*u,I));u+=I;D=l[u++];this.circleIndexBuffer=q.BufferObject.createIndex(w,c.Usage.STATIC_DRAW,new Uint32Array(l.buffer,4*u,D));u+=D;u=this.layer.circleMaterial;this.circleVertexArrayObject=
new e.VertexArrayObject(w,u.getAttributeLocations(),u.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)};return k}(b);A.CircleRenderBucket=m;A.FillRenderBucket=d;A.LineRenderBucket=a;A.RenderBucketBase=b;A.SymbolRenderBucket=h;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/util":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../enums","./core"],function(A,C,v,x,
f){let q=function(a){this.tile=a;this.parent=null;this.children=new Set},c=function(){function a(){this.nodes=new Map;this.roots=new Set}var d=a.prototype;d.create=function(h){const m=new q(h);let n;const k=[];this.nodes.forEach(t=>{this._canConnectDirectly(m,t)&&k.push(t);!n&&this._canConnectDirectly(t,m)&&(n=t)});if(n){for(const t of k)n.children.delete(t),m.children.add(t),t.parent=m;n.children.add(m);m.parent=n}else{this.roots.add(m);for(const t of k)m.children.add(t),t.parent=m,this.roots.delete(t)}this.nodes.set(h.key.id,
m);return m};d.destroy=function(h){v.isSome(h.parent)?(h.parent.children.delete(h),h.children.forEach(m=>{v.isSome(h.parent)&&h.parent.children.add(m)})):this.roots.delete(h);h.children.forEach(m=>{(m.parent=h.parent)||this.roots.add(m)});this.nodes.delete(h.tile.key.id)};d.clear=function(){this.roots.clear();this.nodes.clear()};d._canConnectDirectly=function(h,m){let {level:n,row:k,col:t}=m.tile.key;for({world:m}=m.tile.key;0<n;){n--;k>>=1;t>>=1;if(h.tile.key.level===n&&h.tile.key.row===k&&h.tile.key.col===
t&&h.tile.key.world===m)return!0;if(this.nodes.has(`${n}/${k}/${t}/${m}`))break}return!1};return a}(),e=function(){function a(){this._tileGraph=new c;this._tileArray=null}var d=a.prototype;d.has=function(h){return"string"===typeof h?this._tileGraph.nodes.has(h):this._tileGraph.nodes.has(h.key.id)};d.getAll=function(){this._tileArray||(this._tileArray=[],this._tileGraph.nodes.forEach(h=>{this._tileArray.push(h.tile)}));return this._tileArray};d.getRoots=function(){const h=[];this._tileGraph.roots.forEach(m=>
{h.push(m.tile)});return h};d.getParent=function(h){h=this._tileGraph.nodes.get("string"===typeof h?h:h.key.id);return v.isSome(h.parent)&&h.parent.tile};d.getChildren=function(h){const m=[];this._tileGraph.nodes.get("string"===typeof h?h:h.key.id).children.forEach(n=>{m.push(n.tile)});return m};d.get=function(h){return this._tileGraph.nodes.get(h).tile};d.removeKey=function(h){h=this._tileGraph.nodes.get(h);this._tileGraph.destroy(h);this._tileArray=null};d.forEach=function(h){this._tileGraph.nodes.forEach((m,
n)=>h(m.tile,n))};d.add=function(h){this._tileGraph.create(h);this._tileArray=null};d.remove=function(h){h=this._tileGraph.nodes.get(h.key.id);this._tileGraph.destroy(h);this._tileArray=null};d.clear=function(){this._tileGraph.clear();this._tileArray=[]};return a}(),b=function(){function a(h,m,n){this._rows=Math.ceil(m/n);this._columns=Math.ceil(h/n);this._cellSize=n;this.cells=Array(this._rows);for(h=0;h<this._rows;h++)for(this.cells[h]=Array(this._columns),m=0;m<this._columns;m++)this.cells[h][m]=
[]}var d=a.prototype;d.getCell=function(h,m){m=Math.min(Math.max(Math.floor(m/this._cellSize),0),this._rows-1);h=Math.min(Math.max(Math.floor(h/this._cellSize),0),this._columns-1);return this.cells[m]&&this.cells[m][h]||null};d.getCellSpan=function(h,m,n,k){return[Math.min(Math.max(Math.floor(h/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(m/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(n/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(k/this._cellSize),
0),this.rows-1)]};C._createClass(a,[{key:"cellSize",get:function(){return this._cellSize}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]);return a}();A.GridIndex=b;A.TileForest=e;A.TileGraph=c;A.TileNode=q;A.deserializeSymbols=function(a,d,h,m,n,k){const t=d[m++];for(let u=0;u<t;u++){const D=new f.VTLSymbol(k);D.xTile=d[m++];D.yTile=d[m++];D.hash=d[m++];D.priority=d[m++];var w=d[m++];for(var l=0;l<w;l++){const I=d[m++],H=d[m++],B=d[m++],y=d[m++],
F=!!d[m++],N=d[m++],Q=h[m++],L=h[m++],T=d[m++],R=d[m++];D.colliders.push({xTile:I,yTile:H,dxPixels:B,dyPixels:y,hard:F,partIndex:N,width:T,height:R,minLod:Q,maxLod:L})}w=a[m++];for(l=0;l<w;l++)D.textVertexRanges.push([a[m++],a[m++]]);w=a[m++];for(l=0;l<w;l++)D.iconVertexRanges.push([a[m++],a[m++]]);n.push(D)}return m};A.tileCoordChange=function(a,d,h,m,n,k){h-=n;if(0<=h)return(d>>h)+(m-(k<<h))*(a>>h);h=-h;return d-(k-(m<<h))*(a>>h)<<h};A.writeOpacityToBuffers=function(a,d,h){for(const [u,D]of a.symbols){{var m=
a,n=d,k=h,t=D;const I=m.layerData.get(u);if(I.type===x.BucketType.SYMBOL){for(const H of t){t=H.unique;var w=void 0;if(H.selectedForRendering){var l=t.parts[0];w=l.startOpacity;l=l.targetOpacity;m.allSymbolsFadingOut=m.allSymbolsFadingOut&&0===l;w=k?Math.floor(127*w)|l<<7:l?255:0;w|=w<<24|w<<16|w<<8}else w=0;for(const [B,y]of H.iconVertexRanges)for(l=B;l<B+y;l+=4)I.iconOpacity[l/4]=w;H.selectedForRendering?(w=t.parts[1],t=w.startOpacity,w=w.targetOpacity,m.allSymbolsFadingOut=m.allSymbolsFadingOut&&
0===w,t=k?Math.floor(127*t)|w<<7:w?255:0,w=t<<24|t<<16|t<<8|t):w=0;for(const [B,y]of H.textVertexRanges)for(t=B;t<B+y;t+=4)I.textOpacity[t/4]=w}I.lastOpacityUpdate=n;I.opacityChanged=!0}}}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/core":function(){define(["exports"],function(A){A.VTLSymbol=function(C){this.hash=this.yTile=this.xTile=0;this.priority=1;this.colliders=[];this.textVertexRanges=[];this.iconVertexRanges=[];this.tile=C};A.VTLUniqueSymbol=
function(){this.tileSymbols=[];this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}];this.show=!1};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/VectorTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../../../geometry/support/aaBoundingRect ./decluttering/SymbolFader ./style/StyleDefinition ../webgl/enums ../webgl/RenderableTile ../webgl/TileContainer ../../tiling/TileCoverage ../../tiling/TileKey ../../../webgl/enums".split(" "),
function(A,C,v,x,f,q,c,e,b,a,d,h,m){function n(k,t){if(k){const w=k.getLayoutProperty("visibility");if(!w||w.getValue()!==c.Visibility.NONE&&(void 0===k.minzoom||k.minzoom<t+1E-6)&&(void 0===k.maxzoom||k.maxzoom>=t-1E-6))return!0}return!1}a=function(k){function t(l){l=k.call(this,l)||this;l._backgroundTiles=[];l._pointToCallbacks=new Map;return l}C._inheritsLoose(t,k);var w=t.prototype;w.destroy=function(){this.removeAllChildren();this._spriteMosaic&&(this._spriteMosaic.dispose(),this._spriteMosaic=
null);this._glyphMosaic&&(this._glyphMosaic.dispose(),this._glyphMosaic=null);v.isSome(this._symbolFader)&&(this._symbolFader.clear(),this._symbolFader=null);this._styleRepository=null;this._backgroundTiles=[];this._pointToCallbacks.clear()};w.setStyleResources=function(l,u,D){this._spriteMosaic=l;this._glyphMosaic=u;this._styleRepository=D;v.isNone(this._symbolFader)&&(l=new q.SymbolFader(this._styleRepository,this.children),l.on("fade-start",()=>{this.emit("fade-start");this.requestRender()}),l.on("fade-complete",
()=>{this.emit("fade-complete");this.requestRender()}),this._symbolFader=l);v.unwrap(this._symbolFader).styleRepository=D};w.setSpriteMosaic=function(l){this._spriteMosaic.dispose();this._spriteMosaic=l};w.deleteStyleLayers=function(l){v.isSome(this._symbolFader)&&this._symbolFader.deleteStyleLayers(l)};w.hitTest=function(){var l=C._asyncToGenerator(function*(u){const D=x.createResolver();this._pointToCallbacks.set(u,D);this.requestRender();return D.promise});return function(u){return l.apply(this,
arguments)}}();w.enterTileInvalidation=function(){for(const l of this.children)l.invalidating=!0};w.createRenderParams=function(l){return{...k.prototype.createRenderParams.call(this,l),renderPass:null,styleLayer:null,styleLayerUID:-1,glyphMosaic:this._glyphMosaic,spriteMosaic:this._spriteMosaic,hasClipping:!!this._clippingInfos}};w.doRender=function(l){!this.visible||l.drawPhase!==e.WGLDrawPhase.MAP&&l.drawPhase!==e.WGLDrawPhase.DEBUG||void 0===this._spriteMosaic||k.prototype.doRender.call(this,l)};
w.addChild=function(l){k.prototype.addChild.call(this,l);v.isSome(this._symbolFader)?this._symbolFader.addTile(l):l.decluttered=!0;this.requestRender();return l};w.removeChild=function(l){v.isSome(this._symbolFader)&&this._symbolFader.removeTile(l);this.requestRender();return k.prototype.removeChild.call(this,l)};w.renderChildren=function(l){const {drawPhase:u}=l;if(u===e.WGLDrawPhase.DEBUG)k.prototype.renderChildren.call(this,l);else if(this._doRender(l),0<this._pointToCallbacks.size){l.drawPhase=
e.WGLDrawPhase.HITTEST;const D=l.painter.effects.hittestVTL;D.bind(l);this._doRender(l);D.draw(l,this._pointToCallbacks);D.unbind(l);l.drawPhase=u}};w.removeAllChildren=function(){for(let l=0;l<this.children.length;l++){const u=this.children[l];v.isSome(this._symbolFader)&&this._symbolFader.removeTile(u);u.dispose()}k.prototype.removeAllChildren.call(this)};w.getStencilTarget=function(){return this.children.filter(l=>l.neededForCoverage&&l.hasData())};w.restartDeclutter=function(){v.isSome(this._symbolFader)&&
this._symbolFader.restartDeclutter()};w._doRender=function(l){const {context:u}=l;var D=this._styleRepository;if(D){var I=D.layers,H=!0;l.drawPhase===e.WGLDrawPhase.HITTEST&&(H=!1);0<D.backgroundBucketIds.length&&(l.renderPass="background",this._renderBackgroundLayers(l,D.backgroundBucketIds));k.prototype.renderChildren.call(this,l);l.drawPhase===e.WGLDrawPhase.MAP&&this._fade(l.displayLevel,l.state);if((D=this.children.filter(y=>y.visible&&y.hasData()))&&0!==D.length){for(var B of D)B.triangleCount=
0;u.setStencilWriteMask(0);u.setColorMask(!0,!0,!0,!0);u.setStencilOp(m.StencilOperation.KEEP,m.StencilOperation.KEEP,m.StencilOperation.REPLACE);u.setStencilTestEnabled(!0);u.setBlendingEnabled(!1);u.setDepthTestEnabled(!0);u.setDepthWriteEnabled(!0);u.setDepthFunction(m.CompareFunction.LEQUAL);u.setClearDepth(1);u.clear(u.gl.DEPTH_BUFFER_BIT);l.renderPass="opaque";for(B=I.length-1;0<=B;B--)this._renderStyleLayer(I[B],l,D);u.setDepthWriteEnabled(!1);u.setBlendingEnabled(H);u.setBlendFunctionSeparate(m.BlendFactor.ONE,
m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);l.renderPass="translucent";for(H=0;H<I.length;H++)this._renderStyleLayer(I[H],l,D);u.setDepthTestEnabled(!1);l.renderPass="symbol";for(H=0;H<I.length;H++)this._renderStyleLayer(I[H],l,D)}u.bindVAO();u.setStencilTestEnabled(!0);u.setBlendingEnabled(!0)}};w._fade=function(l,u){v.isSome(this._symbolFader)&&(this._symbolFader.update(l,u)||this.requestRender())};w._renderStyleLayer=function(l,u,D){const {painter:I,renderPass:H}=
u;if(void 0!==l){var B=l.getLayoutProperty("visibility");if(!B||B.getValue()!==c.Visibility.NONE){switch(l.type){case c.StyleLayerType.BACKGROUND:return;case c.StyleLayerType.FILL:if("opaque"!==H&&"translucent"!==u.renderPass)return;var y="vtlFill";break;case c.StyleLayerType.LINE:if("translucent"!==H)return;y="vtlLine";break;case c.StyleLayerType.CIRCLE:if("symbol"!==H)return;y="vtlCircle";break;case c.StyleLayerType.SYMBOL:if("symbol"!==H)return;y="vtlSymbol"}D=l.type===c.StyleLayerType.SYMBOL?
D.filter(F=>F.decluttered):D.filter(F=>F.neededForCoverage);if("vtlSymbol"!==y&&(B=u.displayLevel,0===D.length||void 0!==l.minzoom&&l.minzoom>=B+1E-6||void 0!==l.maxzoom&&l.maxzoom<B-1E-6))return;B=l.uid;u.styleLayerUID=B;u.styleLayer=l;for(const F of D)if(F.layerData.has(B)){I.renderObjects(u,D,y);break}}}};w._renderBackgroundLayers=function(l,u){const {context:D,displayLevel:I,painter:H,state:B}=l,y=this._styleRepository;var F=!1;for(var N of u)if(y.getLayerById(N).type===c.StyleLayerType.BACKGROUND&&
n(y.getLayerById(N),I)){F=!0;break}if(F){F=this._tileInfoView.getTileCoverage(l.state,0,"smallest");var {spans:Q,lodInfo:L}=F,{level:T}=L,R=f.create();N=[];if(this._renderPasses){var S=this._renderPasses[0];v.isSome(this._clippingInfos)&&(S.brushes[0].prepareState(l,this._clippingInfos[0]),S.brushes[0].drawMany(l,this._clippingInfos))}S=this._backgroundTiles;var O=0;for(const {row:G,colFrom:M,colTo:U}of Q)for(let Y=M;Y<=U;Y++){if(O<S.length){var K=S[O];K.key.set(T,G,L.normalizeCol(Y),L.getWorldForColumn(Y));
this._tileInfoView.getTileBounds(R,K.key,!1);K.x=R[0];K.y=R[3]}else{K=new h(T,G,L.normalizeCol(Y),L.getWorldForColumn(Y));const ca=this._tileInfoView.getTileBounds(f.create(),K);K=new b.RenderableTile(K,ca[0],ca[3],512,512,4096,4096);S.push(K)}K.setTransform(B,this._tileInfoView.getTileResolution(K.key));N.push(K);O++}D.setStencilWriteMask(0);D.setColorMask(!0,!0,!0,!0);D.setStencilOp(m.StencilOperation.KEEP,m.StencilOperation.KEEP,m.StencilOperation.REPLACE);D.setStencilFunction(m.CompareFunction.EQUAL,
0,255);T=!0;l.drawPhase===e.WGLDrawPhase.HITTEST&&(T=!1);D.setStencilTestEnabled(T);for(const G of u)u=y.getLayerById(G),u.type===c.StyleLayerType.BACKGROUND&&n(u,I)&&(l.styleLayerUID=u.uid,l.styleLayer=u,H.renderObjects(l,N,"vtlBackground"));d.pool.release(F)}};return t}(a.default);A.VectorTileContainer=a;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolFader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/maybe ./config ./core ./jobs ./SymbolDeclutterer ./SymbolRepository ./util ../style/StyleDefinition".split(" "),
function(A,C,v,x,f,q,c,e,b,a,d){v=function(h){function m(k,t){var w=h.call(this)||this;w.styleRepository=k;w._tileToHandle=new Map;w._viewState={scale:0,rotation:0,center:[0,0],size:[0,0]};w._declutterViewState={scale:0,rotation:0,center:[0,0],size:[0,0]};w._completed=!1;w._symbolRepository=new b.SymbolRepository(4096,t,()=>new q.VTLUniqueSymbol);w._symbolDeclutterer=new e.SymbolDeclutterer(t,w._symbolRepository,(l,u,D)=>new c.CollisionJob(l,u,D,w.styleRepository,w._zoom,w._viewState.rotation),(l,
u)=>{l.allSymbolsFadingOut=!0;l.lastOpacityUpdate=u;a.writeOpacityToBuffers(l,u,!0);l.decluttered=!0;l.requestRender()},(l,u)=>w.styleRepository.getStyleLayerByUID(l.styleLayerUID).z-w.styleRepository.getStyleLayerByUID(u.styleLayerUID).z,l=>{l=w.styleRepository.getStyleLayerByUID(l);return w._zoom+1E-6<l.minzoom||w._zoom-1E-6>=l.maxzoom?!1:(l=l.getLayoutProperty("visibility"))&&l.getValue()===d.Visibility.NONE?!1:!0});return w}C._inheritsLoose(m,h);var n=m.prototype;n.addTile=function(k){k.decluttered=
!1;this._tileToHandle.set(k,k.on("symbols-changed",()=>{this._symbolRepository.add(k);this.restartDeclutter()}));this._symbolRepository.add(k);this.restartDeclutter()};n.removeTile=function(k){const t=this._tileToHandle.get(k);t&&(this._symbolRepository.removeTile(k),this.restartDeclutter(),t.remove(),this._tileToHandle.delete(k))};n.update=function(k,t){this._zoom=k;this._viewState={scale:t.scale,rotation:t.rotation,center:[t.center[0],t.center[1]],size:[t.size[0],t.size[1]]};this._continueDeclutter();
return this._completed};n.restartDeclutter=function(){this._completed=!1;this._symbolDeclutterer.restart();this._notifyUnstable()};n.clear=function(){this._completed=!1;this._symbolRepository=null;this._symbolDeclutterer.restart();this._tileToHandle.forEach(k=>k.remove());this._tileToHandle.clear()};n.deleteStyleLayers=function(k){this._symbolRepository.deleteStyleLayers(k)};n._continueDeclutter=function(){if(!this._completed||this.stale)this._symbolDeclutterer.running||(this._declutterZoom=this._zoom,
this._declutterViewState.center[0]=this._viewState.center[0],this._declutterViewState.center[1]=this._viewState.center[1],this._declutterViewState.rotation=this._viewState.rotation,this._declutterViewState.scale=this._viewState.scale,this._declutterViewState.size[0]=this._viewState.size[0],this._declutterViewState.size[1]=this._viewState.size[1],this._symbolDeclutterer.restart()),this._symbolDeclutterer.setScreenSize(this._viewState.size[0],this._viewState.size[1]),(this._completed=this._symbolDeclutterer.continue(f.DECLUTTER_BUDGET))&&
this._scheduleNotifyStable()};n._scheduleNotifyStable=function(){x.isSome(this._stableNotificationHandle)&&clearTimeout(this._stableNotificationHandle);this._stableNotificationHandle=setTimeout(()=>{this._stableNotificationHandle=null;this.emit("fade-complete")},1.5*f.FADE_DURATION)};n._notifyUnstable=function(){x.isSome(this._stableNotificationHandle)&&(clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=null);this.emit("fade-start")};C._createClass(m,[{key:"stale",get:function(){return this._zoom!==
this._declutterZoom||this._viewState.size[0]!==this._declutterViewState.size[0]||this._viewState.size[1]!==this._declutterViewState.size[1]||this._viewState.scale!==this._declutterViewState.scale||this._viewState.rotation!==this._declutterViewState.rotation}}]);return m}(v);A.SymbolFader=v;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/jobs":function(){define(["exports","../../../../../chunks/mat3f32","./config","./util","../style/StyleDefinition"],
function(A,C,v,x,f){let q=function(){function c(b,a,d,h,m,n){this._symbols=b;this._styleRepository=h;this._zoom=m;this._currentSymbolCursor=this._currentLayerCursor=0;this._styleProps=new Map;this._allNeededMatrices=new Map;this._gridIndex=new x.GridIndex(a,d,v.COLLISION_GRID_CELL_SIZE);this._si=Math.sin(Math.PI*n/180);this._co=Math.cos(Math.PI*n/180);for(const k of b)for(const t of k.symbols)this._allNeededMatrices.has(t.tile)||this._allNeededMatrices.set(t.tile,C.clone(t.tile.transforms.tileUnitsToPixels))}
var e=c.prototype;e.work=function(b){const a=this._gridIndex,d=performance.now();for(;this._currentLayerCursor<this._symbols.length;this._currentLayerCursor++,this._currentSymbolCursor=0){const H=this._symbols[this._currentLayerCursor],B=this._getProperties(H.styleLayerUID);for(;this._currentSymbolCursor<H.symbols.length;this._currentSymbolCursor++){if(99===this._currentSymbolCursor%100&&performance.now()-d>b)return!1;var h=H.symbols[this._currentSymbolCursor];if(!h.unique.show)continue;{var m=h,
n=this._si,k=this._co,t=this._allNeededMatrices.get(h.tile),w=this._zoom;const {iconRotationAlignment:L,textRotationAlignment:T,iconTranslate:R,iconTranslateAnchor:S,textTranslate:O,textTranslateAnchor:K}=B;var l=0;for(const G of m.colliders){const [M,U]=0===G.partIndex?R:O;var u=0===G.partIndex?S:K,D=G.minLod<=w&&w<=G.maxLod;l+=D?0:1;G.enabled=D;G.xScreen=G.xTile*t[0]+G.yTile*t[3]+t[6];G.yScreen=G.xTile*t[1]+G.yTile*t[4]+t[7];u===f.TranslateAnchor.MAP?(G.xScreen+=k*M-n*U,G.yScreen+=n*M+k*U):(G.xScreen+=
M,G.yScreen+=U);f.RotationAlignment.VIEWPORT===(0===G.partIndex?L:T)?(G.dxScreen=G.dxPixels,G.dyScreen=G.dyPixels):(G.dxScreen=k*(G.dxPixels+G.width/2)-n*(G.dyPixels+G.height/2)-G.width/2,G.dyScreen=n*(G.dxPixels+G.width/2)+k*(G.dyPixels+G.height/2)-G.height/2)}0<m.colliders.length&&l===m.colliders.length&&(m.unique.show=!1)}m=h.unique;if(!m.show)continue;const {iconAllowOverlap:y,iconIgnorePlacement:F,textAllowOverlap:N,textIgnorePlacement:Q}=B;for(const L of h.colliders)if(L.enabled&&(n=m.parts[L.partIndex],
n.show)){if(k=!(L.partIndex?N:y))a:{k=L.xScreen+L.dxScreen;t=L.yScreen+L.dyScreen;w=k+L.width;l=t+L.height;const [T,R,S,O]=a.getCellSpan(k,t,w,l);for(u=R;u<=O;u++)for(D=T;D<=S;D++){var I=a.cells[u][D];for(const K of I){I=K.xScreen+K.dxScreen;const G=K.yScreen+K.dyScreen,M=I+K.width,U=G+K.height;if(!(w<I||k>M||l<G||t>U)){k=!0;break a}}}k=!1}k&&(L.hard?m.show=!1:n.show=!1)}if(m.show)for(const L of h.colliders){if(!L.enabled)continue;if(L.partIndex?Q:F)continue;if(!m.parts[L.partIndex].show)continue;
h=L.xScreen+L.dxScreen;n=L.yScreen+L.dyScreen;const [T,R,S,O]=this._gridIndex.getCellSpan(h,n,h+L.width,n+L.height);for(h=R;h<=O;h++)for(n=T;n<=S;n++)this._gridIndex.cells[h][n].push(L)}}}return!0};e._getProperties=function(b){var a=this._styleProps.get(b);if(a)return a;a=this._zoom;const d=this._styleRepository.getStyleLayerByUID(b);var h=d.getLayoutValue("symbol-placement",a)!==f.SymbolPlacement.POINT;let m=d.getLayoutValue("icon-rotation-alignment",a);m===f.RotationAlignment.AUTO&&(m=h?f.RotationAlignment.MAP:
f.RotationAlignment.VIEWPORT);let n=d.getLayoutValue("text-rotation-alignment",a);n===f.RotationAlignment.AUTO&&(n=h?f.RotationAlignment.MAP:f.RotationAlignment.VIEWPORT);h=d.getPaintValue("icon-translate",a);const k=d.getPaintValue("icon-translate-anchor",a),t=d.getPaintValue("text-translate",a),w=d.getPaintValue("text-translate-anchor",a);a={iconAllowOverlap:d.getLayoutValue("icon-allow-overlap",a),iconIgnorePlacement:d.getLayoutValue("icon-ignore-placement",a),textAllowOverlap:d.getLayoutValue("text-allow-overlap",
a),textIgnorePlacement:d.getLayoutValue("text-ignore-placement",a),iconRotationAlignment:m,textRotationAlignment:n,iconTranslateAnchor:k,iconTranslate:h,textTranslateAnchor:w,textTranslate:t};this._styleProps.set(b,a);return a};return c}();A.CollisionJob=q;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolDeclutterer":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./config"],function(A,
C,v,x){function f(c,e){if(c.priority-e.priority)return c.priority-e.priority;const b=c.tile.key,a=e.tile.key;return b.world-a.world?b.world-a.world:b.level-a.level?b.level-a.level:b.row-a.row?b.row-a.row:b.col-a.col?b.col-a.col:c.xTile-e.xTile?c.xTile-e.xTile:c.yTile-e.yTile}let q=function(){function c(b,a,d,h,m,n){this._visibleTiles=b;this._symbolRepository=a;this._createCollisionJob=d;this._assignTileSymbolsOpacity=h;this._symbolLayerSorter=m;this._isLayerVisible=n;this._selectionJob=null;this._selectionJobCompleted=
!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0}var e=c.prototype;e.setScreenSize=function(b,a){this._screenWidth===b&&this._screenHeight===a||this.restart();this._screenWidth=b;this._screenHeight=a};e.restart=function(){this._selectionJob=null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0};e.continue=function(b){this._selectionJob||
(this._selectionJob=this._createSelectionJob());if(!this._selectionJobCompleted){var a=performance.now();if(!this._selectionJob.work(b))return!1;this._selectionJobCompleted=!0;b=Math.max(0,b-(performance.now()-a));if(0===b)return!1}this._collisionJob||(this._collisionJob=this._createCollisionJob(this._selectionJob.sortedSymbols,this._screenWidth,this._screenHeight));if(!this._collisionJobCompleted){a=performance.now();if(!this._collisionJob.work(b))return!1;this._collisionJobCompleted=!0;b=Math.max(0,
b-(performance.now()-a));if(0===b)return!1}this._opacityJob||(this._opacityJob=this._createOpacityJob());if(!this._opacityJobCompleted){a=performance.now();if(!this._opacityJob.work(b))return!1;this._opacityJobCompleted=!0;b=Math.max(0,b-(performance.now()-a));if(0===b)return!1}this._running=!1;return!0};e._createSelectionJob=function(){const b=this._symbolRepository.uniqueSymbols;for(let k=0;k<b.length;k++){const t=b[k];for(let w=0;w<t.uniqueSymbols.length;w++){const l=t.uniqueSymbols[w];for(const u of l.tileSymbols)u.selectedForRendering=
!1}}const a=[];let d=0,h=0;const m=this._isLayerVisible,n=this._symbolLayerSorter;return{work:function(k){const t=performance.now();for(;h<b.length;h++,d=0){const l=b[h];var w=l.styleLayerUID;if(!m(w)){a[h]||(a[h]={styleLayerUID:w,symbols:[]});continue}a[h]=a[h]||{styleLayerUID:w,symbols:[]};const u=a[h];for(;d<l.uniqueSymbols.length;d++){w=l.uniqueSymbols[d];if(99===d%100&&performance.now()-t>k)return!1;let D=null,I=!1,H=!1;for(const B of w.tileSymbols)if(!H||!I){const y=B.tile;if(!D||y.isCoverage||
y.neededForCoverage&&!I){D=B;if(y.neededForCoverage||y.isCoverage)H=!0;y.isCoverage&&(I=!0)}}D.selectedForRendering=!0;if(H){u.symbols.push(D);w.show=!0;for(const B of w.parts)B.show=!0}else w.show=!1}}for(const l of a)l.symbols.sort(f);return!0},get sortedSymbols(){return a.sort(n)}}};e._createOpacityJob=function(){function b(m,n){var k=m.symbols;for(const [,w]of k){var t=w;k=n;for(const l of t){t=l.unique;for(const u of t.parts)u.startOpacity+=(k-u.startTime)/x.FADE_DURATION*(.5<u.targetOpacity?
1:-1),u.startOpacity=Math.min(Math.max(u.startOpacity,0),1),u.startTime=k,u.targetOpacity=t.show&&u.show?1:0}}a(m,n);for(const w of m.childrenTiles)b(w,n)}const a=this._assignTileSymbolsOpacity,d=this._visibleTiles;let h=0;return{work(m){const n=performance.now();for(;h<d.length;h++){if(performance.now()-n>m)return!1;const k=d[h];if(v.isSome(k.parentTile))continue;const t=performance.now();b(k,t)}return!0}}};C._createClass(c,[{key:"running",get:function(){return this._running}}]);return c}();A.SymbolDeclutterer=
q;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolRepository":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./util"],function(A,C,v,x){let f=function(){function q(e,b,a){this.tileCoordRange=e;this._visibleTiles=b;this._createUnique=a;this._tiles=new Map;this._uniqueSymbolsReferences=new Map}var c=q.prototype;c.add=function(e,b){this._uniqueSymbolLayerArray=null;let a=this._tiles.get(e.id);
a||(a={symbols:new Map},this._tiles.set(e.id,a));var d=new Map;if(b)for(var h of b)a.symbols.has(h)&&(d.set(h,a.symbols.get(h)),a.symbols.delete(h));else for(var [m]of e.layerData)a.symbols.has(m)&&(d.set(m,a.symbols.get(m)),a.symbols.delete(m));this._removeSymbols(d);b=e.symbols;d=new Map;for(const [n,k]of b)if(h=k.length,32<=h){m=this.tileCoordRange;do m/=2,h/=4;while(8<h&&64<m);h=new x.GridIndex(this.tileCoordRange,this.tileCoordRange,m);d.set(n,{flat:k,index:h});a.symbols.set(n,{flat:k,index:h});
for(const t of k)h.getCell(t.xTile,t.yTile).push(t)}else d.set(n,{flat:k}),a.symbols.set(n,{flat:k});this._addSymbols(e.key,b)};c.deleteStyleLayers=function(e){this._uniqueSymbolLayerArray=null;for(const [b,a]of this._tiles){const d=new Map;for(const h of e)a.symbols.has(h)&&(d.set(h,a.symbols.get(h)),a.symbols.delete(h));this._removeSymbols(d);0===a.symbols.size&&this._tiles.delete(b)}};c.removeTile=function(e){this._uniqueSymbolLayerArray=null;const b=this._tiles.get(e.id);if(b){var a=new Map;for(const [d]of e.symbols)b.symbols.has(d)&&
(a.set(d,b.symbols.get(d)),b.symbols.delete(d));this._removeSymbols(a);0===b.symbols.size&&this._tiles.delete(e.id)}};c._removeSymbols=function(e){for(const [a,{flat:d}]of e)for(const h of d){e=h.unique;var b=e.tileSymbols;const m=b.length-1;for(let n=0;n<m;n++)if(b[n]===h){b[n]=b[m];break}b.length=m;0===m&&(b=this._uniqueSymbolsReferences.get(a),b.delete(e),0===b.size&&this._uniqueSymbolsReferences.delete(a));h.unique=null}};c._addSymbols=function(e,b){if(0!==b.size){var a=this._visibleTiles;for(const d of a)d.parentTile||
d.key.world!==e.world||d.key.level===e.level&&!d.key.equals(e)||this._matchSymbols(d,e,b);for(const [d,h]of b)for(const m of h)v.isNone(m.unique)&&(e=this._createUnique(),m.unique=e,e.tileSymbols.push(m),b=this._uniqueSymbolsReferences.get(d),b||(b=new Set,this._uniqueSymbolsReferences.set(d,b)),b.add(e))}};c._matchSymbols=function(e,b,a){if(e.key.level>b.level){var d=e.key.level-b.level;if(e.key.row>>d!==b.row||e.key.col>>d!==b.col)return}if(b.level>e.key.level&&(d=b.level-e.key.level,b.row>>d!==
e.key.row||b.col>>d!==e.key.col))return;if(b.equals(e.key))for(var h of e.childrenTiles)this._matchSymbols(h,b,a);else{h=new Map;for(const [k,t]of a){var m=[];for(const l of t)a=x.tileCoordChange(this.tileCoordRange,l.xTile,b.level,b.col,e.key.level,e.key.col),d=x.tileCoordChange(this.tileCoordRange,l.yTile,b.level,b.row,e.key.level,e.key.row),0<=a&&a<this.tileCoordRange&&0<=d&&d<this.tileCoordRange&&m.push({symbol:l,xTransformed:a,yTransformed:d});a=[];d=e.key.level<b.level?1:1<<e.key.level-b.level;
const w=this._tiles.get(e.id).symbols.get(k);if(w){const l=w.flat;for(const u of m){var n=!1;let D;const I=u.xTransformed,H=u.yTransformed;D=v.isSome(w.index)?w.index.getCell(I,H):l;m=u.symbol;const B=m.hash;for(const y of D)if(B===y.hash&&Math.abs(I-y.xTile)<=d&&Math.abs(H-y.yTile)<=d){n=y.unique;m.unique=n;n.tileSymbols.push(m);n=!0;break}n||a.push(m)}}0<a.length&&h.set(k,a)}for(const k of e.childrenTiles)this._matchSymbols(k,b,h)}};c._createUniqueSymbolLayerArray=function(){var e=this._uniqueSymbolsReferences;
const b=Array(e.size);let a=0;for(const [d,h]of e){const m=Array(h.size);e=0;for(const n of h)m[e++]=n;b[a]={styleLayerUID:d,uniqueSymbols:m};a++}return b};C._createClass(q,[{key:"uniqueSymbols",get:function(){v.isNone(this._uniqueSymbolLayerArray)&&(this._uniqueSymbolLayerArray=this._createUniqueSymbolLayerArray());return this._uniqueSymbolLayerArray}}]);return q}();A.SymbolRepository=f;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/RenderableTile":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f32","./TiledDisplayObject"],function(A,C,v,x){x=function(f){function q(){return f.apply(this,arguments)||this}C._inheritsLoose(q,f);q.prototype._createTransforms=function(){return{dvs:v.create(),tileMat3:v.create()}};return q}(x.TiledDisplayObject);A.RenderableTile=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleDefinition","./StyleLayer"],
function(A,C){return function(){function v(f){this._style=f;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;f.layers||(f.layers=[]);this.version=parseFloat(f.version);if(this.layers=f.layers.map((q,c,e)=>this._create(q,c,e)))for(let q=0;q<this.layers.length;q++)f=this.layers[q],this._layerByName[f.id]=f,this._uidToLayer.set(f.uid,f),f.type===A.StyleLayerType.BACKGROUND&&this.backgroundBucketIds.push(f.id);this._identifyRefLayers()}var x=v.prototype;x.isPainterDataDriven=
function(f){return(f=this._layerByName[f])?f.isPainterDataDriven():!1};x.getStyleLayerId=function(f){return f>=this.layers.length?null:this.layers[f].id};x.getStyleLayerByUID=function(f){f=this._uidToLayer.get(f);return null!=f?f:null};x.getStyleLayerIndex=function(f){return(f=this._layerByName[f])?this.layers.indexOf(f):-1};x.setStyleLayer=function(f,q){if(f&&f.id){var c=this._style;null!=q&&q>=this.layers.length&&(q=this.layers.length-1);var e=!0,b;if(b=this._layerByName[f.id]){const a=this.layers.indexOf(b);
q||(q=a);q===a?(e=!1,b=v._recreateLayer(f,b),this.layers[q]=b,c.layers[q]=f):(this.layers.splice(a,1),c.layers.splice(a,1),b=this._create(f,q,this.layers),this.layers.splice(q,0,b),c.layers.splice(q,0,f))}else b=this._create(f,q,this.layers),!q||q>=this.layers.length?(this.layers.push(b),c.layers.push(f)):(this.layers.splice(q,0,b),c.layers.splice(q,0,f));this._layerByName[f.id]=b;this._uidToLayer.set(b.uid,b);e&&this._recomputeZValues();this._identifyRefLayers()}};x.getStyleLayer=function(f){return(f=
this._layerByName[f])?{type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:f.layout,paint:f.paint}:null};x.deleteStyleLayer=function(f){const q=this._layerByName[f];q&&(delete this._layerByName[f],this._uidToLayer.delete(q.uid),f=this.layers.indexOf(q),this.layers.splice(f,1),this._style.layers.splice(f,1),this._recomputeZValues(),this._identifyRefLayers())};x.getLayerById=function(f){return this._layerByName[f]};x.getLayoutProperties=
function(f){return(f=this._layerByName[f])?f.layout:null};x.getPaintProperties=function(f){return(f=this._layerByName[f])?f.paint:null};x.setPaintProperties=function(f,q){if(f=this._layerByName[f]){var c=v._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:f.layout,paint:q},f),e=this.layers.indexOf(f);this.layers[e]=c;this._style.layers[e].paint=q;this._layerByName[f.id]=c;this._uidToLayer.set(f.uid,c)}};
x.setLayoutProperties=function(f,q){if(f=this._layerByName[f]){var c=v._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:q,paint:f.paint},f),e=this.layers.indexOf(f);this.layers[e]=c;this._style.layers[e].layout=q;this._layerByName[f.id]=c;this._uidToLayer.set(f.uid,c)}};x.setStyleLayerVisibility=function(f,q){if(f=this._layerByName[f]){var c=f.layout||{};c.visibility=q;q=v._recreateLayer({type:f.typeName,
id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:c,paint:f.paint},f);var e=this.layers.indexOf(f);this.layers[e]=q;this._style.layers[e].layout=c;this._layerByName[f.id]=q;this._uidToLayer.set(f.uid,q)}};x.getStyleLayerVisibility=function(f){var q;f=this._layerByName[f];if(!f)return"none";f=f.layout;return null!=(q=null==f?void 0:f.visibility)?q:"visible"};x._recomputeZValues=function(){const f=this.layers,q=1/(f.length+1);for(let c=0;c<
f.length;c++)f[c].z=1-(1+c)*q};x._identifyRefLayers=function(){const f=[],q=[];let c=0;for(const h of this.layers){const m=h.layout;if(h.type===A.StyleLayerType.FILL){var e,b=h,a=h.source+"|"+h.sourceLayer;a+=null!=(e="|"+(null==m?void 0:m.visibility))?e:"";a+="|"+h.minzoom;a+="|"+h.maxzoom;a+="|"+JSON.stringify(h.filter);if(b.hasDataDrivenFill||b.hasDataDrivenOutline)a+="|"+c;f.push({key:a,layer:h})}else if(h.type===A.StyleLayerType.LINE){var d;b=h;a=h.source+"|"+h.sourceLayer;a+=null!=(d="|"+(null==
m?void 0:m.visibility))?d:"";a+="|"+h.minzoom;a+="|"+h.maxzoom;a+="|"+JSON.stringify(h.filter);a+="|"+(void 0!==m?m["line-cap"]:"");a+="|"+(void 0!==m?m["line-join"]:"");b.hasDataDrivenLine&&(a+="|"+c);q.push({key:a,layer:h})}++c}this._assignRefLayers(f);this._assignRefLayers(q)};x._assignRefLayers=function(f){f.sort((d,h)=>d.key<h.key?-1:d.key>h.key?1:0);let q,c;const e=f.length;for(let d=0;d<e;d++){const h=f[d];if(h.key===q)h.layer.refLayerId=c;else if(q=h.key,c=h.layer.id,h.layer.type===A.StyleLayerType.FILL){if(!h.layer.getPaintProperty("fill-outline-color"))for(var b=
d+1;b<e;b++){var a=f[b];if(a.key===q){if(a.layer.getPaintProperty("fill-outline-color")){f[d]=a;f[b]=h;c=a.layer.id;break}}else break}}else if(h.layer.type===A.StyleLayerType.LINE)for(b=h.layer,a=d+1;a<e;a++){const m=f[a];if(m.key!==q)break;const n=m.layer;if(b.canUseThinTessellation&&!n.canUseThinTessellation||!b.canUseThinTessellation&&(n.getPaintProperty("line-pattern")||n.getPaintProperty("line-dasharray")))b=n,f[d]=m,f[a]=h,c=m.layer.id}}};x._create=function(f,q,c){q=1-1/(c.length+1)*(1+q);c=
this._runningId++;switch(f.type){case "background":return new C.BackgroundStyleLayer(A.StyleLayerType.BACKGROUND,f,q,c);case "fill":return new C.FillStyleLayer(A.StyleLayerType.FILL,f,q,c);case "line":return new C.LineStyleLayer(A.StyleLayerType.LINE,f,q,c);case "symbol":return new C.SymbolStyleLayer(A.StyleLayerType.SYMBOL,f,q,c);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new C.CircleStyleLayer(A.StyleLayerType.CIRCLE,f,q,c)}throw Error("Unknown vector tile layer");
};v._recreateLayer=function(f,q){switch(f.type){case "background":return new C.BackgroundStyleLayer(A.StyleLayerType.BACKGROUND,f,q.z,q.uid);case "fill":return new C.FillStyleLayer(A.StyleLayerType.FILL,f,q.z,q.uid);case "line":return new C.LineStyleLayer(A.StyleLayerType.LINE,f,q.z,q.uid);case "symbol":return new C.SymbolStyleLayer(A.StyleLayerType.SYMBOL,f,q.z,q.uid);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new C.CircleStyleLayer(A.StyleLayerType.CIRCLE,
f,q.z,q.uid)}};return v}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../symbols/cim/enums ../enums ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),function(A,C,v,x,f,q,c,e,b,a,d,h,m){let n=function(){function H(y,F,N,Q){this.type=
y;this.typeName=F.type;this.id=F.id;this.source=F.source;this.sourceLayer=F["source-layer"];this.minzoom=F.minzoom;this.maxzoom=F.maxzoom;this.filter=F.filter;this.layout=F.layout;this.paint=F.paint;this.z=N;this.uid=Q;switch(y){case d.StyleLayerType.BACKGROUND:this._layoutDefinition=d.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=d.StyleDefinition.backgroundPaintDefinition;break;case d.StyleLayerType.FILL:this._layoutDefinition=d.StyleDefinition.fillLayoutDefinition;this._paintDefinition=
d.StyleDefinition.fillPaintDefinition;break;case d.StyleLayerType.LINE:this._layoutDefinition=d.StyleDefinition.lineLayoutDefinition;this._paintDefinition=d.StyleDefinition.linePaintDefinition;break;case d.StyleLayerType.SYMBOL:this._layoutDefinition=d.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=d.StyleDefinition.symbolPaintDefinition;break;case d.StyleLayerType.CIRCLE:this._layoutDefinition=d.StyleDefinition.circleLayoutDefinition,this._paintDefinition=d.StyleDefinition.circlePaintDefinition}this._layoutProperties=
this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}var B=H.prototype;B.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=a.createFilter(this.filter)};B.getLayoutProperty=function(y){return this._layoutProperties[y]};B.getPaintProperty=function(y){return this._paintProperties[y]};B.getLayoutValue=function(y,F,N){let Q;const L=this._layoutProperties[y];L&&(Q=L.getValue(F,N));void 0===Q&&(Q=this._layoutDefinition[y]["default"]);
return Q};B.getPaintValue=function(y,F,N){let Q;const L=this._paintProperties[y];L&&(Q=L.getValue(F,N));void 0===Q&&(Q=this._paintDefinition[y]["default"]);return Q};B.isPainterDataDriven=function(){const y=this._paintProperties;if(y)for(const F in y)if(y[F].isDataDriven)return!0;return!1};B._parseLayout=function(y){const F={};for(const N in y){const Q=this._layoutDefinition[N];Q&&(F[N]=new h(Q,y[N]))}return F};B._parsePaint=function(y){const F={};for(const N in y){const Q=this._paintDefinition[N];
Q&&(F[N]=new h(Q,y[N]))}return F};B.computeAttributesKey=function(y,F,N,Q){let L=0,T=0;for(const R of F){F=3;if(!R||R!==Q){const {isLayout:S,isOptional:O}=N[R];F=S?this.getLayoutProperty(R):this.getPaintProperty(R);F=null!=F&&F.interpolator?2:null!=F&&F.isDataDriven?1:O&&!F?3:0}T|=F<<L;L+=2}return T<<3|y};return H}(),k=function(H){function B(y,F,N,Q){y=H.call(this,y,F,N,Q)||this;y.backgroundMaterial=new f.VTLBackgroundMaterial(y.computeAttributesKey(x.ShaderProgramType.BACKGROUND,f.VTLBackgroundMaterial.ATTRIBUTES,
f.VTLBackgroundMaterial.ATTRIBUTES_INFO));return y}C._inheritsLoose(B,H);return B}(n),t=function(H){function B(y,F,N,Q){y=H.call(this,y,F,N,Q)||this;F=y.getPaintProperty("fill-color");N=y.getPaintProperty("fill-opacity");Q=y.getPaintProperty("fill-pattern");y.hasDataDrivenColor=null==F?void 0:F.isDataDriven;y.hasDataDrivenOpacity=null==N?void 0:N.isDataDriven;y.hasDataDrivenFill=y.hasDataDrivenColor||y.hasDataDrivenOpacity||(null==Q?void 0:Q.isDataDriven);N=y.getPaintProperty("fill-outline-color");
y.outlineUsesFillColor=!N;y.hasDataDrivenOutlineColor=null==N?void 0:N.isDataDriven;y.hasDataDrivenOutline=N?N.isDataDriven:F?F.isDataDriven:!1;y.hasDataDrivenOutline=(N?y.hasDataDrivenOutlineColor:y.hasDataDrivenColor)||y.hasDataDrivenOpacity;y.fillMaterial=new c.VTLFillMaterial(y.computeAttributesKey(x.ShaderProgramType.FILL,c.VTLFillMaterial.ATTRIBUTES,c.VTLFillMaterial.ATTRIBUTES_INFO));y.outlineMaterial=new c.VTLOutlineMaterial(y.computeAttributesKey(x.ShaderProgramType.OUTLINE,y.outlineUsesFillColor?
c.VTLOutlineMaterial.ATTRIBUTES_FILL:c.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,y.outlineUsesFillColor?c.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:c.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),y.outlineUsesFillColor);return y}C._inheritsLoose(B,H);return B}(n),w=function(H){function B(y,F,N,Q){var L,T,R,S,O,K,G,M,U;y=H.call(this,y,F,N,Q)||this;F=y.getPaintProperty("line-pattern");y.lineMaterial=new e.VTLLineMaterial(y.computeAttributesKey(x.ShaderProgramType.LINE,e.VTLLineMaterial.ATTRIBUTES,e.VTLLineMaterial.ATTRIBUTES_INFO,
F?"line-dasharray":""));y.hasDataDrivenLine=(null==(L=y.getPaintProperty("line-blur"))?void 0:L.isDataDriven)||(null==(T=y.getPaintProperty("line-color"))?void 0:T.isDataDriven)||(null==(R=y.getPaintProperty("line-gap-width"))?void 0:R.isDataDriven)||(null==(S=y.getPaintProperty("line-offset"))?void 0:S.isDataDriven)||(null==(O=y.getPaintProperty("line-opacity"))?void 0:O.isDataDriven)||(null==(K=y.getPaintProperty("line-pattern"))?void 0:K.isDataDriven)||(null==(G=y.getPaintProperty("line-dasharray"))?
void 0:G.isDataDriven)||(null==(M=y.getLayoutProperty("line-cap"))?void 0:M.isDataDriven)||(null==(U=y.getPaintProperty("line-width"))?void 0:U.isDataDriven);y.canUseThinTessellation=!1;!y.hasDataDrivenLine&&(L=y.getPaintProperty("line-width"),!L||"number"===typeof L&&.5*L<m.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(L=y.getPaintProperty("line-offset"),!L||"number"===typeof L&&0===L)&&(y.canUseThinTessellation=!0);return y}C._inheritsLoose(B,H);B.prototype.getDashKey=function(y,F){switch(F){case v.CapType.BUTT:F=
"Butt";break;case v.CapType.ROUND:F="Round";break;case v.CapType.SQUARE:F="Square";break;default:F="Butt"}return`dasharray-[${y.toString()}]-${F}`};return B}(n),l=function(H){function B(y,F,N,Q){var L,T,R,S,O,K,G,M,U,Y,ca,da;y=H.call(this,y,F,N,Q)||this;y.iconMaterial=new b.VTLIconMaterial(y.computeAttributesKey(x.ShaderProgramType.ICON,b.VTLIconMaterial.ATTRIBUTES,b.VTLIconMaterial.ATTRIBUTES_INFO));y.textMaterial=new b.VTLTextMaterial(y.computeAttributesKey(x.ShaderProgramType.TEXT,b.VTLTextMaterial.ATTRIBUTES,
b.VTLTextMaterial.ATTRIBUTES_INFO));y.hasDataDrivenIcon=(null==(L=y.getPaintProperty("icon-color"))?void 0:L.isDataDriven)||(null==(T=y.getPaintProperty("icon-halo-blur"))?void 0:T.isDataDriven)||(null==(R=y.getPaintProperty("icon-halo-color"))?void 0:R.isDataDriven)||(null==(S=y.getPaintProperty("icon-halo-width"))?void 0:S.isDataDriven)||(null==(O=y.getPaintProperty("icon-opacity"))?void 0:O.isDataDriven)||(null==(K=y.getLayoutProperty("icon-size"))?void 0:K.isDataDriven);y.hasDataDrivenText=(null==
(G=y.getPaintProperty("text-color"))?void 0:G.isDataDriven)||(null==(M=y.getPaintProperty("text-halo-blur"))?void 0:M.isDataDriven)||(null==(U=y.getPaintProperty("text-halo-color"))?void 0:U.isDataDriven)||(null==(Y=y.getPaintProperty("text-halo-width"))?void 0:Y.isDataDriven)||(null==(ca=y.getPaintProperty("text-opacity"))?void 0:ca.isDataDriven)||(null==(da=y.getLayoutProperty("text-size"))?void 0:da.isDataDriven);return y}C._inheritsLoose(B,H);return B}(n),u=function(H){function B(y,F,N,Q){y=H.call(this,
y,F,N,Q)||this;y.circleMaterial=new q.VTLCircleMaterial(y.computeAttributesKey(x.ShaderProgramType.CIRCLE,q.VTLCircleMaterial.ATTRIBUTES,q.VTLCircleMaterial.ATTRIBUTES_INFO));return y}C._inheritsLoose(B,H);return B}(n),D=function(){function H(B,y,F){var N,Q,L,T,R;this.allowOverlap=B.getLayoutValue("icon-allow-overlap",y);this.ignorePlacement=B.getLayoutValue("icon-ignore-placement",y);this.keepUpright=B.getLayoutValue("icon-keep-upright",y);this.optional=B.getLayoutValue("icon-optional",y);this.rotationAlignment=
B.getLayoutValue("icon-rotation-alignment",y);this.rotationAlignment===d.RotationAlignment.AUTO&&(this.rotationAlignment=F?d.RotationAlignment.MAP:d.RotationAlignment.VIEWPORT);F=B.getLayoutProperty("icon-anchor");null!=(N=F)&&N.isDataDriven?this._anchorProp=F:this.anchor=B.getLayoutValue("icon-anchor",y);F=B.getLayoutProperty("icon-offset");null!=(Q=F)&&Q.isDataDriven?this._offsetProp=F:this.offset=B.getLayoutValue("icon-offset",y);F=B.getLayoutProperty("icon-padding");null!=(L=F)&&L.isDataDriven?
this._paddingProp=F:this.padding=B.getLayoutValue("icon-padding",y);F=B.getLayoutProperty("icon-rotate");null!=(T=F)&&T.isDataDriven?this._rotateProp=F:this.rotate=B.getLayoutValue("icon-rotate",y);F=B.getLayoutProperty("icon-size");null!=(R=F)&&R.isDataDriven?this._sizeProp=F:this.size=B.getLayoutValue("icon-size",y)}H.prototype.update=function(B,y){this._anchorProp&&(this.anchor=this._anchorProp.getValue(B,y));this._offsetProp&&(this.offset=this._offsetProp.getValue(B,y));this._paddingProp&&(this.padding=
this._paddingProp.getValue(B,y));this._rotateProp&&(this.rotate=this._rotateProp.getValue(B,y));this._sizeProp&&(this.size=this._sizeProp.getValue(B,y))};return H}(),I=function(){function H(B,y,F){var N,Q,L,T,R,S,O,K,G,M,U;this.allowOverlap=B.getLayoutValue("text-allow-overlap",y);this.ignorePlacement=B.getLayoutValue("text-ignore-placement",y);this.keepUpright=B.getLayoutValue("text-keep-upright",y);this.optional=B.getLayoutValue("text-optional",y);this.rotationAlignment=B.getLayoutValue("text-rotation-alignment",
y);this.rotationAlignment===d.RotationAlignment.AUTO&&(this.rotationAlignment=F?d.RotationAlignment.MAP:d.RotationAlignment.VIEWPORT);F=B.getLayoutProperty("text-anchor");null!=(N=F)&&N.isDataDriven?this._anchorProp=F:this.anchor=B.getLayoutValue("text-anchor",y);F=B.getLayoutProperty("text-justify");null!=(Q=F)&&Q.isDataDriven?this._justifyProp=F:this.justify=B.getLayoutValue("text-justify",y);F=B.getLayoutProperty("text-letter-spacing");null!=(L=F)&&L.isDataDriven?this._letterSpacingProp=F:this.letterSpacing=
B.getLayoutValue("text-letter-spacing",y);F=B.getLayoutProperty("text-line-height");null!=(T=F)&&T.isDataDriven?this._lineHeightProp=F:this.lineHeight=B.getLayoutValue("text-line-height",y);F=B.getLayoutProperty("text-max-angle");null!=(R=F)&&R.isDataDriven?this._maxAngleProp=F:this.maxAngle=B.getLayoutValue("text-max-angle",y);F=B.getLayoutProperty("text-max-width");null!=(S=F)&&S.isDataDriven?this._maxWidthProp=F:this.maxWidth=B.getLayoutValue("text-max-width",y);F=B.getLayoutProperty("text-offset");
null!=(O=F)&&O.isDataDriven?this._offsetProp=F:this.offset=B.getLayoutValue("text-offset",y);F=B.getLayoutProperty("text-padding");null!=(K=F)&&K.isDataDriven?this._paddingProp=F:this.padding=B.getLayoutValue("text-padding",y);F=B.getLayoutProperty("text-rotate");null!=(G=F)&&G.isDataDriven?this._rotateProp=F:this.rotate=B.getLayoutValue("text-rotate",y);F=B.getLayoutProperty("text-size");null!=(M=F)&&M.isDataDriven?this._sizeProp=F:this.size=B.getLayoutValue("text-size",y);F=B.getLayoutProperty("text-writing-mode");
null!=(U=F)&&U.isDataDriven?this._writingModeProp=F:this.writingMode=B.getLayoutValue("text-writing-mode",y)}H.prototype.update=function(B,y){this._anchorProp&&(this.anchor=this._anchorProp.getValue(B,y));this._justifyProp&&(this.justify=this._justifyProp.getValue(B,y));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(B,y));this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(B,y));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(B,y));this._maxWidthProp&&
(this.maxWidth=this._maxWidthProp.getValue(B,y));this._offsetProp&&(this.offset=this._offsetProp.getValue(B,y));this._paddingProp&&(this.padding=this._paddingProp.getValue(B,y));this._rotateProp&&(this.rotate=this._rotateProp.getValue(B,y));this._sizeProp&&(this.size=this._sizeProp.getValue(B,y));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(B,y))};return H}();A.BackgroundStyleLayer=k;A.CircleStyleLayer=u;A.FillStyleLayer=t;A.IconLayout=D;A.LineStyleLayer=w;A.StyleLayer=
n;A.SymbolStyleLayer=l;A.TextLayout=I;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],function(A,C,v,x,f){v=function(q){function c(b){return q.call(this,b)||this}C._inheritsLoose(c,q);var e=c.prototype;e.geometryInfo=function(){return c.GEOMETRY_LAYOUT};e.opacityInfo=
function(){return null};e.attributes=function(){return c.ATTRIBUTES};e.attributesInfo=function(){return c.ATTRIBUTES_INFO};return c}(v.VTLMaterial);v.ATTRIBUTES=[];v.GEOMETRY_LAYOUT=[new f.VertexElementDescriptor("a_pos",2,x.DataType.BYTE,0,2)];v.ATTRIBUTES_INFO={};A.VTLBackgroundMaterial=v;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../MemoryBuffer ./enums ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(A,C,v,x,f,q,c){let e=function(){function d(m){this._locations=new Map;this._key=m}var h=d.prototype;h.defines=function(){return[]};h.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};h.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};h.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};h.getEncodingInfos=function(){this._propertyEncodingInfo||this._buildAttributesInfo();
return this._propertyEncodingInfo};h.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};h.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};h.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};h.setDataUniforms=function(m,n,k,t,w){var l=this.getUniforms();for(const u of l){const {name:D,type:I,getValue:H}=u;l=H(k,n,t,w);if(null!==l)switch(I){case "float":m.setUniform1f(D,
l);break;case "vec2":m.setUniform2fv(D,l);break;case "vec4":m.setUniform4fv(D,l)}}};h.encodeAttributes=function(m,n,k,t){const w=this.attributesInfo(),l=this.getEncodingInfos(),u=[];let D=0,I=0;for(const y of Object.keys(l)){var H,B=l[y];const {type:F,precisionFactor:N,isLayout:Q}=w[y],L=Q?k.getLayoutProperty(y):k.getPaintProperty(y),T=null==(H=L.interpolator)?void 0:H.getInterpolationRange(n);let R=0;for(const S of B){const {offset:O,bufferElementsToAdd:K}=S;if(0<K){for(B=0;B<K;B++)u.push(0);D+=
I;I=S.bufferElementsToAdd}B=null!=t?t:L.getValue(T?T[R]:n,m);switch(F){case f.EncodingType.R8_SIGNED:case f.EncodingType.R8_UNSIGNED:u[D]|=this._encodeByte(B*(N||1),8*O);break;case f.EncodingType.R16_SIGNED:case f.EncodingType.R16_UNSIGNED:u[D]|=this._encodeShort(B*(N||1),8*O);break;case f.EncodingType.R8G8_SIGNED:case f.EncodingType.R8G8_UNSIGNED:u[D]|=this._encodeByte(B*(N||1),8*O);u[D]|=this._encodeByte(B*(N||1),8*O+8);break;case f.EncodingType.R16G16_SIGNED:case f.EncodingType.R16G16_UNSIGNED:u[D]|=
this._encodeShort(B*(N||1),8*O);u[D]|=this._encodeShort(B*(N||1),8*O+16);break;case f.EncodingType.R8G8B8A8_SIGNED:case f.EncodingType.R8G8B8A8_UNSIGNED:u[D]|=this._encodeByte(B*(N||1),8*O);u[D]|=this._encodeByte(B*(N||1),8*O+8);u[D]|=this._encodeByte(B*(N||1),8*O+16);u[D]|=this._encodeByte(B*(N||1),8*O+24);break;case f.EncodingType.R8G8B8A8_COLOR:u[D]=this._encodeColor(B);break;case f.EncodingType.R16G16B16A16_DASHARRAY:case f.EncodingType.R16G16B16A16_PATTERN:this._encodePattern(D,u,B);break;default:throw Error("Unsupported encoding type");
}R++}}return u};h.getAtributeState=function(m){const n=3+2*m;m=0|this._bit(n);return m|=this._bit(n+1)<<1};h._buildAttributesInfo=function(){const m=[],n={};var k={},t=-1;const w=this.attributesInfo();var l=this.attributes();let u=-1;for(const B of l){u++;l=this.getAtributeState(u);if(l===f.AttributeStatus.UNIFORM||l===f.AttributeStatus.UNUSED)continue;var D=w[B];const y=[];n[B]=y;D=D.type;for(let F=0;F<l;F++){const {dataType:N,bytesPerElement:Q,count:L,normalized:T}=d._encodingInfo[D],R=Q*L;let S=
k[N];var I=0;!S||4<S.count+L?(t++,S={dataIndex:t,count:0,offset:0},4!==L&&(k[N]=S),m.push({location:-1,name:"a_data_"+t,count:L,type:N,normalized:T}),I=Math.ceil(Math.max(R/4,1))):(I=m[S.dataIndex],I.count+=L,I=Math.ceil(Math.max(I.count*Q/4,1))-Math.ceil(Math.max(S.offset/4,1)));y.push({dataIndex:S.dataIndex,offset:S.offset,bufferElementsToAdd:I});S.offset+=R;S.count+=L}}for(const B of m)switch(B.type){case q.DataType.BYTE:case q.DataType.UNSIGNED_BYTE:B.count=4;case q.DataType.SHORT:case q.DataType.UNSIGNED_SHORT:B.count+=
B.count%2}this._buildVertexBufferLayout(m);k=0;t=this._layoutInfo.geometry;for(var H of t)this._locations.set(H.name,k++);if(H=this._layoutInfo.opacity)for(const B of H)this._locations.set(B.name,k++);this._buildShaderInfo(m,n);this._propertyEncodingInfo=n};h._buildVertexBufferLayout=function(m){const n={};var k=this.geometryInfo();let t=k[0].stride;if(0===m.length)n.geometry=k;else{const w=[];let l=t;for(const u of m)t+=b(u.type)*u.count;for(const u of k)k={...u},k.stride=t,w.push(k);for(const u of m)w.push(new c.VertexElementDescriptor(u.name,
u.count,u.type,l,t)),l+=b(u.type)*u.count;n.geometry=w}this.opacityInfo()&&(n.opacity=this.opacityInfo());this._layoutInfo=n;this._stride=t};h._buildShaderInfo=function(m,n){let k="\n",t="\n";const w=[];for(var l of m)k+=`attribute ${this._getType(l.count)} ${l.name};\n`;var u=this.attributes();m=this.attributesInfo();l=-1;for(const H of u){l++;const {name:B,type:y,precisionFactor:F,isLayout:N}=m[H];u=F&&1!==F?` * ${1/F}`:"";const {bytesPerElement:Q,count:L}=d._encodingInfo[y];var D=T=>`a_data_${T.dataIndex}${a(L,
T.offset,Q)}`;switch(this.getAtributeState(l)){case f.AttributeStatus.UNIFORM:u=this._getType(L);var I=`u_${B}`;w.push({name:I,type:u,getValue:(T,R,S,O)=>{S=N?T.getLayoutValue(H,R):T.getPaintValue(H,R);if(y===f.EncodingType.R16G16B16A16_DASHARRAY){T=T.getDashKey(S,T.getLayoutValue("line-cap",R));O=O.getMosaicItemPosition(T,!1);if(v.isNone(O))return null;const {tl:K,br:G}=O;return[K[0],G[1],G[0],K[1]]}if(y===f.EncodingType.R16G16B16A16_PATTERN){O=O.getMosaicItemPosition(S,-1===H.indexOf("line-"));
if(v.isNone(O))return null;const {tl:K,br:G}=O;return[K[0],G[1],G[0],K[1]]}return y===f.EncodingType.R8G8B8A8_COLOR?(O=S[3],[O*S[0],O*S[1],O*S[2],O]):S}});k+=`uniform ${u} ${I};\n`;t+=`${u} ${B} = ${I};\n`;break;case f.AttributeStatus.DATA_DRIVEN:I=D(n[H][0]);t+=`${this._getType(L)} ${B} = ${I}${u};\n`;break;case f.AttributeStatus.INTERPOLATED_DATA_DRIVEN:{I=`u_t_${B}`;w.push({name:I,type:"float",getValue:(R,S,O,K)=>(N?R.getLayoutProperty(H):R.getPaintProperty(H)).interpolator.interpolationUniformValue(O,
S)});k+=`uniform float ${I};\n`;const T=D(n[H][0]);D=D(n[H][1]);t+=`${this._getType(L)} ${B} = mix(${T}${u}, ${D}${u}, ${I});\n`}}}this._shaderHeader=k;this._shaderMain=t;this._uniforms=w};h._bit=function(m){return(this._key&1<<m)>>m};h._getType=function(m){switch(m){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};h._encodeColor=function(m){const n=255*m[3];return x.i8888to32(m[0]*n,m[1]*n,m[2]*n,n)};h._encodePattern=function(m,n,k){if(k&&
k.rect){var t=k.rect,w=k.width;k=k.height;n[m]=this._encodeShort(t.x+2,0);n[m]|=this._encodeShort(t.y+2+k,16);n[m+1]=this._encodeShort(t.x+2+w,0);n[m+1]|=this._encodeShort(t.y+2,16)}};h._encodeByte=function(m,n){return(m&255)<<n};h._encodeShort=function(m,n){return(m&65535)<<n};C._createClass(d,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return d}();e._encodingInfo={[f.EncodingType.R8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:1,normalized:!1},
[f.EncodingType.R8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[f.EncodingType.R16_SIGNED]:{dataType:q.DataType.SHORT,bytesPerElement:2,count:1,normalized:!1},[f.EncodingType.R16_UNSIGNED]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[f.EncodingType.R8G8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:2,normalized:!1},[f.EncodingType.R8G8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},
[f.EncodingType.R16G16_SIGNED]:{dataType:q.DataType.SHORT,bytesPerElement:2,count:2,normalized:!1},[f.EncodingType.R16G16_UNSIGNED]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[f.EncodingType.R8G8B8A8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:4,normalized:!1},[f.EncodingType.R8G8B8A8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[f.EncodingType.R8G8B8A8_COLOR]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,
count:4,normalized:!0},[f.EncodingType.R16G16B16A16_DASHARRAY]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[f.EncodingType.R16G16B16A16_PATTERN]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const b=d=>{switch(d){case q.DataType.FLOAT:return 4;case q.DataType.INT:return 4;case q.DataType.UNSIGNED_INT:return 4;case q.DataType.SHORT:return 2;case q.DataType.UNSIGNED_SHORT:return 2;case q.DataType.BYTE:return 1;case q.DataType.UNSIGNED_BYTE:return 1}},
a=(d,h,m)=>{h/=m;if(1===d)switch(h){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===d)switch(h){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===d)switch(h){case 0:return".xyz";case 1:return".yzw"}return""};A.VTLMaterial=e;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(A){return function(){function C(x){this._array=
[];0>=x&&console.error("strideInBytes must be positive!");this._stride=x}var v=C.prototype;v.reset=function(){this.array.length=0};v.toBuffer=function(){return(new Uint32Array(this._array)).buffer};C.i1616to32=function(x,f){return 65535&x|f<<16};C.i8888to32=function(x,f,q,c){return x&255|(f&255)<<8|(q&255)<<16|c<<24};C.i8816to32=function(x,f,q){return x&255|(f&255)<<8|q<<16};A._createClass(C,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/
this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return C}()})},"esri/views/2d/engine/vectorTiles/shaders/enums":function(){define(["exports"],function(A){A.EncodingType=void 0;(function(C){C[C.R8_SIGNED=0]="R8_SIGNED";C[C.R8_UNSIGNED=1]="R8_UNSIGNED";C[C.R16_SIGNED=2]="R16_SIGNED";C[C.R16_UNSIGNED=3]="R16_UNSIGNED";C[C.R8G8_SIGNED=4]="R8G8_SIGNED";C[C.R8G8_UNSIGNED=5]="R8G8_UNSIGNED";C[C.R16G16_SIGNED=6]="R16G16_SIGNED";
C[C.R16G16_UNSIGNED=7]="R16G16_UNSIGNED";C[C.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED";C[C.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED";C[C.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR";C[C.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY";C[C.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"})(A.EncodingType||(A.EncodingType={}));A.AttributeStatus=void 0;(function(C){C[C.UNIFORM=0]="UNIFORM";C[C.DATA_DRIVEN=1]="DATA_DRIVEN";C[C.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN";C[C.UNUSED=3]="UNUSED"})(A.AttributeStatus||
(A.AttributeStatus={}));Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(A,C,v,x,f,q){x=function(c){function e(a){return c.call(this,a)||this}C._inheritsLoose(e,c);var b=e.prototype;b.geometryInfo=function(){return e.GEOMETRY_LAYOUT};b.opacityInfo=function(){return null};
b.attributes=function(){return e.ATTRIBUTES};b.attributesInfo=function(){return e.ATTRIBUTES_INFO};return e}(x.VTLMaterial);x.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");x.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,4)];x.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:v.EncodingType.R8_UNSIGNED},"circle-color":{name:"color",type:v.EncodingType.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",
type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:v.EncodingType.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:v.EncodingType.R8_UNSIGNED,precisionFactor:32}};A.VTLCircleMaterial=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(A,C,v,x,f,q){let c=function(e){function b(d){return e.call(this,d)||this}C._inheritsLoose(b,e);var a=b.prototype;a.geometryInfo=function(){return b.GEOMETRY_LAYOUT};a.opacityInfo=function(){return null};a.attributes=function(){return b.ATTRIBUTES};a.attributesInfo=function(){return b.ATTRIBUTES_INFO};return b}(x.VTLMaterial);c.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];c.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,4)];c.ATTRIBUTES_INFO={"fill-color":{name:"color",
type:v.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:v.EncodingType.R16G16B16A16_PATTERN,isOptional:!0}};x=function(e){function b(d,h){d=e.call(this,d)||this;d.usefillColor=h;return d}C._inheritsLoose(b,e);var a=b.prototype;a.geometryInfo=function(){return b.GEOMETRY_LAYOUT};a.opacityInfo=function(){return null};a.attributes=function(){return this.usefillColor?b.ATTRIBUTES_FILL:b.ATTRIBUTES_OUTLINE};
a.attributesInfo=function(){return this.usefillColor?b.ATTRIBUTES_INFO_FILL:b.ATTRIBUTES_INFO_OUTLINE};return b}(x.VTLMaterial);x.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];x.ATTRIBUTES_FILL=["fill-color","fill-opacity"];x.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,8),new q.VertexElementDescriptor("a_offset",2,f.DataType.BYTE,4,8),new q.VertexElementDescriptor("a_xnormal",2,f.DataType.BYTE,6,8)];x.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",
type:v.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100}};x.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:v.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100}};A.VTLFillMaterial=c;A.VTLOutlineMaterial=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(A,C,v,x,f,q){x=function(c){function e(a){return c.call(this,a)||this}C._inheritsLoose(e,c);var b=e.prototype;b.geometryInfo=function(){return e.GEOMETRY_LAYOUT};b.opacityInfo=function(){return null};b.attributes=function(){return e.ATTRIBUTES};b.attributesInfo=function(){return e.ATTRIBUTES_INFO};return e}(x.VTLMaterial);x.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");x.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",
2,f.DataType.SHORT,0,16),new q.VertexElementDescriptor("a_extrude_offset",4,f.DataType.BYTE,4,16),new q.VertexElementDescriptor("a_dir_normal",4,f.DataType.BYTE,8,16),new q.VertexElementDescriptor("a_accumulatedDistance",2,f.DataType.UNSIGNED_SHORT,12,16)];x.ATTRIBUTES_INFO={"line-width":{name:"width",type:v.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:v.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:v.EncodingType.R8_SIGNED,precisionFactor:2},
"line-color":{name:"color",type:v.EncodingType.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:v.EncodingType.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:v.EncodingType.R16G16B16A16_DASHARRAY,isOptional:!0}};A.VTLLineMaterial=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(A,C,v,x,f,q){const c=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,16),new q.VertexElementDescriptor("a_vertexOffset",2,f.DataType.SHORT,4,16),new q.VertexElementDescriptor("a_texAngleRange",4,f.DataType.UNSIGNED_BYTE,8,16),new q.VertexElementDescriptor("a_levelInfo",4,f.DataType.UNSIGNED_BYTE,12,16)],e=[new q.VertexElementDescriptor("a_opacityInfo",1,f.DataType.UNSIGNED_BYTE,0,1)];f=function(b){function a(h){return b.call(this,h)||this}C._inheritsLoose(a,b);var d=a.prototype;
d.geometryInfo=function(){return c};d.opacityInfo=function(){return e};d.attributes=function(){return a.ATTRIBUTES};d.attributesInfo=function(){return a.ATTRIBUTES_INFO};return a}(x.VTLMaterial);f.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");f.ATTRIBUTES_INFO={"icon-color":{name:"color",type:v.EncodingType.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",
type:v.EncodingType.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:v.EncodingType.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};x=function(b){function a(h){return b.call(this,h)||this}C._inheritsLoose(a,b);var d=a.prototype;d.geometryInfo=function(){return c};d.opacityInfo=function(){return e};d.attributes=function(){return a.ATTRIBUTES};
d.attributesInfo=function(){return a.ATTRIBUTES_INFO};return a}(x.VTLMaterial);x.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");x.ATTRIBUTES_INFO={"text-color":{name:"color",type:v.EncodingType.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:v.EncodingType.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:v.EncodingType.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},
"text-halo-blur":{name:"halo_blur",type:v.EncodingType.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:v.EncodingType.R8_UNSIGNED,isLayout:!0}};A.VTLIconMaterial=f;A.VTLTextMaterial=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression","../expression/types"],function(A,C){return function(){function v(x){this._expression=x}v.prototype.filter=function(x,f){if(!this._expression)return!0;try{return this._expression.evaluate(x,
f)}catch(q){return console.log(q.message),!0}};v.createFilter=function(x){if(!x)return null;this.isLegacyFilter(x)&&(x=this.convertLegacyFilter(x));try{const f=A.createExpression(x,null,C.BooleanType);return new v(f)}catch(f){return console.log(f.message),null}};v.isLegacyFilter=function(x){if(!Array.isArray(x)||0===x.length)return!0;switch(x[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===x.length&&"string"===typeof x[1]&&!Array.isArray(x[2]);case "in":return 3<=
x.length&&"string"===typeof x[1]&&!Array.isArray(x[2]);case "!in":return!0;case "any":case "all":for(let f=1;f<x.length;f++)if(!this.isLegacyFilter(x[1]))return!1;return!0;case "none":return!0;case "has":return 2===x.length&&("$id"===x[1]||"$type"===x[1]);case "!has":return!0;default:return!1}};v.convertLegacyFilter=function(x){if(!Array.isArray(x)||0===x.length)return!0;const f=x[0];if(1===x.length)return"any"!==f;switch(f){case "\x3d\x3d":return v.convertComparison("\x3d\x3d",x[1],x[2]);case "!\x3d":return v.negate(v.convertComparison("\x3d\x3d",
x[1],x[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return v.convertComparison(f,x[1],x[2]);case "in":return v.convertIn(x[1],x.slice(2));case "!in":return v.negate(v.convertIn(x[1],x.slice(2)));case "any":case "all":case "none":return v.convertCombining(f,x.slice(1));case "has":return v.convertHas(x[1]);case "!has":return v.negate(v.convertHas(x[1]));default:throw Error("Unexpected legacy filter.");}};v.convertComparison=function(x,f,q){switch(f){case "$type":return[x,["geometry-type"],
q];case "$id":return[x,["id"],q];default:return[x,["get",f],q]}};v.convertIn=function(x,f){switch(x){case "$type":return["in",["geometry-type"],["literal",f]];case "$id":return["in",["id"],["literal",f]];default:return["in",["get",x],["literal",f]]}};v.convertHas=function(x){switch(x){case "$type":return!0;case "$id":return["has-id"];default:return["has",x]}};v.convertCombining=function(x,f){return[x].concat(f.map(this.convertLegacyFilter))};v.negate=function(x){return["!",x]};return v}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types ../../webgl/Geometry".split(" "),
function(A,C,v,x,f,q,c,e){function b(r,g,p){var z=typeof r;if("string"===z||"boolean"===z||"number"===z||null===r){if(p)switch(p.kind){case "string":"string"!==z&&(r=ea.toString(r));break;case "number":"number"!==z&&(r=ea.toNumber(r));break;case "color":r=ea.toColor(r)}r=["literal",r]}if(!Array.isArray(r)||0===r.length)throw Error("Expression must be a non empty array");z=r[0];if("string"!==typeof z)throw Error("First element of expression must be a string");const E=ja[z];if(void 0===E)throw Error(`Invalid expression operator "${z}"`);
if(!E)throw Error(`Unimplemented expression operator "${z}"`);return E.parse(r,g,p)}let a=function(){function r(p){this.parent=p;this.vars={}}var g=r.prototype;g.add=function(p,z){this.vars[p]=z};g.get=function(p){return this.vars[p]?this.vars[p]:this.parent?this.parent.get(p):null};return r}(),d=function(){function r(){this.type=c.ValueType}r.parse=function(g){if(1<g.length)throw Error('"id" does not expect arguments');return new r};r.prototype.evaluate=function(g,p){return null==g?void 0:g.id};
return r}(),h=function(){function r(){this.type=c.StringType}r.parse=function(g){if(1<g.length)throw Error('"geometry-type" does not expect arguments');return new r};r.prototype.evaluate=function(g,p){if(!g)return null;switch(g.type){case e.GeometryType.Point:return"Point";case e.GeometryType.LineString:return"LineString";case e.GeometryType.Polygon:return"Polygon";default:return null}};return r}(),m=function(){function r(){this.type=c.ObjectType}r.parse=function(g){if(1<g.length)throw Error('"properties" does not expect arguments');
return new r};r.prototype.evaluate=function(g,p){return null==g?void 0:g.values};return r}(),n=function(){function r(){this.type=c.NumberType}r.parse=function(g){if(1<g.length)throw Error('"zoom" does not expect arguments');return new r};r.prototype.evaluate=function(g,p){return p};return r}(),k=function(){function r(g,p,z){this.lhs=g;this.rhs=p;this.compare=z;this.type=c.BooleanType}r.parse=function(g,p,z){if(3!==g.length&&4!==g.length)throw Error(`"${g[0]}" expects 2 or 3 arguments`);if(4===g.length)throw Error(`"${g[0]}" collator not supported`);
return new r(b(g[1],p),b(g[2],p),z)};r.prototype.evaluate=function(g,p){return this.compare(this.lhs.evaluate(g,p),this.rhs.evaluate(g,p))};return r}(),t=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return k.parse(p,z,(E,J)=>E===J)};return g}(k),w=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return k.parse(p,z,(E,J)=>E!==J)};return g}(k),l=function(r){function g(){return r.apply(this,
arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return k.parse(p,z,(E,J)=>E<J)};return g}(k),u=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return k.parse(p,z,(E,J)=>E<=J)};return g}(k),D=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return k.parse(p,z,(E,J)=>E>J)};return g}(k),I=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=
function(p,z){return k.parse(p,z,(E,J)=>E>=J)};return g}(k),H=function(){function r(g){this.arg=g;this.type=c.BooleanType}r.parse=function(g,p){if(2!==g.length)throw Error('"!" expects 1 argument');return new r(b(g[1],p))};r.prototype.evaluate=function(g,p){return!this.arg.evaluate(g,p)};return r}(),B=function(){function r(g){this.args=g;this.type=c.BooleanType}r.parse=function(g,p){const z=[];for(let E=1;E<g.length;E++)z.push(b(g[E],p));return new r(z)};r.prototype.evaluate=function(g,p){for(const z of this.args)if(!z.evaluate(g,
p))return!1;return!0};return r}(),y=function(){function r(g){this.args=g;this.type=c.BooleanType}r.parse=function(g,p){const z=[];for(let E=1;E<g.length;E++)z.push(b(g[E],p));return new r(z)};r.prototype.evaluate=function(g,p){for(const z of this.args)if(z.evaluate(g,p))return!0;return!1};return r}(),F=function(){function r(g){this.args=g;this.type=c.BooleanType}r.parse=function(g,p){const z=[];for(let E=1;E<g.length;E++)z.push(b(g[E],p));return new r(z)};r.prototype.evaluate=function(g,p){for(const z of this.args)if(z.evaluate(g,
p))return!1;return!0};return r}(),N=function(){function r(g,p,z){this.type=g;this.args=p;this.fallback=z}r.parse=function(g,p,z){if(4>g.length)throw Error('"case" expects at least 3 arguments');if(1===g.length%2)throw Error('"case" expects an odd number of arguments');let E;const J=[];for(let P=1;P<g.length-1;P+=2){const W=b(g[P],p),V=b(g[P+1],p,z);E||(E=V.type);J.push({condition:W,output:V})}g=b(g[g.length-1],p,z);E||(E=g.type);return new r(E,J,g)};r.prototype.evaluate=function(g,p){for(const z of this.args)if(z.condition.evaluate(g,
p))return z.output.evaluate(g,p);return this.fallback.evaluate(g,p)};return r}(),Q=function(){function r(g,p){this.type=g;this.args=p}r.parse=function(g,p){if(2>g.length)throw Error('"coalesce" expects at least 1 argument');let z;const E=[];for(let J=1;J<g.length;J++){const P=b(g[J],p);z||(z=P.type);E.push(P)}return new r(z,E)};r.prototype.evaluate=function(g,p){for(const z of this.args){const E=z.evaluate(g,p);if(null!==E)return E}return null};return r}(),L=function(){function r(g,p,z,E,J){this.type=
g;this.input=p;this.labels=z;this.outputs=E;this.fallback=J}r.parse=function(g,p){if(3>g.length)throw Error('"match" expects at least 3 arguments');if(0===g.length%2)throw Error('"case" expects an even number of arguments');let z;const E=b(g[1],p),J=[],P={};let W;for(let aa=2;aa<g.length-1;aa+=2){var V=g[aa];Array.isArray(V)||(V=[V]);for(const fa of V){V=typeof fa;if("string"!==V&&"number"!==V)throw Error('"match" requires string or number literal as labels');if(!W)W=V;else if(V!==W)throw Error('"match" requires labels to have the same type');
P[fa]=J.length}V=b(g[aa+1],p);z||(z=V.type);J.push(V)}return new r(z,E,P,J,b(g[g.length-1],p))};r.prototype.evaluate=function(g,p){const z=this.input.evaluate(g,p);return(this.outputs[this.labels[z]]||this.fallback).evaluate(g,p)};return r}(),T=function(){function r(p,z,E,J,P){this.operator=p;this.type=z;this.interpolation=E;this.input=J;this.stops=P}r.parse=function(p,z,E){const J=p[0];if(5>p.length)throw Error(`"${J}" expects at least 4 arguments`);const P=p[1];if(!Array.isArray(P)||0===P.length)throw Error(`"${P}" is not a valid interpolation`);
switch(P[0]){case "linear":if(1!==P.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==P.length||"number"!==typeof P[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==P.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var W=1;5>W;W++){var V=P[W];if("number"!==typeof V||0>V||1<V)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${p[0]}" unknown interpolation type "${P[0]}"`);}if(1!==p.length%2)throw Error(`"${J}" expects an even number of arguments`);W=b(p[2],z,c.NumberType);let aa;"interpolate-hcl"===J||"interpolate-lab"===J?aa=c.ColorType:E&&"value"!==E.kind&&(aa=E);E=[];for(V=3;V<p.length;V+=2){const fa=p[V];if("number"!==typeof fa)throw Error(`"${J}" requires stop inputs as literal numbers`);if(E.length&&E[E.length-1][0]>=fa)throw Error(`"${J}" requires strictly ascending stop inputs`);const ka=
b(p[V+1],z,aa);aa||(aa=ka.type);E.push([fa,ka])}if(aa&&aa!==c.ColorType&&aa!==c.NumberType&&("array"!==aa.kind||aa.itemType!==c.NumberType))throw Error(`"${J}" cannot interpolate type ${c.typeToString(aa)}`);return new r(J,aa,P,W,E)};var g=r.prototype;g.evaluate=function(p,z){var E=this.stops;if(1===E.length)return E[0][1].evaluate(p,z);var J=this.input.evaluate(p,z);if(J<=E[0][0])return E[0][1].evaluate(p,z);if(J>=E[E.length-1][0])return E[E.length-1][1].evaluate(p,z);let P=0;for(;++P<E.length&&
!(J<E[P][0]););const W=r.interpolationRatio(this.interpolation,J,E[P-1][0],E[P][0]);J=E[P-1][1].evaluate(p,z);const V=E[P][1].evaluate(p,z);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(J)&&Array.isArray(V))return J.map((aa,fa)=>q.interpolate(aa,V[fa],W));if("color"===this.type.kind&&J instanceof v&&V instanceof v)return J=new v(J),p=new v(V),new v([q.interpolate(J.r,p.r,W),q.interpolate(J.g,p.g,W),q.interpolate(J.b,p.b,W),q.interpolate(J.a,p.a,W)]);if("number"===this.type.kind&&
"number"===typeof J&&"number"===typeof V)return q.interpolate(J,V,W);throw Error(`"${this.operator}" cannot interpolate type ${c.typeToString(this.type)}`);}if("interpolate-hcl"===this.operator)return p=x.toLCH(J),z=x.toLCH(V),E=z.h-p.h,p=x.toRGB({h:p.h+W*(180<E||-180>E?E-360*Math.round(E/360):E),c:q.interpolate(p.c,z.c,W),l:q.interpolate(p.l,z.l,W)}),new v({a:q.interpolate(J.a,V.a,W),...p});if("interpolate-lab"===this.operator)return p=x.toLAB(J),z=x.toLAB(V),p=x.toRGB({l:q.interpolate(p.l,z.l,W),
a:q.interpolate(p.a,z.a,W),b:q.interpolate(p.b,z.b,W)}),new v({a:q.interpolate(J.a,V.a,W),...p});throw Error(`Unexpected operator "${this.operator}"`);};g.interpolationUniformValue=function(p,z){const E=this.stops;if(1===E.length||p>=E[E.length-1][0])return 0;let J=0;for(;++J<E.length&&!(p<E[J][0]););return r.interpolationRatio(this.interpolation,z,E[J-1][0],E[J][0])};g.getInterpolationRange=function(p){const z=this.stops;if(1===z.length)return p=z[0][0],[p,p];var E=z[z.length-1][0];if(p>=E)return[E,
E];for(E=0;++E<z.length&&!(p<z[E][0]););return[z[E-1][0],z[E][0]]};r.interpolationRatio=function(p,z,E,J){let P=0;"linear"===p[0]?P=r._exponentialInterpolationRatio(z,1,E,J):"exponential"===p[0]?P=r._exponentialInterpolationRatio(z,p[1],E,J):"cubic-bezier"===p[0]&&(P=f.unitBezier(p[1],p[2],p[3],p[4])(r._exponentialInterpolationRatio(z,1,E,J),1E-5));0>P?P=0:1<P&&(P=1);return P};r._exponentialInterpolationRatio=function(p,z,E,J){J-=E;if(0===J)return 0;p-=E;return 1===z?p/J:(z**p-1)/(z**J-1)};return r}(),
R=function(){function r(g,p,z){this.type=g;this.input=p;this.stops=z}r.parse=function(g,p){if(5>g.length)throw Error('"step" expects at least 4 arguments');if(1!==g.length%2)throw Error('"step" expects an even number of arguments');const z=b(g[1],p,c.NumberType);let E;const J=[];J.push([-Infinity,b(g[2],p)]);for(let P=3;P<g.length;P+=2){const W=g[P];if("number"!==typeof W)throw Error('"step" requires stop inputs as literal numbers');if(J.length&&J[J.length-1][0]>=W)throw Error('"step" requires strictly ascending stop inputs');
const V=b(g[P+1],p);E||(E=V.type);J.push([W,V])}return new r(E,z,J)};r.prototype.evaluate=function(g,p){const z=this.stops;if(1===z.length)return z[0][1].evaluate(g,p);const E=this.input.evaluate(g,p);let J=0;for(;++J<z.length&&!(E<z[J][0]););return this.stops[J-1][1].evaluate(g,p)};return r}(),S=function(){function r(g,p){this.type=g;this.output=p}r.parse=function(g,p,z){if(4>g.length)throw Error('"let" expects at least 3 arguments');if(1===g.length%2)throw Error('"let" expects an odd number of arguments');
const E=new a(p);for(let J=1;J<g.length-1;J+=2){const P=g[J];if("string"!==typeof P)throw Error(`"let" requires a string to define variable names - found ${P}`);E.add(P,b(g[J+1],p))}g=b(g[g.length-1],E,z);return new r(g.type,g)};r.prototype.evaluate=function(g,p){return this.output.evaluate(g,p)};return r}(),O=function(){function r(g,p){this.type=g;this.output=p}r.parse=function(g,p,z){if(2!==g.length||"string"!==typeof g[1])throw Error('"var" requires just one literal string argument');p=p.get(g[1]);
if(!p)throw Error(`${g[1]} must be defined before being used in a "var" expression`);return new r(z||c.ValueType,p)};r.prototype.evaluate=function(g,p){return this.output.evaluate(g,p)};return r}(),K=function(){function r(g,p,z){this.type=g;this.index=p;this.array=z}r.parse=function(g,p){if(3!==g.length)throw Error('"at" expects 2 arguments');const z=b(g[1],p,c.NumberType);g=b(g[2],p);return new r(g.type.itemType,z,g)};r.prototype.evaluate=function(g,p){const z=this.index.evaluate(g,p);g=this.array.evaluate(g,
p);if(0>z||z>=g.length)throw Error('"at" index out of bounds');if(z!==Math.floor(z))throw Error('"at" index must be an integer');return g[z]};return r}(),G=function(){function r(g,p){this.key=g;this.obj=p;this.type=c.ValueType}r.parse=function(g,p){let z;switch(g.length){case 2:return z=b(g[1],p),new r(z);case 3:return z=b(g[1],p),g=b(g[2],p),new r(z,g);default:throw Error('"get" expects 1 or 2 arguments');}};r.prototype.evaluate=function(g,p){const z=this.key.evaluate(g,p);return this.obj?this.obj.evaluate(g,
p)[z]:null==g?void 0:g.values[z]};return r}(),M=function(){function r(g,p){this.key=g;this.obj=p;this.type=c.BooleanType}r.parse=function(g,p){let z;switch(g.length){case 2:return z=b(g[1],p),new r(z);case 3:return z=b(g[1],p),g=b(g[2],p),new r(z,g);default:throw Error('"has" expects 1 or 2 arguments');}};r.prototype.evaluate=function(g,p){const z=this.key.evaluate(g,p);return this.obj?(g=this.obj.evaluate(g,p),z in g):!(null==g||!g.values[z])};return r}(),U=function(){function r(g,p){this.key=g;
this.vals=p;this.type=c.BooleanType}r.parse=function(g,p){if(3!==g.length)throw Error('"in" expects 2 arguments');return new r(b(g[1],p),b(g[2],p))};r.prototype.evaluate=function(g,p){const z=this.key.evaluate(g,p);return-1!==this.vals.evaluate(g,p).indexOf(z)};return r}(),Y=function(){function r(g,p,z){this.item=g;this.array=p;this.from=z;this.type=c.NumberType}r.parse=function(g,p){if(3>g.length||4<g.length)throw Error('"index-of" expects 3 or 4 arguments');const z=b(g[1],p),E=b(g[2],p);return 4===
g.length?(g=b(g[3],p,c.NumberType),new r(z,E,g)):new r(z,E)};r.prototype.evaluate=function(g,p){const z=this.item.evaluate(g,p),E=this.array.evaluate(g,p);if(this.from){g=this.from.evaluate(g,p);if(g!==Math.floor(g))throw Error('"index-of" index must be an integer');return E.indexOf(z,g)}return E.indexOf(z)};return r}(),ca=function(){function r(g){this.arg=g;this.type=c.NumberType}r.parse=function(g,p){if(2!==g.length)throw Error('"length" expects 2 arguments');g=b(g[1],p);return new r(g)};r.prototype.evaluate=
function(g,p){g=this.arg.evaluate(g,p);if("string"===typeof g||Array.isArray(g))return g.length;throw Error('"length" expects string or array');};return r}(),da=function(){function r(g,p,z,E){this.type=g;this.array=p;this.from=z;this.to=E}r.parse=function(g,p){if(3>g.length||4<g.length)throw Error('"slice" expects 2 or 3 arguments');const z=b(g[1],p),E=b(g[2],p,c.NumberType);if(E.type!==c.NumberType)throw Error('"slice" index must return a number');if(4===g.length){g=b(g[3],p,c.NumberType);if(g.type!==
c.NumberType)throw Error('"slice" index must return a number');return new r(z.type,z,E,g)}return new r(z.type,z,E)};r.prototype.evaluate=function(g,p){const z=this.array.evaluate(g,p);if(!Array.isArray(z)&&"string"!==typeof z)throw Error('"slice" input must be an array or a string');const E=this.from.evaluate(g,p);if(0>E||E>=z.length)throw Error('"slice" index out of bounds');if(E!==Math.floor(E))throw Error('"slice" index must be an integer');if(this.to){g=this.to.evaluate(g,p);if(0>g||g>=z.length)throw Error('"slice" index out of bounds');
if(g!==Math.floor(g))throw Error('"slice" index must be an integer');return z.slice(E,g)}return z.slice(E)};return r}(),ba=function(){function r(){this.type=c.BooleanType}r.parse=function(g){if(1!==g.length)throw Error('"has-id" expects no arguments');return new r};r.prototype.evaluate=function(g,p){return g&&void 0!==g.id};return r}(),X=function(){function r(g,p){this.args=g;this.calculate=p;this.type=c.NumberType}r.parse=function(g,p,z){g=g.slice(1).map(E=>b(E,p));return new r(g,z)};r.prototype.evaluate=
function(g,p){let z;this.args&&(z=this.args.map(E=>E.evaluate(g,p)));return this.calculate(z)};return r}(),la=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){switch(p.length){case 2:return X.parse(p,z,E=>-E[0]);case 3:return X.parse(p,z,E=>E[0]-E[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return g}(X),ma=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return X.parse(p,
z,E=>{let J=1;for(const P of E)J*=P;return J})};return g}(X),na=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){if(3===p.length)return X.parse(p,z,E=>E[0]/E[1]);throw Error('"/" expects 2 arguments');};return g}(X),oa=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){if(3===p.length)return X.parse(p,z,E=>E[0]%E[1]);throw Error('"%" expects 2 arguments');};return g}(X),pa=function(r){function g(){return r.apply(this,
arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){if(3===p.length)return X.parse(p,z,E=>E[0]**E[1]);throw Error('"^" expects 1 or 2 arguments');};return g}(X),qa=function(r){function g(){return r.apply(this,arguments)||this}C._inheritsLoose(g,r);g.parse=function(p,z){return X.parse(p,z,E=>{let J=0;for(const P of E)J+=P;return J})};return g}(X),Z=function(){function r(g,p){this.args=g;this.calculate=p;this.type=c.NumberType}r.parse=function(g,p){const z=g.slice(1).map(E=>b(E,p));return new r(z,
r.ops[g[0]])};r.prototype.evaluate=function(g,p){let z;this.args&&(z=this.args.map(E=>E.evaluate(g,p)));return this.calculate(z)};return r}();Z.ops={abs:r=>Math.abs(r[0]),acos:r=>Math.acos(r[0]),asin:r=>Math.asin(r[0]),atan:r=>Math.atan(r[0]),ceil:r=>Math.ceil(r[0]),cos:r=>Math.cos(r[0]),e:()=>Math.E,floor:r=>Math.floor(r[0]),ln:r=>Math.log(r[0]),ln2:()=>Math.LN2,log10:r=>Math.log(r[0])/Math.LN10,log2:r=>Math.log(r[0])/Math.LN2,max:r=>Math.max(...r),min:r=>Math.min(...r),pi:()=>Math.PI,round:r=>Math.round(r[0]),
sin:r=>Math.sin(r[0]),sqrt:r=>Math.sqrt(r[0]),tan:r=>Math.tan(r[0])};let ra=function(){function r(g){this.args=g;this.type=c.StringType}r.parse=function(g,p){return new r(g.slice(1).map(z=>b(z,p)))};r.prototype.evaluate=function(g,p){return this.args.map(z=>z.evaluate(g,p)).join("")};return r}(),ia=function(){function r(g,p){this.arg=g;this.calculate=p;this.type=c.StringType}r.parse=function(g,p){if(2!==g.length)throw Error(`${g[0]} expects 1 argument`);p=b(g[1],p);return new r(p,r.ops[g[0]])};r.prototype.evaluate=
function(g,p){return this.calculate(this.arg.evaluate(g,p))};return r}();ia.ops={downcase:r=>r.toLowerCase(),upcase:r=>r.toUpperCase()};let sa=function(){function r(p){this.args=p;this.type=c.ColorType}r.parse=function(p,z){if(4!==p.length)throw Error('"rgb" expects 3 arguments');p=p.slice(1).map(E=>b(E,z));return new r(p)};var g=r.prototype;g.evaluate=function(p,z){const E=this._validate(this.args[0].evaluate(p,z)),J=this._validate(this.args[1].evaluate(p,z));p=this._validate(this.args[2].evaluate(p,
z));return new v({r:E,g:J,b:p})};g._validate=function(p){if("number"!==typeof p||0>p||255<p)throw Error(`${p}: invalid color component`);return Math.round(p)};return r}(),ta=function(){function r(p){this.args=p;this.type=c.ColorType}r.parse=function(p,z){if(5!==p.length)throw Error('"rgba" expects 4 arguments');p=p.slice(1).map(E=>b(E,z));return new r(p)};var g=r.prototype;g.evaluate=function(p,z){const E=this._validate(this.args[0].evaluate(p,z)),J=this._validate(this.args[1].evaluate(p,z)),P=this._validate(this.args[2].evaluate(p,
z));p=this._validateAlpha(this.args[3].evaluate(p,z));return new v({r:E,g:J,b:P,a:p})};g._validate=function(p){if("number"!==typeof p||0>p||255<p)throw Error(`${p}: invalid color component`);return Math.round(p)};g._validateAlpha=function(p){if("number"!==typeof p||0>p||1<p)throw Error(`${p}: invalid alpha color component`);return p};return r}(),ua=function(){function r(g){this.color=g;this.type=c.arrayType(c.NumberType,4)}r.parse=function(g,p){if(2!==g.length)throw Error('"to-rgba" expects 1 argument');
g=b(g[1],p);return new r(g)};r.prototype.evaluate=function(g,p){return(new v(this.color.evaluate(g,p))).toRgba()};return r}(),ha=function(){function r(g,p){this.type=g;this.args=p}r.parse=function(g,p){var z=g[0];if(2>g.length)throw Error(`${z} expects at least one argument`);let E=1,J;if("array"===z){if(2<g.length){switch(g[1]){case "string":J=c.StringType;break;case "number":J=c.NumberType;break;case "boolean":J=c.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');
}E++}else J=c.ValueType;if(3<g.length){var P=g[2];if(null!==P&&("number"!==typeof P||0>P||P!==Math.floor(P)))throw Error('"array" length argument must be a positive integer literal');E++}J=c.arrayType(J,P)}else switch(z){case "string":J=c.StringType;break;case "number":J=c.NumberType;break;case "boolean":J=c.BooleanType;break;case "object":J=c.ObjectType}for(z=[];E<g.length;E++)P=b(g[E],p),z.push(P);return new r(J,z)};r.prototype.evaluate=function(g,p){let z;for(const E of this.args){const J=E.evaluate(g,
p);z=c.getType(J);if(c.matchType(z,this.type))return J}throw Error(`Expected ${c.typeToString(this.type)} but got ${c.typeToString(z)}`);};return r}(),ea=function(){function r(g,p){this.type=g;this.args=p}r.parse=function(g,p){var z=g[0];const E=r.types[z];if(E===c.BooleanType||E===c.StringType){if(2!==g.length)throw Error(`${z} expects one argument`);}else if(2>g.length)throw Error(`${z} expects at least one argument`);z=[];for(let J=1;J<g.length;J++){const P=b(g[J],p);z.push(P)}return new r(E,z)};
r.prototype.evaluate=function(g,p){if(this.type===c.BooleanType)return!!this.args[0].evaluate(g,p);if(this.type===c.StringType)return c.valueToString(this.args[0].evaluate(g,p));if(this.type===c.NumberType){for(const E of this.args){var z=Number(E.evaluate(g,p));if(!isNaN(z))return z}return null}if(this.type===c.ColorType){for(z of this.args)try{const E=r.toColor(z.evaluate(g,p));if(E instanceof v)return E}catch{}return null}};r.toBoolean=function(g){return!!g};r.toString=function(g){return c.valueToString(g)};
r.toNumber=function(g){const p=Number(g);if(isNaN(p))throw Error(`"${g}" is not a number`);return p};r.toColor=function(g){if(g instanceof v)return g;if("string"===typeof g){const p=v.fromString(g);if(p)return p;throw Error(`"${g}" is not a color`);}if(Array.isArray(g))return v.fromArray(g);throw Error(`"${g}" is not a color`);};return r}();ea.types={"to-boolean":c.BooleanType,"to-color":c.ColorType,"to-number":c.NumberType,"to-string":c.StringType};let va=function(){function r(g){this.val=g;this.type=
c.getType(g)}r.parse=function(g){if(2!==g.length)throw Error('"literal" expects 1 argument');return new r(g[1])};r.prototype.evaluate=function(g,p){return this.val};return r}(),wa=function(){function r(g){this.arg=g;this.type=c.StringType}r.parse=function(g,p){if(2!==g.length)throw Error('"typeof" expects 1 argument');return new r(b(g[1],p))};r.prototype.evaluate=function(g,p){return c.typeToString(c.getType(this.arg.evaluate(g,p)))};return r}();const ja={array:ha,boolean:ha,collator:null,format:null,
image:null,literal:va,number:ha,"number-format":null,object:ha,string:ha,"to-boolean":ea,"to-color":ea,"to-number":ea,"to-string":ea,typeof:wa,accumulated:null,"feature-state":null,"geometry-type":h,id:d,"line-progress":null,properties:m,at:K,get:G,has:M,in:U,"index-of":Y,length:ca,slice:da,"!":H,"!\x3d":w,"\x3c":l,"\x3c\x3d":u,"\x3d\x3d":t,"\x3e":D,"\x3e\x3d":I,all:B,any:y,case:N,coalesce:Q,match:L,within:null,interpolate:T,"interpolate-hcl":T,"interpolate-lab":T,step:R,let:S,var:O,concat:ra,downcase:ia,
"is-supported-script":null,"resolved-locale":null,upcase:ia,rgb:sa,rgba:ta,"to-rgba":ua,"-":la,"*":ma,"/":na,"%":oa,"^":pa,"+":qa,abs:Z,acos:Z,asin:Z,atan:Z,ceil:Z,cos:Z,e:Z,floor:Z,ln:Z,ln2:Z,log10:Z,log2:Z,max:Z,min:Z,pi:Z,round:Z,sin:Z,sqrt:Z,tan:Z,zoom:n,"heatmap-density":null,"has-id":ba,none:F};A.ALL=B;A.ANY=y;A.Add=qa;A.Assert=ha;A.At=K;A.Calculate=Z;A.Case=N;A.Coalesce=Q;A.Coerce=ea;A.Concat=ra;A.Div=na;A.EQ=t;A.GE=I;A.GT=D;A.GeomType=h;A.Get=G;A.Has=M;A.HasID=ba;A.ID=d;A.In=U;A.IndexOf=Y;
A.Interpolate=T;A.LE=u;A.LT=l;A.Length=ca;A.Let=S;A.Literal=va;A.Match=L;A.Mod=oa;A.Mul=ma;A.NE=w;A.NONE=F;A.NOT=H;A.Pow=pa;A.Properties=m;A.Rgb=sa;A.Rgba=ta;A.Slice=da;A.Step=R;A.String=ia;A.Sub=la;A.ToRgba=ua;A.TypeOf=wa;A.Var=O;A.Zoom=n;A.createExpression=b;A.ops=ja;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(A){function C(a,d){const h=[];let m,n;if(a[0].length!==d.length)throw"dimensions do not match";const k=a.length,t=a[0].length;
let w=0;for(m=0;m<k;m++){for(n=w=0;n<t;n++)w+=a[m][n]*d[n];h.push(w)}return h}function v(a){a=[a.r/255,a.g/255,a.b/255].map(d=>.04045>=d?d/12.92:((d+.055)/1.055)**2.4);a=C(e,a);return{x:100*a[0],y:100*a[1],z:100*a[2]}}function x(a){a=C(b,[a.x/100,a.y/100,a.z/100]).map(d=>Math.min(1,Math.max(.0031308>=d?12.92*d:1.055*d**(1/2.4)-.055,0)));return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function f(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(d=>d>(6/29)**3?d**(1/3):1/3*(29/
6)**2*d+4/29);return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function q(a){const d=a.l;a=[(d+16)/116+a.a/500,(d+16)/116,(d+16)/116-a.b/200].map(h=>h>6/29?h**3:3*(6/29)**2*(h-4/29));return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function c(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var d=a.c;var h=a.h;d={l:a.l,a:d*Math.cos(h),b:d*Math.sin(h)};return x(q(d))}if("l"in a&&"a"in a&&"b"in a)return x(q(a));if("x"in a&&"y"in a&&"z"in a)return x(a);if("h"in a&&"s"in
a&&"v"in a){{h=(a.h+360)%360/60;d=a.v/100*255;a=a.s/100*d;const m=a*(1-Math.abs(h%2-1));switch(Math.floor(h)){case 0:h={r:a,g:m,b:0};break;case 1:h={r:m,g:a,b:0};break;case 2:h={r:0,g:a,b:m};break;case 3:h={r:0,g:m,b:a};break;case 4:h={r:m,g:0,b:a};break;case 5:case 6:h={r:a,g:0,b:m};break;default:h={r:0,g:0,b:0}}h.r=Math.round(h.r+d-a);h.g=Math.round(h.g+d-a);h.b=Math.round(h.b+d-a);d=h}return d}return a}const e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],b=[[3.2406,-1.5372,-.4986],
[-.9689,1.8758,.0415],[.0557,-.204,1.057]];A.darken=function(a,d){a=f(v(a));a.l*=1-d;return x(q(a))};A.toHSV=function(a){if("h"in a&&"s"in a&&"v"in a)return a;var d=c(a);{a=d.r;const h=d.g,m=d.b;d=Math.max(a,h,m);const n=d-Math.min(a,h,m);a=0===n?0:d===a?(h-m)/n%6:d===h?(m-a)/n+2:(a-h)/n+4;0>a&&(a+=6);a={h:60*a,s:100*(0===n?0:n/d),v:100/255*d}}return a};A.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:f(v(c(a)))};A.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){{var d=f(v(c(a)));a=d.l;var h=
d.a;const m=d.b;d=Math.sqrt(h*h+m*m);h=Math.atan2(m,h);h=0<h?h:h+2*Math.PI;a={l:a,c:d,h}}}return a};A.toRGB=c;A.toXYZ=function(a){return"x"in a&&"y"in a&&"z"in a?a:v(c(a))};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],function(A,C){function v(k,t){return{kind:"array",itemType:k,n:t}}function x(k){if("array"===k.kind){const t=x(k.itemType);return"number"===typeof k.n?`array<${t}, ${k.n}>`:
"value"===k.itemType.kind?"array":`array<${t}>`}return k.kind}function f(k){if(null===k)return c;if("string"===typeof k)return b;if("boolean"===typeof k)return a;if("number"===typeof k)return e;if(k instanceof C)return d;if(Array.isArray(k)){let t;for(const w of k){const l=f(w);if(!t)t=l;else if(t!==l){t=m;break}}return v(t||m,k.length)}return"object"===typeof k?h:m}function q(k,t){if("array"===t.kind)return"array"===k.kind&&(0===k.n&&"value"===k.itemType.kind||q(k.itemType,t.itemType))&&("number"!==
typeof t.n||t.n===k.n);if("value"===t.kind)for(const w of n)if(q(k,w))return!0;return t.kind===k.kind}const c={kind:"null"},e={kind:"number"},b={kind:"string"},a={kind:"boolean"},d={kind:"color"},h={kind:"object"},m={kind:"value"},n=[c,e,b,a,d,h,v(m)];A.BooleanType=a;A.ColorType=d;A.NullType=c;A.NumberType=e;A.ObjectType=h;A.StringType=b;A.ValueType=m;A.arrayType=v;A.getType=f;A.matchType=q;A.typeToString=x;A.valueToString=function(k){if(null===k)return"";const t=typeof k;return"string"===t?k:"number"===
t||"boolean"===t?String(k):k instanceof C?k.toString():JSON.stringify(k)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../GeometryUtils","../expression/expression","../expression/types"],function(A,C,v,x){return function(){function f(c,e){this.isDataDriven=!1;this.interpolator=null;switch(c.type){case "number":var b=!0;break;case "color":b=!0;break;case "array":b="number"===c.value;break;default:b=
!1}null==e&&(e=c.default);if(Array.isArray(e)&&0<e.length&&v.ops[e[0]]){b={number:x.NumberType,color:x.ColorType,string:x.StringType,boolean:x.BooleanType,enum:x.StringType};try{var a="array"===c.type?x.arrayType(b[c.value]||x.ValueType,c.length):b[c.type];const d=v.createExpression(e,null,a);this.getValue=this._buildExpression(d,c);this.isDataDriven=!0;d instanceof v.Interpolate&&d.input instanceof v.Zoom&&(this.interpolator=d)}catch(d){console.log(d.message),this.getValue=this._buildSimple(c.default)}}else{b&&
"interval"===e.type&&(b=!1);if(a=e&&e.stops&&0<e.stops.length)for(const d of e.stops)d[1]=this._validate(d[1],c);if(this.isDataDriven=e?!!e.property:!1)if(void 0!==e.default&&(e.default=this._validate(e.default,c)),a)switch(e.type){case "identity":this.getValue=this._buildIdentity(e,c);break;case "categorical":this.getValue=this._buildCategorical(e,c);break;default:this.getValue=b?this._buildInterpolate(e,c):this._buildInterval(e,c)}else this.getValue=this._buildIdentity(e,c);else a?this.getValue=
b?this._buildZoomInterpolate(e):this._buildZoomInterval(e):(e=this._validate(e,c),this.getValue=this._buildSimple(e))}}var q=f.prototype;q._validate=function(c,e){if("number"===e.type){if(c<e.minimum)return e.minimum;if(c>e.maximum)return e.maximum}else"color"===e.type?c=f._parseColor(c):"enum"===e.type?"string"===typeof c&&(c=e.values.indexOf(c)):"array"===e.type&&"enum"===e.value?c=c.map(b=>"string"===typeof b?e.values.indexOf(b):b):"string"===e.type&&(c=x.valueToString(c));return c};q._buildSimple=
function(c){return()=>c};q._buildExpression=function(c,e){return(b,a)=>{try{const d=c.evaluate(a,b);return void 0===d?e.default:this._validate(d,e)}catch(d){return console.log(d.message),e.default}}};q._buildIdentity=function(c,e){return(b,a)=>{let d;a&&(d=a.values[c.property]);void 0!==d&&(d=this._validate(d,e));return null!=d?d:void 0!==c.default?c.default:e.default}};q._buildCategorical=function(c,e){return(b,a)=>{let d;a&&(d=a.values[c.property]);d=this._categorical(d,c.stops);return void 0!==
d?d:void 0!==c.default?c.default:e.default}};q._buildInterval=function(c,e){return(b,a)=>{let d;a&&(d=a.values[c.property]);return"number"===typeof d?this._interval(d,c.stops):void 0!==c.default?c.default:e.default}};q._buildInterpolate=function(c,e){return(b,a)=>{let d;a&&(d=a.values[c.property]);return"number"===typeof d?this._interpolate(d,c.stops,c.base||1):void 0!==c.default?c.default:e.default}};q._buildZoomInterpolate=function(c){return e=>this._interpolate(e,c.stops,c.base||1)};q._buildZoomInterval=
function(c){return e=>this._interval(e,c.stops)};q._categorical=function(c,e){const b=e.length;for(let a=0;a<b;a++)if(e[a][0]===c)return e[a][1]};q._interval=function(c,e){const b=e.length;let a=0;for(let d=0;d<b;d++)if(e[d][0]<=c)a=d;else break;return e[a][1]};q._interpolate=function(c,e,b){const a=e.length;for(let m=0;m<a;m++){const n=e[m];if(n[0]<=c)var d=n;else{var h=n;break}}if(d&&h){e=h[0]-d[0];c-=d[0];b=1===b?c/e:(b**c-1)/(b**e-1);if(Array.isArray(d[1])){d=d[1];h=h[1];c=[];for(e=0;e<d.length;e++)c.push(C.interpolate(d[e],
h[e],b));return c}return C.interpolate(d[1],h[1],b)}if(d)return d[1];if(h)return h[1]};f._isEmpty=function(c){for(const e in c)if(c.hasOwnProperty(e))return!1;return!0};f._parseColor=function(c){if(Array.isArray(c))return c;"string"===typeof c&&(c=new A(c));if(c instanceof A&&!this._isEmpty(c))return A.toUnitRGBA(c)};return f}()})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../engine/Container ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(A,C,v,x,f,q,c,e,b,a,d,h,m,n,k,t,w){const l=x.ofType({key:"type",base:n,typeMap:{rect:k,path:w,geometry:t}});A.LayerView2DMixin=u=>{u=function(D){function I(){var B=D.apply(this,arguments)||this;B.attached=!1;B.clips=new l;B.lastUpdateId=-1;B.moving=!1;B.updateRequested=!1;return B}C._inheritsLoose(I,D);var H=I.prototype;H.initialize=function(){var B,y,F,N;const Q=null!=(B=null==(y=this.view)?void 0:y.spatialReferenceLocked)?B:!0;(null==(F=this.view)?0:F.spatialReference)&&Q&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new q("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new m.Container),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([c.watch(()=>this.suspended,L=>{this.container&&(this.container.visible=!L);this.view&&!L&&this.updateRequested&&this.view.requestUpdate()},c.syncAndInitial),
c.watch(()=>{var L,T;return null!=(L=null==(T=this.layer)?void 0:T.opacity)?L:1},L=>{this.container&&(this.container.opacity=L)},c.syncAndInitial),c.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",L=>{this.container&&(this.container.blendMode=L)},c.syncAndInitial),c.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,L=>{this.container&&(this.container.effect=L)},c.syncAndInitial),c.on(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)})]),
null!=(N=this.view)&&N.whenLayerView?this.view.whenLayerView(this.layer).then(L=>{L===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))};H.destroy=function(){this.processDetach();this.updateRequested=!1};H.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};H.processDetach=function(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=
!1)};H.isVisibleAtScale=function(B){const y=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!y)return!0;const {minScale:F,maxScale:N}=y;return(0===F||B<=F)&&(0===N||B>=N)};H.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};H.processUpdate=function(B){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",B),this.updateRequested&&!this.suspended&&
(this.updateRequested=!1,this.update(B)))};H.hitTest=function(B,y){return Promise.resolve(null)};H.supportsSpatialReference=function(B){return!0};H.canResume=function(){return this.spatialReferenceSupported?D.prototype.canResume.call(this)?this.visibleAtCurrentScale:!1:!1};H.getSuspendInfo=function(){const B=D.prototype.getSuspendInfo.call(this),y=!this.spatialReferenceSupported,F=this.visibleAtCurrentScale;y&&(B.spatialReferenceNotSupported=y);F&&(B.outsideScaleRange=F);return B};C._createClass(I,
[{key:"spatialReferenceSupported",get:function(){var B;const y=null==(B=this.view)?void 0:B.spatialReference;return null==y||this.supportsSpatialReference(y)}},{key:"updating",get:function(){var B;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(null==(B=this.updatingHandles)||!B.updating))}},{key:"visibleAtCurrentScale",get:function(){return this.isVisibleAtScale(this.view.scale)}}]);return I}(u);v.__decorate([e.property()],u.prototype,
"attached",void 0);v.__decorate([e.property({type:l,set(D){D=f.referenceSetter(D,this._get("clips"),l);this._set("clips",D)}})],u.prototype,"clips",void 0);v.__decorate([e.property()],u.prototype,"container",void 0);v.__decorate([e.property()],u.prototype,"moving",void 0);v.__decorate([e.property({readOnly:!0})],u.prototype,"spatialReferenceSupported",null);v.__decorate([e.property({readOnly:!0})],u.prototype,"updateParameters",void 0);v.__decorate([e.property()],u.prototype,"updateRequested",void 0);
v.__decorate([e.property()],u.prototype,"updating",null);v.__decorate([e.property()],u.prototype,"view",void 0);v.__decorate([e.property({readOnly:!0})],u.prototype,"visibleAtCurrentScale",null);return u=v.__decorate([h.subclass("esri.views.2d.layers.LayerView2D")],u)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/set ../../../core/accessorSupport/decorators/subclass".split(" "),
function(A,C,v,x,f,q,c,e,b){v=function(a){function d(){return a.apply(this,arguments)||this}A._inheritsLoose(d,a);return d}(v.JSONSupport);return v=C.__decorate([b.subclass("esri.views.layers.support.ClipArea")],v)})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(A,C,v,x,f,q,c,e){var b;x=b=function(a){function d(){var h=a.apply(this,arguments)||this;h.type="rect";h.left=null;h.right=null;h.top=null;h.bottom=null;return h}A._inheritsLoose(d,a);d.prototype.clone=function(){return new b({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};A._createClass(d,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return d}(e);C.__decorate([v.property({type:[Number,String],json:{write:!0}})],x.prototype,"left",void 0);C.__decorate([v.property({type:[Number,
String],json:{write:!0}})],x.prototype,"right",void 0);C.__decorate([v.property({type:[Number,String],json:{write:!0}})],x.prototype,"top",void 0);C.__decorate([v.property({type:[Number,String],json:{write:!0}})],x.prototype,"bottom",void 0);C.__decorate([v.property({readOnly:!0})],x.prototype,"version",null);return x=b=C.__decorate([c.subclass("esri.views.layers.support.ClipRect")],x)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(A,C,v,x,f,q,c,e,b,a,d,h,m){var n;v={base:b,key:"type",typeMap:{extent:h,polygon:m}};d=n=function(k){function t(){var w=k.apply(this,arguments)||this;w.type="geometry";w.geometry=null;return w}A._inheritsLoose(t,k);t.prototype.clone=function(){return new n({geometry:this.geometry.clone()})};A._createClass(t,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return t}(d);C.__decorate([x.property({types:v,json:{read:a.fromJSON,write:!0}})],d.prototype,"geometry",void 0);C.__decorate([x.property({readOnly:!0})],
d.prototype,"version",null);return d=n=C.__decorate([e.subclass("esri.views.layers.support.Geometry")],d)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(A,C,v,x,f,q,c,e){x=function(b){function a(){var d=b.apply(this,
arguments)||this;d.type="path";d.path=[];return d}A._inheritsLoose(a,b);A._createClass(a,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return a}(e);C.__decorate([v.property({type:[[[Number]]],json:{write:!0}})],x.prototype,"path",void 0);C.__decorate([v.property({readOnly:!0})],x.prototype,"version",null);return x=C.__decorate([c.subclass("esri.views.layers.support.Path")],x)})},"esri/views/2d/layers/support/Display":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/Bitmap","../../engine/BitmapContainer"],function(A,C,v,x){x=function(f){function q(e){var b=f.call(this)||this;b.requestRender=b.requestRender.bind(C._assertThisInitialized(b));b._layerView=e;b._canvas=document.createElement("canvas");b._context=b._canvas.getContext("2d");b._bitmap=new v.Bitmap(null,"standard",!1);b.addChild(b._bitmap);return b}C._inheritsLoose(q,f);var c=q.prototype;c.doRender=function(e){const b=e.state,a=this._createCustomRenderParams(e),d=this._canvas,h=this._bitmap,
m=window.devicePixelRatio;d.width=b.size[0]*m;d.height=b.size[1]*m;h.resolution=b.resolution;const n=b.clone();n.pixelRatio=m;h.pixelRatio=m;a.state=n;h.x=b.viewpoint.targetGeometry.x-Math.abs(b.extent.xmax-b.extent.xmin)/2;h.y=b.viewpoint.targetGeometry.y+Math.abs(b.extent.ymax-b.extent.ymin)/2;this._layerView.render(a);h.source=d;h.rotation=b.rotation;f.prototype.doRender.call(this,{...e,state:n})};c._createCustomRenderParams=function(e){return{globalOpacity:e.globalOpacity,state:e.state,stationary:e.stationary,
pixelRatio:window.devicePixelRatio,context:this._context}};return q}(x.BitmapContainer);A.Display=x;A.default=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/tiling/TileInfoViewPOT":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../layers/support/TileInfo","./TileInfoView","./TileKey"],function(A,C,v,x){return function(f){function q(){var e=f.apply(this,arguments)||this;e._fullCacheLodInfos=null;e._levelByScale={};return e}A._inheritsLoose(q,f);var c=q.prototype;
c.getTileParentId=function(e){e=x.pool.acquire(e);const b=0===e.level?null:x.getId(e.level-1,e.row>>1,e.col>>1,e.world);x.pool.release(e);return b};c.getTileCoverage=function(e,b,a){e=f.prototype.getTileCoverage.call(this,e,b,a);if(!e)return e;const d=1<<e.lodInfo.level;e.spans=e.spans.filter(h=>0<=h.row&&h.row<d);return e};c.scaleToLevel=function(e){this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos);if(this._levelByScale[e])return this._levelByScale[e];{var b=this._fullCacheLodInfos;
if(e>b[0].scale)return b[0].level;let a;for(let d=0;d<b.length-1;d++)if(a=b[d+1],e>a.scale)return b=b[d],b.level+(b.scale-e)/(b.scale-a.scale);return b[b.length-1].level}};c._initializeFullCacheLODs=function(e){e=0===e[0].level?e.map(b=>({level:b.level,resolution:b.resolution,scale:b.scale})):C.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map(b=>({level:b.level,resolution:b.resolution,scale:b.scale}));for(let b=0;b<e.length;b++)this._levelByScale[e[b].scale]=
e[b].level;this._fullCacheLodInfos=e};return q}(v)})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/diffUtils ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../engine/vectorTiles/enums ../engine/vectorTiles/TileHandler ../engine/vectorTiles/TileManager ../engine/vectorTiles/VectorTile ../engine/vectorTiles/VectorTileContainer ../engine/vectorTiles/decluttering/debugging ../engine/vectorTiles/style/StyleDefinition ../engine/vectorTiles/style/StyleRepository ./LayerView2D ./support/Display ../tiling/TileInfoViewPOT ../tiling/TileQueue ../../layers/LayerView".split(" "),function(A,
C,v,x,f,q,c,e,b,a,d,h,m,n,k,t,w,l,u,D,I,H,B,y,F,N,Q){function L(R){if(q.isNone(R))return 0;switch(R.type){case "partial":return Object.keys(R.diff).length;case "complete":return Math.max(Object.keys(R.oldValue).length,Object.keys(R.newValue).length);case "collection":return Object.keys(R.added).length+Object.keys(R.changed).length+Object.keys(R.removed).length}}const T=f.getLogger("esri.views.2d.layers.VectorTileLayerView2D");f=function(R){function S(){var K=R.apply(this,arguments)||this;K._styleChanges=
[];K._fetchQueue=null;K._parseQueue=null;K._isTileHandlerReady=!1;K.fading=!1;return K}A._inheritsLoose(S,R);var O=S.prototype;O.hitTest=function(){var K=A._asyncToGenerator(function*(G,M){if(!this._tileHandlerPromise)return null;yield this._tileHandlerPromise;G=yield this._vectorTileContainer.hitTest(M);if(!G||0===G.length)return null;G=G[0]-1;var U=this._styleRepository;M=U.getStyleLayerByUID(G);if(!M)return null;U=U.getStyleLayerIndex(M.id);G=new v({attributes:{layerId:U,layerName:M.id,layerUID:G}});
G.layer=this.layer;G.sourceLayer=this.layer;return[G]});return function(G,M){return K.apply(this,arguments)}}();O.update=function(K){this._tileHandlerPromise&&this._isTileHandlerReady&&(K.pixelRatio!==this._tileHandler.devicePixelRatio?(this._start(),this._tileHandler.devicePixelRatio=K.pixelRatio):0<this._styleChanges.length?this._tileHandlerPromise=this._applyStyleChanges():(this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.state=K.state,this._parseQueue.state=K.state,this._tileManager.update(K)||
this.requestUpdate(),this._parseQueue.resume(),this._fetchQueue.resume()))};O.attach=function(){const {style:K}=this.layer.currentStyleInfo;this._styleRepository=new H(K);this._tileInfoView=new F(this.layer.tileInfo,this.layer.fullExtent);this._vectorTileContainer=new u.VectorTileContainer(this._tileInfoView);this._tileHandler=new t.TileHandler(this.layer,this._styleRepository,window.devicePixelRatio||1);this.container.addChild(this._vectorTileContainer);this._start();this.handles.add([this._vectorTileContainer.on("fade-start",
()=>{this.fading=!0;this.notifyChange("updating");this.requestUpdate()}),this._vectorTileContainer.on("fade-complete",()=>{var G;null==(G=this._collisionBoxesDisplay)?void 0:G.requestRender();this.fading=!1;this.notifyChange("updating");this.requestUpdate()}),e.watch(()=>this.layer.symbolCollisionBoxesVisible,G=>{G?(this._collisionBoxesDisplay=new y.Display({render:M=>this._renderCollisionBoxes(M.context)}),this.container.addChild(this._collisionBoxesDisplay)):(this.container.removeChild(this._collisionBoxesDisplay),
this._collisionBoxesDisplay=null)},e.initial),this.layer.on("paint-change",G=>{if(G.isDataDriven)this._styleChanges.push({type:k.StyleUpdateType.PAINTER_CHANGED,data:G}),this.notifyChange("updating"),this.requestUpdate();else{const U=this._styleRepository;var M=U.getLayerById(G.layer);M&&(M=M.type===I.StyleLayerType.SYMBOL,U.setPaintProperties(G.layer,G.paint),M&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}}),this.layer.on("layout-change",G=>{const M=this._styleRepository,
U=M.getLayerById(G.layer);if(U){var Y=h.diff(U.layout,G.layout);q.isNone(Y)||(h.hasDiff(Y,"visibility")&&1===L(Y)?(M.setLayoutProperties(G.layer,G.layout),U.type===I.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender()):(this._styleChanges.push({type:k.StyleUpdateType.LAYOUT_CHANGED,data:G}),this.notifyChange("updating"),this.requestUpdate()))}}),this.layer.on("style-layer-visibility-change",G=>{const M=this._styleRepository,U=M.getLayerById(G.layer);
U&&(M.setStyleLayerVisibility(G.layer,G.visibility),U.type===I.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}),this.layer.on("style-layer-change",G=>{this._styleChanges.push({type:k.StyleUpdateType.LAYER_CHANGED,data:G});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("delete-style-layer",G=>{this._styleChanges.push({type:k.StyleUpdateType.LAYER_REMOVED,data:G});this.notifyChange("updating");this.requestUpdate()}),
this.layer.on("load-style",()=>this._loadStyle()),this.layer.on("spriteSource-change",G=>{this._newSpriteSource=G.spriteSource;this._styleChanges.push({type:k.StyleUpdateType.SPRITES_CHANGED,data:null});G=this._styleRepository.layers;for(const M of G)switch(M.type){case I.StyleLayerType.SYMBOL:M.getLayoutProperty("icon-image")&&this._styleChanges.push({type:k.StyleUpdateType.LAYOUT_CHANGED,data:{layer:M.id,layout:M.layout}});break;case I.StyleLayerType.LINE:M.getPaintProperty("line-pattern")&&this._styleChanges.push({type:k.StyleUpdateType.PAINTER_CHANGED,
data:{layer:M.id,paint:M.paint,isDataDriven:M.isPainterDataDriven()}});break;case I.StyleLayerType.FILL:M.getLayoutProperty("fill-pattern")&&this._styleChanges.push({type:k.StyleUpdateType.PAINTER_CHANGED,data:{layer:M.id,paint:M.paint,isDataDriven:M.isPainterDataDriven()}})}this.notifyChange("updating");this.requestUpdate()})],this.declaredClass)};O.detach=function(){var K,G;this._stop();this.container.removeAllChildren();null==(K=this._vectorTileContainer)?void 0:K.destroy();this._vectorTileContainer=
null;null==(G=this._tileHandler)?void 0:G.destroy();this._tileHandler=null;this.handles.remove(this.declaredClass)};O.moveStart=function(){this.requestUpdate()};O.viewChange=function(){this.requestUpdate()};O.moveEnd=function(){this._collisionBoxesDisplay&&this._vectorTileContainer.restartDeclutter();this.requestUpdate()};O.supportsSpatialReference=function(K){var G;return n.equals(null==(G=this.layer.tileInfo)?void 0:G.spatialReference,K)};O.canResume=function(){let K=R.prototype.canResume.call(this);
const {currentStyleInfo:G}=this.layer;if(K&&null!=G&&G.layerDefinition){const M=this.view.scale,{minScale:U,maxScale:Y}=G.layerDefinition;G&&G.layerDefinition&&(U&&U<M&&(K=!1),Y&&Y>M&&(K=!1))}return K};O.isUpdating=function(){const K=this._vectorTileContainer.children;return!this._isTileHandlerReady||!this._fetchQueue||!this._parseQueue||this._fetchQueue.updating||this._parseQueue.updating||0<K.length&&0<K.filter(G=>G.invalidating).length||this.fading};O.acquireTile=function(K){const G=this._createVectorTile(K);
this._tileHandlerPromise.then(()=>{this._fetchQueue.push(G.key).then(M=>this._parseQueue.push({key:G.key,data:M})).then(M=>{G.once("attach",()=>this.requestUpdate());G.setData(M);this.requestUpdate();this.notifyChange("updating")}).catch(M=>{this.notifyChange("updating");c.isAbortError(M)||T.error(M)})});return G};O.releaseTile=function(K){K=K.key.id;this._fetchQueue.abort(K);this._parseQueue.abort(K);this.requestUpdate()};O._start=function(){this._stop();this._tileManager=new w.TileManager({acquireTile:M=>
this.acquireTile(M),releaseTile:M=>this.releaseTile(M),tileInfoView:this._tileInfoView},this._vectorTileContainer);if(this.layer.currentStyleInfo){var K=new AbortController,G=this._tileHandler.start({signal:K.signal}).then(()=>{this._fetchQueue=new N({tileInfoView:this._tileInfoView,process:(M,U)=>this._getTileData(M,U),concurrency:15});this._parseQueue=new N({tileInfoView:this._tileInfoView,process:(M,U)=>this._parseTileData(M,U),concurrency:8});this.requestUpdate();this._isTileHandlerReady=!0});
this._tileHandler.spriteMosaic.then(M=>{this._vectorTileContainer.setStyleResources(M,this._tileHandler.glyphMosaic,this._styleRepository);this.requestUpdate()});this._tileHandlerAbortController=K;this._tileHandlerPromise=G}};O._stop=function(){if(this._tileHandlerAbortController&&this._vectorTileContainer){var K=this._tileHandlerAbortController;K&&K.abort();this._tileHandlerPromise=null;this._isTileHandlerReady=!1;this._fetchQueue&&(this._fetchQueue.destroy(),this._fetchQueue=null);this._parseQueue&&
(this._parseQueue.destroy(),this._parseQueue=null);this._tileManager&&(this._tileManager.destroy(),this._tileManager=null);this._vectorTileContainer.removeAllChildren()}};O._getTileData=function(){var K=A._asyncToGenerator(function*(G,M){G=yield this._tileHandler.fetchTileData(G,M);this.notifyChange("updating");return G});return function(G,M){return K.apply(this,arguments)}}();O._parseTileData=function(){var K=A._asyncToGenerator(function*(G,M){return this._tileHandler.parseTileData(G,M)});return function(G,
M){return K.apply(this,arguments)}}();O._applyStyleChanges=function(){var K=A._asyncToGenerator(function*(){this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this._tileManager.clearCache();var G=this._styleChanges;try{yield this._tileHandler.updateStyle(G)}catch(ba){T.error("error applying vector-tiles style update",ba.message),this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0}const M=this._styleRepository,
U=[];G.forEach(ba=>{ba.type===k.StyleUpdateType.LAYER_REMOVED&&(ba=M.getLayerById(ba.data.layer))&&U.push(ba.uid)});const Y=[];let ca;G.forEach(ba=>{const X=ba.data;switch(ba.type){case k.StyleUpdateType.PAINTER_CHANGED:M.setPaintProperties(X.layer,X.paint);ca=X.layer;break;case k.StyleUpdateType.LAYOUT_CHANGED:M.setLayoutProperties(X.layer,X.layout);ca=X.layer;break;case k.StyleUpdateType.LAYER_REMOVED:M.deleteStyleLayer(X.layer);return;case k.StyleUpdateType.LAYER_CHANGED:M.setStyleLayer(X.layer,
X.index);ca=X.layer.id;break;case k.StyleUpdateType.SPRITES_CHANGED:this._vectorTileContainer.setSpriteMosaic(this._tileHandler.setSpriteSource(this._newSpriteSource)),ca=this._newSpriteSource=null}(ba=M.getLayerById(ca))&&Y.push(ba.uid)});G=this._vectorTileContainer.children;if(0<U.length){this._vectorTileContainer.deleteStyleLayers(U);for(var da of G)da.deleteLayerData(U)}this._fetchQueue.resume();this._parseQueue.resume();if(0<Y.length){da=[];for(const ba of G)G=this._fetchQueue.push(ba.key).then(X=>
this._parseQueue.push({key:ba.key,data:X,styleLayerUIDs:Y})).then(X=>ba.setData(X)),da.push(G);yield Promise.all(da)}this._styleChanges=[];this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return K.apply(this,arguments)}}();O._loadStyle=function(){var K=A._asyncToGenerator(function*(){var {style:G}=this.layer.currentStyleInfo;G=x.clone(G);this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();
this.notifyChange("updating");this._styleRepository=new H(G);this._vectorTileContainer.destroy();this._tileManager.clear();this._tileHandlerAbortController.abort();this._tileHandlerAbortController=new AbortController;const {signal:M}=this._tileHandlerAbortController;try{this._tileHandlerPromise=this._tileHandler.setStyle(this._styleRepository,G),yield this._tileHandlerPromise}catch(U){if(!c.isAbortError(U))throw U;}M.aborted||(G=yield this._tileHandler.spriteMosaic,this._vectorTileContainer.setStyleResources(G,
this._tileHandler.glyphMosaic,this._styleRepository));this._fetchQueue.resume();this._parseQueue.resume();this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return K.apply(this,arguments)}}();O._createVectorTile=function(K){const G=this._tileInfoView.getTileBounds(m.create(),K);return new l.VectorTile(K,G[0],G[3],512,512,this._styleRepository)};O._renderCollisionBoxes=function(K){for(const G of this._vectorTileContainer.children)if(G.symbols){const M=
[];for(const [,U]of G.symbols)M.push(...U);D.drawColliders(K,M)}};return S}(B.LayerView2DMixin(Q));C.__decorate([b.property()],f.prototype,"_fetchQueue",void 0);C.__decorate([b.property()],f.prototype,"_parseQueue",void 0);C.__decorate([b.property()],f.prototype,"_isTileHandlerReady",void 0);C.__decorate([b.property()],f.prototype,"fading",void 0);return f=C.__decorate([d.subclass("esri.views.2d.layers.VectorTileLayerView2D")],f)});