// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),function(u,v,l,w,m,n,p,c,q,x,r){return function(t){function k(){var a=t.apply(this,arguments)||this;a._color=v.fromValues(1,0,0,1);return a}u._inheritsLoose(k,
t);var h=k.prototype;h.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};h.prepareState=function({context:a}){a.setBlendingEnabled(!0);
a.setBlendFunctionSeparate(c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA,c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};h.draw=function(a,b){({context:a}=a);if(b.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",b.rangeX,b.rangeY);
this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(c.PrimitiveType.LINE_STRIP,0,4);var e=this._getTexture(a,b);e&&(a.bindVAO(this._tileInfoVertexArrayObject),a.useProgram(this._tileInfoProgram),a.bindTexture(e,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",b.rangeX/b.width,b.rangeY/b.height),this._tileInfoProgram.setUniform2f("u_delta",
8,8),this._tileInfoProgram.setUniform2f("u_dimensions",e.descriptor.width,e.descriptor.height),a.drawArrays(c.PrimitiveType.TRIANGLE_STRIP,0,4));a.bindVAO()}};h._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var b=q.createProgram(a,m.background),e=q.createProgram(a,n.tileInfo),f=new Int8Array([0,0,1,0,1,1,0,1]);f=p.BufferObject.createVertex(a,c.Usage.STATIC_DRAW,f);f=new r.VertexArrayObject(a,m.background.attributes,l.Pos2b,{geometry:f});var g=new Int8Array([0,0,1,
0,0,1,1,1]);g=p.BufferObject.createVertex(a,c.Usage.STATIC_DRAW,g);a=new r.VertexArrayObject(a,n.tileInfo.attributes,l.Pos2b,{geometry:g});this._outlineProgram=b;this._tileInfoProgram=e;this._outlineVertexArrayObject=f;this._tileInfoVertexArrayObject=a}};h._getTexture=function(a,b){if(b.texture&&b.triangleCountReportedInDebug===b.triangleCount)return b.texture;b.triangleCountReportedInDebug=b.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id",
"canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const e=b.triangleCount;let f=b.key.id;0<b.triangleCount&&(f+=`, ${e}`);const g=this._canvas,d=g.getContext("2d");d.font="24px sans-serif";d.textAlign="left";d.textBaseline="top";d.clearRect(0,0,300,32);1E5<e?(d.fillStyle="red",d.fillRect(0,0,300,32),d.fillStyle="black"):(d.clearRect(0,0,300,32),d.fillStyle="blue");d.fillText(f,0,0);b.texture=new x.Texture(a,
{target:c.TextureType.TEXTURE_2D,pixelFormat:c.PixelFormat.RGBA,dataType:c.PixelType.UNSIGNED_BYTE,samplingMode:c.TextureSamplingMode.NEAREST,wrapMode:c.TextureWrapMode.CLAMP_TO_EDGE},g);return b.texture};return k}(w)});