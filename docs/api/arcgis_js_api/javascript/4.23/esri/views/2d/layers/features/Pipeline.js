// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ../views/support/WatchUpdatingTracking".split(" "),function(r,t,F,C,v,A,w,l){const e=h=>{h=function(k){function n(){return k.apply(this,arguments)||this}t._inheritsLoose(n,k);n.prototype.destroy=function(){var p,c;this.destroyed||(null==(p=this._get("handles"))?void 0:p.destroy(),
null==(c=this._get("updatingHandles"))?void 0:c.destroy())};t._createClass(n,[{key:"handles",get:function(){return this._get("handles")||new v}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new l.WatchUpdatingTracking}}]);return n}(h);F.__decorate([A.property({readOnly:!0})],h.prototype,"handles",null);F.__decorate([A.property({readOnly:!0})],h.prototype,"updatingHandles",null);return h=F.__decorate([w.subclass("esri.core.HandleOwner")],h)};r.HandleOwner=function(h){function k(){return h.apply(this,
arguments)||this}t._inheritsLoose(k,h);return k}(e(C));r.HandleOwner=F.__decorate([w.subclass("esri.core.HandleOwner")],r.HandleOwner);r.HandleOwnerMixin=e;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/Handles":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Collection ./maybe ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w){F=function(l){function e(k){k=l.call(this,k)||this;k._groups=
new Map;return k}r._inheritsLoose(e,l);var h=e.prototype;h.destroy=function(){this.removeAll()};h.add=function(k,n){if(!this._isHandle(k)&&!Array.isArray(k)&&!C.isCollection(k))return this;const p=this._getOrCreateGroup(n);Array.isArray(k)||C.isCollection(k)?k.forEach(c=>this._isHandle(c)&&p.push(c)):p.push(k);this.notifyChange("size");return this};h.forEach=function(k,n){if("function"===typeof k)this._groups.forEach(p=>p.forEach(k));else{const p=this._getGroup(k);p&&n&&p.forEach(n)}};h.has=function(k){return this._groups.has(this._ensureGroupKey(k))};
h.remove=function(k){if(Array.isArray(k)||C.isCollection(k))return k.forEach(this.remove,this),this;if(!this.has(k))return this;const n=this._getGroup(k);for(let p=0;p<n.length;p++)n[p].remove();this._deleteGroup(k);this.notifyChange("size");return this};h.removeAll=function(){this._groups.forEach(k=>{for(let n=0;n<k.length;n++)k[n].remove()});this._groups.clear();this.notifyChange("size");return this};h._isHandle=function(k){return k&&!!k.remove};h._getOrCreateGroup=function(k){if(this.has(k))return this._getGroup(k);
const n=[];this._groups.set(this._ensureGroupKey(k),n);return n};h._getGroup=function(k){return v.assumeNonNull(this._groups.get(this._ensureGroupKey(k)))};h._deleteGroup=function(k){return this._groups.delete(this._ensureGroupKey(k))};h._ensureGroupKey=function(k){return k||"_default_"};r._createClass(e,[{key:"size",get:function(){let k=0;this._groups.forEach(n=>{k+=n.length});return k}}]);return e}(F);t.__decorate([A.property({readOnly:!0})],F.prototype,"size",null);return F=t.__decorate([w.subclass("esri.core.Handles")],
F)})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d){function a(J){return J?J instanceof H?J.toArray():
J.length?Array.prototype.slice.apply(J):[]:[]}function b(J){if(J&&J.length)return J[0]}function f(J,P,O,K){P&&P.forEach((D,I,L)=>{J.push(D);f(J,O.call(K,D,I,L),O,K)})}var m;let g=function(){function J(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var P=J.prototype;P.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};P.reset=function(O){this.defaultPrevented=!1;this.item=O};return J}();const x=new w(g,void 0,J=>{J.item=null;J.target=null;
J.defaultPrevented=!1;J.cancellable=!1}),q=()=>{},B=new Set,z=new Set,u=new Set,y=new Map;let E=0,H=m=function(J,P){function O(D){D=J.call(this,D)||this;D._chgListeners=[];D._notifications=null;D._timer=null;D._observable=new d.SimpleObservable;D.length=0;D._items=[];Object.defineProperty(r._assertThisInitialized(D),"uid",{value:E++});return D}r._inheritsLoose(O,J);O.isCollection=function(D){return null!=D&&D instanceof m};var K=O.prototype;K.normalizeCtorArgs=function(D){return D?Array.isArray(D)||
D instanceof m?{items:D}:D:{}};K.destroy=function(){this.removeAll()};K[P]=function*(){yield*this.items};K.hasEventListener=function(D){return"change"===D?0<this._chgListeners.length:this._emitter.hasEventListener(D)};K.on=function(D,I){if("change"===D){const L=this._chgListeners,R={removed:!1,callback:I};L.push(R);this._notifications&&this._notifications.push({listeners:L.slice(),items:this._items.slice(),changes:[]});return{remove(){this.remove=q;R.removed=!0;L.splice(L.indexOf(R),1)}}}return this._emitter.on(D,
I)};K.once=function(D,I){const L=this.on(D,I);return{remove(){L.remove()}}};K.add=function(D,I){c.trackAccess(this._observable);if(this._emitBeforeChanges(l.ObservableChangesType.ADD))return this;I=this.getNextIndex(null!=I?I:null);this._splice(I,0,[D]);this._emitAfterChanges(l.ObservableChangesType.ADD);return this};K.addMany=function(D,I=this._items.length){c.trackAccess(this._observable);if(!D||!D.length||this._emitBeforeChanges(l.ObservableChangesType.ADD))return this;I=this.getNextIndex(I);this._splice(I,
0,a(D));this._emitAfterChanges(l.ObservableChangesType.ADD);return this};K.at=function(D){c.trackAccess(this._observable);D=Math.trunc(D)||0;0>D&&(D+=this.length);if(!(0>D||D>=this.length))return this._items[D]};K.removeAll=function(){c.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(l.ObservableChangesType.REMOVE))return[];const D=this._splice(0,this.length)||[];this._emitAfterChanges(l.ObservableChangesType.REMOVE);return D};K.clone=function(){c.trackAccess(this._observable);
return this._createNewInstance({items:this._items.map(v.clone)})};K.concat=function(...D){c.trackAccess(this._observable);D=D.map(a);return this._createNewInstance({items:this._items.concat(...D)})};K.drain=function(D,I){c.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(l.ObservableChangesType.REMOVE)){var L=A.assumeNonNull(this._splice(0,this.length)),R=L.length;for(let Z=0;Z<R;Z++)D.call(I,L[Z],Z,L);this._emitAfterChanges(l.ObservableChangesType.REMOVE)}};K.every=function(D,
I){c.trackAccess(this._observable);return this._items.every(D,I)};K.filter=function(D,I){c.trackAccess(this._observable);let L;L=2===arguments.length?this._items.filter(D,I):this._items.filter(D);return this._createNewInstance({items:L})};K.find=function(D,I){c.trackAccess(this._observable);return this._items.find(D,I)};K.findIndex=function(D,I){c.trackAccess(this._observable);return this._items.findIndex(D,I)};K.flatten=function(D,I){c.trackAccess(this._observable);const L=[];f(L,this,D,I);return new m(L)};
K.forEach=function(D,I){c.trackAccess(this._observable);return this._items.forEach(D,I)};K.getItemAt=function(D){c.trackAccess(this._observable);return this._items[D]};K.getNextIndex=function(D){c.trackAccess(this._observable);const I=this.length;D=null==D?I:D;0>D?D=0:D>I&&(D=I);return D};K.includes=function(D,I=0){c.trackAccess(this._observable);return this._items.includes(D,I)};K.indexOf=function(D,I=0){c.trackAccess(this._observable);return this._items.indexOf(D,I)};K.join=function(D=","){c.trackAccess(this._observable);
return this._items.join(D)};K.lastIndexOf=function(D,I=this.length-1){c.trackAccess(this._observable);return this._items.lastIndexOf(D,I)};K.map=function(D,I){c.trackAccess(this._observable);D=this._items.map(D,I);return new m({items:D})};K.reorder=function(D,I=this.length-1){c.trackAccess(this._observable);const L=this.indexOf(D);if(-1!==L){0>I?I=0:I>=this.length&&(I=this.length-1);if(L!==I){if(this._emitBeforeChanges(l.ObservableChangesType.MOVE))return D;this._splice(L,1);this._splice(I,0,[D]);
this._emitAfterChanges(l.ObservableChangesType.MOVE)}return D}};K.pop=function(){c.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(l.ObservableChangesType.REMOVE)){var D=b(this._splice(this.length-1,1));this._emitAfterChanges(l.ObservableChangesType.REMOVE);return D}};K.push=function(...D){c.trackAccess(this._observable);if(this._emitBeforeChanges(l.ObservableChangesType.ADD))return this.length;this._splice(this.length,0,D);this._emitAfterChanges(l.ObservableChangesType.ADD);
return this.length};K.reduce=function(D,I){c.trackAccess(this._observable);const L=this._items;return 2===arguments.length?L.reduce(D,I):L.reduce(D)};K.reduceRight=function(D,I){c.trackAccess(this._observable);const L=this._items;return 2===arguments.length?L.reduceRight(D,I):L.reduceRight(D)};K.remove=function(D){c.trackAccess(this._observable);return this.removeAt(this.indexOf(D))};K.removeAt=function(D){c.trackAccess(this._observable);if(!(0>D||D>=this.length||this._emitBeforeChanges(l.ObservableChangesType.REMOVE)))return D=
b(this._splice(D,1)),this._emitAfterChanges(l.ObservableChangesType.REMOVE),D};K.removeMany=function(D){c.trackAccess(this._observable);if(!D||!D.length||this._emitBeforeChanges(l.ObservableChangesType.REMOVE))return[];D=D instanceof m?D.toArray():D;const I=this._items,L=[],R=D.length;for(let M=0;M<R;M++){var Z=I.indexOf(D[M]);if(-1<Z){{var X=M+1;var Q=Z+1;const V=Math.min(D.length-X,I.length-Q);let fa=0;for(;fa<V&&D[X+fa]===I[Q+fa];)fa++;X=fa}X=1+X;(Z=this._splice(Z,X))&&0<Z.length&&L.push.apply(L,
Z);M+=X-1}}this._emitAfterChanges(l.ObservableChangesType.REMOVE);return L};K.reverse=function(){c.trackAccess(this._observable);if(this._emitBeforeChanges(l.ObservableChangesType.MOVE))return this;const D=this._splice(0,this.length);D&&(D.reverse(),this._splice(0,0,D));this._emitAfterChanges(l.ObservableChangesType.MOVE);return this};K.shift=function(){c.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(l.ObservableChangesType.REMOVE)){var D=b(this._splice(0,1));this._emitAfterChanges(l.ObservableChangesType.REMOVE);
return D}};K.slice=function(D=0,I=this.length){c.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(D,I)})};K.some=function(D,I){c.trackAccess(this._observable);return this._items.some(D,I)};K.sort=function(D){c.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(l.ObservableChangesType.MOVE))return this;const I=A.assumeNonNull(this._splice(0,this.length));arguments.length?I.sort(D):I.sort();this._splice(0,0,I);this._emitAfterChanges(l.ObservableChangesType.MOVE);
return this};K.splice=function(D,I,...L){c.trackAccess(this._observable);const R=(I?l.ObservableChangesType.REMOVE:0)|(L.length?l.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(R))return[];D=this._splice(D,I,L)||[];this._emitAfterChanges(R);return D};K.toArray=function(){c.trackAccess(this._observable);return this._items.slice()};K.toJSON=function(){c.trackAccess(this._observable);return this.toArray()};K.toLocaleString=function(){c.trackAccess(this._observable);return this._items.toLocaleString()};
K.toString=function(){c.trackAccess(this._observable);return this._items.toString()};K.unshift=function(...D){c.trackAccess(this._observable);if(!D.length||this._emitBeforeChanges(l.ObservableChangesType.ADD))return this.length;this._splice(0,0,D);this._emitAfterChanges(l.ObservableChangesType.ADD);return this.length};K._createNewInstance=function(D){return new this.constructor(D)};K._splice=function(D,I,L){const R=this._items;var Z=this.itemType;let X=void 0;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=e.schedule(()=>this._dispatchChange()));if(I){X=R.splice(D,I);if(this.hasEventListener("before-remove")){var Q=x.acquire();Q.target=this;Q.cancellable=!0;for(let fa=0,oa=X.length;fa<oa;fa++)I=X[fa],Q.reset(I),this.emit("before-remove",Q),Q.defaultPrevented&&(X.splice(fa,1),R.splice(D,0,I),D+=1,--fa,--oa);x.release(Q)}this.length=this._items.length;if(this.hasEventListener("after-remove")){I=
x.acquire();I.target=this;I.cancellable=!1;Q=X.length;for(let fa=0;fa<Q;fa++)I.reset(X[fa]),this.emit("after-remove",I);x.release(I)}}if(L&&L.length){if(Z){I=[];for(var M of L)L=Z.ensureType(M),null==L&&null!=M||I.push(L);L=I}Z=this.hasEventListener("before-add");M=this.hasEventListener("after-add");I=D===this.length;if(Z||M){var V=x.acquire();V.target=this;V.cancellable=!0;Q=x.acquire();Q.target=this;Q.cancellable=!1;for(const fa of L)Z?(V.reset(fa),this.emit("before-add",V),V.defaultPrevented||
(I?R.push(fa):R.splice(D++,0,fa),this._set("length",R.length),M&&(Q.reset(fa),this.emit("after-add",Q)))):(I?R.push(fa):R.splice(D++,0,fa),this._set("length",R.length),Q.reset(fa),this.emit("after-add",Q));x.release(Q);x.release(V)}else{if(I)for(V of L)R.push(V);else R.splice(D,0,...L);this._set("length",R.length)}}(L&&L.length||X&&X.length)&&this._notifyChangeEvent(L,X);return X};K._emitBeforeChanges=function(D){let I=!1;if(this.hasEventListener("before-changes")){const L=x.acquire();L.target=this;
L.cancellable=!0;L.type=D;this.emit("before-changes",L);I=L.defaultPrevented;x.release(L)}return I};K._emitAfterChanges=function(D){if(this.hasEventListener("after-changes")){const I=x.acquire();I.target=this;I.cancellable=!1;I.type=D;this.emit("after-changes",I);x.release(I)}this._observable.notify()};K._notifyChangeEvent=function(D,I){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:D,removed:I})};K._dispatchChange=function(){this._timer&&
(this._timer.remove(),this._timer=null);if(this._notifications){var D=this._notifications;this._notifications=null;for(const I of D){D=I.changes;B.clear();z.clear();u.clear();for(const {added:M,removed:V}of D){if(M)if(0===u.size&&0===z.size)for(const fa of M)B.add(fa);else for(const fa of M)z.has(fa)?(u.add(fa),z.delete(fa)):u.has(fa)||B.add(fa);if(V)if(0===u.size&&0===B.size)for(const fa of V)z.add(fa);else for(const fa of V)B.has(fa)?B.delete(fa):(u.delete(fa),z.add(fa))}const L=F.acquire();B.forEach(M=>
{L.push(M)});const R=F.acquire();z.forEach(M=>{R.push(M)});const Z=this._items,X=I.items,Q=F.acquire();u.forEach(M=>{X.indexOf(M)!==Z.indexOf(M)&&Q.push(M)});if(I.listeners&&(L.length||R.length||Q.length)){D={target:this,added:L,removed:R,moved:Q};const M=I.listeners.length;for(let V=0;V<M;V++){const fa=I.listeners[V];fa.removed||fa.callback.call(this,D)}}F.release(L);F.release(R);F.release(Q)}B.clear();z.clear();u.clear()}};r._createClass(O,[{key:"items",get:function(){c.trackAccess(this._observable);
return this._items},set:function(D){this._emitBeforeChanges(l.ObservableChangesType.ADD)||(this._splice(0,this.length,a(D)),this._emitAfterChanges(l.ObservableChangesType.ADD))}}]);return O}(C.EventedAccessor,Symbol.iterator);H.ofType=J=>{if(!J)return m;if(y.has(J))return y.get(J);let P=null;if("function"===typeof J)P=J.prototype.declaredClass;else if(J.base)P=J.base.prototype.declaredClass;else for(var O in J.typeMap){const K=J.typeMap[O].prototype.declaredClass;P=P?P+` | ${K}`:K}O=function(K){function D(){return K.apply(this,
arguments)||this}r._inheritsLoose(D,K);return D}(m);t.__decorate([n.shared({Type:J,ensureType:"function"===typeof J?k.ensureType(J):k.ensureOneOfType(J)})],O.prototype,"itemType",void 0);O=t.__decorate([p.subclass(`esri.core.Collection<${P}>`)],O);y.set(J,O);return O};t.__decorate([h.property()],H.prototype,"length",void 0);t.__decorate([h.property()],H.prototype,"items",null);return H=m=t.__decorate([p.subclass("esri.core.Collection")],H)})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers",
"../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],function(r,t,F,C,v){let A=function(){function w(){this._emitter=new w.EventEmitter(this)}var l=w.prototype;l.emit=function(e,h){return this._emitter.emit(e,h)};l.on=function(e,h){return this._emitter.on(e,h)};l.once=function(e,h){return this._emitter.once(e,h)};l.hasEventListener=function(e){return this._emitter.hasEventListener(e)};return w}();(function(w){let l=function(){function h(n=null){this.target=n;
this._listenersMap=null}var k=h.prototype;k.clear=function(){this._listenersMap&&this._listenersMap.clear();this._listenersMap=null};k.emit=function(n,p){n=this._listenersMap&&this._listenersMap.get(n);if(!n)return!1;const c=this.target||this;[...n].forEach(d=>{d.call(c,p)});return 0<n.length};k.on=function(n,p){if(Array.isArray(n)){var c=n.map(d=>this.on(d,p));return C.handlesGroup(c)}if(-1<n.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");
this._listenersMap||(this._listenersMap=new Map);c=this._listenersMap.get(n)||[];c.push(p);this._listenersMap.set(n,c);return{remove:()=>{const d=this._listenersMap&&this._listenersMap.get(n)||[],a=d.indexOf(p);0<=a&&d.splice(a,1)}}};k.once=function(n,p){const c=this.on(n,d=>{c.remove();p.call(null,d)});return c};k.hasEventListener=function(n){n=this._listenersMap&&this._listenersMap.get(n);return null!=n&&0<n.length};return h}();w.EventEmitter=l;w.EventedMixin=h=>{h=function(k){function n(){var c=
k.apply(this,arguments)||this;c._emitter=new l;return c}r._inheritsLoose(n,k);var p=n.prototype;p.destroy=function(){this._emitter.clear()};p.emit=function(c,d){return this._emitter.emit(c,d)};p.on=function(c,d){return this._emitter.on(c,d)};p.once=function(c,d){return this._emitter.once(c,d)};p.hasEventListener=function(c){return this._emitter.hasEventListener(c)};return n}(h);return h=t.__decorate([v.subclass("esri.core.Evented")],h)};let e=function(h){function k(){var p=h.apply(this,arguments)||
this;p._emitter=new A.EventEmitter(r._assertThisInitialized(p));return p}r._inheritsLoose(k,h);var n=k.prototype;n.destroy=function(){this._emitter.clear()};n.emit=function(p,c){return this._emitter.emit(p,c)};n.on=function(p,c){return this._emitter.on(p,c)};n.once=function(p,c){return this._emitter.once(p,c)};n.hasEventListener=function(p){return this._emitter.hasEventListener(p)};return k}(F);e=t.__decorate([v.subclass("esri.core.Evented")],e);w.EventedAccessor=e})(A||(A={}));return A})},"esri/core/ObservableChangesType":function(){define(["exports"],
function(r){r.ObservableChangesType=void 0;var t=r.ObservableChangesType||(r.ObservableChangesType={});t[t.ADD=1]="ADD";t[t.REMOVE=2]="REMOVE";t[t.MOVE=4]="MOVE";Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],function(r){r.shared=function(t){return(F,C)=>{F[C]=t}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports","./ObservationHandle"],
function(r,t){let F=function(){function C(){this._observers=[]}var v=C.prototype;v.observe=function(A){this._observers.includes(A)||this._observers.push(A);return new t.ObservationHandle(this._observers,A)};v.notify=function(){const A=this._observers.slice();for(let w=0;w<A.length;++w){const l=A[w];l.onInvalidated();l.onCommitted()}};return C}();r.SimpleObservable=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/scheduling ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h){r.WatchUpdatingTracking=function(k){function n(){var c=k.apply(this,arguments)||this;c.updating=!1;c.handleId=0;c.handles=new v;c.scheduleHandleId=0;c.pendingPromises=new Set;return c}t._inheritsLoose(n,k);var p=n.prototype;p.destroy=function(){this.removeAll();this.handles.destroy()};p.add=function(c,d,a={}){return this._installWatch(c,d,a,w.watch)};p.addWhen=function(c,d,a={}){return this._installWatch(c,d,a,w.when)};p.addOnCollectionChange=function(c,d,{initial:a=
!1}={}){const b=++this.handleId;this.handles.add([w.on(c,"after-changes",this._createSyncUpdatingCallback(),w.sync),w.on(c,"change",d,{onListenerAdd:a?f=>d({added:f.toArray(),removed:[]}):void 0})],b);return{remove:()=>this.handles.remove(b)}};p.addPromise=function(c){if(A.isNone(c))return c;const d=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(c)&&(0!==this.pendingPromises.size||this.handles.has(-42)||this._set("updating",!1))}},d);this.pendingPromises.add(c);this._set("updating",
!0);const a=()=>this.handles.remove(d);c.then(a,a);return c};p.removeAll=function(){this.pendingPromises.clear();this.handles.removeAll();this._set("updating",!1)};p._installWatch=function(c,d,a={},b){const f=++this.handleId;a.sync||this._installSyncUpdatingWatch(c,f);c=b(c,d,a);this.handles.add(c,f);return{remove:()=>this.handles.remove(f)}};p._installSyncUpdatingWatch=function(c,d){const a=this._createSyncUpdatingCallback();c=w.watch(c,a,{sync:!0,equals:()=>!1});this.handles.add(c,d);return c};
p._createSyncUpdatingCallback=function(){return()=>{this.handles.remove(-42);++this.scheduleHandleId;const c=this.scheduleHandleId;this._get("updating")||this._set("updating",!0);this.handles.add(l.schedule(()=>{c===this.scheduleHandleId&&(this._set("updating",0<this.pendingPromises.size),this.handles.remove(-42))}),-42)}};return n}(C);F.__decorate([e.property({readOnly:!0})],r.WatchUpdatingTracking.prototype,"updating",void 0);r.WatchUpdatingTracking=F.__decorate([h.subclass("esri.views.support.WatchUpdatingTracking")],
r.WatchUpdatingTracking);r.WatchFlags=void 0;(function(k){k[k.NONE=0]="NONE";k[k.SYNC=1]="SYNC";k[k.INIT=2]="INIT"})(r.WatchFlags||(r.WatchFlags={}));Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(r,t,F,C,v,A,w){function l(p,c,d={}){return e(p,c,d,k)}function e(p,c,d={},a){let b=null;const f=d.once?(m,g)=>{a(m)&&(C.removeMaybe(b),
c(m,g))}:(m,g)=>{a(m)&&c(m,g)};b=A.watchTracked(p,f,d.sync,d.equals);d.initial&&(p=p(),f(p,p));return b}function h(p,c,d){if(v.isAborted(d))return Promise.reject(v.createAbortError());const a=p();if(null!=c&&c(a))return Promise.resolve(a);let b=null;return new Promise((f,m)=>{b=F.handlesGroup([v.onAbort(d,()=>{b=C.removeMaybe(b);m(v.createAbortError())}),e(p,g=>{b=C.removeMaybe(b);f(g)},{sync:!1,once:!0},null!=c?c:k)])})}function k(p){return!0}function n(p){return!!p}r.autorun=w.autorun;r.initial=
{initial:!0};r.on=function(p,c,d,a={}){function b(){m&&g&&(g.remove(),null==a.onListenerRemove?void 0:a.onListenerRemove(m),g=m=null)}function f(B){a.once&&a.once&&C.removeMaybe(x);d(B)}let m=null,g=null,x=null;const q=l(p,(B,z)=>{b();t.isEventTarget(B)&&(m=B,g=t.on(B,c,f),null==a.onListenerAdd?void 0:a.onListenerAdd(B))},{sync:a.sync,initial:!0});return x=F.makeHandle(()=>{q.remove();b()})};r.once=function(p,c){return h(p,null,c)};r.sync={sync:!0};r.syncAndInitial={sync:!0,initial:!0};r.watch=l;
r.when=function(p,c,d={}){return e(p,c,d,n)};r.whenOnce=function(p,c){return h(p,n,c)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m){var g;F=new F.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});C=g=function(x){function q(z){z=x.call(this,z)||this;z.dpi=96;z.format=null;z.origin=null;z.minScale=0;z.maxScale=0;z.size=null;z.spatialReference=null;return z}r._inheritsLoose(q,x);q.create=function(z=
{}){const {resolutionFactor:u=1,scales:y,size:E=256,spatialReference:H=d.WebMercator,numLODs:J=24}=z;if(!b.isValid(H)){z=[];if(y)for(var P=0;P<y.length;P++){var O=y[P];z.push({level:P,scale:O,resolution:O})}else for(P=5E-4,O=J-1;0<=O;O--)z.unshift({level:O,scale:P,resolution:P}),P*=2;return new g({dpi:96,lods:z,origin:new c(0,0,H),size:[E,E],spatialReference:H})}P=b.getInfo(H);z=z.origin?new c({x:z.origin.x,y:z.origin.y,spatialReference:H}):P?new c({x:P.origin[0],y:P.origin[1],spatialReference:H}):
new c({x:0,y:0,spatialReference:H});P=1/(39.37*A.getMetersPerUnitForSR(H)*96);O=[];if(y)for(var K=0;K<y.length;K++){var D=y[K];O.push({level:K,scale:D,resolution:D*P})}else{var I=b.isGeographic(H)?512/E*5.916575275917094E8:256/E*5.91657527591555E8;K=Math.ceil(J/u);O.push({level:0,scale:I,resolution:I*P});for(D=1;D<K;D++)I/=2**u,O.push({level:D,scale:I,resolution:I*P})}return new g({dpi:96,lods:O,origin:z,size:[E,E],spatialReference:H})};var B=q.prototype;B.readOrigin=function(z,u){return c.fromJSON({spatialReference:u.spatialReference,
...z})};B.readSize=function(z,u){return[u.cols,u.rows]};B.writeSize=function(z,u){u.cols=z[0];u.rows=z[1]};B.zoomToScale=function(z){const u=this.scales;if(0>=z)return u[0];if(z>=u.length-1)return u[u.length-1];{const y=Math.floor(z);return u[y]/(u[y]/u[y+1])**(z-y)}};B.scaleToZoom=function(z){const u=this.scales,y=u.length-1;let E=0;for(;E<y;E++){const H=u[E],J=u[E+1];if(H<=z)break;if(J===z)return E+1;if(H>z&&J<z)return E+Math.log(H/z)/Math.log(H/J)}return E};B.snapScale=function(z,u=.95){z=this.scaleToZoom(z);
return z%Math.floor(z)>=u?this.zoomToScale(Math.ceil(z)):this.zoomToScale(Math.floor(z))};B.tileAt=function(z,u,y,E){var H=this.lodAt(z);if(!H)return null;let J;if("number"===typeof u)J=u,u=y;else{if(b.equals(u.spatialReference,this.spatialReference))J=u.x,u=u.y;else{E=f.project(u,this.spatialReference);if(v.isNone(E))return null;J=E.x;u=E.y}E=y}y=H.resolution*this.size[0];H=H.resolution*this.size[1];E||(E={id:null,level:0,row:0,col:0,extent:a.create()});E.level=z;E.row=Math.floor((this.origin.y-
u)/H+.001);E.col=Math.floor((J-this.origin.x)/y+.001);this.updateTileInfo(E);return E};B.updateTileInfo=function(z,u=g.ExtrapolateOptions.NONE){var y=this.lodAt(z.level);y||u!==g.ExtrapolateOptions.POWER_OF_TWO||(u=this.lods[this.lods.length-1],u.level<z.level&&(y=u));if(y){var E=z.level-y.level;u=y.resolution*this.size[0]/2**E;y=y.resolution*this.size[1]/2**E;z.id=`${z.level}/${z.row}/${z.col}`;z.extent||(z.extent=a.create());z.extent[0]=this.origin.x+z.col*u;z.extent[1]=this.origin.y-(z.row+1)*
y;z.extent[2]=z.extent[0]+u;z.extent[3]=z.extent[1]+y}};B.upsampleTile=function(z){const u=this._upsampleLevels[z.level];if(!u||-1===u.parentLevel)return!1;z.level=u.parentLevel;z.row=Math.floor(z.row/u.factor+.001);z.col=Math.floor(z.col/u.factor+.001);this.updateTileInfo(z);return!0};B.getTileBounds=function(z,u){var {resolution:y}=this.lodAt(u.level);const E=y*this.size[0];y*=this.size[1];z[0]=this.origin.x+u.col*E;z[1]=this.origin.y-(u.row+1)*y;z[2]=z[0]+E;z[3]=z[1]+y;return z};B.lodAt=function(z){return this._levelToLOD&&
this._levelToLOD[z]||null};B.clone=function(){return g.fromJSON(this.write({}))};B.getOrCreateCompatible=function(z,u){if(256===this.size[0]&&256===this.size[1])return 256===z?this:null;const y=[],E=this.lods.length;for(let H=0;H<E;H++){const J=this.lods[H];y.push(new m({level:J.level,scale:J.scale,resolution:J.resolution*u}))}return new g({size:[z,z],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:y})};B._initializeUpsampleLevels=
function(){const z=this.lods;this._upsampleLevels=[];let u=null;for(let y=0;y<z.length;y++){const E=z[y];this._upsampleLevels[E.level]={parentLevel:u?u.level:-1,factor:u?u.resolution/E.resolution:0};u=E}};r._createClass(q,[{key:"isWrappable",get:function(){const {spatialReference:z,origin:u}=this;if(z&&u){const y=b.getInfo(z);return z.isWrappable&&Math.abs(y.origin[0]-u.x)<=y.dx}return!1}},{key:"lods",set:function(z){let u=0,y=0;const E=[];this._levelToLOD={};z&&(u=-Infinity,y=Infinity,z.forEach(H=>
{E.push(H.scale);u=H.scale>u?H.scale:u;y=H.scale<y?H.scale:y;this._levelToLOD[H.level]=H}));this._set("scales",E);this._set("minScale",u);this._set("maxScale",y);this._set("lods",z);this._initializeUpsampleLevels()}}]);return q}(C.JSONSupport);t.__decorate([w.property({type:Number,json:{write:!0}})],C.prototype,"compressionQuality",void 0);t.__decorate([w.property({type:Number,json:{write:!0}})],C.prototype,"dpi",void 0);t.__decorate([w.property({type:String,json:{read:F.read,write:F.write,origins:{"web-scene":{read:!1,
write:!1}}}})],C.prototype,"format",void 0);t.__decorate([w.property({readOnly:!0})],C.prototype,"isWrappable",null);t.__decorate([w.property({type:c,json:{write:!0}})],C.prototype,"origin",void 0);t.__decorate([k.reader("origin")],C.prototype,"readOrigin",null);t.__decorate([w.property({type:[m],value:null,json:{write:!0}})],C.prototype,"lods",null);t.__decorate([w.property({readOnly:!0})],C.prototype,"minScale",void 0);t.__decorate([w.property({readOnly:!0})],C.prototype,"maxScale",void 0);t.__decorate([w.property({readOnly:!0})],
C.prototype,"scales",void 0);t.__decorate([w.property({cast:x=>Array.isArray(x)?x:"number"===typeof x?[x,x]:[256,256]})],C.prototype,"size",void 0);t.__decorate([k.reader("size",["rows","cols"])],C.prototype,"readSize",null);t.__decorate([p.writer("size",{cols:{type:h.Integer},rows:{type:h.Integer}})],C.prototype,"writeSize",null);t.__decorate([w.property({type:d,json:{write:!0}})],C.prototype,"spatialReference",void 0);C=g=t.__decorate([n.subclass("esri.layers.support.TileInfo")],C);(function(x){x=
x.ExtrapolateOptions||(x.ExtrapolateOptions={});x[x.NONE=0]="NONE";x[x.POWER_OF_TWO=1]="POWER_OF_TWO"})(C||(C={}));return C})},"esri/core/unitUtils":function(){define("exports ./has ./jsonMap ./maybe ../geometry/projectionEllipsoid ../geometry/SpatialReference ../geometry/support/Ellipsoid ../geometry/support/spatialReferenceUtils ../geometry/support/WKIDUnitConversion".split(" "),function(r,t,F,C,v,A,w,l,e){function h(D){if(D=P[D])return D;throw Error("unknown type");}function k(D){return J[D].baseUnit}
function n(D,I=null){I=I||h(D);return J[I].baseUnit===D}function p(D,I,L){if(I===L)return D;const R=h(I);if(R!==h(L))throw Error("incompatible units");D=n(I,R)?D:D*J[R].units[I].inBaseUnits;return n(L,R)?D:D/J[R].units[L].inBaseUnits}function c(D,I){return 3E3>p(D,I,"meters")?"meters":"kilometers"}function d(D,I){return 1E5>p(D,I,"meters")?"meters":"kilometers"}function a(D,I){return 1E3>p(D,I,"feet")?"feet":"miles"}function b(D,I){return 1E5>p(D,I,"feet")?"feet":"miles"}function f(D){return H.fromJSON(D.toLowerCase())||
null}function m(D,I=w.earth.metersPerDegree){return g(D,!0)||I}function g(D,I=!1){let L,R,Z=null;null!=D&&("object"===typeof D?(L=D.wkid,R=D.wkt):"number"===typeof D?L=D:"string"===typeof D&&(R=D));if(L){if(l.isWKIDFromMars(L))return w.mars.metersPerDegree;if(l.isWKIDFromMoon(L))return w.moon.metersPerDegree;Z=u.values[u[L]];!Z&&I&&E.has(L)&&(Z=B)}else R&&(/^PROJCS/i.test(R)?Z=x(z.exec(R),Z):/^GEOCCS/i.test(R)&&(Z=x(y.exec(R),Z)));return Z}function x(D,I){return D&&D[1]?parseFloat(D[1].split(",")[1]):
I}function q(D){var I=null;if(null!=D)if("object"===typeof D){var L=D.wkid;var R=D.wkt}else"number"===typeof D?L=D:"string"===typeof D&&(R=D);if(L)I=u.units[u[L]];else if(R&&(D=/^PROJCS/i.test(R)?z:/^GEOCCS/i.test(R)?y:null)&&(R=D.exec(R))&&R[1]&&(R=R[1],I=(I=/[\\"\\']{1}([^\\"\\']+)/.exec(R))&&I[1],!I||-1===u.units.indexOf(I)))for(R=parseFloat(R.split(",")[1]),I=null,D=u.values,L=0;L<D.length;++L)if(1E-7>Math.abs(R-D[L])){I=u.units[L];break}return C.isSome(I)?f(I):null}const B=w.earth.radius*Math.PI/
200,z=/UNIT\[([^\]]+)\]\]$/i,u=e,y=/UNIT\[([^\]]+)\]/i,E=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),H=F.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",
"50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});t={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};e={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*
.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:(D=>D*D)(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};const J={length:{baseUnit:"meters",units:t},area:{baseUnit:"square-meters",units:e},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},
"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},P=function(){const D={};for(const I in J)for(const L in J[I].units)D[L]=
I;return D}(),O={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},K={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",
esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"};t=F.strict()(O);e=F.strict()(K);F=F.strict()({...O,...K});r.areaUnitsJSONMap=t;r.baseUnitForUnit=function(D){return k(h(D))};r.baseUnitForUnitType=k;r.convertUnit=p;r.getDefaultUnitSystem=function(D){if(!D)return null;switch(q(D)){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null};r.getMetersPerUnit=g;r.getMetersPerUnitForSR=m;r.getMetersPerVerticalUnitForSR=function(D){if(D&&"object"===typeof D&&!l.isEarth(D))return 1;D=m(D);return 1E5<D?1:D};r.getUnitString=q;r.getVerticalUnitStringForSR=function(D){const I=m(D),L=D instanceof A?v.getReferenceEllipsoid(D).metersPerDegree:1E5;return I>=L?"meters":q(D)};r.inchesPerMeter=39.37;r.isBaseUnit=n;r.isMeasurementSystem=function(D){return"imperial"===
D||"metric"===D};r.lengthToDegrees=function(D,I,L){return p(D,I,"meters")/(L*Math.PI/180)};r.lengthUnitsJSONMap=e;r.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");r.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");r.preferredImperialAreaUnit=function(D,I){return 1E6>p(D,I,"square-feet")?"square-feet":"square-miles"};
r.preferredImperialLengthUnit=a;r.preferredImperialVerticalLengthUnit=b;r.preferredLengthUnit=function(D,I,L){switch(L){case "metric":return c(D,I);case "imperial":return a(D,I);default:return L}};r.preferredMetricAreaUnit=function(D,I){return 3E6>p(D,I,"square-meters")?"square-meters":"square-kilometers"};r.preferredMetricLengthUnit=c;r.preferredMetricVerticalLengthUnit=d;r.preferredVerticalLengthUnit=function(D,I,L){switch(L){case "metric":return d(D,I);case "imperial":return b(D,I);default:return L}};
r.unitFromRESTJSON=f;r.unitToRESTJSON=function(D){return H.toJSON(D)||null};r.unitType=h;r.unitsJSONMap=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/projectionEllipsoid":function(){define(["exports","./SpatialReference","./support/Ellipsoid","./support/spatialReferenceUtils"],function(r,t,F,C){function v(h){return new t({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${h.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}
const A=v(F.earth),w=v(F.mars),l=v(F.moon),e=new t({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${F.earth.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});r.SphericalECEFSpatialReference=A;r.SphericalPCPFMars=
w;r.SphericalPCPFMoon=l;r.WGS84ECEFSpatialReference=e;r.createSphericalPCPF=v;r.getReferenceEllipsoid=function(h){return h&&(C.isMars(h)||h===w)?F.mars:h&&(C.isMoon(h)||h===l)?F.moon:F.earth};r.getReferenceEllipsoidFromWKID=function(h){return C.isWKIDFromMars(h)?F.mars:C.isWKIDFromMoon(h)?F.moon:F.earth};r.getSphericalPCPF=function(h){return h&&(C.isMars(h)||h===w)?w:h&&(C.isMoon(h)||h===l)?l:A};r.getSphericalPCPFForEllipsoid=function(h){return h&&h===F.mars?w:h&&h===F.moon?l:A};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/maybe","../Extent"],function(r,t,F,C,v){function A(c=p){return[c[0],c[1],c[2],c[3]]}function w(c,d){c!==d&&(c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3]);return c}function l(c){return C.isNone(c)||c[0]>=c[2]?0:c[2]-c[0]}function e(c){return c[1]>=c[3]?0:c[3]-c[1]}function h(c,d,a){return d>=c[0]&&a>=c[1]&&d<=c[2]&&a<=c[3]}function k(c){return null!=c&&4===
c.length}const n=[Infinity,Infinity,-Infinity,-Infinity],p=[0,0,0,0];r.NEGATIVE_INFINITY=n;r.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];r.UNIT=[0,0,1,1];r.ZERO=p;r.allFinite=function(c){for(let d=0;4>d;d++)if(!isFinite(c[d]))return!1;return!0};r.area=function(c){return l(c)*e(c)};r.center=function(c,d=[0,0]){d[0]=(c[0]+c[2])/2;d[1]=(c[1]+c[3])/2;return d};r.clone=function(c){return[c[0],c[1],c[2],c[3]]};r.contains=function(c,d){return d[0]>=c[0]&&d[2]<=c[2]&&d[1]>=c[1]&&d[3]<=c[3]};
r.containsPoint=function(c,d){return h(c,d[0],d[1])};r.containsPointObject=function(c,d){return h(c,d.x,d.y)};r.containsPointWithMargin=function(c,d,a){return d[0]>=c[0]-a&&d[1]>=c[1]-a&&d[0]<=c[2]+a&&d[1]<=c[3]+a};r.containsXY=h;r.copy=w;r.create=A;r.distance=function(c,d){const a=(c[1]+c[3])/2,b=Math.max(Math.abs(d[0]-(c[0]+c[2])/2)-l(c)/2,0);c=Math.max(Math.abs(d[1]-a)-e(c)/2,0);return Math.sqrt(b*b+c*c)};r.empty=function(c){return c?w(c,n):A(n)};r.equals=function(c,d){return k(c)&&k(d)?c[0]===
d[0]&&c[1]===d[1]&&c[2]===d[2]&&c[3]===d[3]:c===d};r.expand=function(c,d,a){if(C.isNone(d))w(a,c);else if("length"in d)if(k(d))a[0]=Math.min(c[0],d[0]),a[1]=Math.min(c[1],d[1]),a[2]=Math.max(c[2],d[2]),a[3]=Math.max(c[3],d[3]);else{if(2===d.length||3===d.length)a[0]=Math.min(c[0],d[0]),a[1]=Math.min(c[1],d[1]),a[2]=Math.max(c[2],d[0]),a[3]=Math.max(c[3],d[1])}else switch(d.type){case "extent":a[0]=Math.min(c[0],d.xmin);a[1]=Math.min(c[1],d.ymin);a[2]=Math.max(c[2],d.xmax);a[3]=Math.max(c[3],d.ymax);
break;case "point":a[0]=Math.min(c[0],d.x),a[1]=Math.min(c[1],d.y),a[2]=Math.max(c[2],d.x),a[3]=Math.max(c[3],d.y)}};r.expandPointInPlace=function(c,d){d[0]<c[0]&&(c[0]=d[0]);d[0]>c[2]&&(c[2]=d[0]);d[1]<c[1]&&(c[1]=d[1]);d[1]>c[3]&&(c[3]=d[1])};r.expandWithNestedArray=function(c,d,a=c){const b=d.length;let f=c[0],m=c[1],g=c[2];c=c[3];for(let x=0;x<b;x++){const q=d[x];f=Math.min(f,q[0]);m=Math.min(m,q[1]);g=Math.max(g,q[0]);c=Math.max(c,q[1])}a[0]=f;a[1]=m;a[2]=g;a[3]=c;return a};r.fromExtent=function(c,
d=A()){d[0]=c.xmin;d[1]=c.ymin;d[2]=c.xmax;d[3]=c.ymax;return d};r.fromValues=function(c,d,a,b,f=A()){f[0]=c;f[1]=d;f[2]=a;f[3]=b;return f};r.height=e;r.intersection=function(c,d,a){if(C.isNone(d))return w(a,c);const b=d[0],f=d[1],m=d[2];d=d[3];a[0]=F.clamp(c[0],b,m);a[1]=F.clamp(c[1],f,d);a[2]=F.clamp(c[2],b,m);a[3]=F.clamp(c[3],f,d);return a};r.intersects=function(c,d){return Math.max(d[0],c[0])<=Math.min(d[2],c[2])&&Math.max(d[1],c[1])<=Math.min(d[3],c[3])};r.intersectsSegment=function(c,d,a){const b=
c[0],f=c[1],m=c[2];c=c[3];const {x:g,y:x}=d,{x:q,y:B}=a;var z=(y,E)=>0>(B-x)*y+(g-q)*E+(q*x-g*B);d=z(b,c);a=z(m,c);const u=z(m,f);z=z(b,f);return d===a&&a===u&&u===z&&z===d||g<b&&q<b||g>m&&q>m||x>c&&B>c||x<f&&B<f?!1:!0};r.intersectsSphere=function(c,d){const a=d[3];var b=Math.abs(d[0]-.5*(c[0]+c[2]));const f=.5*(c[2]-c[0]);if(b>a+f)return!1;var m=.5*(c[3]-c[1]);c=Math.abs(d[1]-.5*(c[1]+c[3]));if(c>a+m)return!1;if(b<f||c<m)return!0;b-=f;m=c-m;return b*b+m*m<=a*a};r.is=k;r.isPoint=function(c){return(0===
l(c)||!isFinite(c[0]))&&(0===e(c)||!isFinite(c[1]))};r.offset=function(c,d,a,b=c){b[0]=c[0]+d;b[1]=c[1]+a;b[2]=c[2]+d;b[3]=c[3]+a;return b};r.pad=function(c,d,a=c){a[0]=c[0]-d;a[1]=c[1]-d;a[2]=c[2]+d;a[3]=c[3]+d;return a};r.setMax=function(c,d,a=c){a[2]=d[0];a[3]=d[1];a!==c&&(a[0]=c[0],a[1]=c[1]);return c};r.setMin=function(c,d,a=c){a[0]=d[0];a[1]=d[1];a!==c&&(a[2]=c[2],a[3]=c[3]);return a};r.size=function(c,d){d[0]=c[2]-c[0];d[1]=c[3]-c[1]};r.toExtent=function(c,d){return new v({xmin:c[0],ymin:c[1],
xmax:c[2],ymax:c[3],spatialReference:d})};r.width=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w,l){var e;F=e=function(h){function k(n){n=h.call(this,n)||this;n.cols=
null;n.level=0;n.levelValue=null;n.origin=null;n.resolution=0;n.rows=null;n.scale=0;return n}r._inheritsLoose(k,h);k.prototype.clone=function(){return new e({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return k}(F.JSONSupport);t.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],F.prototype,"cols",void 0);t.__decorate([C.property({type:w.Integer,json:{write:!0}})],
F.prototype,"level",void 0);t.__decorate([C.property({type:String,json:{write:!0}})],F.prototype,"levelValue",void 0);t.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],F.prototype,"origin",void 0);t.__decorate([C.property({type:Number,json:{write:!0}})],F.prototype,"resolution",void 0);t.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],F.prototype,"rows",void 0);
t.__decorate([C.property({type:Number,json:{write:!0}})],F.prototype,"scale",void 0);return F=e=t.__decorate([l.subclass("esri.layers.support.LOD")],F)})},"esri/views/2d/layers/features/processors":function(){define(["require","exports"],function(r,t){t.loadProcessorModule=function(F){return"heatmap"===F?new Promise((C,v)=>r(["./processors/HeatmapProcessor"],A=>C(Object.freeze({__proto__:null,default:A})),v)):new Promise((C,v)=>r(["./processors/SymbolProcessor"],A=>C(Object.freeze({__proto__:null,
default:A})),v))};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q){function B(u){if(!A.isAbortError(u)&&"worker:port-closed"!==u.name)throw u;}function z(u){return"feature"===u.type&&"snapshot"===u.mode}F=function(u){function y(){var H=u.apply(this,arguments)||this;H._storage=new m.ComputedAttributeStorage;H._markedIdsBufId=H._storage.createBitset();H._lastCleanup=performance.now();H._cleanupNeeded=!1;H._invalidated=!1;H._tileToResolver=new Map;H._didEdit=!1;H.tileStore=null;H.config=null;H.processor=null;H.remoteClient=
null;H.service=null;return H}r._inheritsLoose(y,u);var E=y.prototype;E.initialize=function(){this._initAttributeStore();this._initStores();this._initQueryEngine();this._initSource();this._updateQueue=new q.QueueProcessor({concurrency:"geoevent"===this._source.type?1:4,process:(H,J)=>this._onTileMessage(H,{signal:J})});this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this)),this.watch("updating",H=>!H&&this.onIdle())]);this._checkUpdating=setInterval(()=>this.notifyChange("updating"),
300)};E.startup=function(){var H=r._asyncToGenerator(function*(){this._initAttributeStore()});return function(){return H.apply(this,arguments)}}();E._initSource=function(){this._source=a.createSource(this.service,this.spatialReference,this.tileStore.tileScheme,(H,J)=>{this._invalidated=!0;return this._patchTile(H,J)},()=>50>this._updateQueue.length,this.featureStore);this._proxyEvents()};E._proxyEvents=function(){if("geoevent"===this._source.type){const H=this._source.events;this.handles.add([H.on("connectionStatus",
J=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:J}).catch(B)),H.on("errorString",J=>this.remoteClient.invoke("setProperty",{propertyName:"errorString",value:J}).catch(B)),H.on("feature",J=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:J.attributes,centroid:J.centroid,geometry:J.geometry}}).catch(B)),H.on("updateRate",J=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...J}}).catch(B))])}};E._initAttributeStore=function(){this.attributeStore?
this.attributeStore.invalidateResources():this.attributeStore=new b({type:"remote",initialize:(H,J)=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",H,{signal:J}).catch(B)),update:(H,J)=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",H,{signal:J}).catch(B)),render:H=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:H}).catch(B))},this.config)};
E._initStores=function(){const H={geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};this.featureStore=new d.FeatureStore2D(H,this._storage,"snapshot"===this.service.type?"snapshot":"on-demand");this.aggregateStore=new f.ClusterStore(H,this.spatialReference,this._storage,this.service);this.handles.add(this.aggregateStore.events.on("valueRangesChanged",J=>{this.remoteClient.invoke("emitEvent",
{name:"valueRangesChanged",event:{valueRanges:J.valueRanges}}).catch(B)}))};E._initQueryEngine=function(){var H;const J=this;null==(H=this.queryEngine)?void 0:H.destroy();this.queryEngine=new p.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(P){return J.aggregateStore.getFeatureDisplayIdsForAggregate(P).map(O=>
J.getObjectId(O))}},timeInfo:this.service.timeInfo})};E.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.queryEngine.destroy();this.attributeStore&&this.attributeStore.destroy();for(const H of this.tileStore.tiles)this._source.unsubscribe(H);clearInterval(this._checkUpdating)};E.isUpdating=function(){return this._source.updating||!!this._updateQueue.length};E.enableEvent=function(H){this._source.enableEvent(H.name,H.value)};E.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};
E.pauseStream=function(){"geoevent"===this._source.type&&this._source.pauseStream()};E.resumeStream=function(){"geoevent"===this._source.type&&this._source.resumeStream()};E.update=function(){var H=r._asyncToGenerator(function*(J,P){this._set("config",P);this._schema=P.schema;this._initQueryEngine();yield Promise.all([this._source.update(J,P.schema.source),this.featureStore.updateSchema(J,P.schema.targets.feature),this.attributeStore.update(J,P),this.attributeStore.updateFilters(J,this)]);yield this.aggregateStore.updateSchema(J,
P.schema.targets.aggregate);C("esri-2d-update-debug")&&J.describe()});return function(J,P){return H.apply(this,arguments)}}();E.applyUpdate=function(){var H=r._asyncToGenerator(function*(J){J.mesh&&this.clearTiles();this._updateQueue.resume();yield this._source.applyUpdate(J);this.notifyChange("updating");yield w.whenOnce(()=>!this.updating);this.hasAggregates&&(yield A.after(10),yield w.whenOnce(()=>!this.updating))});return function(J){return H.apply(this,arguments)}}();E.onEdits=function(){var H=
r._asyncToGenerator(function*({edits:J}){C("esri-2d-update-debug")&&console.debug("Applying Edit:",J);this._didEdit=!0;try{const P=J.removed.map(K=>K.objectId&&-1!==K.objectId?K.objectId:this._lookupObjectIdByGlobalId(K.globalId)),O=J.addOrModified.map(({objectId:K})=>K);this.featureStore.invalidate();yield this._source.edit(O,P);this.clearTiles();this.notifyChange("updating");this.aggregateStore.clear();yield this._source.resend();yield w.whenOnce(()=>!this.updating)}catch(P){}});return function(J){return H.apply(this,
arguments)}}();E.refresh=function(){var H=r._asyncToGenerator(function*(J){if(!J)return J=x.UpdateToken.empty(),J.storage.filters=!0,this.applyUpdate(J);this.featureStore.invalidate();this.clearTiles();this._source.refresh();this._cleanupNeeded=!0;this.notifyChange("updating");yield w.whenOnce(()=>!this.updating)});return function(J){return H.apply(this,arguments)}}();E.clearTiles=function(){for(const H of this.tileStore.tiles)this.processor.onTileClear(H)};E.onTileUpdate=function(H){this.aggregateStore.onTileUpdate(H);
for(const J of H.added)this._source.subscribe(J),this._level=J.level;for(const J of H.removed)this._source.unsubscribe(J),this._cleanupNeeded=!0,this._tileToResolver.has(J.id)&&(this._tileToResolver.get(J.id).resolve(),this._tileToResolver.delete(J.id));this.notifyChange("updating")};E.onIdle=function(){this._invalidated&&((this.hasAggregates||"heatmap"===this.processor.type)&&this._repushCurrentLevelTiles(),this._invalidated=!1);this._markAndSweep()};E.querySummaryStatistics=function(){var H=r._asyncToGenerator(function*({query:J,
params:P}){return this.queryEngine.executeQueryForSummaryStatistics(J,P)});return function(J){return H.apply(this,arguments)}}();E.queryUniqueValues=function(){var H=r._asyncToGenerator(function*({query:J,params:P}){return this.queryEngine.executeQueryForUniqueValues(J,P)});return function(J){return H.apply(this,arguments)}}();E.queryClassBreaks=function(){var H=r._asyncToGenerator(function*({query:J,params:P}){return this.queryEngine.executeQueryForClassBreaks(J,P)});return function(J){return H.apply(this,
arguments)}}();E.queryHistogram=function(){var H=r._asyncToGenerator(function*({query:J,params:P}){return this.queryEngine.executeQueryForHistogram(J,P)});return function(J){return H.apply(this,arguments)}}();E.queryExtent=function(H){return this.queryEngine.executeQueryForExtent(H)};E.queryFeatures=function(H){return this.queryEngine.executeQuery(H)};E.queryVisibleFeatures=function(){var H=r._asyncToGenerator(function*(J){J=yield this.queryEngine.executeQuery(J);const P=J.objectIdFieldName;J.features=
J.features.filter(O=>{O=this.getDisplayId(O.attributes[P]);return this.attributeStore.isVisible(O)});return J});return function(J){return H.apply(this,arguments)}}();E.queryFeatureCount=function(H){return this.queryEngine.executeQueryForCount(H)};E.queryLatestObservations=function(H){return this.queryEngine.executeQueryForLatestObservations(H)};E.queryObjectIds=function(H){return this.queryEngine.executeQueryForIds(H)};E.queryStatistics=function(){var H=r._asyncToGenerator(function*(){return this.featureStore.storeStatistics});
return function(){return H.apply(this,arguments)}}();E.getObjectId=function(H){return this.featureStore.lookupObjectId(H,this._storage)};E.getDisplayId=function(H){if(this._schema.targets.aggregate){const J=this.aggregateStore.getDisplayId(H);return v.isNone(J)?(H=this.featureStore.lookupDisplayId(H),this.aggregateStore.getDisplayIdForReferenceId(H)):J}return this.featureStore.lookupDisplayId(H)};E.getFeatures=function(H){const J=[],P=[];for(const O of H)H=this.hasAggregates?this.getAggregate(O):
null,v.isSome(H)?v.isSome(H.referenceId)?(H=this.getFeature(H.referenceId),v.isSome(H)&&J.push(H)):P.push(H):(H=this.getFeature(O),v.isSome(H)&&J.push(H));return{features:J,aggregates:P}};E.getFeature=function(H){H=this.featureStore.lookupFeatureByDisplayId(H,this._storage);if(v.isNone(H))return null;var J=H.readHydratedGeometry();J=n.convertToGeometry(J,H.geometryType,H.hasZ,H.hasM);return{attributes:H.readAttributes(),geometry:J}};E.getAggregate=function(H){return this.aggregateStore.getAggregate(H)};
E.getAggregates=function(){return this.aggregateStore.getAggregates()};E.setHighlight=function(){var H=r._asyncToGenerator(function*(J){const P=J.map(O=>this.getDisplayId(O));return this.attributeStore.setHighlight(J,P)});return function(J){return H.apply(this,arguments)}}();E._lookupObjectIdByGlobalId=function(H){const J=this.service.globalIdField;if(v.isNone(J))throw Error("Expected globalIdField to be defined");let P=null;this.featureStore.forEach(O=>{H===O.readAttribute(J)&&(P=O.getObjectId())});
if(v.isNone(P))throw Error(`Expected to find a feature with globalId ${H}`);return P};E._repushCurrentLevelTiles=function(){const H=this.tileStore.tiles.filter(J=>J.level===this._level);for(const J of H)this._patchTile({type:"append",id:J.key.id,addOrUpdate:g.FeatureSetReaderJSON.fromOptimizedFeatures([],this.service),remove:[],end:!0,status:x.UpdateToken.empty()})};E._maybeForceCleanup=function(){5E3<performance.now()-this._lastCleanup&&this._markAndSweep()};E._patchTile=function(H,J){H=this._updateQueue.push(H,
J).then(()=>{this.notifyChange("updating")}).catch(P=>{this.notifyChange("updating")});this.notifyChange("updating");return H};E._onTileMessage=function(){var H=r._asyncToGenerator(function*(J,P){A.throwIfAborted(P);const O=this.tileStore.get(J.id);if(O){if(J.clear)return this.processor.onTileClear(O);var K=J.status;this._cleanupNeeded=!0;var D=[];for(const I of J.remove){const L=this.featureStore.lookupDisplayId(I);L&&D.push(L)}J.remove=D;try{if(v.isNone(J.addOrUpdate))this.processor.onTileMessage(O,
{...J,addOrUpdate:null},this.hasAggregates,P).catch(A.throwIfNotAbortError);else{J.addOrUpdate.setArcadeSpatialReference(this.spatialReference);this.featureStore.hasInstance(J.addOrUpdate.instance)&&K.targets.feature||(K.targets.feature=!0,this.featureStore.onTileData(O,J));K.storage.data&&K.storage.filters||(K.storage.data=!0,K.storage.filters=!0,this.attributeStore.onTileData(O,J),"geoevent"===this._source.type||this._didEdit?(yield this.attributeStore.sendUpdates(),A.throwIfAborted(P)):this.attributeStore.sendUpdates());
if(this.hasAggregates&&!K.targets.aggregate){K.targets.aggregate=!0;const I=z(this._source)&&this._source.loading,L=!z(this._source)||I||J.end;this.aggregateStore.onTileData(O,J,this._storage,this.attributeStore,L);if(!L)return;K.mesh||(this.attributeStore.onTileData(O,J),yield this.attributeStore.sendUpdates(),this.processor.onTileClear(O))}K.mesh||(K.mesh=!0,yield this.processor.onTileMessage(O,J,this.hasAggregates,P),A.throwIfAborted(P));this._maybeForceCleanup()}}catch(I){A.throwIfNotAbortError(I)}}});
return function(J,P){return H.apply(this,arguments)}}();E._mark=function(H,J,P){const O=this._storage.getInstanceId(H);H&&(J.add((4294901760&O)>>>16),P.set(H))};E._markAndSweep=function(){this._lastCleanup=performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||"geoevent"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var H=this._storage.getBitset(this._markedIdsBufId),J=new Set;H.clear();for(const O of this.tileStore.tiles)for(const K of this._source.readers(O.id)){const D=
K.getCursor();for(;D.next();){var P=D.getDisplayId();P||(P=D.getObjectId(),P=this.featureStore.lookupDisplayId(P));this._mark(P,J,H)}}"symbol"===this.processor.type&&this.processor.forEachBufferId(O=>{this._mark(O,J,H)});this._updateQueue.forEach(O=>{for(const K of O.remove)O=this.featureStore.lookupDisplayId(K),this._mark(O,J,H)});this.config.schema.targets.aggregate&&(this.aggregateStore.sweepFeatures(H,this.featureStore),this.aggregateStore.sweepClusters(this._storage,this.attributeStore,this._level));
this.featureStore.sweepFeatures(H,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(J)}};r._createClass(y,[{key:"fieldsIndex",get:function(){return new c(this.service.fields)}},{key:"hasAggregates",get:function(){return!!this.config.schema.targets.aggregate}},{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},{key:"updating",get:function(){return this.isUpdating()}}]);return y}(F.HandleOwner);t.__decorate([l.property({constructOnly:!0})],
F.prototype,"tileStore",void 0);t.__decorate([l.property()],F.prototype,"config",void 0);t.__decorate([l.property({readOnly:!0})],F.prototype,"fieldsIndex",null);t.__decorate([l.property()],F.prototype,"processor",void 0);t.__decorate([l.property({constructOnly:!0})],F.prototype,"remoteClient",void 0);t.__decorate([l.property({constructOnly:!0})],F.prototype,"service",void 0);t.__decorate([l.property()],F.prototype,"spatialReference",null);t.__decorate([l.property()],F.prototype,"updating",null);
return F=t.__decorate([k.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],F)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(r,t,F,C,v,A,w,l){function e(T,W){return T?W?4:3:W?3:2}function h(T,W,ca,da){if(T){if(ca)return W&&da?G:Ca;if(W&&da)return va}else if(W&&da)return Ca;return xa}
function k({scale:T,translate:W},ca){return Math.round((ca-W[0])/T[0])}function n({scale:T,translate:W},ca){return Math.round((W[1]-ca)/T[1])}function p({scale:T,translate:W},ca){return ca*T[0]+W[0]}function c({scale:T,translate:W},ca){return W[1]-ca*T[1]}function d(T){T=T.coords;return{x:T[0],y:T[1]}}function a(T,W){T.coords[0]=W.x;T.coords[1]=W.y;return T}function b(T){T=T.coords;return{x:T[0],y:T[1],z:T[2]}}function f(T,W){T.coords[0]=W.x;T.coords[1]=W.y;T.coords[2]=W.z;return T}function m(T){T=
T.coords;return{x:T[0],y:T[1],m:T[2]}}function g(T,W){T.coords[0]=W.x;T.coords[1]=W.y;T.coords[2]=W.m;return T}function x(T){T=T.coords;return{x:T[0],y:T[1],z:T[2],m:T[3]}}function q(T,W){T.coords[0]=W.x;T.coords[1]=W.y;T.coords[2]=W.z;T.coords[3]=W.m;return T}function B(T,W){return T&&W?q:T?f:W?g:a}function z(T,W,ca,da,ia){ca=B(ca,da);for(const ja of W){const {geometry:aa,attributes:ea}=ja;let la;aa&&(la=ca(new l,aa));T.push(new A.OptimizedFeature(la,ea,null,ea[ia]))}return T}function u(T,W,ca,da){for(const ia of W){const {geometry:ja,
attributes:aa}=ia;let ea;ja&&(ea=y(ja,ca,da));T.push({attributes:aa,geometry:ea})}return T}function y(T,W,ca){if(C.isNone(T))return null;const da=e(W,ca),ia=[];for(let ja=0;ja<T.coords.length;ja+=da){const aa=[];for(let ea=0;ea<da;ea++)aa.push(T.coords[ja+ea]);ia.push(aa)}return W?ca?{points:ia,hasZ:W,hasM:ca}:{points:ia,hasZ:W}:ca?{points:ia,hasM:ca}:{points:ia}}function E(T,W,ca,da,ia){ca=e(ca,da);for(const ja of W){W=ja.geometry;da=ja.attributes;let aa;W&&(aa=H(new l,W,ca));T.push(new A.OptimizedFeature(aa,
da,null,da[ia]))}return T}function H(T,W,ca=e(W.hasZ,W.hasM)){T.lengths[0]=W.points.length;const da=T.coords;let ia=0;for(const ja of W.points)for(W=0;W<ca;W++)da[ia++]=ja[W];return T}function J(T,W,ca){if(!T)return null;const da=e(W,ca),{coords:ia,lengths:ja}=T;T=[];let aa=0;for(const ea of ja){const la=[];for(let qa=0;qa<ea;qa++){const sa=[];for(let wa=0;wa<da;wa++)sa.push(ia[aa++]);la.push(sa)}T.push(la)}return W?ca?{paths:T,hasZ:W,hasM:ca}:{paths:T,hasZ:W}:ca?{paths:T,hasM:ca}:{paths:T}}function P(T,
W,ca,da,ia){ca=e(ca,da);for(const ja of W){W=ja.geometry;da=ja.attributes;let aa;W&&(aa=O(new l,W,ca));T.push(new A.OptimizedFeature(aa,da,null,da[ia]))}return T}function O(T,W,ca=e(W.hasZ,W.hasM)){const {lengths:da,coords:ia}=T;let ja=0;for(const aa of W.paths){for(const ea of aa)for(W=0;W<ca;W++)ia[ja++]=ea[W];da.push(aa.length)}return T}function K(T,W,ca){if(!T)return null;const da=e(W,ca),{coords:ia,lengths:ja}=T;T=[];let aa=0;for(const ea of ja){const la=[];for(let qa=0;qa<ea;qa++){const sa=
[];for(let wa=0;wa<da;wa++)sa.push(ia[aa++]);la.push(sa)}T.push(la)}return W?ca?{rings:T,hasZ:W,hasM:ca}:{rings:T,hasZ:W}:ca?{rings:T,hasM:ca}:{rings:T}}function D(T,W,ca,da,ia){for(const ja of W){W=ja.geometry;const aa=ja.centroid,ea=ja.attributes;let la;W&&(la=I(new l,W,ca,da));C.isSome(aa)?T.push(new A.OptimizedFeature(la,ea,a(new l,aa),ea[ia])):T.push(new A.OptimizedFeature(la,ea,null,ea[ia]))}return T}function I(T,W,ca=W.hasZ,da=W.hasM){L(T,W.rings,ca,da);return T}function L(T,W,ca,da){ca=e(ca,
da);const {lengths:ia,coords:ja}=T;da=0;ia.length=ja.length=0;for(const aa of W){for(const ea of aa)for(W=0;W<ca;W++)ja[da++]=ea[W];ia.push(aa.length)}return T}function R(T,W,ca,da,ia,ja){T.length=0;if(!ca){for(const aa of W)T.push(new A.OptimizedFeature(null,aa.attributes,null,aa.attributes[ja]));return T}switch(ca){case "esriGeometryPoint":return z(T,W,da,ia,ja);case "esriGeometryMultipoint":return E(T,W,da,ia,ja);case "esriGeometryPolyline":return P(T,W,da,ia,ja);case "esriGeometryPolygon":return D(T,
W,da,ia,ja);default:oa.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`)),T.length=0}return T}function Z(T,W,ca,da){T=T&&("coords"in T?T:T.geometry);if(C.isNone(T))return null;switch(W){case "esriGeometryPoint":return W=d,ca&&da?W=x:ca?W=b:da&&(W=m),W(T);case "esriGeometryMultipoint":return y(T,ca,da);case "esriGeometryPolyline":return J(T,ca,da);case "esriGeometryPolygon":return K(T,ca,da);default:oa.error("convertToGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${W}'`))}}
function X(T,W,ca,da,ia){T.length=0;if(C.isNone(ca)){for(const ea of W)T.push({attributes:ea.attributes});return T}switch(ca){case "esriGeometryPoint":var ja=d;da&&ia?ja=x:da?ja=b:ia&&(ja=m);for(var aa of W){const {geometry:ea,attributes:la}=aa;da=C.isSome(ea)?ja(ea):null;T.push({attributes:la,geometry:da})}break;case "esriGeometryMultipoint":return u(T,W,da,ia);case "esriGeometryPolyline":for(const ea of W){const {geometry:la,attributes:qa}=ea;let sa;C.isSome(la)&&(sa=J(la,da,ia));T.push({attributes:qa,
geometry:sa})}break;case "esriGeometryPolygon":for(ja of W){const {geometry:ea,attributes:la,centroid:qa}=ja;let sa;C.isSome(ea)&&(sa=K(ea,da,ia));C.isSome(qa)?(aa=d(qa),T.push({attributes:la,centroid:aa,geometry:sa})):T.push({attributes:la,geometry:sa})}break;default:oa.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`))}return T}function Q(T,W,ca,da,ia,ja,aa=ca,ea=da){T.lengths.length&&(T.lengths.length=0);T.coords.length&&(T.coords.length=0);if(C.isNone(W)||
!W.coords.length)return null;ia=ua[ia];const {coords:la,lengths:qa}=W;W=e(ca,da);const sa=e(ca&&aa,da&&ea);ca=h(ca,da,aa,ea);if(!qa.length)return ca(T.coords,la,0,0,k(ja,la[0]),n(ja,la[1])),T.lengths.length&&(T.lengths.length=0),T.coords.length=W,T;let wa,za=0,Da,Ja=0;for(const Ga of qa){if(Ga<ia)continue;let Ha=0;Da=Ja;ea=da=k(ja,la[za]);wa=aa=n(ja,la[za+1]);ca(T.coords,la,Da,za,ea,wa);Ha++;za+=W;Da+=sa;for(let Ia=1;Ia<Ga;Ia++,za+=W)if(ea=k(ja,la[za]),wa=n(ja,la[za+1]),ea!==da||wa!==aa)ca(T.coords,
la,Da,za,ea-da,wa-aa),Da+=sa,Ha++,da=ea,aa=wa;Ha>=ia&&(T.lengths.push(Ha),Ja=Da)}T.coords.length=Ja;return T.coords.length?T:null}function M(T,W,ca,da,ia,ja,aa){let ea=da,la=0;for(let sa=ja+ca;sa<aa;sa+=ca){{var qa=W[sa];const wa=W[sa+1],za=W[aa],Da=W[aa+1];let Ja=W[ja],Ga=W[ja+1],Ha=za-Ja,Ia=Da-Ga;if(0!==Ha||0!==Ia){const La=((qa-Ja)*Ha+(wa-Ga)*Ia)/(Ha*Ha+Ia*Ia);1<La?(Ja=za,Ga=Da):0<La&&(Ja+=Ha*La,Ga+=Ia*La)}Ha=qa-Ja;Ia=wa-Ga;qa=Ha*Ha+Ia*Ia}qa>ea&&(la=sa,ea=qa)}ea>da&&(la-ja>ca&&M(T,W,ca,da,ia,ja,
la),ia(T,W,T.length,la,W[la],W[la+1]),aa-la>ca&&M(T,W,ca,da,ia,la,aa))}function V(T,W,ca,da,ia){const {coords:ja,lengths:aa}=W,ea=ca?da?G:Ca:da?Ca:xa;ca=e(ca,da);if(!ja.length)return T!==W&&(T.lengths.length=0,T.coords.length=0),T;if(!aa.length)return ea(T.coords,ja,0,0,p(ia,ja[0]),c(ia,ja[1])),T!==W&&(T.lengths.length=0,T.coords.length=ca),T;const [la,qa]=ia.scale;da=0;for(let sa=0;sa<aa.length;sa++){const wa=aa[sa];T.lengths[sa]=wa;let za=p(ia,ja[da]),Da=c(ia,ja[da+1]);ea(T.coords,ja,da,da,za,Da);
da+=ca;for(let Ja=1;Ja<wa;Ja++,da+=ca)za+=ja[da]*la,Da-=ja[da+1]*qa,ea(T.coords,ja,da,da,za,Da)}T!==W&&(T.lengths.length=aa.length,T.coords.length=ja.length);return T}function fa(T,W,ca,da){let ia=0,ja=T[da*W],aa=T[da*(W+1)];for(let ea=1;ea<ca;ea++){const la=ja+T[da*(W+ea)],qa=aa+T[da*(W+ea)+1],sa=(la-ja)*(qa+aa);ja=la;aa=qa;ia+=sa}return.5*ia}const oa=F.getLogger("esri.layers.graphics.featureConversionUtils"),ua={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},
xa=(T,W,ca,da,ia,ja)=>{T[ca]=ia;T[ca+1]=ja},Ca=(T,W,ca,da,ia,ja)=>{T[ca]=ia;T[ca+1]=ja;T[ca+2]=W[da+2]},va=(T,W,ca,da,ia,ja)=>{T[ca]=ia;T[ca+1]=ja;T[ca+2]=W[da+3]},G=(T,W,ca,da,ia,ja)=>{T[ca]=ia;T[ca+1]=ja;T[ca+2]=W[da+2];T[ca+3]=W[da+3]},S=[],ha=[];r.convertFromFeature=function(T,W,ca,da,ia){S[0]=T;[T]=R(ha,S,W,ca,da,ia);S.length=ha.length=0;return T};r.convertFromFeatureSet=function(T,W){const ca=new w,{hasM:da,hasZ:ia,features:ja,objectIdFieldName:aa,spatialReference:ea,geometryType:la,exceededTransferLimit:qa,
transform:sa,fields:wa}=T;wa&&(ca.fields=wa);ca.geometryType=la;ca.objectIdFieldName=aa||W;ca.spatialReference=ea;if(!ca.objectIdFieldName)return oa.error(new t("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),ca;ja&&R(ca.features,ja,la,ia,da,ca.objectIdFieldName);qa&&(ca.exceededTransferLimit=qa);da&&(ca.hasM=da);ia&&(ca.hasZ=ia);sa&&(ca.transform=sa);return ca};r.convertFromFeatures=R;r.convertFromGeometry=function(T,W,ca){if(C.isNone(T))return null;const da=new l;
"hasZ"in T&&null==W&&(W=T.hasZ);"hasM"in T&&null==ca&&(ca=T.hasM);if(v.isPoint(T))return B(null!=W?W:null!=T.z,null!=ca?ca:null!=T.m)(da,T);if(v.isPolygon(T))return I(da,T,W,ca);if(v.isPolyline(T))return O(da,T,e(W,ca));if(v.isMultipoint(T))return H(da,T,e(W,ca));oa.error("convertFromGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${T}'`))};r.convertFromGraphics=function(T,W,ca,da,ia,ja){const aa=T.length;switch(ca){case "esriGeometryPoint":z(T,W,da,ia,ja);break;case "esriGeometryMultipoint":E(T,
W,da,ia,ja);break;case "esriGeometryPolyline":P(T,W,da,ia,ja);break;case "esriGeometryPolygon":D(T,W,da,ia,ja);break;default:oa.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`))}for(da=0;da<W.length;da++)T[da+aa].geometryType=ca,T[da+aa].insertAfter=W[da].insertAfter,T[da+aa].groupId=W[da].groupId;return T};r.convertFromMultipoint=H;r.convertFromMultipointFeatures=E;r.convertFromNestedArray=L;r.convertFromPoint=function(T,W,ca=B(null!=W.z,null!=W.m)){return ca(T,
W)};r.convertFromPointFeatures=z;r.convertFromPolygon=I;r.convertFromPolyline=O;r.convertFromPolylineFeatures=P;r.convertToFeature=function(T,W,ca,da){ha[0]=T;X(S,ha,W,ca,da);T=S[0];S.length=ha.length=0;return T};r.convertToFeatureSet=function(T){const {objectIdFieldName:W,spatialReference:ca,transform:da,fields:ia,hasM:ja,hasZ:aa,features:ea,geometryType:la,exceededTransferLimit:qa,uniqueIdField:sa,queryGeometry:wa,queryGeometryType:za}=T;T=X([],ea,la,aa,ja);const Da=Z(wa,za,!1,!1);T={features:T,
fields:ia,geometryType:la,objectIdFieldName:W,spatialReference:ca,uniqueIdField:sa,queryGeometry:Da};da&&(T.transform=da);qa&&(T.exceededTransferLimit=qa);ja&&(T.hasM=ja);aa&&(T.hasZ=aa);return T};r.convertToFeatures=X;r.convertToGeometry=Z;r.convertToMultipoint=y;r.convertToMultipointFeatures=u;r.convertToPoint=function(T,W,ca){return T?W?ca?x(T):b(T):ca?m(T):d(T):null};r.convertToPolygon=K;r.convertToPolyline=J;r.deltaDecodeGeometry=function(T,W){if(C.isNone(T))return null;const ca=T.clone(),da=
T.coords;T=T.lengths;let ia=0;for(let ea=0;ea<T.length;ea++){const la=T[ea];var ja=da[W*ia],aa=da[W*ia+1];for(let qa=1;qa<la;qa++)ja+=da[W*(ia+qa)],aa+=da[W*(ia+qa)+1],ca.coords[W*(ia+qa)]=ja,ca.coords[W*(ia+qa)+1]=aa;ia+=la}return ca};r.deltaEncodeGeometry=function(T,W){const ca=T.clone(),da=T.coords;T=T.lengths;let ia=0;for(let aa=0;aa<T.length;aa++){const ea=T[aa];let la=da[W*ia];var ja=da[W*ia+1];for(let qa=1;qa<ea;qa++){const sa=da[W*(ia+qa)],wa=da[W*(ia+qa)+1];ja=wa-ja;ca.coords[W*(ia+qa)]=
sa-la;ca.coords[W*(ia+qa)+1]=ja;la=sa;ja=wa}ia+=ea}return ca};r.generalizeOptimizedGeometry=function(T,W,ca,da,ia,ja,aa=ca,ea=da){T.lengths.length&&(T.lengths.length=0);T.coords.length&&(T.coords.length=0);if(!W||!W.coords.length)return null;ia=ua[ia];const {coords:la,lengths:qa}=W;W=e(ca,da);const sa=e(ca&&aa,da&&ea);ca=h(ca,da,aa,ea);if(!qa.length)return ca(T.coords,la,0,0,la[0],la[1]),T.lengths.length&&(T.lengths.length=0),T.coords.length=W,T;da=0;ja*=ja;for(const wa of qa){if(wa<ia){da+=wa*W;
continue}aa=T.coords.length/sa;ea=da;const za=da+(wa-1)*W;ca(T.coords,la,T.coords.length,ea,la[ea],la[ea+1]);M(T.coords,la,W,ja,ca,ea,za);ca(T.coords,la,T.coords.length,za,la[za],la[za+1]);ea=T.coords.length/sa-aa;ea>=ia?T.lengths.push(ea):T.coords.length=aa*sa;da+=wa*W}return T.coords.length?T:null};r.getBoundsOptimizedGeometry=function(T,W,ca,da){if(C.isNone(W)||!W.coords||!W.coords.length)return null;ca=e(ca,da);let ia=da=Number.POSITIVE_INFINITY,ja=Number.NEGATIVE_INFINITY,aa=Number.NEGATIVE_INFINITY;
if(W&&W.coords){W=W.coords;for(let ea=0;ea<W.length;ea+=ca){const la=W[ea],qa=W[ea+1];da=Math.min(da,la);ja=Math.max(ja,la);ia=Math.min(ia,qa);aa=Math.max(aa,qa)}}T[0]=da;T[1]=ia;T[2]=ja;T[3]=aa;return T};r.getQuantizedArea=function(T,W){const {coords:ca,lengths:da}=T;let ia=T=0;for(let ja=0;ja<da.length;ja++)ia+=fa(ca,T,da[ja],W),T+=ja;return Math.abs(ia)};r.getQuantizedBoundsOptimizedGeometry=function(T,W,ca,da){ca=e(ca,da);const {lengths:ia,coords:ja}=W;da=W=Number.POSITIVE_INFINITY;let aa=Number.NEGATIVE_INFINITY,
ea=Number.NEGATIVE_INFINITY,la=0;for(const qa of ia){let sa=ja[la],wa=ja[la+1];W=Math.min(sa,W);da=Math.min(wa,da);aa=Math.max(sa,aa);ea=Math.max(wa,ea);la+=ca;for(let za=1;za<qa;za++,la+=ca){const Da=ja[la],Ja=ja[la+1];sa+=Da;wa+=Ja;0>Da&&(W=Math.min(W,sa));0<Da&&(aa=Math.max(aa,sa));0>Ja?da=Math.min(da,wa):0<Ja&&(ea=Math.max(ea,wa))}}T[0]=W;T[1]=da;T[2]=aa;T[3]=ea;return T};r.getSignedQuantizedRingArea=fa;r.quantizeOptimizedFeatureSet=function(T,W){const {geometryType:ca,features:da,hasM:ia,hasZ:ja}=
W;if(!T)return W;for(let aa=0;aa<da.length;aa++){const ea=da[aa],la=ea.weakClone();la.geometry=new l;Q(la.geometry,ea.geometry,ia,ja,ca,T);ea.centroid&&(la.centroid=new l,Q(la.centroid,ea.centroid,ia,ja,"esriGeometryPoint",T));da[aa]=la}W.transform=T;return W};r.quantizeOptimizedGeometry=Q;r.quantizeX=k;r.quantizeY=n;r.removeCollinearVectices=function(T,W,ca,da,ia){if(!W||!W.coords||!W.coords.length)return null;ca=ua[ca];const {coords:ja,lengths:aa}=W;W=h(da,ia,da,ia);da=e(da,ia);let ea=ia=0,la=0,
qa=0;for(const za of aa){ea=qa;W(T.coords,ja,ea,ia,ja[ia],ja[ia+1]);ia+=da;var sa=ja[ia];let Da=ja[ia+1],Ja=sa,Ga=Da;var wa=Da/sa;ea+=da;W(T.coords,ja,ea,ia,Ja,Ga);ia+=da;for(let Ha=2;Ha<za;Ha++){sa=ja[ia];Da=ja[ia+1];const Ia=Da/sa,La=wa===Ia||!isFinite(wa)&&!isFinite(Ia);wa=La&&isFinite(Ia)?0<=wa&&0<=Ia||0>=wa&&0>=Ia:0<=Ga&&0<=Da||0>=Ga&&0>=Da;La&&wa?(Ja+=sa,Ga+=Da):(Ja=sa,Ga=Da,ea+=da);W(T.coords,ja,ea,ia,Ja,Ga);ia+=da;wa=Ia}ea+=da;sa=(ea-qa)/da;sa>=ca&&(T.lengths[la]=sa,qa=ea,la++)}T.coords.length>
qa&&(T.coords.length=qa);T.lengths.length>la&&(T.lengths.length=la);return T.coords.length&&T.lengths.length?T:null};r.removeZMValues=function(T,W,ca,da,ia,ja){const aa=e(ca,da);ca=h(ca,da,ia,ja);da=W.coords;T.coords.length=0;T.lengths.length=0;T.lengths.push(...W.lengths);for(W=0;W<da.length;W+=aa)ca(T.coords,da,T.coords.length,W,da[W],da[W+1]);return T};r.unquantizeOptimizedFeatureSet=function(T){const {transform:W,features:ca,hasM:da,hasZ:ia}=T;if(!W)return T;for(const ja of ca)C.isSome(ja.geometry)&&
V(ja.geometry,ja.geometry,da,ia,W),C.isSome(ja.centroid)&&V(ja.centroid,ja.centroid,da,ia,W);T.transform=null;return T};r.unquantizeOptimizedGeometry=V;r.unquantizeX=p;r.unquantizeY=c;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(r,t,F){let C=function(){function A(w=null,l={},e,h){this.geometry=w;this.attributes=l;this.centroid=e;this.objectId=h;this.geohashY=
this.geohashX=this.displayId=0}A.prototype.weakClone=function(){const w=new A(this.geometry,this.attributes,this.centroid,this.objectId);w.displayId=this.displayId;w.geohashX=this.geohashX;w.geohashY=this.geohashY;return w};return A}(),v=function(A){function w(){return A.apply(this,arguments)||this}t._inheritsLoose(w,A);return w}(C);r.OptimizedFeature=C;r.OptimizedFeatureWithGeometry=v;r.hasGeometry=function(A){return!(F.isNone(A.geometry)||!A.geometry.coords||!A.geometry.coords.length)};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){return function(){function r(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}r.prototype.weakClone=function(){const t=new r;t.objectIdFieldName=
this.objectIdFieldName;t.globalIdFieldName=this.globalIdFieldName;t.geohashFieldName=this.geohashFieldName;t.geometryProperties=this.geometryProperties;t.geometryType=this.geometryType;t.spatialReference=this.spatialReference;t.hasZ=this.hasZ;t.hasM=this.hasM;t.features=this.features;t.fields=this.fields;t.transform=this.transform;t.exceededTransferLimit=this.exceededTransferLimit;t.uniqueIdField=this.uniqueIdField;t.queryGeometry=this.queryGeometry;t.queryGeometryType=this.queryGeometryType;return t};
return r}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(C=[],v=[],A=!1){this.lengths=null!=C?C:[];this.coords=null!=v?v:[];this.hasIndeterminateRingOrder=A}var F=t.prototype;F.forEachVertex=function(C){let v=0;this.lengths.length||C(this.coords[0],this.coords[1]);for(let A=0;A<this.lengths.length;A++){const w=this.lengths[A];for(let l=0;l<w;l++)C(this.coords[2*(l+v)],this.coords[2*(l+v)+1]);v+=w}};
F.clone=function(C){return C?(C.set(this.coords),new t(this.lengths.slice(),C,this.hasIndeterminateRingOrder)):new t(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};r._createClass(t,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},{key:"size",get:function(){return this.lengths.reduce((C,v)=>C+v)}}]);return t}()})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q,B){function z(O){return O.every(K=>"exceedslimit"!==K.statisticType)}const u=new Set,y=new A.MemCacheStorage(2E6);let E=0,H=function(){function O(D){this.capabilities={query:a.queryCapabilities};this.geometryType=D.geometryType;this.hasM=D.hasM;this.hasZ=D.hasZ;this.objectIdField=D.objectIdField;this.spatialReference=D.spatialReference;this.definitionExpression=D.definitionExpression;this.featureStore=D.featureStore;this.aggregateAdapter=D.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=D.timeInfo;D.cacheSpatialQueries&&(this._geometryQueryCache=new A.MemCache(E++ +"$$",y));this.fieldsIndex=new x(D.fields);D.scheduler&&D.priority&&(this._frameTask=D.scheduler.registerTask(D.priority))}var K=O.prototype;K.destroy=function(){this._frameTask=v.removeMaybe(this._frameTask);this.clearCache();v.destroyMaybe(this._geometryQueryCache);this._changeHandle=v.removeMaybe(this._changeHandle);v.destroyMaybe(this.fieldsIndex)};
K.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};K.executeQuery=function(){var D=t._asyncToGenerator(function*(I={},L){let R=C.clone(I),Z;try{R=yield this._schedule(()=>g.normalizeQuery(R,this.definitionExpression,this.spatialReference),L),R=yield this._reschedule(()=>this._checkQuerySupport(R),L),Z=yield this._reschedule(()=>this._executeGeometryQuery(R,L),L),Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(R),L),Z=yield this._reschedule(()=>
Z.executeObjectIdsQuery(R),L),Z=yield this._reschedule(()=>Z.executeTimeQuery(R),L),Z=yield this._reschedule(()=>Z.executeAttributesQuery(R),L)}catch(X){if(X!==g.QUERY_ENGINE_EMPTY_RESULT)throw X;Z=new b.default([],null,this)}return Z.createQueryResponse(R)});return function(){return D.apply(this,arguments)}}();K.executeQueryForCount=function(){var D=t._asyncToGenerator(function*(I={},L){let R=C.clone(I);R.returnGeometry=!1;R.returnCentroid=!1;R.outSR=null;try{R=yield this._schedule(()=>g.normalizeQuery(R,
this.definitionExpression,this.spatialReference),L);R=yield this._reschedule(()=>this._checkQuerySupport(R),L);let Z=yield this._reschedule(()=>this._executeGeometryQuery(R,L),L);Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(R),L);Z=yield this._reschedule(()=>Z.executeObjectIdsQuery(R),L);Z=yield this._reschedule(()=>Z.executeTimeQuery(R),L);Z=yield this._reschedule(()=>Z.executeAttributesQuery(R),L);return Z.createQueryResponseForCount(R)}catch(Z){if(Z!==g.QUERY_ENGINE_EMPTY_RESULT)throw Z;
return 0}});return function(){return D.apply(this,arguments)}}();K.executeQueryForExtent=function(){var D=t._asyncToGenerator(function*(I={},L){let R=C.clone(I),Z;I=R.outSR;try{R=yield this._schedule(()=>g.normalizeQuery(R,this.definitionExpression,this.spatialReference),L);R=yield this._reschedule(()=>this._checkQuerySupport(R),L);R.returnGeometry=!0;R.returnCentroid=!1;R.outSR=null;Z=yield this._reschedule(()=>this._executeGeometryQuery(R,L),L);Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(R),
L);Z=yield this._reschedule(()=>Z.executeObjectIdsQuery(R),L);Z=yield this._reschedule(()=>Z.executeTimeQuery(R),L);Z=yield this._reschedule(()=>Z.executeAttributesQuery(R),L);const X=Z.size;if(!X)return{count:X,extent:null};l.set(P,l.NEGATIVE_INFINITY);this.featureStore.forEachBounds(Z.items,V=>l.expandWithAABB(P,V),J);const Q={xmin:P[0],ymin:P[1],xmax:P[3],ymax:P[4],spatialReference:g.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(P[2])&&isFinite(P[5])&&(Q.zmin=P[2],Q.zmax=
P[5]);const M=d.project(Q,Z.spatialReference,I);M.spatialReference=g.cleanFromGeometryEngine(I||this.spatialReference);if(0===M.xmax-M.xmin){const V=w.getMetersPerUnitForSR(M.spatialReference);M.xmin-=V;M.xmax+=V}if(0===M.ymax-M.ymin){const V=w.getMetersPerUnitForSR(M.spatialReference);M.ymin-=V;M.ymax+=V}if(this.hasZ&&null!=M.zmin&&null!=M.zmax&&0===M.zmax-M.zmin){const V=w.getMetersPerUnitForSR(M.spatialReference);M.zmin-=V;M.zmax+=V}return{count:X,extent:M}}catch(X){if(X===g.QUERY_ENGINE_EMPTY_RESULT)return{count:0,
extent:null};throw X;}});return function(){return D.apply(this,arguments)}}();K.executeQueryForIds=function(){var D=t._asyncToGenerator(function*(I={},L){return this.executeQueryForIdSet(I,L).then(R=>Array.from(R))});return function(){return D.apply(this,arguments)}}();K.executeQueryForIdSet=function(){var D=t._asyncToGenerator(function*(I={},L){let R=C.clone(I),Z;R.returnGeometry=!1;R.returnCentroid=!1;R.outSR=null;try{R=yield this._schedule(()=>g.normalizeQuery(R,this.definitionExpression,this.spatialReference),
L);R=yield this._reschedule(()=>this._checkQuerySupport(R),L);Z=yield this._reschedule(()=>this._executeGeometryQuery(R,L),L);Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(R),L);Z=yield this._reschedule(()=>Z.executeObjectIdsQuery(R),L);Z=yield this._reschedule(()=>Z.executeTimeQuery(R),L);Z=yield this._reschedule(()=>Z.executeAttributesQuery(R),L);const X=Z.items,Q=new Set;yield this._reschedule(()=>{for(const M of X)Q.add(Z.featureAdapter.getObjectId(M))},L);return Q}catch(X){if(X===g.QUERY_ENGINE_EMPTY_RESULT)return new Set;
throw X;}});return function(){return D.apply(this,arguments)}}();K.executeQueryForSnapping=function(){var D=t._asyncToGenerator(function*(I,L){const {point:R,distance:Z,types:X}=I;if(X===b.SnappingTypes.NONE)return{candidates:[]};const Q=yield this._reschedule(()=>this._checkQuerySupport(I.query),L),M=!p.equals(R.spatialReference,this.spatialReference);M&&(yield d.checkProjectionSupport(R.spatialReference,this.spatialReference));var V="number"===typeof Z?Z:Z.x,fa="number"===typeof Z?Z:Z.y;V={xmin:R.x-
V,xmax:R.x+V,ymin:R.y-fa,ymax:R.y+fa,spatialReference:R.spatialReference};V=M?d.project(V,this.spatialReference):V;if(!V)return{candidates:[]};fa=(yield n.normalizeCentralMeridian(k.fromJSON(R),null,{signal:L}))[0];const oa=(yield n.normalizeCentralMeridian(k.fromJSON(V),null,{signal:L}))[0];if(v.isNone(fa)||v.isNone(oa))return{candidates:[]};let ua=new b.default(this._searchFeatures(this._getQueryBBoxes(oa.toJSON())),null,this);ua=yield this._reschedule(()=>ua.executeObjectIdsQuery(Q),L);ua=yield this._reschedule(()=>
ua.executeTimeQuery(Q),L);ua=yield this._reschedule(()=>ua.executeAttributesQuery(Q),L);L=fa.toJSON();L=M?d.project(L,this.spatialReference):L;return ua.createSnappingResponse({...I,point:L,distance:M?Math.max(V.xmax-V.xmin,V.ymax-V.ymin)/2:Z},R.spatialReference)});return function(I,L){return D.apply(this,arguments)}}();K.executeQueryForLatestObservations=function(){var D=t._asyncToGenerator(function*(I={},L){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new F("feature-store:unsupported-query",
"Missing timeInfo or timeInfo.trackIdField",{query:I,timeInfo:this.timeInfo});let R=C.clone(I),Z;try{R=yield this._schedule(()=>g.normalizeQuery(R,this.definitionExpression,this.spatialReference),L),R=yield this._reschedule(()=>this._checkQuerySupport(R),L),Z=yield this._reschedule(()=>this._executeGeometryQuery(R,L),L),Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(R),L),Z=yield this._reschedule(()=>Z.executeObjectIdsQuery(R),L),Z=yield this._reschedule(()=>Z.executeTimeQuery(R),L),Z=yield this._reschedule(()=>
Z.executeAttributesQuery(R),L),Z=yield this._reschedule(()=>Z.filterLatest(),L)}catch(X){if(X!==g.QUERY_ENGINE_EMPTY_RESULT)throw X;Z=new b.default([],null,this)}return Z.createQueryResponse(R)});return function(){return D.apply(this,arguments)}}();K.executeQueryForSummaryStatistics=function(){var D=t._asyncToGenerator(function*(I={},L,R){const {field:Z,normalizationField:X,valueExpression:Q}=L;return(yield this._getQueryEngineResultForStats(I,{field:Z,normalizationField:X,valueExpression:Q},R)).createSummaryStatisticsResponse(I,
L)});return function(){return D.apply(this,arguments)}}();K.executeQueryForUniqueValues=function(){var D=t._asyncToGenerator(function*(I={},L,R){const {field:Z,valueExpression:X}=L;return(yield this._getQueryEngineResultForStats(I,{field:Z,valueExpression:X},R)).createUniqueValuesResponse(I,L)});return function(){return D.apply(this,arguments)}}();K.executeQueryForClassBreaks=function(){var D=t._asyncToGenerator(function*(I={},L,R){const {field:Z,normalizationField:X,valueExpression:Q}=L;return(yield this._getQueryEngineResultForStats(I,
{field:Z,normalizationField:X,valueExpression:Q},R)).createClassBreaksResponse(I,L)});return function(){return D.apply(this,arguments)}}();K.executeQueryForHistogram=function(){var D=t._asyncToGenerator(function*(I={},L,R){const {field:Z,normalizationField:X,valueExpression:Q}=L;return(yield this._getQueryEngineResultForStats(I,{field:Z,normalizationField:X,valueExpression:Q},R)).createHistogramResponse(I,L)});return function(){return D.apply(this,arguments)}}();K._schedule=function(){var D=t._asyncToGenerator(function*(I,
L){return v.isSome(this._frameTask)?this._frameTask.schedule(I,L):I(B.noBudget)});return function(I,L){return D.apply(this,arguments)}}();K._reschedule=function(){var D=t._asyncToGenerator(function*(I,L){return v.isSome(this._frameTask)?this._frameTask.reschedule(I,L):I(B.noBudget)});return function(I,L){return D.apply(this,arguments)}}();K._getAll=function(){if(!this._allItems){const D=[];this.featureStore.forEach(I=>D.push(I));this._allItems=new b.default(D,null,this)}return this._allItems};K._executeGeometryQuery=
function(){var D=t._asyncToGenerator(function*(I,L){var R=this;const {geometry:Z,outSR:X,spatialRel:Q,returnGeometry:M,returnCentroid:V}=I;var fa=this.featureStore.featureSpatialReference;const oa=Z&&fa&&fa!==Z.spatialReference?d.project(Z,fa):Z,ua=M||V,xa=p.isValid(X)&&!p.equals(this.spatialReference,X),Ca=this._geometryQueryCache?xa&&ua?JSON.stringify({originalFilterGeometry:Z,spatialRelationship:Q,outSpatialReference:X}):JSON.stringify({originalFilterGeometry:Z,spatialRelationship:Q}):null;if(Ca&&
(fa=this._geometryQueryCache.get(Ca),!v.isUndefined(fa)))return fa;fa=function(){var ha=t._asyncToGenerator(function*(T){if(xa&&ua)return T=yield T.project(X),Ca&&R._geometryQueryCache.put(Ca,T,T.size||1),T;Ca&&R._geometryQueryCache.put(Ca,T,T.size||1);return T});return function(T){return ha.apply(this,arguments)}}();if(!oa)return fa(this._getAll());const va=this.featureAdapter;if("esriSpatialRelDisjoint"===Q){I=this._searchFeatures(this._getQueryBBoxes(Z));if(!I.length)return fa(this._getAll());
let ha,T;const W=new Set;for(var G of I)W.add(va.getObjectId(G));yield this._reschedule(()=>{let ca=0;ha=Array(W.size);this.featureStore.forEach(da=>ha[ca++]=da);T=W},L);I=yield this._reschedule(t._asyncToGenerator(function*(){const ca=yield f.getSpatialQueryOperator(Q,oa,R.geometryType,R.hasZ,R.hasM);return new b.default(yield R._runSpatialFilter(ha,da=>!T.has(va.getObjectId(da))||ca(va.getGeometry(da)),L),Z,R)}),L);return fa(I)}G=this._searchFeatures(this._getQueryBBoxes(Z));if(!G.length)return fa=
new b.default([],Z,this),Ca&&this._geometryQueryCache.put(Ca,fa,fa.size||1),fa;if(this._canExecuteSoloPass(oa,I))return fa(new b.default(G,Z,this));const S=yield f.getSpatialQueryOperator(Q,oa,this.geometryType,this.hasZ,this.hasM);I=yield this._runSpatialFilter(G,ha=>S(va.getGeometry(ha)),L);return fa(new b.default(I,Z,this))});return function(I,L){return D.apply(this,arguments)}}();K._runSpatialFilter=function(){var D=t._asyncToGenerator(function*(I,L,R){var Z=this;if(!L)return I;if(v.isNone(this._frameTask))return I.filter(V=>
L(V));let X=0;const Q=[],M=function(){var V=t._asyncToGenerator(function*(fa){for(;X<I.length;){const oa=I[X++];L(oa)&&(Q.push(oa),fa.madeProgress());fa.done&&(yield Z._reschedule(ua=>M(ua),R))}});return function(fa){return V.apply(this,arguments)}}();return this._reschedule(V=>M(V),R).then(()=>Q)});return function(I,L,R){return D.apply(this,arguments)}}();K._canExecuteSoloPass=function(D,I){const {geometryType:L}=this;({spatialRel:I}=I);return f.canQueryWithRBush(D)&&("esriSpatialRelEnvelopeIntersects"===
I||"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===I||"esriSpatialRelContains"===I||"esriSpatialRelWithin"===I))};K._getQueryBBoxes=function(D){if(f.canQueryWithRBush(D)){if(k.isExtent(D))return[e.fromValues(D.xmin,D.ymin,D.xmax,D.ymax)];if(k.isPolygon(D))return D.rings.map(I=>e.fromValues(Math.min(I[0][0],I[2][0]),Math.min(I[0][1],I[2][1]),Math.max(I[0][0],I[2][0]),Math.max(I[0][1],I[2][1])))}return[h.getBoundsXY(e.create(),D)]};K._searchFeatures=function(D){for(const R of D)this.featureStore.forEachInBounds(R,
Z=>{u.add(Z)});const I=Array(u.size);let L=0;u.forEach(R=>I[L++]=R);u.clear();return I};K._checkStatisticsSupport=function(){var D=t._asyncToGenerator(function*(I,L){if(0>I.distance||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text||I.outStatistics||I.groupByFieldsForStatistics||I.having||I.orderByFields)throw new F("feature-store:unsupported-query","Unsupported query options",{query:I});return Promise.all([this._checkAttributesQuerySupport(I),this._checkStatisticsParamsSupport(L),
f.checkSpatialQuerySupport(I,this.geometryType,this.spatialReference),d.checkProjectionSupport(this.spatialReference,I.outSR)]).then(()=>I)});return function(I,L){return D.apply(this,arguments)}}();K._checkStatisticsParamsSupport=function(){var D=t._asyncToGenerator(function*(I){var L=[];I.valueExpression&&({arcadeUtils:L}=yield q.loadArcade(),L=L.extractFieldNames(I.valueExpression));I.field&&L.push(I.field);I.normalizationField&&L.push(I.normalizationField);if(!L.length)throw new F("feature-store:unsupported-query",
"params should have at least a field or valueExpression",{params:I});c.validateFields(this.fieldsIndex,L,"params contains missing fields")});return function(I){return D.apply(this,arguments)}}();K._checkQuerySupport=function(){var D=t._asyncToGenerator(function*(I){if(0>I.distance||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text)throw new F("feature-store:unsupported-query","Unsupported query options",{query:I});return Promise.all([this._checkAttributesQuerySupport(I),
this._checkStatisticsQuerySupport(I),f.checkSpatialQuerySupport(I,this.geometryType,this.spatialReference),d.checkProjectionSupport(this.spatialReference,I.outSR)]).then(()=>I)});return function(I){return D.apply(this,arguments)}}();K._checkAttributesQuerySupport=function(D){const {outFields:I,orderByFields:L,returnDistinctValues:R,outStatistics:Z}=D,X=Z?Z.map(Q=>Q.outStatisticFieldName&&Q.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(L&&0<L.length){const Q=L.map(M=>{const V=M.toLowerCase();
return-1<V.indexOf(" asc")?V.split(" asc")[0]:-1<V.indexOf(" desc")?V.split(" desc")[0]:M}).filter(M=>-1===X.indexOf(M));c.validateFields(this.fieldsIndex,Q,"orderByFields contains missing fields")}if(I&&0<I.length)c.validateFields(this.fieldsIndex,I,"outFields contains missing fields");else if(R)throw new F("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:D});c.validateWhere(this.fieldsIndex,D.where)};K._checkStatisticsQuerySupport=function(){var D=
t._asyncToGenerator(function*(I){const {outStatistics:L,groupByFieldsForStatistics:R,having:Z}=I;var X=R&&R.length,Q=L&&L.length;if(Z){if(!X||!Q)throw new F("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:I});c.validateHaving(this.fieldsIndex,Z,L)}if(Q&&z(L)){Q=L.map(M=>M.onStatisticField).filter(Boolean);c.validateFields(this.fieldsIndex,Q,"onStatisticFields contains missing fields");X&&c.validateFields(this.fieldsIndex,R,"groupByFieldsForStatistics contains missing fields");
for(const M of L){const {onStatisticField:V,statisticType:fa}=M;if(("percentile_disc"===fa||"percentile_cont"===fa)&&"statisticParameters"in M){if({statisticParameters:X}=M,!X)throw new F("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:M,query:I});}else if("count"!==fa&&V&&c.hasInvalidFieldType(V,this.fieldsIndex))throw new F("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:M,query:I});}}});return function(I){return D.apply(this,
arguments)}}();K._getQueryEngineResultForStats=function(){var D=t._asyncToGenerator(function*(I={},L,R){I=C.clone(I);let Z;try{I=yield this._schedule(()=>g.normalizeQuery(I,this.definitionExpression,this.spatialReference),R),I=yield this._reschedule(()=>this._checkStatisticsSupport(I,L),R),Z=yield this._reschedule(()=>this._executeGeometryQuery(I,R),R),Z=yield this._reschedule(()=>Z.executeAggregateIdsQuery(I),R),Z=yield this._reschedule(()=>Z.executeObjectIdsQuery(I),R),Z=yield this._reschedule(()=>
Z.executeTimeQuery(I),R),Z=yield this._reschedule(()=>Z.executeAttributesQuery(I),R)}catch(X){if(X!==g.QUERY_ENGINE_EMPTY_RESULT)throw X;Z=new b.default([],null,this)}return Z});return function(){return D.apply(this,arguments)}}();t._createClass(O,[{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){const D=this.featureStore.fullBounds;return D?{xmin:D[0],ymin:D[1],xmax:D[2],ymax:D[3],spatialReference:g.cleanFromGeometryEngine(this.spatialReference)}:
null}},{key:"timeExtent",get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=m.getTimeExtent(this.timeInfo,this.featureStore):null}}]);return O}();const J=l.create(),P=l.create();r.Feature=function(O,K=null,D,I,L){this.attributes=O;this.geometry=D;this.centroid=I;this.filterFlags=L;this.groupId=-1;this.displayId=K};r.default=H;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers",
"./maybe","./PooledArray"],function(r,t,F,C){r.RemoveMode=void 0;(function(w){w[w.ALL=0]="ALL";w[w.SOME=1]="SOME"})(r.RemoveMode||(r.RemoveMode={}));let v=function(){function w(e,h,k){this._namespace=e;this._storage=h;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";k&&(this._storage.registerRemoveFunc(this._namespace,k),this._removeFunc=!0)}var l=w.prototype;l.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);
this._storage.deregister(this);this._storage=null};l.resetHitRate=function(){this._hit=this._miss=0};l.put=function(e,h,k,n=0){this._storage.put(this._namespace+e,h,k,n)};l.get=function(e){e=this._storage.get(this._namespace+e);void 0===e?++this._miss:++this._hit;return e};l.pop=function(e){e=this._storage.pop(this._namespace+e);void 0===e?++this._miss:++this._hit;return e};l.updateSize=function(e,h,k){this._storage.updateSize(this._namespace+e,h,k)};l.clear=function(){this._storage.clear(this._namespace)};
l.clearAll=function(){this._storage.clearAll()};l.getStats=function(){return this._storage.getStats()};l.resetStats=function(){this._storage.resetStats()};t._createClass(w,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}}]);return w}(),A=function(){function w(e=10485760){this._maxSize=e;this._db=
new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new C;this._users=new C}var l=w.prototype;l.destroy=function(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null};l.register=function(e){this._users.push(e)};l.deregister=function(e){this._users.removeUnordered(e)};l.registerRemoveFunc=function(e,h){this._removeFuncs.push([e,h])};l.deregisterRemoveFunc=function(e){this._removeFuncs.filterInPlace(h=>h[0]!==e)};l.put=function(e,h,k,n){const p=this._db.get(e);p&&(this._size-=
p.size,this._db.delete(e),p.entry!==h&&this._notifyRemove(e,p.entry,r.RemoveMode.ALL));k>this._maxSize?this._notifyRemove(e,h,r.RemoveMode.ALL):void 0===h?console.warn("Refusing to cache undefined entry "):!k||0>k?console.warn("Refusing to cache entry with invalid size "+k):(n=1+Math.max(n,-3)- -3,this._db.set(e,{entry:h,size:k,lifetime:n,lives:n}),this._size+=k,this._checkSizeLimit())};l.updateSize=function(e,h,k){const n=this._db.get(e);if(n&&n.entry===h){for(this._size-=n.size;k>this._maxSize;)if(k=
this._notifyRemove(e,h,r.RemoveMode.SOME),!(F.isSome(k)&&0<k)){this._db.delete(e);return}n.size=k;this._size+=k;this._checkSizeLimit()}};l.pop=function(e){const h=this._db.get(e);if(h)return this._size-=h.size,this._db.delete(e),++this._hit,h.entry;++this._miss};l.get=function(e){const h=this._db.get(e);if(void 0===h)++this._miss;else return this._db.delete(e),h.lives=h.lifetime,this._db.set(e,h),++this._hit,h.entry};l.getStats=function(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/
1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},h={},k=[];this._db.forEach((c,d)=>{const a=c.lifetime;k[a]=(k[a]||0)+c.size;this._users.forAll(b=>{b=b.namespace;d.startsWith(b)&&(h[b]=(h[b]||0)+c.size)})});const n={};this._users.forAll(c=>{const d=c.namespace;!isNaN(c.hitRate)&&0<c.hitRate?(h[d]=h[d]||0,n[d]=Math.round(100*c.hitRate)+"%"):n[d]="0%"});var p=Object.keys(h);p.sort((c,d)=>h[d]-h[c]);p.forEach(c=>e[c]=Math.round(h[c]/2**20)+"MB / "+n[c]);
for(p=k.length-1;0<=p;--p){const c=k[p];c&&(e["Priority "+(p+-3-1)]=Math.round(c/this.size*100)+"%")}return e};l.resetStats=function(){this._hit=this._miss=0;this._users.forAll(e=>e.resetHitRate())};l.clear=function(e){this._db.forEach((h,k)=>{k.startsWith(e)&&(this._size-=h.size,this._db.delete(k),this._notifyRemove(k,h.entry,r.RemoveMode.ALL))})};l.clearAll=function(){this._db.forEach((e,h)=>this._notifyRemove(h,e.entry,r.RemoveMode.ALL));this._size=0;this._db.clear()};l._getHitRate=function(){return this._hit/
(this._hit+this._miss)};l._notifyRemove=function(e,h,k){let n;this._removeFuncs.some(p=>e.startsWith(p[0])?(p=p[1](h,k),"number"===typeof p&&(n=p),!0):!1);return n};l._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [e,h]of this._db){this._db.delete(e);if(1>=h.lives){this._size-=h.size;const k=this._notifyRemove(e,h.entry,r.RemoveMode.SOME);F.isSome(k)&&0<k&&(this._size+=k,h.lives=h.lifetime,h.size=k,this._db.set(e,h))}else--h.lives,this._db.set(e,h);if(this._size<=.9*this.maxSize)break}};
t._createClass(w,[{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0);this._checkSizeLimit()}}]);return w}();r.MIN_PRIORITY=-3;r.MemCache=v;r.MemCacheStorage=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent","./aaBoundingRect"],function(r,t,F,C){function v(a=c){return[a[0],a[1],a[2],a[3],a[4],a[5]]}function A(a,
b,f,m,g,x,q=v()){q[0]=a;q[1]=b;q[2]=f;q[3]=m;q[4]=g;q[5]=x;return q}function w(a){return a[0]>=a[3]?0:a[3]-a[0]}function l(a){return a[1]>=a[4]?0:a[4]-a[1]}function e(a){return a[2]>=a[5]?0:a[5]-a[2]}function h(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])}function k(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function n(a){return 6===a.length}const p=[Infinity,Infinity,Infinity,
-Infinity,-Infinity,-Infinity],c=[0,0,0,0,0,0],d=v();r.NEGATIVE_INFINITY=p;r.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];r.ZERO=c;r.allFinite=function(a){for(let b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};r.center=function(a,b=[0,0,0]){b[0]=a[0]+w(a)/2;b[1]=a[1]+l(a)/2;b[2]=a[2]+e(a)/2;return b};r.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};r.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&
b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};r.containsPointWithMargin=function(a,b,f){return b[0]>=a[0]-f&&b[1]>=a[1]-f&&b[2]>=a[2]-f&&b[0]<=a[3]+f&&b[1]<=a[4]+f&&b[2]<=a[5]+f};r.create=v;r.depth=l;r.diameter=function(a){const b=w(a),f=e(a);a=l(a);return Math.sqrt(b*b+f*f+a*a)};r.empty=function(a){return a?k(a,p):v(p)};r.equals=function(a,b,f){if(t.isNone(a)||t.isNone(b))return a===b;if(!n(a)||!n(b))return!1;if(f)for(let m=0;m<a.length;m++){if(!f(a[m],b[m]))return!1}else for(f=0;f<a.length;f++)if(a[f]!==
b[f])return!1;return!0};r.expandWithAABB=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[3]);a[4]=Math.max(a[4],b[4]);a[5]=Math.max(a[5],b[5])};r.expandWithBuffer=function(a,b,f=0,m=b.length/3){let g=a[0],x=a[1],q=a[2],B=a[3],z=a[4],u=a[5];for(let y=0;y<m;y++)g=Math.min(g,b[f+3*y]),x=Math.min(x,b[f+3*y+1]),q=Math.min(q,b[f+3*y+2]),B=Math.max(B,b[f+3*y]),z=Math.max(z,b[f+3*y+1]),u=Math.max(u,b[f+3*y+2]);a[0]=g;a[1]=x;a[2]=q;a[3]=B;a[4]=
z;a[5]=u};r.expandWithNestedArray=function(a,b,f){const m=b.length;let g=a[0],x=a[1],q=a[2],B=a[3],z=a[4],u=a[5];if(f)for(f=0;f<m;f++){var y=b[f];g=Math.min(g,y[0]);x=Math.min(x,y[1]);q=Math.min(q,y[2]);B=Math.max(B,y[0]);z=Math.max(z,y[1]);u=Math.max(u,y[2])}else for(f=0;f<m;f++)y=b[f],g=Math.min(g,y[0]),x=Math.min(x,y[1]),B=Math.max(B,y[0]),z=Math.max(z,y[1]);a[0]=g;a[1]=x;a[2]=q;a[3]=B;a[4]=z;a[5]=u};r.expandWithOffset=function(a,b,f,m){a[0]=Math.min(a[0],a[0]+b);a[3]=Math.max(a[3],a[3]+b);a[1]=
Math.min(a[1],a[1]+f);a[4]=Math.max(a[4],a[4]+f);a[2]=Math.min(a[2],a[2]+m);a[5]=Math.max(a[5],a[5]+m)};r.expandWithRect=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[3]=Math.max(a[3],b[2]);a[4]=Math.max(a[4],b[3])};r.expandWithVec3=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[0]);a[4]=Math.max(a[4],b[1]);a[5]=Math.max(a[5],b[2])};r.fromExtent=function(a,b=v()){b[0]=a.xmin;b[1]=a.ymin;b[2]=a.zmin;b[3]=a.xmax;b[4]=
a.ymax;b[5]=a.zmax;return b};r.fromMinMax=function(a,b,f=v()){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=b[0];f[4]=b[1];f[5]=b[2];return f};r.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=b[2];a[4]=b[3];a[5]=Number.POSITIVE_INFINITY;return a};r.fromValues=A;r.getMax=function(a,b){b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};r.getMin=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};r.height=e;r.intersects=h;r.intersectsClippingArea=function(a,b){return t.isNone(b)?!0:h(a,b)};
r.is=n;r.isPoint=function(a){return 0===w(a)&&0===l(a)&&0===e(a)};r.maximumDimension=function(a){return Math.max(w(a),e(a),l(a))};r.offset=function(a,b,f,m,g=a){g[0]=a[0]+b;g[1]=a[1]+f;g[2]=a[2]+m;g[3]=a[3]+b;g[4]=a[4]+f;g[5]=a[5]+m;return g};r.scale=function(a,b,f=a){const m=a[0]+w(a)/2,g=a[1]+l(a)/2,x=a[2]+e(a)/2;f[0]=m+(a[0]-m)*b;f[1]=g+(a[1]-g)*b;f[2]=x+(a[2]-x)*b;f[3]=m+(a[3]-m)*b;f[4]=g+(a[4]-g)*b;f[5]=x+(a[5]-x)*b;return f};r.set=k;r.setMax=function(a,b,f=a){f[3]=b[0];f[4]=b[1];f[5]=b[2];f!==
a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2]);return a};r.setMin=function(a,b,f=a){f[0]=b[0];f[1]=b[1];f[2]=b[2];f!==a&&(f[3]=a[3],f[4]=a[4],f[5]=a[5]);return f};r.size=function(a,b=[0,0,0]){b[0]=w(a);b[1]=l(a);b[2]=e(a);return b};r.toExtent=function(a,b){return isFinite(a[2])||isFinite(a[5])?new F({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:b}):new F({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};r.toRect=function(a,b){b||(b=C.create());b[0]=a[0];b[1]=a[1];
b[2]=a[3];b[3]=a[4];return b};r.width=w;r.wrap=function(a,b,f,m,g,x){return A(a,b,f,m,g,x,d)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometry/cut ../../rest/geometry/simplify".split(" "),function(r,t,F,C,v,A,w,l,e,h,k,
n,p){function c(q){const B=[];let z=0,u=0;for(let y=0;y<q.length;y++){const E=q[y];let H=null;for(let J=0;J<E.length;J++)H=E[J],B.push(H),0===J?u=z=H[0]:(z=Math.min(z,H[0]),u=Math.max(u,H[0]));H&&B.push([(z+u)/2,0])}return B}function d(q,B){if(!(q instanceof l||q instanceof w))throw x.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new C("straightLineDensify: the input geometry is neither polyline nor polygon");var z=e.getGeometryParts(q);const u=[];for(const E of z){z=
[];u.push(z);z.push([E[0][0],E[0][1]]);for(let H=0;H<E.length-1;H++){const J=E[H][0],P=E[H][1],O=E[H+1][0],K=E[H+1][1];var y=Math.sqrt((O-J)*(O-J)+(K-P)*(K-P));const D=(K-P)/y,I=(O-J)/y,L=y/B;if(1<L){for(let R=1;R<=L-1;R++){const Z=R*B;z.push([I*Z+J,D*Z+P])}y=(y+Math.floor(L-1)*B)/2;z.push([I*y+J,D*y+P])}z.push([O,K])}}return"polygon"===q.type?new w({rings:u,spatialReference:q.spatialReference}):new l({paths:u,spatialReference:q.spatialReference})}function a(q,B,z){B&&(q=d(q,1E6),q=k.webMercatorToGeographic(q,
!0));z&&(q=e.updatePolyGeometry(q,z));return q}function b(q,B,z){if(Array.isArray(q)){var u=q[0];u>B?(z=e.offsetMagnitude(u,B),q[0]=u+-2*z*B):u<z&&(B=e.offsetMagnitude(u,z),q[0]=u+-2*B*z)}else u=q.x,u>B?(z=e.offsetMagnitude(u,B),q=q.clone().offset(-2*z*B,0)):u<z&&(B=e.offsetMagnitude(u,z),q=q.clone().offset(-2*B*z,0));return q}function f(q,B){let z=-1;for(let u=0;u<B.cutIndexes.length;u++){const y=B.cutIndexes[u],E=B.geometries[u],H=e.getGeometryParts(E);for(let J=0;J<H.length;J++){const P=H[J];P.some(O=>
{if(180>O[0])return!0;O=0;for(var K=0;K<P.length;K++){var D=P[K][0];O=D>O?D:O}O=Number(O.toFixed(9));O=-360*e.offsetMagnitude(O,180);for(K=0;K<P.length;K++)D=E.getPoint(J,K),E.setPoint(J,K,D.clone().offset(O,0));return!0})}if(y===z)if("polygon"===q[0].type)for(const J of e.getGeometryParts(E))q[y]=q[y].addRing(J);else{if("polyline"===q[0].type)for(const J of e.getGeometryParts(E))q[y]=q[y].addPath(J)}else z=y,q[y]=E}return q}function m(q,B,z){return g.apply(this,arguments)}function g(){g=t._asyncToGenerator(function*(q,
B,z){var u;if(!Array.isArray(q))return m([q],B);B=null!=(u=null==B?void 0:B.url)?u:F.geometryServiceUrl;let y,E,H;let J=0;var P=[];u=[];for(var O of q)if(A.isNone(O))u.push(O);else{if(!K){var K=O.spatialReference;var D=h.getInfo(K);var I=(y=K.isWebMercator)?102100:4326;E=e.cutParams[I].maxX;H=e.cutParams[I].minX;var L=e.cutParams[I].plus180Line;I=e.cutParams[I].minus180Line}if(D)if("mesh"===O.type)u.push(O);else if("point"===O.type)u.push(b(O.clone(),E,H));else if("multipoint"===O.type){var R=O.clone();
R.points=R.points.map(Z=>b(Z,E,H));u.push(R)}else if("extent"===O.type)R=O.clone()._normalize(!1,!1,D),u.push(R.rings?new w(R):R);else if(O.extent){R=O.extent;const Z=2*e.offsetMagnitude(R.xmin,H)*E;let X=0===Z?O.clone():e.updatePolyGeometry(O.clone(),Z);R.offset(Z,0);R.intersects(L)&&R.xmax!==E?(J=R.xmax>J?R.xmax:J,X=a(X,y),P.push(X),u.push("cut")):R.intersects(I)&&R.xmin!==H?(J=2*R.xmax*E>J?2*R.xmax*E:J,X=a(X,y,360),P.push(X),u.push("cut")):u.push(X)}else u.push(O.clone());else u.push(O)}K=e.offsetMagnitude(J,
E);D=-90;L=K;for(O=new l;0<K;)I=-180+360*K,O.addPath([[I,D],[I,-1*D]]),D*=-1,K--;if(0<P.length&&0<L){K=yield n.cut(B,P,O,z);K=f(P,K);D=[];P=[];for(L=0;L<u.length;L++)O=u[L],"cut"!==O?P.push(O):(O=K.shift(),I=q[L],A.isSome(I)&&"polygon"===I.type&&I.rings&&1<I.rings.length&&O.rings.length>=I.rings.length?(D.push(O),P.push("simplify")):P.push(y?k.geographicToWebMercator(O):O));if(!D.length)return P;u=yield p.simplify(B,D,z);q=[];for(z=0;z<P.length;z++)B=P[z],"simplify"!==B?q.push(B):q.push(y?k.geographicToWebMercator(u.shift()):
u.shift());return q}q=[];for(z=0;z<u.length;z++)B=u[z],"cut"!==B?q.push(B):(B=P.shift(),q.push(!0===y?k.geographicToWebMercator(B):B));return Promise.resolve(q)});return g.apply(this,arguments)}const x=v.getLogger("esri.geometry.support.normalizeUtils");r.getDenormalizedExtent=function(q){if(!q)return null;const B=q.extent;if(!B)return null;var z=q.spatialReference&&h.getInfo(q.spatialReference);if(!z)return B;const [u,y]=z.valid;({width:z}=B);let {xmin:E,xmax:H}=B;[E,H]=[H,E];if("extent"===q.type||
0===z||z<=y||z>2*y||E<u||H>y)return B;let J;switch(q.type){case "polygon":if(1<q.rings.length)J=c(q.rings);else return B;break;case "polyline":if(1<q.paths.length)J=c(q.paths);else return B;break;case "multipoint":J=q.points}q=B.clone();for(let P=0;P<J.length;P++){let O=J[P][0];0>O?(O+=y,H=Math.max(O,H)):(O-=y,E=Math.min(O,E))}q.xmin=E;q.xmax=H;return q.width<z?(q.xmin-=y,q.xmax-=y,q):B};r.normalizeCentralMeridian=m;r.normalizeMapX=function(q,B){if(B=h.getInfo(B)){const [z,u]=B.valid;B=u-z;if(q<z)for(;q<
z;)q+=B;if(q>u)for(;q>u;)q-=B}return q};r.straightLineDensify=d;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(r,t,F,C){function v(w){return C.isPolygon(w)?w.rings:w.paths}const A={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new t({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:F.WebMercator}),
minus180Line:new t({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:F.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new t({paths:[[[180,-180],[180,180]]],spatialReference:F.WGS84}),minus180Line:new t({paths:[[[-180,-180],[-180,180]]],spatialReference:F.WGS84})}};r.cutParams=A;r.getGeometryParts=v;r.getSpatialReferenceMinMaxX=function(w){w=(null==w?0:w.isWebMercator)?102100:4326;return[A[w].minX,A[w].maxX]};r.offsetMagnitude=
function(w,l){return Math.ceil((w-l)/(2*l))};r.updatePolyGeometry=function(w,l){const e=v(w);for(const h of e)for(const k of h)k[0]+=l;return w};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/geometry/cut":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(r,t,F,C,v,A){function w(){w=t._asyncToGenerator(function*(l,e,h,k){l="string"===typeof l?v.urlToObject(l):l;const n=
e[0].spatialReference;e={...k,query:{...l.query,f:"json",sr:JSON.stringify(n),target:JSON.stringify({geometryType:A.getJsonType(e[0]),geometries:e}),cutter:JSON.stringify(h)}};e=yield C(l.path+"/cut",e);const {cutIndexes:p,geometries:c=[]}=e.data;return{cutIndexes:p,geometries:c.map(d=>{d=A.fromJSON(d);d.spatialReference=n;return d})}});return w.apply(this,arguments)}r.cut=function(l,e,h,k){return w.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/geometry/simplify":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../request","../../core/urlUtils","../../geometry/support/jsonUtils"],function(r,t,F,C,v){function A(){A=t._asyncToGenerator(function*(e,h,k){const n="string"===typeof e?C.urlToObject(e):e;e=h[0].spatialReference;const p=v.getJsonType(h[0]);h={...k,query:{...n.query,f:"json",sr:e.wkid?e.wkid:JSON.stringify(e),geometries:JSON.stringify(w(h))}};h=yield F(n.path+"/simplify",h);return l(h.data,p,e)});return A.apply(this,arguments)}function w(e){return{geometryType:v.getJsonType(e[0]),
geometries:e.map(h=>h.toJSON())}}function l(e,h,k){const n=v.getGeometryType(h);return e.map(p=>{p=n.fromJSON(p);p.spatialReference=k;return p})}r.simplify=function(e,h,k){return A.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(r,t,F){function C(e,h){return e?w.get(e,h):null}function v(e,h,k,n=!0){const p=[];for(const c of h)if("*"!==
c&&!e.has(c))if(n){h=A(c);try{const d=C(h,e);if(!d)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:h});if(!d.isStandardized)throw new t("feature-store:unsupported-query","expression is not standard",{clause:d});v(e,d.fieldNames,"expression contains missing fields")}catch(d){if((h=d&&d.details)&&(h.clause||h.where))throw d;h&&h.missingFields?p.push(...h.missingFields):p.push(c)}}else p.push(c);if(p.length)throw new t("feature-store:unsupported-query",k,{missingFields:p});
}function A(e){return e.split(" as ")[0]}const w=new F.WhereClauseCache(50,500),l=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));r.getAliasFromFieldName=function(e){return e.split(" as ")[1]};r.getExpressionFromFieldName=A;r.getWhereClause=C;r.hasInvalidFieldType=function(e,h){return(e=h.get(e))?!l.has(e.type):!1};r.validateFields=v;r.validateHaving=function(e,h,k){if(!h)return!0;const n=
w.get(h,e);if(!n)throw new t("feature-store:unsupported-query","invalid SQL expression",{having:h});if(!n.isAggregate)throw new t("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:h});v(e,n.fieldNames,"having contains missing fields");if(!n.getExpressions().every(p=>{const {aggregateType:c,field:d}=p,a=e.has(d)&&e.get(d).name;return k.some(b=>{const {onStatisticField:f,statisticType:m}=b;return(e.has(f)&&e.get(f).name)===a&&m.toLowerCase().trim()===c})}))throw new t("feature-store:unsupported-query",
"expressions in having should also exist in outStatistics",{having:h});return!0};r.validateWhere=function(e,h){if(!h)return!0;const k=w.get(h,e);if(!k)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:h});if(!k.isStandardized)throw new t("feature-store:unsupported-query","where clause is not standard",{where:h});v(e,k.fieldNames,"where clause contains missing fields");return!0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/WhereClauseCache":function(){define(["exports",
"../ItemCache","./WhereClause"],function(r,t,F){let C=function(){function v(A,w){this._cache=new t(A);this._invalidCache=new t(w)}v.prototype.get=function(A,w){const l=`${w.uid}:${A}`,e=this._cache.get(l);if(e)return e;if(void 0!==this._invalidCache.get(l))return null;try{const h=F.WhereClause.create(A,w);this._cache.put(l,h);return h}catch{return this._invalidCache.put(l,null),null}};return v}();r.WhereClauseCache=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],
function(r){return function(){function t(C,v){this._storage=new r.MemCacheStorage;this._storage.maxSize=C;v&&this._storage.registerRemoveFunc("",v)}var F=t.prototype;F.put=function(C,v){this._storage.put(C,v,1,1)};F.pop=function(C){return this._storage.pop(C)};F.get=function(C){return this._storage.get(C)};F.clear=function(){this._storage.clearAll()};F.destroy=function(){this._storage.destroy()};return t}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(r,t,F,C,v,A){function w(O,K){O+="";return O.length>=K?O:Array(K-O.length+1).join("0")+O}function l(O,K,D="0",I="0",L="0",R="0",Z="",X="0",Q="0"){return"+"===Z||"-"===Z?(O=`${w(parseInt(O,10),4)}-${w(parseInt(K,10),2)}-${w(parseInt(D,10),2)}`,K="",10>parseFloat(R)&&(K="0"),I=`${w(parseInt(I,10),2)}:${w(parseInt(L,10),2)}:${K+parseFloat(R).toString()}`,Z=`${Z}${w(parseInt(X,10),2)}:${w(parseInt(Q,10),2)}`,new Date(O+"T"+I+Z)):new Date(parseInt(O,10),parseInt(K,10)-1,parseInt(D,10),parseInt(I,
10),parseInt(L,10),parseFloat(R))}function e(O){let K=q.exec(O);if(null!==K){const [,D,I,L,R,Z,X]=K;return l(D,I,L,R,Z,X)}K=B.exec(O);if(null!==K){const [,D,I,L,R,Z,X,Q,M,V]=K;return l(D,I,L,R,Z,X,Q,M,V)}K=z.exec(O);if(null!==K){const [,D,I,L,R,Z,X,Q,M]=K;return l(D,I,L,R,Z,"0",X,Q,M)}K=u.exec(O);if(null!==K){const [,D,I,L,R,Z]=K;return l(D,I,L,R,Z)}K=x.exec(O);if(null!==K){const [,D,I,L]=K;return l(D,I,L)}throw Error("SQL Invalid Timestamp");}function h(O){O=x.exec(O);if(null===O)throw Error("SQL Invalid Date");
const [,K,D,I]=O;return new Date(parseInt(K,10),parseInt(D,10)-1,parseInt(I,10))}function k(O){return Array.isArray(O)?O:[O]}function n(O){return null!==O?!0!==O:null}function p(O,K){return null!=O&&null!=K?!0===O&&!0===K:!1===O||!1===K?!1:null}function c(O,K){return null!=O&&null!=K?!0===O||!0===K:!0===O||!0===K?!0:null}function d(O,K){if(null==O)return null;let D=!1;for(const I of K)if(null==I)D=null;else if(O===I){D=!0;break}return D}function a(O,K,D){if(null==O)return null;{let I="",L=J.Normal;
for(let R=0;R<K.length;R++){const Z=K.charAt(R);switch(L){case J.Normal:Z===D?L=J.Escaped:I="-[]/{}()*+?.\\^$|".includes(Z)?I+("\\"+Z):"%"===Z?I+".*":"_"===Z?I+".":I+Z;break;case J.Escaped:I="-[]/{}()*+?.\\^$|".includes(Z)?I+("\\"+Z):I+Z,L=J.Normal}}K=new RegExp("^"+I+"$","m")}return K.test(O)}function b(O){return O instanceof Date?O.valueOf():O}function f(O,K,D){if(null==K||null==D)return null;K=b(K);D=b(D);switch(O){case "\x3c\x3e":return K!==D;case "\x3d":return K===D;case "\x3e":return K>D;case "\x3c":return K<
D;case "\x3e\x3d":return K>=D;case "\x3c\x3d":return K<=D}}function m(O,K,D){if(K instanceof v.SqlInterval)if(D instanceof Date)switch(O){case "+":return new Date(K.valueInMilliseconds()+D.getTime());case "-":return K.valueInMilliseconds()-D.getTime();case "*":return K.valueInMilliseconds()*D.getTime();case "/":return K.valueInMilliseconds()/D.getTime()}else if(D instanceof v.SqlInterval)switch(O){case "+":return v.SqlInterval.createFromMilliseconds(K.valueInMilliseconds()+D.valueInMilliseconds());
case "-":return v.SqlInterval.createFromMilliseconds(K.valueInMilliseconds()-D.valueInMilliseconds());case "*":return K.valueInMilliseconds()*D.valueInMilliseconds();case "/":return K.valueInMilliseconds()/D.valueInMilliseconds()}else K=K.valueInMilliseconds();else if(D instanceof v.SqlInterval)if(K instanceof Date)switch(O){case "+":return new Date(D.valueInMilliseconds()+K.getTime());case "-":return new Date(K.getTime()-D.valueInMilliseconds());case "*":return K.getTime()*D.valueInMilliseconds();
case "/":return K.getTime()/D.valueInMilliseconds()}else D=D.valueInMilliseconds();else if(K instanceof Date&&"number"===typeof D)switch(D*=864E5,K=K.getTime(),O){case "+":return new Date(K+D);case "-":return new Date(K-D);case "*":return new Date(K*D);case "/":return new Date(K/D)}else if(D instanceof Date&&"number"===typeof K)switch(K*=864E5,D=D.getTime(),O){case "+":return new Date(K+D);case "-":return new Date(K-D);case "*":return new Date(K*D);case "/":return new Date(K/D)}switch(O){case "+":return K+
D;case "-":return K-D;case "*":return K*D;case "/":return K/D}}function g(O,K,D,I){O=I.getAttribute(O,K);return null!=O&&1===D[K]?new Date(O):O}const x=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,z=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,y=new Set(["current_timestamp",
"current_date","current_time"]);let E=function(){function O(){}O.makeBool=function(K){return!0===K};O.featureValue=function(K,D,I,L){return g(K,D,I,L)};O.equalsNull=function(K){return null===K};O.applyLike=function(K,D,I){return a(K,D,I)};O.ensureArray=function(K){return k(K)};O.applyIn=function(K,D){return d(K,D)};O.currentDate=function(){const K=new Date;K.setHours(0,0,0,0);return K};O.makeSqlInterval=function(K,D,I){return v.SqlInterval.createFromValueAndQualifer(K,D,I)};O.convertInterval=function(K){return K instanceof
v.SqlInterval?K.valueInMilliseconds():K};O.currentTimestamp=function(){return new Date};O.compare=function(K,D,I){return f(K,D,I)};O.calculate=function(K,D,I){return m(K,D,I)};O.makeComparable=function(K){return b(K)};O.evaluateFunction=function(K,D){return v.evaluateFunction(K,D)};O.lookup=function(K,D){K=D[K];return void 0===K?null:K};O.between=function(K,D){return null==K||null==D[0]||null==D[1]?null:K>=D[0]&&K<=D[1]};O.notbetween=function(K,D){return null==K||null==D[0]||null==D[1]?null:K<D[0]||
K>D[1]};O.ternaryNot=function(K){return n(K)};O.ternaryAnd=function(K,D){return p(K,D)};O.ternaryOr=function(K,D){return c(K,D)};return O}(),H=function(){function O(D,I){this.fieldsIndex=I;this.datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=A.WhereGrammar.parse(D);const {isStandardized:L,isAggregate:R,referencedFieldNames:Z}=this._extractExpressionInfo(I);this.referencedFieldNames=Z;this.isStandardized=L;this.isAggregate=R}O.create=function(D,I){return new O(D,I)};var K=
O.prototype;K.testSet=function(D,I=P){const L={};for(const R of this.fieldNames)L[R]=D.map(Z=>I.getAttribute(Z,R));return!!this._evaluateNode(this.parseTree,{attributes:L},P)};K.calculateValue=function(D,I=P){D=this._evaluateNode(this.parseTree,D,I);return D instanceof v.SqlInterval?D.valueInMilliseconds()/864E5:D};K.calculateValueCompiled=function(D,I=P){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(D,this.parameters,I,this.datefields);if(F("esri-csp-restrictions"))return this.calculateValue(D,
I);this._compileMe();return this.parseTree._compiledVersion(D,this.parameters,I,this.datefields)};K.testFeature=function(D,I=P){return!!this._evaluateNode(this.parseTree,D,I)};K.testFeatureCompiled=function(D,I=P){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(D,this.parameters,I,this.datefields);if(F("esri-csp-restrictions"))return this.testFeature(D,I);this._compileMe();return!!this.parseTree._compiledVersion(D,this.parameters,I,this.datefields)};K.getFunctions=
function(){const D=new Set;this._visitAll(this.parseTree,I=>{"function"===I.type&&D.add(I.name.toLowerCase())});return Array.from(D)};K.getExpressions=function(){const D=new Map;this._visitAll(this.parseTree,I=>{if("function"===I.type){const L=I.name.toLowerCase();I=I.args.value[0];if("column_ref"===I.type){I=I.column;const R=`${L}-${I}`;D.has(R)||D.set(R,{aggregateType:L,field:I})}}});return[...D.values()]};K.getVariables=function(){const D=new Set;this._visitAll(this.parseTree,I=>{"param"===I.type&&
D.add(I.value.toLowerCase())});return Array.from(D)};K._compileMe=function(){const D="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",D)).bind(E)};K._extractExpressionInfo=function(D){const I=[],L=new Set;let R=!0,Z=!0;this._visitAll(this.parseTree,X=>{switch(X.type){case "column_ref":{const Q=D.get(X.column);let M,V;Q?M=V=Q.name:(V=X.column,M=V.toLowerCase());!Q||"date"!==
Q.type&&"esriFieldTypeDate"!==Q.type||(this.datefields[Q.name]=1);L.has(M)||(L.add(M),I.push(V));X.column=V;break}case "function":{const {name:Q,args:M}=X;X=M.value.length;R&&(R=v.isStandardized(Q,X));Z&&(Z=C.isAggregate(Q,X))}}});return{referencedFieldNames:Array.from(I),isStandardized:R,isAggregate:Z}};K._visitAll=function(D,I){if(null!=D)switch(I(D),D.type){case "when_clause":this._visitAll(D.operand,I);this._visitAll(D.value,I);break;case "case_expression":for(const L of D.clauses)this._visitAll(L,
I);"simple"===D.format&&this._visitAll(D.operand,I);null!==D.else&&this._visitAll(D.else,I);break;case "expr_list":for(const L of D.value)this._visitAll(L,I);break;case "unary_expr":this._visitAll(D.expr,I);break;case "binary_expr":this._visitAll(D.left,I);this._visitAll(D.right,I);break;case "function":this._visitAll(D.args,I)}};K.evaluateNodeToJavaScript=function(D){switch(D.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(D.value)+", "+JSON.stringify(D.qualifier)+
","+JSON.stringify(D.op)+")";case "case_expression":var I="";if("simple"===D.format){var L="this.makeComparable("+this.evaluateNodeToJavaScript(D.operand)+")";I="( ";for(let R=0;R<D.clauses.length;R++)I+=" ("+L+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(D.clauses[R].operand)+")) ? ("+this.evaluateNodeToJavaScript(D.clauses[R].value)+") : "}else for(I="( ",L=0;L<D.clauses.length;L++)I+=" this.makeBool("+this.evaluateNodeToJavaScript(D.clauses[L].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(D.clauses[L].value)+") : ";I=null!==D.else?I+this.evaluateNodeToJavaScript(D.else):I+"null";return I+=" )";case "param":return"this.lookup("+JSON.stringify(D.value.toLowerCase())+",lookups)";case "expr_list":I="[";for(L of D.value)"["!==I&&(I+=","),I+=this.evaluateNodeToJavaScript(L);return I+="]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(D.expr)+")";case "binary_expr":switch(D.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(D.left)+
","+this.evaluateNodeToJavaScript(D.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+" )";case "IS":if("null"!==D.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(D.left)+")";case "ISNOT":if("null"!==D.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(D.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(D.left)+
",this.ensureArray("+this.evaluateNodeToJavaScript(D.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(D.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(D.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+")";case "LIKE":return"this.applyLike("+
this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+","+JSON.stringify(D.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+","+JSON.stringify(D.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(D.operator)+","+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+
")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(D.operator)+","+this.evaluateNodeToJavaScript(D.left)+","+this.evaluateNodeToJavaScript(D.right)+")"}throw Error("Not Supported Operator "+D.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(D.value);case "date":return"(new Date("+h(D.value).getTime().toString()+"))";case "timestamp":return"(new Date("+e(D.value).getTime().toString()+"))";case "current_time":return"date"===D.mode?"this.currentDate()":
"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(D.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(D.name)+","+this.evaluateNodeToJavaScript(D.args)+")"}throw Error("Unsupported sql syntax "+D.type);};K._evaluateNode=function(D,I,L){switch(D.type){case "interval":return I=this._evaluateNode(D.value,I,L),v.SqlInterval.createFromValueAndQualifer(I,D.qualifier,D.op);case "case_expression":if("simple"===
D.format){var R=b(this._evaluateNode(D.operand,I,L));for(var Z=0;Z<D.clauses.length;Z++)if(R===b(this._evaluateNode(D.clauses[Z].operand,I,L)))return this._evaluateNode(D.clauses[Z].value,I,L)}else for(R=0;R<D.clauses.length;R++)if(!0===this._evaluateNode(D.clauses[R].operand,I,L))return this._evaluateNode(D.clauses[R].value,I,L);return null!==D.else?this._evaluateNode(D.else,I,L):null;case "param":return this.parameters[D.value.toLowerCase()];case "expr_list":R=[];for(Z of D.value)R.push(this._evaluateNode(Z,
I,L));return R;case "unary_expr":return n(this._evaluateNode(D.expr,I,L));case "binary_expr":switch(D.operator){case "AND":return p(this._evaluateNode(D.left,I,L),this._evaluateNode(D.right,I,L));case "OR":return c(this._evaluateNode(D.left,I,L),this._evaluateNode(D.right,I,L));case "IS":if("null"!==D.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(D.left,I,L);case "ISNOT":if("null"!==D.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(D.left,
I,L);case "IN":return R=k(this._evaluateNode(D.right,I,L)),d(this._evaluateNode(D.left,I,L),R);case "NOT IN":return R=k(this._evaluateNode(D.right,I,L)),n(d(this._evaluateNode(D.left,I,L),R));case "BETWEEN":return R=this._evaluateNode(D.left,I,L),D=this._evaluateNode(D.right,I,L),null==R||null==D[0]||null==D[1]?null:R>=b(D[0])&&R<=b(D[1]);case "NOTBETWEEN":return R=this._evaluateNode(D.left,I,L),D=this._evaluateNode(D.right,I,L),null==R||null==D[0]||null==D[1]?null:R<b(D[0])||R>b(D[1]);case "LIKE":return a(this._evaluateNode(D.left,
I,L),this._evaluateNode(D.right,I,L),D.escape);case "NOT LIKE":return n(a(this._evaluateNode(D.left,I,L),this._evaluateNode(D.right,I,L),D.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return f(D.operator,this._evaluateNode(D.left,I,L),this._evaluateNode(D.right,I,L));case "-":case "+":case "*":case "/":return m(D.operator,this._evaluateNode(D.left,I,L),this._evaluateNode(D.right,I,L))}case "null":case "bool":case "string":case "number":return D.value;
case "date":return h(D.value);case "timestamp":return e(D.value);case "current_time":return I=new Date,"date"===D.mode&&I.setHours(0,0,0,0),I;case "column_ref":return g(I,D.column,this.datefields,L);case "function":return I=this._evaluateNode(D.args,I,L),this.isAggregate?C.aggregateFunction(D.name,I):v.evaluateFunction(D.name,I)}throw Error("Unsupported sql syntax "+D.type);};t._createClass(O,[{key:"fieldNames",get:function(){return this.referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,D=>{"current_time"===D.type?this._hasDateFunctions=!0:"function"===D.type&&(this._hasDateFunctions=this._hasDateFunctions||y.has(D.name.toLowerCase()))});return this._hasDateFunctions}}]);return O}();var J;(function(O){O[O.Normal=0]="Normal";O[O.Escaped=1]="Escaped"})(J||(J={}));const P={getAttribute(O,K){return(O&&"object"===typeof O.attributes?O.attributes:O)[K]}};r.WhereClause=H;r.defaultAttributeAdapter=
P;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(r){function t(v){let A=0;for(let w=0;w<v.length;w++)A+=v[w];return A/v.length}function F(v){const A=t(v),w=v.length;let l=0;for(const e of v)l+=(e-A)**2;return 1<w?l/(w-1):0}const C={min:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.min.apply(Math,v[0])},max:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.max.apply(Math,v[0])},avg:{minParams:1,maxParams:1,
evaluate:v=>null==v[0]?null:t(v[0])},sum:{minParams:1,maxParams:1,evaluate:v=>{if(null==v[0])v=null;else{{v=v[0];let A=0;for(let w=0;w<v.length;w++)A+=v[w];v=A}}return v}},stddev:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sqrt(F(v[0]))},count:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].length},var:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:F(v[0])}};r.aggregateFunction=function(v,A){const w=C[v.toLowerCase()];if(null==w)throw Error("Function Not Recognised");
if(A.length<w.minParams||A.length>w.maxParams)throw Error(`Invalid Parameter count for call to ${v.toUpperCase()}`);return w.evaluate(A)};r.isAggregate=function(v,A){v=C[v.toLowerCase()];return null!=v&&A>=v.minParams&&A<=v.maxParams};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(r,t){let F=function(){function v(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}v._fixDefaults=
function(A){if(null!==A.precision||null!==A.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};v.createFromMilliseconds=function(A){const w=new v;w.second=A/1E3;return w};v.createFromValueAndQualifer=function(A,w,l){let e=null;const h=new v;h.op="-"===l?"-":"+";if("interval-period"===w.type){v._fixDefaults(w);if("year"===w.period||"month"===w.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(A))h[w.period]=parseFloat(A);else throw Error("Illegal Interval");
}else{v._fixDefaults(w.start);v._fixDefaults(w.end);if("year"===w.start.period||"month"===w.start.period)throw Error("Year-Month Intervals not supported");if("year"===w.end.period||"month"===w.end.period)throw Error("Year-Month Intervals not supported");switch(w.start.period){case "day":switch(w.end.period){case "hour":e=/^[0-9]{1,} [0-9]{1,}$/;if(e.test(A))h[w.start.period]=parseFloat(A.split(" ")[0]),h[w.end.period]=parseFloat(A.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":e=
/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(e.test(A))h[w.start.period]=parseFloat(A.split(" ")[0]),A=A.split(" ")[1].split(":"),h.hour=parseFloat(A[0]),h.minute=parseFloat(A[1]);else throw Error("Illegal Interval");break;case "second":e=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(e.test(A))h[w.start.period]=parseFloat(A.split(" ")[0]),A=A.split(" ")[1].split(":"),h.hour=parseFloat(A[0]),h.minute=parseFloat(A[1]),h.second=parseFloat(A[2]);else throw Error("Illegal Interval");
break;default:throw"Invalid Interval.";}break;case "hour":switch(w.end.period){case "minute":e=/^[0-9]{1,}:[0-9]{1,}$/;if(e.test(A))h.hour=parseFloat(A.split(":")[0]),h.minute=parseFloat(A.split(":")[1]);else throw Error("Illegal Interval");break;case "second":e=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(e.test(A))A=A.split(":"),h.hour=parseFloat(A[0]),h.minute=parseFloat(A[1]),h.second=parseFloat(A[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;
case "minute":switch(w.end.period){case "second":e=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(e.test(A))A=A.split(":"),h.minute=parseFloat(A[0]),h.second=parseFloat(A[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return h};v.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return v}();const C=
{extract:{minParams:2,maxParams:2,evaluate:([v,A])=>{if(null==A)return null;if(A instanceof Date)switch(v.toUpperCase()){case "SECOND":return A.getSeconds();case "MINUTE":return A.getMinutes();case "HOUR":return A.getHours();case "DAY":return A.getDate();case "MONTH":return A.getMonth()+1;case "YEAR":return A.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:v=>{if(2===v.length){const [A,w]=v;return null==A||null==w?null:A.toString().substring(w-
1)}if(3===v.length){const [A,w,l]=v;return null==A||null==w||null==l?null:0>=l?"":A.toString().substring(w-1,w+l-1)}}},position:{minParams:2,maxParams:2,evaluate:([v,A])=>null==v||null==A?null:A.indexOf(v)+1},trim:{minParams:2,maxParams:3,evaluate:v=>{var A=3===v.length,w=A?v[1]:" ";A=A?v[2]:v[1];if(null==w||null==A)return null;w=`(${t.escapeRegExpString(w)})`;switch(v[0]){case "BOTH":return A.replace(new RegExp(`^${w}*|${w}*$`,"g"),"");case "LEADING":return A.replace(new RegExp(`^${w}*`,"g"),"");
case "TRAILING":return A.replace(new RegExp(`${w}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.abs(v[0])},ceiling:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.ceil(v[0])},floor:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.floor(v[0])},log:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])},log10:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])*Math.LOG10E},
sin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sin(v[0])},cos:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.cos(v[0])},tan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.tan(v[0])},asin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.asin(v[0])},acos:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.acos(v[0])},atan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.atan(v[0])},sign:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:
0<v[0]?1:0>v[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]**v[1]},mod:{minParams:2,maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]%v[1]},round:{minParams:1,maxParams:2,evaluate:v=>{const A=v[0];v=2===v.length?10**v[1]:1;return null==A?null:Math.round(A*v)/v}},truncate:{minParams:1,maxParams:2,evaluate:v=>null==v[0]?null:1===v.length?parseInt(v[0].toFixed(0),10):parseFloat(v[0].toFixed(v[1]))},char_length:{minParams:1,maxParams:1,evaluate:v=>"string"===
typeof v[0]||v[0]instanceof String?v[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:v=>{let A="";for(let w=0;w<v.length;w++){if(null==v[w])return null;A+=v[w].toString()}return A}},lower:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toUpperCase()}};r.SqlInterval=F;r.evaluateFunction=function(v,A){const w=C[v.toLowerCase()];if(null==w)throw Error("Function Not Recognised");
if(A.length<w.minParams||A.length>w.maxParams)throw Error(`Invalid Parameter count for call to ${v.toUpperCase()}`);return w.evaluate(A)};r.isStandardized=function(v,A){v=C[v.toLowerCase()];return null!=v&&A>=v.minParams&&A<=v.maxParams};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(r,t){var F={exports:{}};(function(v){(function(A,w){v.exports&&(v.exports=w())})(t.commonjsGlobal,function(){function A(l,
e,h,k){l=Error.call(this,l);Object.setPrototypeOf&&Object.setPrototypeOf(l,A.prototype);l.expected=e;l.found=h;l.location=k;l.name="SyntaxError";return l}function w(l,e,h){h=h||" ";if(l.length>e)return l;e-=l.length;h+=h.repeat(e);return l+h.slice(0,e)}(function(l,e){function h(){this.constructor=l}h.prototype=e.prototype;l.prototype=new h})(A,Error);A.prototype.format=function(l){var e="Error: "+this.message;if(this.location){var h=null,k;for(k=0;k<l.length;k++)if(l[k].source===this.location.source){h=
l[k].text.split(/\r\n|\n|\r/g);break}l=this.location.start;k=this.location.source+":"+l.line+":"+l.column;if(h){var n=this.location.end,p=w("",l.line.toString().length);h=h[l.line-1];n=l.line===n.line?n.column:h.length+1;e+="\n --\x3e "+k+"\n"+p+" |\n"+l.line+" | "+h+"\n"+p+" | "+w("",l.column-1)+w("",n-l.column,"^")}else e+="\n at "+k}return e};A.buildMessage=function(l,e){function h(d){return d.charCodeAt(0).toString(16).toUpperCase()}function k(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+h(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+h(a)})}function n(d){return d.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+h(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+h(a)})}function p(d){return c[d.type](d)}
var c={literal:function(d){return'"'+k(d.text)+'"'},class:function(d){var a=d.parts.map(function(b){return Array.isArray(b)?n(b[0])+"-"+n(b[1]):n(b)});return"["+(d.inverted?"^":"")+a+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(d){return d.description}};return"Expected "+function(d){d=d.map(p);var a,b;d.sort();if(0<d.length){for(b=a=1;a<d.length;a++)d[a-1]!==d[a]&&(d[b]=d[a],b++);d.length=b}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+
d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}(l)+" but "+(e?'"'+k(e)+'"':"end of input")+" found."};return{SyntaxError:A,parse:function(l,e){function h(Y,ba){return{type:"literal",text:Y,ignoreCase:ba}}function k(Y,ba,ma){return{type:"class",parts:Y,inverted:ba,ignoreCase:ma}}function n(Y){var ba=bc[Y],ma;if(!ba){for(ma=Y-1;!bc[ma];)ma--;ba=bc[ma];for(ba={line:ba.line,column:ba.column};ma<Y;)10===l.charCodeAt(ma)?(ba.line++,ba.column=1):ba.column++,ma++;bc[Y]=ba}return ba}function p(Y,
ba){var ma=n(Y),Aa=n(ba);return{source:Wa,start:{offset:Y,line:ma.line,column:ma.column},end:{offset:ba,line:Aa.line,column:Aa.column}}}function c(Y){U<rb||(U>rb&&(rb=U,vc=[]),vc.push(Y))}function d(){var Y=U;ya();var ba=b();ba!==N?(ya(),Y=ba):(U=Y,Y=N);return Y}function a(){var Y=U;var ba=b();if(ba!==N){Y=[];var ma=U;var Aa=ya();var Ka=Ia();if(Ka!==N){var Ra=ya();var Sa=b();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;for(;ma!==N;)Y.push(ma),ma=U,Aa=ya(),Ka=Ia(),Ka!==N?(Ra=ya(),Sa=b(),Sa!==
N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);ma={type:"expr_list"};ba=[ba];for(Aa=0;Aa<Y.length;Aa++)ba.push(Y[Aa][3]);ma.value=ba;Y=ma}else U=Y,Y=N;return Y}function b(){var Y=U;var ba=f();if(ba!==N){Y=[];var ma=U;var Aa=ya();var Ka=ca();if(Ka!==N){var Ra=ya();var Sa=f();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;for(;ma!==N;)Y.push(ma),ma=U,Aa=ya(),Ka=ca(),Ka!==N?(Ra=ya(),Sa=f(),Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);Y=Na(ba,Y)}else U=Y,Y=N;return Y}function f(){var Y=
U;var ba=m();if(ba!==N){Y=[];var ma=U;var Aa=ya();var Ka=W();if(Ka!==N){var Ra=ya();var Sa=m();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;for(;ma!==N;)Y.push(ma),ma=U,Aa=ya(),Ka=W(),Ka!==N?(Ra=ya(),Sa=m(),Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);Y=Na(ba,Y)}else U=Y,Y=N;return Y}function m(){var Y=U;var ba=T();if(ba===N){ba=U;if(33===l.charCodeAt(U)){var ma=ra;U++}else ma=N,0===Ba&&c(nd);if(ma!==N){var Aa=U;Ba++;if(61===l.charCodeAt(U)){var Ka=Ab;U++}else Ka=N,0===Ba&&c(Lc);Ba--;
Ka===N?Aa=void 0:(U=Aa,Aa=N);Aa!==N?ba=ma=[ma,Aa]:(U=ba,ba=N)}else U=ba,ba=N}ba!==N?(ma=ya(),Aa=m(),Aa!==N?Y={type:"unary_expr",operator:"NOT",expr:Aa}:(U=Y,Y=N)):(U=Y,Y=N);if(Y===N){ba=U;Y=B();if(Y!==N){ya();ba=[];ma=U;Aa=ya();Ka=g();if(Ka!==N){var Ra=ya();var Sa=B();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;if(ma!==N)for(;ma!==N;)ba.push(ma),ma=U,Aa=ya(),Ka=g(),Ka!==N?(Ra=ya(),Sa=B(),Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);else ba=N;ba!==N&&(ba={type:"arithmetic",tail:ba});
ba===N&&(ba=U,ma=q(),ma!==N?(ya(),Aa=La(),Aa!==N?(ya(),Aa=a(),Aa!==N?(ya(),Ka=Oa(),Ka!==N?ba={op:ma,right:Aa}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ma=q(),ma!==N?(ya(),Aa=La(),Aa!==N?(ya(),Aa=Oa(),Aa!==N?ba={op:ma,right:{type:"expr_list",value:[]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ma=q(),ma!==N?(ya(),Aa=K(),Aa!==N?ba={op:ma,right:Aa}:(U=ba,ba=N)):(U=ba,ba=N))),ba===N&&(ba=U,Ka=T(),Ka!==N?(ya(),ma=da(),ma!==N?(ya(),Aa=B(),Aa!==N?(ya(),Ra=W(),Ra!==N?(ya(),
Ka=B(),Ka!==N?ba={op:"NOT"+ma,right:{type:"expr_list",value:[Aa,Ka]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,Ka=da(),Ka!==N?(ya(),ma=B(),ma!==N?(ya(),Aa=W(),Aa!==N?(ya(),Ra=B(),Ra!==N?ba={op:Ka,right:{type:"expr_list",value:[ma,Ra]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)),ba===N&&(ba=U,ma=S(),ma!==N?(ya(),Aa=T(),Aa!==N?(ya(),Aa=B(),Aa!==N?ba={op:ma+"NOT",right:Aa}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ma=S(),ma!==N?(ya(),Aa=B(),Aa!==
N?ba={op:ma,right:Aa}:(U=ba,ba=N)):(U=ba,ba=N)),ba===N&&(ba=U,ma=x(),ma!==N?(ya(),Aa=X(),Aa!==N?(ya(),Ka=U,l.substr(U,6).toLowerCase()===$a?(Ra=l.substr(U,6),U+=6):(Ra=N,0===Ba&&c(od)),Ra!==N?(Ra=U,Ba++,Sa=P(),Ba--,Sa===N?Ra=void 0:(U=Ra,Ra=N),Ra!==N?Ka="ESCAPE":(U=Ka,Ka=N)):(U=Ka,Ka=N),Ka!==N?(ya(),Ka=Q(),Ka!==N?ba={op:ma,right:Aa,escape:Ka.value}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ma=x(),ma!==N?(ya(),Aa=X(),Aa!==N?ba={op:ma,right:Aa,escape:""}:(U=ba,ba=N)):(U=ba,ba=
N))))));ba===N&&(ba=null);""==ba||void 0==ba||null==ba?ba=Y:(ma=null,ba=ma="arithmetic"==ba.type?Na(Y,ba.tail):Qa(ba.op,Y,ba.right,ba.escape))}else U=ba,ba=N;Y=ba}return Y}function g(){if(l.substr(U,2)===ob){var Y=ob;U+=2}else Y=N,0===Ba&&c(pd);Y===N&&(62===l.charCodeAt(U)?(Y=cb,U++):(Y=N,0===Ba&&c(qd)),Y===N&&(l.substr(U,2)===Cb?(Y=Cb,U+=2):(Y=N,0===Ba&&c(rd)),Y===N&&(l.substr(U,2)===Qb?(Y=Qb,U+=2):(Y=N,0===Ba&&c(sd)),Y===N&&(60===l.charCodeAt(U)?(Y=Rb,U++):(Y=N,0===Ba&&c(td)),Y===N&&(61===l.charCodeAt(U)?
(Y=Ab,U++):(Y=N,0===Ba&&c(Lc)),Y===N&&(l.substr(U,2)===cc?(Y=cc,U+=2):(Y=N,0===Ba&&c(ud))))))));return Y}function x(){var Y=Y=U;var ba=T();if(ba!==N){var ma=ya();var Aa=ha();Aa!==N?Y=ba=[ba,ma,Aa]:(U=Y,Y=N)}else U=Y,Y=N;Y!==N&&(Y=Y[0]+" "+Y[2]);Y===N&&(Y=ha());return Y}function q(){var Y=Y=U;var ba=T();if(ba!==N){var ma=ya();var Aa=G();Aa!==N?Y=ba=[ba,ma,Aa]:(U=Y,Y=N)}else U=Y,Y=N;Y!==N&&(Y=Y[0]+" "+Y[2]);Y===N&&(Y=G());return Y}function B(){var Y=U;var ba=u();if(ba!==N){Y=[];var ma=U;var Aa=ya();
var Ka=z();if(Ka!==N){var Ra=ya();var Sa=u();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;for(;ma!==N;)Y.push(ma),ma=U,Aa=ya(),Ka=z(),Ka!==N?(Ra=ya(),Sa=u(),Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);Y=Na(ba,Y)}else U=Y,Y=N;return Y}function z(){if(43===l.charCodeAt(U)){var Y=gb;U++}else Y=N,0===Ba&&c(wc);Y===N&&(45===l.charCodeAt(U)?(Y=sb,U++):(Y=N,0===Ba&&c(xc)));return Y}function u(){var Y=U;var ba=E();if(ba!==N){Y=[];var ma=U;var Aa=ya();var Ka=y();if(Ka!==N){var Ra=ya();var Sa=
E();Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)}else U=ma,ma=N;for(;ma!==N;)Y.push(ma),ma=U,Aa=ya(),Ka=y(),Ka!==N?(Ra=ya(),Sa=E(),Sa!==N?ma=Aa=[Aa,Ka,Ra,Sa]:(U=ma,ma=N)):(U=ma,ma=N);Y=Na(ba,Y)}else U=Y,Y=N;return Y}function y(){if(42===l.charCodeAt(U)){var Y=Xa;U++}else Y=N,0===Ba&&c(vd);Y===N&&(47===l.charCodeAt(U)?(Y=mb,U++):(Y=N,0===Ba&&c(wd)));return Y}function E(){var Y=Q();if(Y===N){var ba=U;var ma=U;var Aa=oa();if(Aa!==N){var Ka=ua();if(Ka!==N){var Ra=xa();Ra!==N?ma=parseFloat(Aa+Ka+Ra):(U=ma,ma=
N)}else U=ma,ma=N}else U=ma,ma=N;ma===N&&(ma=U,Aa=oa(),Aa!==N?(Ka=ua(),Ka!==N?ma=parseFloat(Aa+Ka):(U=ma,ma=N)):(U=ma,ma=N),ma===N&&(ma=U,Aa=oa(),Aa!==N?(Ka=xa(),Ka!==N?ma=parseFloat(Aa+Ka):(U=ma,ma=N)):(U=ma,ma=N),ma===N&&(ma=U,Aa=oa(),Aa!==N&&(Aa=parseFloat(Aa)),ma=Aa)));var Sa=ma;if(Sa!==N){var dc=U;Ba++;var xd=J();Ba--;xd===N?dc=void 0:(U=dc,dc=N);dc!==N?ba={type:"number",value:Sa}:(U=ba,ba=N)}else U=ba,ba=N;Y=ba;if(Y===N){var Sb=U;var Fb=U;if(l.substr(U,4).toLowerCase()===ta){var ec=l.substr(U,
4);U+=4}else ec=N,0===Ba&&c(yd);if(ec!==N){var Tb=U;Ba++;var zd=P();Ba--;zd===N?Tb=void 0:(U=Tb,Tb=N);Tb!==N?Fb=ec=[ec,Tb]:(U=Fb,Fb=N)}else U=Fb,Fb=N;var Db=Fb;Db!==N&&(Db={type:"bool",value:!0});Sb=Db;if(Sb===N){Sb=U;var Gb=U;if(l.substr(U,5).toLowerCase()===Ea){var fc=l.substr(U,5);U+=5}else fc=N,0===Ba&&c(Ad);if(fc!==N){var Ub=U;Ba++;var Bd=P();Ba--;Bd===N?Ub=void 0:(U=Ub,Ub=N);Ub!==N?Gb=fc=[fc,Ub]:(U=Gb,Gb=N)}else U=Gb,Gb=N;Db=Gb;Db!==N&&(Db={type:"bool",value:!1});Sb=Db}Y=Sb;if(Y===N){var Hb=
U;if(l.substr(U,4).toLowerCase()===na){var gc=l.substr(U,4);U+=4}else gc=N,0===Ba&&c(Cd);if(gc!==N){var Vb=U;Ba++;var Dd=P();Ba--;Dd===N?Vb=void 0:(U=Vb,Vb=N);Vb!==N?Hb=gc=[gc,Vb]:(U=Hb,Hb=N)}else U=Hb,Hb=N;var yc=Hb;yc!==N&&(yc={type:"null",value:null});Y=yc;if(Y===N){var Ib=U;var Jb=U;if(l.substr(U,4).toLowerCase()===Ed){var Mc=l.substr(U,4);U+=4}else Mc=N,0===Ba&&c(Fd);if(Mc!==N){var hc=U;Ba++;var Gd=P();Ba--;Gd===N?hc=void 0:(U=hc,hc=N);hc!==N?Jb="DATE":(U=Jb,Jb=N)}else U=Jb,Jb=N;if(Jb!==N){ya();
var Nc=X();Nc!==N?Ib={type:"date",value:Nc.value}:(U=Ib,Ib=N)}else U=Ib,Ib=N;Y=Ib;if(Y===N){var Kb=U;var Lb=U;if(l.substr(U,9).toLowerCase()===Hd){var Oc=l.substr(U,9);U+=9}else Oc=N,0===Ba&&c(Id);if(Oc!==N){var ic=U;Ba++;var Jd=P();Ba--;Jd===N?ic=void 0:(U=ic,ic=N);ic!==N?Lb="TIMESTAMP":(U=Lb,Lb=N)}else U=Lb,Lb=N;if(Lb!==N){ya();var Pc=X();Pc!==N?Kb={type:"timestamp",value:Pc.value}:(U=Kb,Kb=N)}else U=Kb,Kb=N;Y=Kb;if(Y===N){var db=U;var zc=aa();if(zc!==N){ya();if(45===l.charCodeAt(U)){var wb=sb;
U++}else wb=N,0===Ba&&c(xc);wb===N&&(43===l.charCodeAt(U)?(wb=gb,U++):(wb=N,0===Ba&&c(wc)));if(wb!==N){ya();var Wb=X();if(Wb!==N){ya();var Qc=I();Qc!==N?db={type:"interval",value:Wb,qualifier:Qc,op:wb}:(U=db,db=N)}else U=db,db=N}else U=db,db=N}else U=db,db=N;db===N&&(db=U,zc=aa(),zc!==N?(ya(),wb=X(),wb!==N?(ya(),Wb=I(),Wb!==N?db={type:"interval",value:wb,qualifier:Wb,op:""}:(U=db,db=N)):(U=db,db=N)):(U=db,db=N));Y=db}}}}}}var ab=Y;if(ab===N){var jb=U;var Mb=U;if(l.substr(U,7).toLowerCase()===Kd){var Rc=
l.substr(U,7);U+=7}else Rc=N,0===Ba&&c(Ld);if(Rc!==N){var jc=U;Ba++;var Md=P();Ba--;Md===N?jc=void 0:(U=jc,jc=N);jc!==N?Mb="EXTRACT":(U=Mb,Mb=N)}else U=Mb,Mb=N;if(Mb!==N){ya();var Nd=La();if(Nd!==N){ya();var pb=ea();pb===N&&(pb=la(),pb===N&&(pb=qa(),pb===N&&(pb=sa(),pb===N&&(pb=wa(),pb===N&&(pb=za())))));var Sc=pb;if(Sc!==N){ya();var Od=ia();if(Od!==N){ya();var Tc=b();if(Tc!==N){ya();var Pd=Oa();Pd!==N?jb={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:Sc},Tc]}}:
(U=jb,jb=N)}else U=jb,jb=N}else U=jb,jb=N}else U=jb,jb=N}else U=jb,jb=N}else U=jb,jb=N;ab=jb;if(ab===N){var kb=U;var Nb=U;if(l.substr(U,9).toLowerCase()===Qd){var Uc=l.substr(U,9);U+=9}else Uc=N,0===Ba&&c(Rd);if(Uc!==N){var kc=U;Ba++;var Sd=P();Ba--;Sd===N?kc=void 0:(U=kc,kc=N);kc!==N?Nb="SUBSTRING":(U=Nb,Nb=N)}else U=Nb,Nb=N;if(Nb!==N){ya();var Td=La();if(Td!==N){ya();var Ac=b();if(Ac!==N){ya();var Ud=ia();if(Ud!==N){ya();var Bc=b();if(Bc!==N){ya();var xb=U;var Ob=U;if(l.substr(U,3).toLowerCase()===
Vd){var Vc=l.substr(U,3);U+=3}else Vc=N,0===Ba&&c(Wd);if(Vc!==N){var lc=U;Ba++;var Xd=P();Ba--;Xd===N?lc=void 0:(U=lc,lc=N);lc!==N?Ob="FOR":(U=Ob,Ob=N)}else U=Ob,Ob=N;var Xb=Ob;if(Xb!==N){var Yd=ya();var Wc=b();if(Wc!==N){var Zd=ya();xb=Xb=[Xb,Yd,Wc,Zd]}else U=xb,xb=N}else U=xb,xb=N;xb===N&&(xb=null);Xb=Oa();Xb!==N?kb={type:"function",name:"substring",args:{type:"expr_list",value:xb?[Ac,Bc,xb[2]]:[Ac,Bc]}}:(U=kb,kb=N)}else U=kb,kb=N}else U=kb,kb=N}else U=kb,kb=N}else U=kb,kb=N}else U=kb,kb=N;ab=kb;
if(ab===N){var bb=U;var Cc=ja();if(Cc!==N){ya();var Dc=La();if(Dc!==N){ya();var yb=D();yb===N&&(yb=null);ya();var Yb=b();if(Yb!==N){ya();var Ec=ia();if(Ec!==N){ya();var Xc=b();if(Xc!==N){ya();var $d=Oa();$d!==N?bb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==yb?"BOTH":yb},Yb,Xc]}}:(U=bb,bb=N)}else U=bb,bb=N}else U=bb,bb=N}else U=bb,bb=N}else U=bb,bb=N}else U=bb,bb=N;bb===N&&(bb=U,Cc=ja(),Cc!==N?(ya(),Dc=La(),Dc!==N?(ya(),yb=D(),yb===N&&(yb=null),ya(),Yb=b(),
Yb!==N?(ya(),Ec=Oa(),Ec!==N?bb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==yb?"BOTH":yb},Yb]}}:(U=bb,bb=N)):(U=bb,bb=N)):(U=bb,bb=N)):(U=bb,bb=N));ab=bb;if(ab===N){var lb=U;var Pb=U;if(l.substr(U,8).toLowerCase()===ae){var Yc=l.substr(U,8);U+=8}else Yc=N,0===Ba&&c(be);if(Yc!==N){var mc=U;Ba++;var ce=P();Ba--;ce===N?mc=void 0:(U=mc,mc=N);mc!==N?Pb="POSITION":(U=Pb,Pb=N)}else U=Pb,Pb=N;if(Pb!==N){ya();var de=La();if(de!==N){ya();var Zc=b();if(Zc!==N){ya();var ee=
G();if(ee!==N){ya();var $c=b();if($c!==N){ya();var fe=Oa();fe!==N?lb={type:"function",name:"position",args:{type:"expr_list",value:[Zc,$c]}}:(U=lb,lb=N)}else U=lb,lb=N}else U=lb,lb=N}else U=lb,lb=N}else U=lb,lb=N}else U=lb,lb=N;ab=lb;if(ab===N){var Bb=U;var nc;var qb=U;qb=nc=H();if(qb===N)if(qb=U,96===l.charCodeAt(U)?(nc=ad,U++):(nc=N,0===Ba&&c(bd)),nc!==N){var oc=[];if(cd.test(l.charAt(U))){var zb=l.charAt(U);U++}else zb=N,0===Ba&&c(dd);if(zb!==N)for(;zb!==N;)oc.push(zb),cd.test(l.charAt(U))?(zb=
l.charAt(U),U++):(zb=N,0===Ba&&c(dd));else oc=N;oc!==N?(96===l.charCodeAt(U)?(zb=ad,U++):(zb=N,0===Ba&&c(bd)),zb!==N?qb=oc.join(""):(U=qb,qb=N)):(U=qb,qb=N)}else U=qb,qb=N;var ed=qb;if(ed!==N){ya();var ge=La();if(ge!==N){ya();var pc=a();pc===N&&(pc=null);ya();var he=Oa();he!==N?Bb={type:"function",name:ed,args:pc?pc:{type:"expr_list",value:[]}}:(U=Bb,Bb=N)}else U=Bb,Bb=N}else U=Bb,Bb=N;ab=Bb;if(ab===N){var tb;var eb=U;var Fc=Da();if(Fc!==N){ya();var Zb=b();if(Zb!==N){ya();var $b=[];for(tb=V();tb!==
N;)$b.push(tb),tb=V();tb=ya();var qc=Ja();qc!==N?eb={type:"case_expression",format:"simple",operand:Zb,clauses:$b,else:null}:(U=eb,eb=N)}else U=eb,eb=N}else U=eb,eb=N;if(eb===N)if(eb=U,Fc=Da(),Fc!==N)if(ya(),Zb=b(),Zb!==N){ya();$b=[];for(tb=V();tb!==N;)$b.push(tb),tb=V();tb=ya();qc=fa();if(qc!==N){ya();var ie=Ja();ie!==N?eb={type:"case_expression",format:"simple",operand:Zb,clauses:$b,else:qc.value}:(U=eb,eb=N)}else U=eb,eb=N}else U=eb,eb=N;else U=eb,eb=N;var Gc=eb;if(Gc===N){var ub;var hb=U;var Hc=
Da();if(Hc!==N){ya();var ac=[];for(ub=M();ub!==N;)ac.push(ub),ub=M();ub=ya();var rc=Ja();rc!==N?hb={type:"case_expression",format:"searched",clauses:ac,else:null}:(U=hb,hb=N)}else U=hb,hb=N;if(hb===N)if(hb=U,Hc=Da(),Hc!==N){ya();ac=[];for(ub=M();ub!==N;)ac.push(ub),ub=M();ub=ya();rc=fa();if(rc!==N){ya();var je=Ja();je!==N?hb={type:"case_expression",format:"searched",clauses:ac,else:rc.value}:(U=hb,hb=N)}else U=hb,hb=N}else U=hb,hb=N;Gc=hb}ab=Gc;if(ab===N){var sc;var tc=U;var fd=J();if(fd!==N){var gd=
[];for(sc=O();sc!==N;)gd.push(sc),sc=O();tc=fd+gd.join("")}else U=tc,tc=N;var uc=tc;if(uc!==N){var Ic=uc;uc=/^CURRENT_DATE$/i.test(Ic)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Ic)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:Ic}}ab=uc;if(ab===N&&(ab=K(),ab===N)){ab=U;var ke=La();if(ke!==N){ya();var Jc=b();if(Jc!==N){ya();var le=Oa();le!==N?(Jc.paren=!0,ab=Jc):(U=ab,ab=N)}else U=ab,ab=N}else U=ab,ab=N}}}}}}}}return ab}function H(){var Y;var ba=U;var ma=
J();if(ma!==N){ba=[];for(Y=P();Y!==N;)ba.push(Y),Y=P();ba=ma+ba.join("")}else U=ba,ba=N;return ba}function J(){if(me.test(l.charAt(U))){var Y=l.charAt(U);U++}else Y=N,0===Ba&&c(ne);return Y}function P(){if(oe.test(l.charAt(U))){var Y=l.charAt(U);U++}else Y=N,0===Ba&&c(pe);return Y}function O(){if(qe.test(l.charAt(U))){var Y=l.charAt(U);U++}else Y=N,0===Ba&&c(re);return Y}function K(){var Y=U;if(64===l.charCodeAt(U)){var ba=vb;U++}else ba=N,0===Ba&&c(se);if(ba!==N){var ma=H();ma!==N?Y=ba=[ba,ma]:(U=
Y,Y=N)}else U=Y,Y=N;Y!==N&&(Y={type:"param",value:Y[1]});return Y}function D(){var Y=U;if(l.substr(U,7).toLowerCase()===te){var ba=l.substr(U,7);U+=7}else ba=N,0===Ba&&c(ue);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="LEADING":(U=Y,Y=N)}else U=Y,Y=N;Y===N&&(Y=U,l.substr(U,8).toLowerCase()===ve?(ba=l.substr(U,8),U+=8):(ba=N,0===Ba&&c(we)),ba!==N?(ba=U,Ba++,ma=P(),Ba--,ma===N?ba=void 0:(U=ba,ba=N),ba!==N?Y="TRAILING":(U=Y,Y=N)):(U=Y,Y=N),Y===N&&(Y=U,l.substr(U,4).toLowerCase()===
xe?(ba=l.substr(U,4),U+=4):(ba=N,0===Ba&&c(ye)),ba!==N?(ba=U,Ba++,ma=P(),Ba--,ma===N?ba=void 0:(U=ba,ba=N),ba!==N?Y="BOTH":(U=Y,Y=N)):(U=Y,Y=N)));return Y}function I(){var Y=U;var ba=U;var ma=L();if(ma!==N){ya();var Aa=La();if(Aa!==N)if(ya(),Aa=Z(),Aa!==N){ya();var Ka=Oa();Ka!==N?ba={type:"interval-period",period:ma.value,precision:Aa,secondary:null}:(U=ba,ba=N)}else U=ba,ba=N;else U=ba,ba=N}else U=ba,ba=N;ba===N&&(ba=U,ma=L(),ma!==N&&(ma=hd(ma)),ba=ma);if(ba!==N)if(ya(),ma=U,l.substr(U,2).toLowerCase()===
ze?(Aa=l.substr(U,2),U+=2):(Aa=N,0===Ba&&c(Ae)),Aa!==N?(Aa=U,Ba++,Ka=P(),Ba--,Ka===N?Aa=void 0:(U=Aa,Aa=N),Aa!==N?ma="TO":(U=ma,ma=N)):(U=ma,ma=N),ma!==N){ya();ma=U;Aa=L();Aa!==N&&(Aa={type:"interval-period",period:Aa.value,precision:null,secondary:null});ma=Aa;if(ma===N){ma=U;Aa=za();if(Aa!==N)if(ya(),Aa=La(),Aa!==N)if(ya(),Aa=Z(),Aa!==N)if(ya(),Ka=Ia(),Ka!==N)if(ya(),Ka=R(),Ka!==N){ya();var Ra=Oa();Ra!==N?ma=id(Aa,Ka):(U=ma,ma=N)}else U=ma,ma=N;else U=ma,ma=N;else U=ma,ma=N;else U=ma,ma=N;else U=
ma,ma=N;ma===N&&(ma=U,Aa=za(),Aa!==N?(ya(),Aa=La(),Aa!==N?(ya(),Aa=Z(),Aa!==N?(ya(),Ka=Oa(),Ka!==N?ma={type:"interval-period",period:"second",precision:Aa,secondary:null}:(U=ma,ma=N)):(U=ma,ma=N)):(U=ma,ma=N)):(U=ma,ma=N),ma===N&&(ma=U,Aa=za(),Aa!==N&&(Aa={type:"interval-period",period:"second",precision:null,secondary:null}),ma=Aa))}ma!==N?Y={type:"interval-qualifier",start:ba,end:ma}:(U=Y,Y=N)}else U=Y,Y=N;else U=Y,Y=N;Y===N&&(Y=U,ma=L(),ma!==N?(ya(),ba=La(),ba!==N?(ya(),ba=R(),ba!==N?(ya(),Aa=
Oa(),Aa!==N?Y={type:"interval-period",period:ma.value,precision:ba,secondary:null}:(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N),Y===N&&(Y=U,ma=L(),ma!==N&&(ma=hd(ma)),Y=ma,Y===N&&(Y=U,ma=za(),ma!==N?(ya(),ba=La(),ba!==N?(ya(),ba=Z(),ba!==N?(ya(),Aa=Ia(),Aa!==N?(ya(),ma=R(),ma!==N?(ya(),Aa=Oa(),Aa!==N?Y=id(ba,ma):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N),Y===N&&(Y=U,ma=za(),ma!==N?(ya(),ba=La(),ba!==N?(ya(),ba=R(),ba!==N?(ya(),Aa=Oa(),Aa!==N?Y={type:"interval-period",period:"second",
precision:ba,secondary:null}:(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N)):(U=Y,Y=N),Y===N&&(Y=U,ma=za(),ma!==N&&(ma={type:"interval-period",period:"second",precision:null,secondary:null}),Y=ma)))));return Y}function L(){var Y=U;Y=qa();Y!==N&&(Y={type:"string",value:"day"});Y===N&&(Y=U,Y=sa(),Y!==N&&(Y={type:"string",value:"hour"}),Y===N&&(Y=U,Y=wa(),Y!==N&&(Y={type:"string",value:"minute"}),Y===N&&(Y=U,Y=la(),Y!==N&&(Y={type:"string",value:"month"}),Y===N&&(Y=U,Y=ea(),Y!==N&&(Y={type:"string",value:"year"})))));
return Y}function R(){var Y=Ca();Y!==N&&(Y=parseFloat(Y));return Y}function Z(){var Y=Ca();Y!==N&&(Y=parseFloat(Y));return Y}function X(){var Y=Q();Y===N&&(Y=K());return Y}function Q(){var Y=U;if(39===l.charCodeAt(U)){var ba=Ta;U++}else ba=N,0===Ba&&c(jd);ba===N&&(l.substr(U,2)===Eb?(ba=Eb,U+=2):(ba=N,0===Ba&&c(Be)));if(ba!==N){ba=[];var ma=U;l.substr(U,2)===ka?(ma=ka,U+=2):(ma=N,0===Ba&&c(kd));ma!==N&&(ma="'");ma===N&&(ld.test(l.charAt(U))?(ma=l.charAt(U),U++):(ma=N,0===Ba&&c(md)));for(;ma!==N;)ba.push(ma),
ma=U,l.substr(U,2)===ka?(ma=ka,U+=2):(ma=N,0===Ba&&c(kd)),ma!==N&&(ma="'"),ma===N&&(ld.test(l.charAt(U))?(ma=l.charAt(U),U++):(ma=N,0===Ba&&c(md)));39===l.charCodeAt(U)?(ma=Ta,U++):(ma=N,0===Ba&&c(jd));ma!==N?Y={type:"string",value:ba.join("")}:(U=Y,Y=N)}else U=Y,Y=N;return Y}function M(){var Y=U;if(Ga()!==N){ya();var ba=b();if(ba!==N){ya();var ma=Ha();ma!==N?(ya(),ma=b(),ma!==N?Y={type:"when_clause",operand:ba,value:ma}:(U=Y,Y=N)):(U=Y,Y=N)}else U=Y,Y=N}else U=Y,Y=N;return Y}function V(){var Y=U;
if(Ga()!==N){ya();var ba=b();if(ba!==N){ya();var ma=Ha();ma!==N?(ya(),ma=b(),ma!==N?Y={type:"when_clause",operand:ba,value:ma}:(U=Y,Y=N)):(U=Y,Y=N)}else U=Y,Y=N}else U=Y,Y=N;return Y}function fa(){var Y=U;var ba=U;if(l.substr(U,4).toLowerCase()===Ce){var ma=l.substr(U,4);U+=4}else ma=N,0===Ba&&c(De);if(ma!==N){ma=U;Ba++;var Aa=P();Ba--;Aa===N?ma=void 0:(U=ma,ma=N);ma!==N?ba="ELSE":(U=ba,ba=N)}else U=ba,ba=N;ba!==N?(ya(),ba=b(),ba!==N?Y={type:"else_clause",value:ba}:(U=Y,Y=N)):(U=Y,Y=N);return Y}function oa(){var Y=
Ca();if(Y===N){Y=U;if(45===l.charCodeAt(U)){var ba=sb;U++}else ba=N,0===Ba&&c(xc);ba===N&&(43===l.charCodeAt(U)?(ba=gb,U++):(ba=N,0===Ba&&c(wc)));if(ba!==N){var ma=Ca();ma!==N?Y=ba[0]+ma:(U=Y,Y=N)}else U=Y,Y=N}return Y}function ua(){var Y=U;if(46===l.charCodeAt(U)){var ba=pa;U++}else ba=N,0===Ba&&c(Ee);ba!==N?(Y=Ca(),Y===N&&(Y=null),Y="."+(null!=Y?Y:"")):(U=Y,Y=N);return Y}function xa(){var Y;var ba=Y=U;if(Fe.test(l.charAt(U))){var ma=l.charAt(U);U++}else ma=N,0===Ba&&c(Ge);ma!==N?(He.test(l.charAt(U))?
(ba=l.charAt(U),U++):(ba=N,0===Ba&&c(Ie)),ba===N&&(ba=null),ba="e"+(null===ba?"":ba)):(U=ba,ba=N);ba!==N?(ma=Ca(),ma!==N?Y=ba+ma:(U=Y,Y=N)):(U=Y,Y=N);return Y}function Ca(){var Y=[];var ba=va();if(ba!==N)for(;ba!==N;)Y.push(ba),ba=va();else Y=N;Y!==N&&(Y=Y.join(""));return Y}function va(){if(Je.test(l.charAt(U))){var Y=l.charAt(U);U++}else Y=N,0===Ba&&c(Ke);return Y}function G(){var Y=U;if(l.substr(U,2).toLowerCase()===Fa){var ba=l.substr(U,2);U+=2}else ba=N,0===Ba&&c(Le);if(ba!==N){ba=U;Ba++;var ma=
P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="IN":(U=Y,Y=N)}else U=Y,Y=N;return Y}function S(){var Y=U;if(l.substr(U,2).toLowerCase()===Ma){var ba=l.substr(U,2);U+=2}else ba=N,0===Ba&&c(Me);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="IS":(U=Y,Y=N)}else U=Y,Y=N;return Y}function ha(){var Y=U;if(l.substr(U,4).toLowerCase()===Pa){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(Ne);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="LIKE":(U=Y,Y=
N)}else U=Y,Y=N;return Y}function T(){var Y=U;if(l.substr(U,3).toLowerCase()===Za){var ba=l.substr(U,3);U+=3}else ba=N,0===Ba&&c(Oe);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="NOT":(U=Y,Y=N)}else U=Y,Y=N;return Y}function W(){var Y=U;if(l.substr(U,3).toLowerCase()===Ya){var ba=l.substr(U,3);U+=3}else ba=N,0===Ba&&c(Pe);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="AND":(U=Y,Y=N)}else U=Y,Y=N;return Y}function ca(){var Y=U;if(l.substr(U,
2).toLowerCase()===fb){var ba=l.substr(U,2);U+=2}else ba=N,0===Ba&&c(Qe);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="OR":(U=Y,Y=N)}else U=Y,Y=N;return Y}function da(){var Y=U;if(l.substr(U,7).toLowerCase()===nb){var ba=l.substr(U,7);U+=7}else ba=N,0===Ba&&c(Re);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="BETWEEN":(U=Y,Y=N)}else U=Y,Y=N;return Y}function ia(){var Y=U;if(l.substr(U,4).toLowerCase()===Se){var ba=l.substr(U,4);U+=4}else ba=
N,0===Ba&&c(Te);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="FROM":(U=Y,Y=N)}else U=Y,Y=N;return Y}function ja(){var Y=U;if(l.substr(U,4).toLowerCase()===Ue){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(Ve);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="TRIM":(U=Y,Y=N)}else U=Y,Y=N;return Y}function aa(){var Y=U;if(l.substr(U,8).toLowerCase()===We){var ba=l.substr(U,8);U+=8}else ba=N,0===Ba&&c(Xe);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===
N?ba=void 0:(U=ba,ba=N);ba!==N?Y="INTERVAL":(U=Y,Y=N)}else U=Y,Y=N;return Y}function ea(){var Y=U;if(l.substr(U,4).toLowerCase()===Ye){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(Ze);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="YEAR":(U=Y,Y=N)}else U=Y,Y=N;return Y}function la(){var Y=U;if(l.substr(U,5).toLowerCase()===$e){var ba=l.substr(U,5);U+=5}else ba=N,0===Ba&&c(af);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="MONTH":(U=Y,Y=N)}else U=
Y,Y=N;return Y}function qa(){var Y=U;if(l.substr(U,3).toLowerCase()===bf){var ba=l.substr(U,3);U+=3}else ba=N,0===Ba&&c(cf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="DAY":(U=Y,Y=N)}else U=Y,Y=N;return Y}function sa(){var Y=U;if(l.substr(U,4).toLowerCase()===df){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(ef);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="HOUR":(U=Y,Y=N)}else U=Y,Y=N;return Y}function wa(){var Y=U;if(l.substr(U,6).toLowerCase()===
ff){var ba=l.substr(U,6);U+=6}else ba=N,0===Ba&&c(gf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="MINUTE":(U=Y,Y=N)}else U=Y,Y=N;return Y}function za(){var Y=U;if(l.substr(U,6).toLowerCase()===hf){var ba=l.substr(U,6);U+=6}else ba=N,0===Ba&&c(jf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="SECOND":(U=Y,Y=N)}else U=Y,Y=N;return Y}function Da(){var Y=U;if(l.substr(U,4).toLowerCase()===kf){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(lf);
if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="CASE":(U=Y,Y=N)}else U=Y,Y=N;return Y}function Ja(){var Y=U;if(l.substr(U,3).toLowerCase()===mf){var ba=l.substr(U,3);U+=3}else ba=N,0===Ba&&c(nf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="END":(U=Y,Y=N)}else U=Y,Y=N;return Y}function Ga(){var Y=U;if(l.substr(U,4).toLowerCase()===of){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(pf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=
ba,ba=N);ba!==N?Y="WHEN":(U=Y,Y=N)}else U=Y,Y=N;return Y}function Ha(){var Y=U;if(l.substr(U,4).toLowerCase()===qf){var ba=l.substr(U,4);U+=4}else ba=N,0===Ba&&c(rf);if(ba!==N){ba=U;Ba++;var ma=P();Ba--;ma===N?ba=void 0:(U=ba,ba=N);ba!==N?Y="THEN":(U=Y,Y=N)}else U=Y,Y=N;return Y}function Ia(){if(44===l.charCodeAt(U)){var Y=sf;U++}else Y=N,0===Ba&&c(tf);return Y}function La(){if(40===l.charCodeAt(U)){var Y=uf;U++}else Y=N,0===Ba&&c(vf);return Y}function Oa(){if(41===l.charCodeAt(U)){var Y=wf;U++}else Y=
N,0===Ba&&c(xf);return Y}function ya(){var Y;var ba=[];for(Y=Va();Y!==N;)ba.push(Y),Y=Va();return ba}function Va(){if(yf.test(l.charAt(U))){var Y=l.charAt(U);U++}else Y=N,0===Ba&&c(zf);return Y}function Qa(Y,ba,ma,Aa){Y={type:"binary_expr",operator:Y,left:ba,right:ma};void 0!==Aa&&(Y.escape=Aa);return Y}function Na(Y,ba){for(var ma=0;ma<ba.length;ma++)Y=Qa(ba[ma][1],Y,ba[ma][3]);return Y}e=void 0!==e?e:{};var N={},Wa=e.grammarSource,Ua={start:d},ib=d,ra="!",Ab="\x3d",ob="\x3e\x3d",cb="\x3e",Cb="\x3c\x3d",
Qb="\x3c\x3e",Rb="\x3c",cc="!\x3d",gb="+",sb="-",Xa="*",mb="/",vb="@",Ta="'",Eb="N'",ka="''",pa=".",na="null",ta="true",Ea="false",Fa="in",Ma="is",Pa="like",$a="escape",Za="not",Ya="and",fb="or",nb="between",Se="from",Vd="for",Qd="substring",Kd="extract",Ue="trim",ae="position",Hd="timestamp",Ed="date",te="leading",ve="trailing",xe="both",ze="to",We="interval",Ye="year",$e="month",bf="day",df="hour",ff="minute",hf="second",kf="case",mf="end",of="when",qf="then",Ce="else",sf=",",uf="(",wf=")",ad="`",
me=/^[A-Za-z_\x80-\uFFFF]/,oe=/^[A-Za-z0-9_]/,qe=/^[A-Za-z0-9_.\x80-\uFFFF]/,ld=/^[^']/,Je=/^[0-9]/,Fe=/^[eE]/,He=/^[+\-]/,yf=/^[ \t\n\r]/,cd=/^[^`]/,nd=h("!",!1),Lc=h("\x3d",!1),pd=h("\x3e\x3d",!1),qd=h("\x3e",!1),rd=h("\x3c\x3d",!1),sd=h("\x3c\x3e",!1),td=h("\x3c",!1),ud=h("!\x3d",!1),wc=h("+",!1),xc=h("-",!1),vd=h("*",!1),wd=h("/",!1),ne=k([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),pe=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),re=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),se=h("@",!1),jd=h("'",!1),Be=h("N'",!1),kd=h("''",!1),md=k(["'"],!0,!1),Ee=h(".",!1),Ke=k([["0","9"]],!1,!1),Ge=k(["e","E"],!1,!1),Ie=k(["+","-"],!1,!1),Cd=h("NULL",!0),yd=h("TRUE",!0),Ad=h("FALSE",!0),Le=h("IN",!0),Me=h("IS",!0),Ne=h("LIKE",!0),od=h("ESCAPE",!0),Oe=h("NOT",!0),Pe=h("AND",!0),Qe=h("OR",!0),Re=h("BETWEEN",!0),Te=h("FROM",!0),Wd=h("FOR",!0),Rd=h("SUBSTRING",!0),Ld=h("EXTRACT",!0),Ve=h("TRIM",!0),be=h("POSITION",!0),Id=h("TIMESTAMP",!0),Fd=h("DATE",!0),ue=h("LEADING",!0),we=h("TRAILING",
!0),ye=h("BOTH",!0),Ae=h("TO",!0),Xe=h("INTERVAL",!0),Ze=h("YEAR",!0),af=h("MONTH",!0),cf=h("DAY",!0),ef=h("HOUR",!0),gf=h("MINUTE",!0),jf=h("SECOND",!0),lf=h("CASE",!0),nf=h("END",!0),pf=h("WHEN",!0),rf=h("THEN",!0),De=h("ELSE",!0),tf=h(",",!1),vf=h("(",!1),xf=h(")",!1),zf=k([" ","\t","\n","\r"],!1,!1),bd=h("`",!1),dd=k(["`"],!0,!1),hd=function(Y){return{type:"interval-period",period:Y.value,precision:null,secondary:null}},id=function(Y,ba){return{type:"interval-period",period:"second",precision:Y,
secondary:ba}},U=0,bc=[{line:1,column:1}],rb=0,vc=[],Ba=0;if("startRule"in e){if(!(e.startRule in Ua))throw Error("Can't start parsing from rule \""+e.startRule+'".');ib=Ua[e.startRule]}var Kc=ib();if(Kc!==N&&U===l.length)return Kc;Kc!==N&&U<l.length&&c({type:"end"});throw function(Y,ba,ma){return new A(A.buildMessage(Y,ba),Y,ba,ma)}(vc,rb<l.length?l.charAt(rb):null,rb<l.length?p(rb,rb+1):p(rb,rb));}}})})(F);let C=function(){function v(){}v.parse=function(A){return F.exports.parse(A)};return v}();
r.WhereGrammar=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(r){r.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};r.commonjsRequire=function(t){throw Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
};r.getDefaultExportFromCjs=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(r,t,F,C,v,A,w){function l(a,b){if(!b)return null;if("x"in
b){var f={x:0,y:0};[f.x,f.y]=a(b.x,b.y,n);null!=b.z&&(f.z=b.z);null!=b.m&&(f.m=b.m);return f}if("xmin"in b)return f={xmin:0,ymin:0,xmax:0,ymax:0},[f.xmin,f.ymin]=a(b.xmin,b.ymin,n),[f.xmax,f.ymax]=a(b.xmax,b.ymax,n),b.hasZ&&(f.zmin=b.zmin,f.zmax=b.zmax,f.hasZ=!0),b.hasM&&(f.mmin=b.mmin,f.mmax=b.mmax,f.hasM=!0),f;if("rings"in b)return{rings:e(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:e(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:h(b.points,a),hasM:b.hasM,
hasZ:b.hasZ}}function e(a,b){const f=[];for(const m of a)f.push(h(m,b));return f}function h(a,b){const f=[];for(const m of a)a=b(m[0],m[1],[0,0]),f.push(a),2<m.length&&a.push(m[2]),3<m.length&&a.push(m[3]);return f}function k(){k=t._asyncToGenerator(function*(a,b){b&&(a=Array.isArray(a)?a.map(f=>F.isSome(f.geometry)&&f.geometry.spatialReference):[a],yield C.initializeProjection(a.map(f=>({source:f,dest:b}))))});return k.apply(this,arguments)}const n=[0,0],p=l.bind(null,w.lngLatToXY),c=l.bind(null,
w.xyToLngLat),d=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var b=a.prototype;b.push=function(){var f=t._asyncToGenerator(function*(m,g,x){if(!(m&&m.length&&g&&x)||A.equals(g,x))return m;const q={geometries:m,inSpatialReference:g,outSpatialReference:x,resolve:null};this._jobs.push(q);return new Promise(B=>{q.resolve=B;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(m,g,x){return f.apply(this,arguments)}}();b._process=
function(){this._timer=null;const f=this._jobs.shift();if(f){var {geometries:m,inSpatialReference:g,outSpatialReference:x,resolve:q}=f;w.canProject(g,x)?A.isWebMercator(x)?q(m.map(p)):q(m.map(c)):q(C.projectMany(v.jsonAdapter,m,g,x,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());r.checkProjectionSupport=function(a,b){return k.apply(this,arguments)};r.project=function(a,b,f){if(!a)return a;f||(f=b,b=a.spatialReference);return A.isValid(b)&&A.isValid(f)&&!A.equals(b,
f)?w.canProject(b,f)?(a=A.isWebMercator(f)?p(a):c(a),a.spatialReference=f,a):C.projectMany(v.jsonAdapter,[a],b,f,null)[0]:a};r.projectMany=function(a,b,f){return d.push(a,b,f)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/SupportedGCSWkids ./support/zscale".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q,B,z,u){function y(){return!!Na&&c.isLoaded()}function E(ka){A.isNone(Wa)&&(Wa=Promise.all([c.load(),(new Promise((pa,na)=>r(["../chunks/geometryEngineBase"],pa,na))).then(pa=>pa.geometryEngineBase),new Promise((pa,na)=>r(["./geometryAdapters/hydrated"],pa,na))]));return Wa.then(([,pa,{hydratedAdapter:na}])=>{w.throwIfAborted(ka);N=na;Na=pa.default;Na._enableProjection(c.pe)})}function H(ka,pa,na=null){return Array.isArray(ka)?0===ka.length?[]:J(N,
ka,ka[0].spatialReference,pa,na):J(N,[ka],ka.spatialReference,pa,na)[0]}function J(ka,pa,na,ta,Ea=null){if(A.isNone(na)||A.isNone(ta))return pa;if(O(na,ta,Ea))return pa.map(Fa=>A.unwrap(D(Fa,na,ta)));if(A.isNone(Ea)){const Fa=q.cacheKey(na,ta);void 0!==Ua[Fa]?Ea=Ua[Fa]:(Ea=P(na,ta,null),A.isNone(Ea)&&(Ea=new q),Ua[Fa]=Ea)}if(A.isNone(Na))throw new ib;return Na._project(ka,pa,na,ta,Ea)}function P(ka,pa,na=null){if(A.isNone(Na))throw new ib;if(A.isNone(ka)||A.isNone(pa))return null;ka=Na._getTransformation(N,
ka,pa,na,null==na?void 0:na.spatialReference);return null!==ka?q.fromGE(ka):null}function O(ka,pa,na){return na?!1:B.equals(ka,pa)?!0:B.isValid(ka)&&B.isValid(pa)&&!!ya(ka,pa,Rb)}function K(){K=F._asyncToGenerator(function*(ka,pa,na,ta){if(!y())if(Array.isArray(ka))for(const {source:Ea,dest:Fa,geographicTransformation:Ma}of ka){if(!O(Ea,Fa,Ma))return E(ta)}else if(!O(ka,pa,na))return E(ta)});return K.apply(this,arguments)}function D(ka,pa,na){return ka?"x"in ka?I(ka,pa,new d,na,0):"xmin"in ka?X(ka,
pa,new n,na,0):"rings"in ka?Z(ka,pa,new a,na,0):"paths"in ka?R(ka,pa,new b,na,0):"points"in ka?L(ka,pa,new p,na,0):null:null}function I(ka,pa,na,ta,Ea){Ta[0]=ka.x;Ta[1]=ka.y;const Fa=ka.z;Ta[2]=void 0!==Fa?Fa:Ea;if(!fa(Ta,pa,0,Ta,ta,0,1))return null;na.x=Ta[0];na.y=Ta[1];na.spatialReference=ta;void 0===Fa?(na.z=void 0,na.hasZ=!1):(na.z=Ta[2],na.hasZ=!0);void 0===ka.m?(na.m=void 0,na.hasM=!1):(na.m=ka.m,na.hasM=!0);return na}function L(ka,pa,na,ta,Ea){const {points:Fa,hasZ:Ma,hasM:Pa}=ka;ka=[];const $a=
Fa.length,Za=[];for(var Ya of Fa)Za.push(Ya[0],Ya[1],Ma?Ya[2]:Ea);if(!fa(Za,pa,0,Za,ta,0,$a))return null;for(pa=0;pa<$a;++pa){Ea=3*pa;Ya=Za[Ea];const fb=Za[Ea+1];Ma&&Pa?ka.push([Ya,fb,Za[Ea+2],Fa[pa][3]]):Ma?ka.push([Ya,fb,Za[Ea+2]]):Pa?ka.push([Ya,fb,Fa[pa][2]]):ka.push([Ya,fb])}na.points=ka;na.spatialReference=ta;na.hasZ=Ma;na.hasM=Pa;return na}function R(ka,pa,na,ta,Ea){const {paths:Fa,hasZ:Ma,hasM:Pa}=ka;ka=[];if(!oa(Fa,Ma,Pa,pa,ka,ta,Ea))return null;na.paths=ka;na.spatialReference=ta;na.hasZ=
Ma;na.hasM=Pa;return na}function Z(ka,pa,na,ta,Ea){const {rings:Fa,hasZ:Ma,hasM:Pa}=ka;ka=[];if(!oa(Fa,Ma,Pa,pa,ka,ta,Ea))return null;na.rings=ka;na.spatialReference=ta;na.hasZ=Ma;na.hasM=Pa;return na}function X(ka,pa,na,ta,Ea){const {xmin:Fa,ymin:Ma,xmax:Pa,ymax:$a,hasZ:Za,hasM:Ya}=ka;if(!Q(Fa,Ma,Za?ka.zmin:Ea,pa,Ta,ta))return null;na.xmin=Ta[0];na.ymin=Ta[1];Za&&(na.zmin=Ta[2]);if(!Q(Pa,$a,Za?ka.zmax:Ea,pa,Ta,ta))return null;na.xmax=Ta[0];na.ymax=Ta[1];Za&&(na.zmax=Ta[2]);Ya&&(na.mmin=ka.mmin,na.mmax=
ka.mmax);na.spatialReference=ta;return na}function Q(ka,pa,na,ta,Ea,Fa){Xa[0]=ka;Xa[1]=pa;Xa[2]=na;return fa(Xa,ta,0,Ea,Fa,0,1)}function M(ka,pa,na,ta){if(A.isNone(pa)||A.isNone(ta)||2>ka.length)return!1;2===ka.length&&(Xa[0]=ka[0],Xa[1]=ka[1],Xa[2]=0,ka=Xa);return fa(ka,pa,0,na,ta,0,1)}function V(ka,pa,na){if(A.isNone(pa))return!1;pa=va(pa,Cb);pa=cb[pa][ra.WGS84_COMPARABLE_LON_LAT];if(A.isNone(pa))return!1;pa(ka,0,Xa,0);na!==Xa&&(na[0]=Xa[0],na[1]=Xa[1],2<na.length&&(na[2]=Xa[2]));return!0}function fa(ka,
pa,na,ta,Ea,Fa,Ma=1){pa=ya(pa,Ea,Rb);if(A.isNone(pa))return!1;if(pa===G){if(ka===ta&&na===Fa)return!0;Ma=na+3*Ma;for(let Pa=na,$a=Fa;Pa<Ma;Pa++,$a++)ta[$a]=ka[Pa];return!0}Ma=na+3*Ma;for(let Pa=na,$a=Fa;Pa<Ma;Pa+=3,$a+=3)pa(ka,Pa,ta,$a);return!0}function oa(ka,pa,na,ta,Ea,Fa,Ma=0){const Pa=[];for(const $a of ka)for(const Za of $a)Pa.push(Za[0],Za[1],pa?Za[2]:Ma);if(!fa(Pa,ta,0,Pa,Fa,0,Pa.length/3))return!1;ta=0;Ea.length=0;for(const $a of ka){ka=[];for(const Za of $a)pa&&na?ka.push([Pa[ta++],Pa[ta++],
Pa[ta++],Za[3]]):pa?ka.push([Pa[ta++],Pa[ta++],Pa[ta++]]):(na?ka.push([Pa[ta++],Pa[ta++],Za[2]]):ka.push([Pa[ta++],Pa[ta++]]),ta++);Ea.push(ka)}return!0}function ua(ka,pa,na,ta){pa=ta+pa;if(pa<ta/2||na>pa)return Number.MAX_VALUE;ka=Math.abs(gb*ka)+Math.asin(na/pa);return ka>=Math.PI/2?Number.MAX_VALUE:na/Math.cos(ka)}function xa(ka,pa,na){const ta=Math.sin(ka);ka=Math.cos(ka);const Ea=Math.sin(pa);pa=Math.cos(pa);na[0]=-ta;na[4]=-Ea*ka;na[8]=pa*ka;na[12]=0;na[1]=ka;na[5]=-Ea*ta;na[9]=pa*ta;na[13]=
0;na[2]=0;na[6]=pa;na[10]=Ea;na[14]=0;na[3]=0;na[7]=0;na[11]=0;na[15]=1;return na}function Ca(ka,pa,na){xa(ka,pa,na);e.transpose(na,na);return na}function va(ka,pa){if(pa.spatialReference===ka)return pa.spatialReferenceId;pa.spatialReference=ka;"metersPerUnit"in pa&&(pa.metersPerUnit=l.getMetersPerUnitForSR(ka,1));return ka.wkt===f.SphericalECEFSpatialReference.wkt?pa.spatialReferenceId=ra.SPHERICAL_ECEF:B.isWGS84(ka)?pa.spatialReferenceId=ra.WGS84:B.isWebMercator(ka)?pa.spatialReferenceId=ra.WEB_MERCATOR:
B.isPlateCarree(ka)?pa.spatialReferenceId=ra.PLATE_CARREE:ka.wkt===f.WGS84ECEFSpatialReference.wkt?pa.spatialReferenceId=ra.WGS84_ECEF:ka.wkid===z.SupportedGCSWkids.CGCS2000?pa.spatialReferenceId=ra.CGCS2000:ka.wkt===f.SphericalPCPFMars.wkt?pa.spatialReferenceId=ra.SPHERICAL_MARS_PCPF:ka.wkt===f.SphericalPCPFMoon.wkt?pa.spatialReferenceId=ra.SPHERICAL_MOON_PCPF:B.isMars(ka)?pa.spatialReferenceId=ra.GCSMARS2000:B.isMoon(ka)?pa.spatialReferenceId=ra.GCSMOON2000:pa.spatialReferenceId=ra.UNKNOWN}function G(ka,
pa,na,ta){ka!==na&&(na[ta++]=ka[pa++],na[ta++]=ka[pa++],na[ta]=ka[pa])}function S(ka,pa,na,ta){na[ta++]=sb*(ka[pa++]/g.earth.radius);na[ta++]=sb*(Math.PI/2-2*Math.atan(Math.exp(-ka[pa++]/g.earth.radius)));na[ta]=ka[pa]}function ha(ka,pa,na,ta){S(ka,pa,na,ta);qa(na,ta,na,ta)}function T(ka,pa,na,ta){S(ka,pa,na,ta);Ha(na,ta,na,ta)}function W(ka,pa,na,ta,Ea){var Fa=.4999999*Math.PI;Fa=v.clamp(gb*ka[pa+1],-Fa,Fa);Fa=Math.sin(Fa);na[ta++]=gb*ka[pa]*Ea.radius;na[ta++]=Ea.halfSemiMajorAxis*Math.log((1+Fa)/
(1-Fa));na[ta]=ka[pa+2]}function ca(ka,pa,na,ta){W(ka,pa,na,ta,g.earth)}function da(ka,pa,na,ta){na[ta]=ka[pa]*Ab;na[ta+1]=ka[pa+1]*Ab;na[ta+2]=ka[pa+2]}function ia(ka,pa,na,ta){na[ta]=ka[pa]*ob;na[ta+1]=ka[pa+1]*ob;na[ta+2]=ka[pa+2]}function ja(ka,pa,na,ta){S(ka,pa,na,ta);da(na,ta,na,ta)}function aa(ka,pa,na,ta,Ea){Ea+=ka[pa+2];const Fa=gb*ka[pa+1];ka=gb*ka[pa];pa=Math.cos(Fa);na[ta++]=Math.cos(ka)*pa*Ea;na[ta++]=Math.sin(ka)*pa*Ea;na[ta]=Math.sin(Fa)*Ea}function ea(ka,pa,na,ta){aa(ka,pa,na,ta,g.moon.radius)}
function la(ka,pa,na,ta){aa(ka,pa,na,ta,g.mars.radius)}function qa(ka,pa,na,ta){aa(ka,pa,na,ta,g.earth.radius)}function sa(ka,pa,na,ta,Ea){var Fa=ka[pa];const Ma=ka[pa+1];pa=ka[pa+2];ka=Math.sqrt(Fa*Fa+Ma*Ma+pa*pa);pa=v.asinClamped(pa/(0===ka?1:ka));Fa=Math.atan2(Ma,Fa);na[ta++]=sb*Fa;na[ta++]=sb*pa;na[ta]=ka-Ea}function wa(ka,pa,na,ta){sa(ka,pa,na,ta,g.moon.radius)}function za(ka,pa,na,ta){sa(ka,pa,na,ta,g.mars.radius)}function Da(ka,pa,na,ta){sa(ka,pa,na,ta,g.earth.radius)}function Ja(ka,pa,na,
ta){Da(ka,pa,na,ta);ca(na,ta,na,ta)}function Ga(ka,pa,na,ta){Da(ka,pa,na,ta);Ha(na,ta,na,ta)}function Ha(ka,pa,na,ta){{var Ea=g.earth;const Ma=gb*ka[pa];var Fa=gb*ka[pa+1];ka=ka[pa+2];pa=Math.sin(Fa);Fa=Math.cos(Fa);const Pa=Ea.radius/Math.sqrt(1-Ea.eccentricitySquared*pa*pa);na[ta++]=(Pa+ka)*Fa*Math.cos(Ma);na[ta++]=(Pa+ka)*Fa*Math.sin(Ma);na[ta++]=(Pa*(1-Ea.eccentricitySquared)+ka)*pa}}function Ia(ka,pa,na,ta){var Ea=x.earthEllipsoidConstants,Fa=ka[pa],Ma=ka[pa+1];ka=ka[pa+2];let Pa;pa=Math.abs(ka);
var $a=Fa*Fa+Ma*Ma;var Za=Math.sqrt($a);var Ya=$a+ka*ka;var fb=Math.sqrt(Ya);Fa=Math.atan2(Ma,Fa);var nb=ka*ka/Ya;Ya=$a/Ya;Ma=Ea.a2/fb;$a=Ea.a3-Ea.a4/fb;.3<Ya?(nb=pa/fb*(1+Ya*(Ea.a1+Ma+nb*$a)/fb),fb=Math.asin(nb),Ma=nb*nb,Ya=Math.sqrt(1-Ma)):(Ya=Za/fb*(1-nb*(Ea.a5-Ma-Ya*$a)/fb),fb=Math.acos(Ya),Ma=1-Ya*Ya,nb=Math.sqrt(Ma));Pa=1-g.earth.eccentricitySquared*Ma;Ma=g.earth.radius/Math.sqrt(Pa);Ea=Ea.a6*Ma;Ma=Za-Ma*Ya;$a=pa-Ea*nb;pa=Ya*Ma+nb*$a;Za=Ya*$a-nb*Ma;Ea=Za/(Ea/Pa+pa);fb+=Ea;0>ka&&(fb=-fb);na[ta++]=
sb*Fa;na[ta++]=sb*fb;na[ta]=pa+Za*Ea/2}function La(ka,pa,na,ta){Ia(ka,pa,na,ta);qa(na,ta,na,ta)}function Oa(ka,pa,na,ta){Ia(ka,pa,na,ta);ca(na,ta,na,ta)}function ya(ka,pa,na=Qa()){return A.isNone(ka)||A.isNone(pa)?null:Va(ka,pa,na).projector}function Va(ka,pa,na){if(A.isNone(ka)||A.isNone(pa)||na.source.spatialReference===ka&&na.dest.spatialReference===pa)return na;const ta=va(ka,na.source),Ea=va(pa,na.dest);ta===ra.UNKNOWN&&Ea===ra.UNKNOWN?B.equals(ka,pa)?na.projector=G:na.projector=null:na.projector=
cb[ta][Ea];return na}function Qa(){return{source:{spatialReference:null,spatialReferenceId:ra.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:ra.UNKNOWN,metersPerUnit:1},projector:G}}let Na=null,N=null,Wa=null,Ua={},ib=function(ka){function pa(){return ka.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}F._inheritsLoose(pa,ka);return pa}(C);var ra;(function(ka){ka[ka.UNKNOWN=0]="UNKNOWN";ka[ka.SPHERICAL_ECEF=1]="SPHERICAL_ECEF";
ka[ka.WGS84=2]="WGS84";ka[ka.WEB_MERCATOR=3]="WEB_MERCATOR";ka[ka.WGS84_ECEF=4]="WGS84_ECEF";ka[ka.CGCS2000=5]="CGCS2000";ka[ka.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT";ka[ka.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF";ka[ka.GCSMARS2000=8]="GCSMARS2000";ka[ka.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF";ka[ka.GCSMOON2000=10]="GCSMOON2000";ka[ka.LON_LAT=11]="LON_LAT";ka[ka.PLATE_CARREE=12]="PLATE_CARREE"})(ra||(ra={}));const Ab=g.earth.radius*Math.PI/180,ob=180/(g.earth.radius*Math.PI),
cb={[ra.WGS84]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:G,[ra.WGS84_COMPARABLE_LON_LAT]:G,[ra.SPHERICAL_ECEF]:qa,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:ca,[ra.PLATE_CARREE]:da,[ra.WGS84]:G,[ra.WGS84_ECEF]:Ha},[ra.CGCS2000]:{[ra.CGCS2000]:G,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:G,[ra.WGS84_COMPARABLE_LON_LAT]:G,[ra.SPHERICAL_ECEF]:qa,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,
[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:da,[ra.WGS84]:null,[ra.WGS84_ECEF]:Ha},[ra.GCSMARS2000]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:G,[ra.GCSMOON2000]:null,[ra.LON_LAT]:G,[ra.WGS84_COMPARABLE_LON_LAT]:null,[ra.SPHERICAL_ECEF]:null,[ra.SPHERICAL_MARS_PCPF]:la,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:null,[ra.WGS84]:null,[ra.WGS84_ECEF]:null},[ra.GCSMOON2000]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:G,[ra.LON_LAT]:G,
[ra.WGS84_COMPARABLE_LON_LAT]:null,[ra.SPHERICAL_ECEF]:null,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:ea,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:null,[ra.WGS84]:null,[ra.WGS84_ECEF]:null},[ra.WEB_MERCATOR]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:S,[ra.WGS84_COMPARABLE_LON_LAT]:S,[ra.SPHERICAL_ECEF]:ha,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:G,[ra.PLATE_CARREE]:ja,[ra.WGS84]:S,
[ra.WGS84_ECEF]:T},[ra.WGS84_ECEF]:{[ra.CGCS2000]:Ia,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:Ia,[ra.WGS84_COMPARABLE_LON_LAT]:Ia,[ra.SPHERICAL_ECEF]:La,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:Oa,[ra.PLATE_CARREE]:function(ka,pa,na,ta){Ia(ka,pa,na,ta);da(na,ta,na,ta)},[ra.WGS84]:Ia,[ra.WGS84_ECEF]:G},[ra.SPHERICAL_ECEF]:{[ra.CGCS2000]:Da,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:Da,[ra.WGS84_COMPARABLE_LON_LAT]:Da,
[ra.SPHERICAL_ECEF]:G,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:Ja,[ra.PLATE_CARREE]:function(ka,pa,na,ta){Da(ka,pa,na,ta);da(na,ta,na,ta)},[ra.WGS84]:Da,[ra.WGS84_ECEF]:Ga},[ra.SPHERICAL_MARS_PCPF]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:za,[ra.GCSMOON2000]:null,[ra.LON_LAT]:za,[ra.WGS84_COMPARABLE_LON_LAT]:null,[ra.SPHERICAL_ECEF]:null,[ra.SPHERICAL_MARS_PCPF]:G,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:null,
[ra.WGS84]:null,[ra.WGS84_ECEF]:null},[ra.SPHERICAL_MOON_PCPF]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:wa,[ra.LON_LAT]:wa,[ra.WGS84_COMPARABLE_LON_LAT]:null,[ra.SPHERICAL_ECEF]:null,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:G,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:null,[ra.WGS84]:null,[ra.WGS84_ECEF]:null},[ra.UNKNOWN]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:null,[ra.WGS84_COMPARABLE_LON_LAT]:null,[ra.SPHERICAL_ECEF]:null,
[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:G,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:null,[ra.WGS84]:null,[ra.WGS84_ECEF]:null},[ra.LON_LAT]:{[ra.CGCS2000]:G,[ra.GCSMARS2000]:G,[ra.GCSMOON2000]:G,[ra.LON_LAT]:G,[ra.WGS84_COMPARABLE_LON_LAT]:G,[ra.SPHERICAL_ECEF]:qa,[ra.SPHERICAL_MARS_PCPF]:la,[ra.SPHERICAL_MOON_PCPF]:ea,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:ca,[ra.PLATE_CARREE]:da,[ra.WGS84]:G,[ra.WGS84_ECEF]:Ha},[ra.WGS84_COMPARABLE_LON_LAT]:{[ra.CGCS2000]:null,[ra.GCSMARS2000]:null,
[ra.GCSMOON2000]:null,[ra.LON_LAT]:G,[ra.WGS84_COMPARABLE_LON_LAT]:G,[ra.SPHERICAL_ECEF]:qa,[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:null,[ra.PLATE_CARREE]:da,[ra.WGS84]:G,[ra.WGS84_ECEF]:Ha},[ra.PLATE_CARREE]:{[ra.CGCS2000]:ia,[ra.GCSMARS2000]:null,[ra.GCSMOON2000]:null,[ra.LON_LAT]:ia,[ra.WGS84_COMPARABLE_LON_LAT]:ia,[ra.SPHERICAL_ECEF]:function(ka,pa,na,ta){ia(ka,pa,na,ta);qa(na,ta,na,ta)},[ra.SPHERICAL_MARS_PCPF]:null,[ra.SPHERICAL_MOON_PCPF]:null,
[ra.UNKNOWN]:null,[ra.WEB_MERCATOR]:function(ka,pa,na,ta){ia(ka,pa,na,ta);ca(na,ta,na,ta)},[ra.PLATE_CARREE]:G,[ra.WGS84]:ia,[ra.WGS84_ECEF]:function(ka,pa,na,ta){ia(ka,pa,na,ta);Ha(na,ta,na,ta)}}},Cb={spatialReference:null,spatialReferenceId:ra.UNKNOWN},Qb={spatialReference:null,spatialReferenceId:ra.UNKNOWN},Rb=Qa(),cc=Qa(),gb=v.deg2rad(1),sb=v.rad2deg(1),Xa=k.create(),mb=k.create(),vb=k.create(),Ta=k.create(),Eb=k.create();t.canProjectToWGS84ComparableLonLat=function(ka){if(A.isNone(ka))return!1;
ka=va(ka,Cb);return!!cb[ka][ra.WGS84_COMPARABLE_LON_LAT]};t.canProjectWithoutEngine=O;t.computeENUToSphericalPCPFLocalRotation=xa;t.computeSphericalPCPFToENULocalRotation=Ca;t.computeTranslationToOriginAndRotation=function(ka,pa,na,ta){if(A.isNone(ka)||A.isNone(ta))return!1;var Ea=va(ka,Cb),Fa=va(ta,Qb);if(Ea===Fa&&Fa!==ra.SPHERICAL_ECEF&&Fa!==ra.SPHERICAL_MARS_PCPF&&Fa!==ra.SPHERICAL_MOON_PCPF&&(Ea!==ra.UNKNOWN||B.equals(ka,ta)))return e.fromTranslation(na,pa),!0;if(Fa===ra.SPHERICAL_ECEF||Fa===
ra.SPHERICAL_MARS_PCPF||Fa===ra.SPHERICAL_MOON_PCPF){Ea=cb[Ea][ra.LON_LAT];Fa=cb[ra.LON_LAT][Fa];if(A.isNone(Ea)||A.isNone(Fa))return!1;Ea(pa,0,mb,0);Fa(mb,0,vb,0);xa(gb*mb[0],gb*mb[1],na);na[12]=vb[0];na[13]=vb[1];na[14]=vb[2];return!0}if((Fa===ra.WEB_MERCATOR||Fa===ra.PLATE_CARREE)&&(Ea===ra.WGS84||Ea===ra.CGCS2000&&Fa===ra.PLATE_CARREE||Ea===ra.SPHERICAL_ECEF||Ea===ra.WEB_MERCATOR)){ka=cb[Ea][ra.LON_LAT];Fa=cb[ra.LON_LAT][Fa];if(A.isNone(ka)||A.isNone(Fa))return!1;ka(pa,0,mb,0);Fa(mb,0,vb,0);Ea===
ra.SPHERICAL_ECEF?Ca(gb*mb[0],gb*mb[1],na):e.identity(na);na[12]=vb[0];na[13]=vb[1];na[14]=vb[2];return!0}return!1};t.getProjectorName=function(ka,pa){switch(ya(ka,pa,Rb)){case G:return"copy3";case qa:return"wgs84ToSphericalECEF";case ca:return"wgs84ToWebMercator";case da:return"wgs84ToPlateCarree";case Ha:return"wgs84ToWGS84ECEF";case S:return"webMercatorToWGS84";case ha:return"webMercatorToSphericalECEF";case T:return"webMercatorToWGS84ECEF";case ja:return"webMercatorToPlateCarree";case Ia:return"wgs84ECEFToWGS84";
case La:return"wgs84ECEFToSphericalECEF";case Oa:return"wgs84ECEFToWebMercator";case Da:return"sphericalECEFToWGS84";case Ja:return"sphericalECEFToWebMercator";case za:return"sphericalMarsPCPFToMars2000";case wa:return"sphericalMoonPCPFToMoon2000";case Ga:return"sphericalECEFToWGS84ECEF";case la:return"mars2000ToSphericalPCPF";case ea:return"moon2000ToSphericalPCPF";default:return null}};t.getTransformation=P;t.getTransformations=function(ka,pa,na=null){if(A.isNone(Na))throw new ib;ka=Na._getTransformationBySuitability(N,
ka,pa,na,null==na?void 0:na.spatialReference);if(null!==ka){pa=[];for(const ta of ka)pa.push(q.fromGE(ta));return pa}return[]};t.initializeProjection=function(ka,pa,na,ta){return K.apply(this,arguments)};t.isLoaded=y;t.load=E;t.localLinearScaleFactors=function(ka,pa,na,ta){if(A.isNone(pa)||A.isNone(ta))return!1;const Ea=va(pa,Cb);var Fa=va(ta,Qb);if(Ea===Fa&&Ea!==ra.UNKNOWN||B.equals(pa,ta))return na[0]=1,na[1]=1,na[2]=1,!0;if(Ea===ra.SPHERICAL_ECEF){pa=h.length(ka);ka=pa/Math.sqrt(ka[0]*ka[0]+ka[1]*
ka[1]);pa/=g.earth.radius;if(Fa===ra.WEB_MERCATOR)return na[0]=ka*pa,na[1]=ka*pa,na[2]=1,!0;if(Fa===ra.WGS84||Fa===ra.CGCS2000)return Fa=ob,na[0]=Fa*ka*pa,na[1]=Fa*pa,na[2]=1,!0}else if(Ea===ra.PLATE_CARREE){if(Fa===ra.WGS84||Fa===ra.CGCS2000)return na[0]=ob,na[1]=ob,na[2]=1,!0;if(Fa===ra.WEB_MERCATOR)return Fa=ka[1]/g.earth.radius,na[0]=1,na[1]=1/Math.cos(Fa),na[2]=1,!0}return!1};t.lonLatToSphericalPCPF=function(ka,pa,na,ta,Ea=0){ta+=Ea;Ea=Math.cos(na);ka[0]=Math.cos(pa)*Ea*ta;ka[1]=Math.sin(pa)*
Ea*ta;ka[2]=Math.sin(na)*ta};t.lonLatToWebMercatorComparable=W;t.project=H;t.projectBoundingRect=function(ka,pa,na,ta){if(null==ka)return!1;if(B.equals(pa,ta))return m.copy(na,ka),!0;Xa[0]=ka[0];Xa[1]=ka[1];Xa[2]=0;if(!fa(Xa,pa,0,Xa,ta,0,1))return!1;na[0]=Xa[0];na[1]=Xa[1];Xa[0]=ka[2];Xa[1]=ka[3];Xa[2]=0;if(!fa(Xa,pa,0,Xa,ta,0,1))return!1;na[2]=Xa[0];na[3]=Xa[1];return!0};t.projectBoundingSphere=function(ka,pa,na,ta){if(A.isNone(pa)||A.isNone(ta))return!1;pa=Va(pa,ta,cc);if(pa.projector===G)return na[0]=
ka[0],na[1]=ka[1],na[2]=ka[2],na[3]=ka[3],!0;if(A.isNone(pa.projector))return!1;const {source:Ea,dest:Fa}=pa;if(Fa.spatialReferenceId===ra.WEB_MERCATOR){pa=cb[Ea.spatialReferenceId][ra.WGS84];if(A.isNone(pa))return!1;pa(ka,0,mb,0);ca(mb,0,na,0);na[3]=ua(mb[1],ka[2],ka[3],g.earth.radius);return!0}if(Ea.spatialReferenceId!==ra.WGS84&&Ea.spatialReferenceId!==ra.CGCS2000||Fa.spatialReferenceId!==ra.PLATE_CARREE)pa.projector(ka,0,na,0),na[3]=ka[3]*Ea.metersPerUnit/Fa.metersPerUnit;else{ta=cb[ra.SPHERICAL_ECEF][ra.PLATE_CARREE];
let Ma=ka[3];A.isSome(cb[Ea.spatialReferenceId][ra.SPHERICAL_ECEF])&&A.isSome(ta)&&(Ma=ua(ka[1],ka[2],ka[3],g.earth.radius));pa.projector(ka,0,na,0);na[3]=Ma}return!0};t.projectBuffer=fa;t.projectDirection=function(ka,pa,na,ta,Ea){h.copy(Ta,ka);h.add(Eb,ka,pa);M(Ta,na,Ta,Ea);M(Eb,na,Eb,Ea);h.subtract(ta,Eb,Ta);h.normalize(ta,ta)};t.projectExtent=function(ka,pa,na=pa.spatialReference,ta=0){return A.isSome(na)&&A.isSome(X(ka,ka.spatialReference,pa,na,ta))};t.projectMany=J;t.projectMultipoint=function(ka,
pa,na=pa.spatialReference,ta=0){return A.isNone(na)?!1:A.isSome(L(ka,ka.spatialReference,pa,na,ta))};t.projectPoint=function(ka,pa,na=pa.spatialReference,ta=0){return A.isNone(na)?!1:A.isSome(I(ka,ka.spatialReference,pa,na,ta))};t.projectPointToVector=function(ka,pa,na,ta=0){Ta[0]=ka.x;Ta[1]=ka.y;const Ea=ka.z;Ta[2]=void 0!==Ea?Ea:ta;return fa(Ta,ka.spatialReference,0,pa,na,0,1)};t.projectPointToWGS84ComparableLonLat=function(ka,pa){Ta[0]=ka.x;Ta[1]=ka.y;const na=ka.z;Ta[2]=void 0!==na?na:0;return V(Ta,
ka.spatialReference,pa)};t.projectPolygon=function(ka,pa,na=pa.spatialReference,ta=0){return A.isSome(na)&&A.isSome(Z(ka,ka.spatialReference,pa,na,ta))};t.projectPolyline=function(ka,pa,na=pa.spatialReference,ta=0){return A.isSome(na)&&A.isSome(R(ka,ka.spatialReference,pa,na,ta))};t.projectVectorToDehydratedPoint=function(ka,pa,na){return fa(ka,pa,0,Ta,na.spatialReference,0,1)?(na.x=Ta[0],na.y=Ta[1],na.z=Ta[2],na):null};t.projectVectorToPoint=function(ka,pa,na){if(A.isNone(pa)||A.isNone(na))return null;
const ta=new d({spatialReference:na});return fa(ka,pa,0,Ta,na,0,1)?(ta.x=Ta[0],ta.y=Ta[1],ta.z=Ta[2],ta):null};t.projectVectorToVector=M;t.projectVectorToWGS84ComparableLonLat=function(ka,pa,na){return V(ka,pa,na)};t.projectWithoutEngine=D;t.projectXYZToVector=Q;t.sphericalPCPFtoLonLatElevation=sa;t.tryProjectWithZConversion=function(ka,pa){try{const na=H(ka,pa);if(null==na)return null;"xmin"in ka&&"xmin"in na&&(na.zmin=ka.zmin,na.zmax=ka.zmax);const ta=u.getGeometryZScaler(na.type,ka.spatialReference,
pa);A.isSome(ta)&&ta(na);return na}catch(na){if(!(na instanceof ib))throw na;return null}};t.unload=function(){Wa=N=Na=null;Ua={}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(r,t,F){function C(G,S){G[0]=S[0];G[1]=S[1];G[2]=S[2];G[3]=S[3];G[4]=S[4];G[5]=S[5];G[6]=S[6];G[7]=S[7];G[8]=S[8];G[9]=S[9];G[10]=S[10];G[11]=S[11];G[12]=S[12];G[13]=S[13];G[14]=S[14];G[15]=S[15];return G}function v(G,S,ha,T,W,ca,da,ia,ja,
aa,ea,la,qa,sa,wa,za,Da){G[0]=S;G[1]=ha;G[2]=T;G[3]=W;G[4]=ca;G[5]=da;G[6]=ia;G[7]=ja;G[8]=aa;G[9]=ea;G[10]=la;G[11]=qa;G[12]=sa;G[13]=wa;G[14]=za;G[15]=Da;return G}function A(G){G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function w(G,S){if(G===S){const ha=S[1],T=S[2],W=S[3],ca=S[6],da=S[7],ia=S[11];G[1]=S[4];G[2]=S[8];G[3]=S[12];G[4]=ha;G[6]=S[9];G[7]=S[13];G[8]=T;G[9]=ca;G[11]=S[14];G[12]=W;G[13]=da;G[14]=ia}else G[0]=
S[0],G[1]=S[4],G[2]=S[8],G[3]=S[12],G[4]=S[1],G[5]=S[5],G[6]=S[9],G[7]=S[13],G[8]=S[2],G[9]=S[6],G[10]=S[10],G[11]=S[14],G[12]=S[3],G[13]=S[7],G[14]=S[11],G[15]=S[15];return G}function l(G,S){const ha=S[0],T=S[1],W=S[2],ca=S[3],da=S[4],ia=S[5],ja=S[6],aa=S[7],ea=S[8],la=S[9],qa=S[10],sa=S[11],wa=S[12],za=S[13],Da=S[14];S=S[15];const Ja=ha*ia-T*da,Ga=ha*ja-W*da,Ha=ha*aa-ca*da,Ia=T*ja-W*ia,La=T*aa-ca*ia,Oa=W*aa-ca*ja,ya=ea*za-la*wa,Va=ea*Da-qa*wa,Qa=ea*S-sa*wa,Na=la*Da-qa*za,N=la*S-sa*za,Wa=qa*S-sa*
Da;let Ua=Ja*Wa-Ga*N+Ha*Na+Ia*Qa-La*Va+Oa*ya;if(!Ua)return null;Ua=1/Ua;G[0]=(ia*Wa-ja*N+aa*Na)*Ua;G[1]=(W*N-T*Wa-ca*Na)*Ua;G[2]=(za*Oa-Da*La+S*Ia)*Ua;G[3]=(qa*La-la*Oa-sa*Ia)*Ua;G[4]=(ja*Qa-da*Wa-aa*Va)*Ua;G[5]=(ha*Wa-W*Qa+ca*Va)*Ua;G[6]=(Da*Ha-wa*Oa-S*Ga)*Ua;G[7]=(ea*Oa-qa*Ha+sa*Ga)*Ua;G[8]=(da*N-ia*Qa+aa*ya)*Ua;G[9]=(T*Qa-ha*N-ca*ya)*Ua;G[10]=(wa*La-za*Ha+S*Ja)*Ua;G[11]=(la*Ha-ea*La-sa*Ja)*Ua;G[12]=(ia*Va-da*Na-ja*ya)*Ua;G[13]=(ha*Na-T*Va+W*ya)*Ua;G[14]=(za*Ga-wa*Ia-Da*Ja)*Ua;G[15]=(ea*Ia-la*Ga+
qa*Ja)*Ua;return G}function e(G,S){const ha=S[0],T=S[1],W=S[2],ca=S[3],da=S[4],ia=S[5],ja=S[6],aa=S[7],ea=S[8],la=S[9],qa=S[10],sa=S[11],wa=S[12],za=S[13],Da=S[14];S=S[15];G[0]=ia*(qa*S-sa*Da)-la*(ja*S-aa*Da)+za*(ja*sa-aa*qa);G[1]=-(T*(qa*S-sa*Da)-la*(W*S-ca*Da)+za*(W*sa-ca*qa));G[2]=T*(ja*S-aa*Da)-ia*(W*S-ca*Da)+za*(W*aa-ca*ja);G[3]=-(T*(ja*sa-aa*qa)-ia*(W*sa-ca*qa)+la*(W*aa-ca*ja));G[4]=-(da*(qa*S-sa*Da)-ea*(ja*S-aa*Da)+wa*(ja*sa-aa*qa));G[5]=ha*(qa*S-sa*Da)-ea*(W*S-ca*Da)+wa*(W*sa-ca*qa);G[6]=
-(ha*(ja*S-aa*Da)-da*(W*S-ca*Da)+wa*(W*aa-ca*ja));G[7]=ha*(ja*sa-aa*qa)-da*(W*sa-ca*qa)+ea*(W*aa-ca*ja);G[8]=da*(la*S-sa*za)-ea*(ia*S-aa*za)+wa*(ia*sa-aa*la);G[9]=-(ha*(la*S-sa*za)-ea*(T*S-ca*za)+wa*(T*sa-ca*la));G[10]=ha*(ia*S-aa*za)-da*(T*S-ca*za)+wa*(T*aa-ca*ia);G[11]=-(ha*(ia*sa-aa*la)-da*(T*sa-ca*la)+ea*(T*aa-ca*ia));G[12]=-(da*(la*Da-qa*za)-ea*(ia*Da-ja*za)+wa*(ia*qa-ja*la));G[13]=ha*(la*Da-qa*za)-ea*(T*Da-W*za)+wa*(T*qa-W*la);G[14]=-(ha*(ia*Da-ja*za)-da*(T*Da-W*za)+wa*(T*ja-W*ia));G[15]=ha*
(ia*qa-ja*la)-da*(T*qa-W*la)+ea*(T*ja-W*ia);return G}function h(G){const S=G[0],ha=G[1],T=G[2],W=G[3],ca=G[4],da=G[5],ia=G[6],ja=G[7],aa=G[8],ea=G[9],la=G[10],qa=G[11],sa=G[12],wa=G[13],za=G[14];G=G[15];return(S*da-ha*ca)*(la*G-qa*za)-(S*ia-T*ca)*(ea*G-qa*wa)+(S*ja-W*ca)*(ea*za-la*wa)+(ha*ia-T*da)*(aa*G-qa*sa)-(ha*ja-W*da)*(aa*za-la*sa)+(T*ja-W*ia)*(aa*wa-ea*sa)}function k(G,S,ha){const T=S[0],W=S[1],ca=S[2],da=S[3],ia=S[4],ja=S[5],aa=S[6],ea=S[7],la=S[8],qa=S[9],sa=S[10],wa=S[11],za=S[12],Da=S[13],
Ja=S[14];S=S[15];let Ga=ha[0],Ha=ha[1],Ia=ha[2],La=ha[3];G[0]=Ga*T+Ha*ia+Ia*la+La*za;G[1]=Ga*W+Ha*ja+Ia*qa+La*Da;G[2]=Ga*ca+Ha*aa+Ia*sa+La*Ja;G[3]=Ga*da+Ha*ea+Ia*wa+La*S;Ga=ha[4];Ha=ha[5];Ia=ha[6];La=ha[7];G[4]=Ga*T+Ha*ia+Ia*la+La*za;G[5]=Ga*W+Ha*ja+Ia*qa+La*Da;G[6]=Ga*ca+Ha*aa+Ia*sa+La*Ja;G[7]=Ga*da+Ha*ea+Ia*wa+La*S;Ga=ha[8];Ha=ha[9];Ia=ha[10];La=ha[11];G[8]=Ga*T+Ha*ia+Ia*la+La*za;G[9]=Ga*W+Ha*ja+Ia*qa+La*Da;G[10]=Ga*ca+Ha*aa+Ia*sa+La*Ja;G[11]=Ga*da+Ha*ea+Ia*wa+La*S;Ga=ha[12];Ha=ha[13];Ia=ha[14];
La=ha[15];G[12]=Ga*T+Ha*ia+Ia*la+La*za;G[13]=Ga*W+Ha*ja+Ia*qa+La*Da;G[14]=Ga*ca+Ha*aa+Ia*sa+La*Ja;G[15]=Ga*da+Ha*ea+Ia*wa+La*S;return G}function n(G,S,ha){const T=ha[0],W=ha[1];ha=ha[2];let ca=void 0,da=void 0,ia=void 0,ja=void 0,aa=void 0,ea=void 0,la=void 0,qa=void 0,sa=void 0,wa=void 0,za=void 0,Da=void 0;S===G?(G[12]=S[0]*T+S[4]*W+S[8]*ha+S[12],G[13]=S[1]*T+S[5]*W+S[9]*ha+S[13],G[14]=S[2]*T+S[6]*W+S[10]*ha+S[14],G[15]=S[3]*T+S[7]*W+S[11]*ha+S[15]):(ca=S[0],da=S[1],ia=S[2],ja=S[3],aa=S[4],ea=S[5],
la=S[6],qa=S[7],sa=S[8],wa=S[9],za=S[10],Da=S[11],G[0]=ca,G[1]=da,G[2]=ia,G[3]=ja,G[4]=aa,G[5]=ea,G[6]=la,G[7]=qa,G[8]=sa,G[9]=wa,G[10]=za,G[11]=Da,G[12]=ca*T+aa*W+sa*ha+S[12],G[13]=da*T+ea*W+wa*ha+S[13],G[14]=ia*T+la*W+za*ha+S[14],G[15]=ja*T+qa*W+Da*ha+S[15]);return G}function p(G,S,ha){const T=ha[0],W=ha[1];ha=ha[2];G[0]=S[0]*T;G[1]=S[1]*T;G[2]=S[2]*T;G[3]=S[3]*T;G[4]=S[4]*W;G[5]=S[5]*W;G[6]=S[6]*W;G[7]=S[7]*W;G[8]=S[8]*ha;G[9]=S[9]*ha;G[10]=S[10]*ha;G[11]=S[11]*ha;G[12]=S[12];G[13]=S[13];G[14]=
S[14];G[15]=S[15];return G}function c(G,S,ha,T){let W=T[0],ca=T[1];T=T[2];let da=Math.sqrt(W*W+ca*ca+T*T);var ia=void 0,ja=void 0;let aa=void 0,ea=void 0,la=void 0,qa=void 0,sa=void 0,wa=void 0,za=void 0,Da=void 0,Ja=void 0,Ga=void 0,Ha=void 0,Ia=void 0,La=void 0,Oa=void 0,ya=void 0,Va=void 0,Qa=void 0,Na=void 0,N=void 0,Wa=void 0;ja=ia=void 0;if(da<F.EPSILON)return null;da=1/da;W*=da;ca*=da;T*=da;ia=Math.sin(ha);ja=Math.cos(ha);aa=1-ja;ea=S[0];la=S[1];qa=S[2];sa=S[3];wa=S[4];za=S[5];Da=S[6];Ja=S[7];
Ga=S[8];Ha=S[9];Ia=S[10];La=S[11];Oa=W*W*aa+ja;ya=ca*W*aa+T*ia;Va=T*W*aa-ca*ia;Qa=W*ca*aa-T*ia;Na=ca*ca*aa+ja;N=T*ca*aa+W*ia;Wa=W*T*aa+ca*ia;ia=ca*T*aa-W*ia;ja=T*T*aa+ja;G[0]=ea*Oa+wa*ya+Ga*Va;G[1]=la*Oa+za*ya+Ha*Va;G[2]=qa*Oa+Da*ya+Ia*Va;G[3]=sa*Oa+Ja*ya+La*Va;G[4]=ea*Qa+wa*Na+Ga*N;G[5]=la*Qa+za*Na+Ha*N;G[6]=qa*Qa+Da*Na+Ia*N;G[7]=sa*Qa+Ja*Na+La*N;G[8]=ea*Wa+wa*ia+Ga*ja;G[9]=la*Wa+za*ia+Ha*ja;G[10]=qa*Wa+Da*ia+Ia*ja;G[11]=sa*Wa+Ja*ia+La*ja;S!==G&&(G[12]=S[12],G[13]=S[13],G[14]=S[14],G[15]=S[15]);
return G}function d(G,S,ha){const T=Math.sin(ha);ha=Math.cos(ha);const W=S[4],ca=S[5],da=S[6],ia=S[7],ja=S[8],aa=S[9],ea=S[10],la=S[11];S!==G&&(G[0]=S[0],G[1]=S[1],G[2]=S[2],G[3]=S[3],G[12]=S[12],G[13]=S[13],G[14]=S[14],G[15]=S[15]);G[4]=W*ha+ja*T;G[5]=ca*ha+aa*T;G[6]=da*ha+ea*T;G[7]=ia*ha+la*T;G[8]=ja*ha-W*T;G[9]=aa*ha-ca*T;G[10]=ea*ha-da*T;G[11]=la*ha-ia*T;return G}function a(G,S,ha){const T=Math.sin(ha);ha=Math.cos(ha);const W=S[0],ca=S[1],da=S[2],ia=S[3],ja=S[8],aa=S[9],ea=S[10],la=S[11];S!==
G&&(G[4]=S[4],G[5]=S[5],G[6]=S[6],G[7]=S[7],G[12]=S[12],G[13]=S[13],G[14]=S[14],G[15]=S[15]);G[0]=W*ha-ja*T;G[1]=ca*ha-aa*T;G[2]=da*ha-ea*T;G[3]=ia*ha-la*T;G[8]=W*T+ja*ha;G[9]=ca*T+aa*ha;G[10]=da*T+ea*ha;G[11]=ia*T+la*ha;return G}function b(G,S,ha){const T=Math.sin(ha);ha=Math.cos(ha);const W=S[0],ca=S[1],da=S[2],ia=S[3],ja=S[4],aa=S[5],ea=S[6],la=S[7];S!==G&&(G[8]=S[8],G[9]=S[9],G[10]=S[10],G[11]=S[11],G[12]=S[12],G[13]=S[13],G[14]=S[14],G[15]=S[15]);G[0]=W*ha+ja*T;G[1]=ca*ha+aa*T;G[2]=da*ha+ea*
T;G[3]=ia*ha+la*T;G[4]=ja*ha-W*T;G[5]=aa*ha-ca*T;G[6]=ea*ha-da*T;G[7]=la*ha-ia*T;return G}function f(G,S){G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=S[0];G[13]=S[1];G[14]=S[2];G[15]=1;return G}function m(G,S){G[0]=S[0];G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=S[1];G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=S[2];G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function g(G,S,ha){let T=ha[0],W=ha[1];ha=ha[2];let ca=Math.sqrt(T*T+W*W+ha*ha),da=void 0,ia=void 0,ja=void 0;
if(ca<F.EPSILON)return null;ca=1/ca;T*=ca;W*=ca;ha*=ca;da=Math.sin(S);ia=Math.cos(S);ja=1-ia;G[0]=T*T*ja+ia;G[1]=W*T*ja+ha*da;G[2]=ha*T*ja-W*da;G[3]=0;G[4]=T*W*ja-ha*da;G[5]=W*W*ja+ia;G[6]=ha*W*ja+T*da;G[7]=0;G[8]=T*ha*ja+W*da;G[9]=W*ha*ja-T*da;G[10]=ha*ha*ja+ia;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function x(G,S){const ha=Math.sin(S);S=Math.cos(S);G[0]=1;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=S;G[6]=ha;G[7]=0;G[8]=0;G[9]=-ha;G[10]=S;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function q(G,
S){const ha=Math.sin(S);S=Math.cos(S);G[0]=S;G[1]=0;G[2]=-ha;G[3]=0;G[4]=0;G[5]=1;G[6]=0;G[7]=0;G[8]=ha;G[9]=0;G[10]=S;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function B(G,S){const ha=Math.sin(S);S=Math.cos(S);G[0]=S;G[1]=ha;G[2]=0;G[3]=0;G[4]=-ha;G[5]=S;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=1;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function z(G,S,ha){var T=S[0],W=S[1],ca=S[2],da=S[3],ia=T+T,ja=W+W;const aa=ca+ca;S=T*ia;const ea=T*ja;T*=aa;const la=W*ja;W*=aa;ca*=aa;ia*=da;ja*=da;da*=
aa;G[0]=1-(la+ca);G[1]=ea+da;G[2]=T-ja;G[3]=0;G[4]=ea-da;G[5]=1-(S+ca);G[6]=W+ia;G[7]=0;G[8]=T+ja;G[9]=W-ia;G[10]=1-(S+la);G[11]=0;G[12]=ha[0];G[13]=ha[1];G[14]=ha[2];G[15]=1;return G}function u(G,S){const ha=va,T=-S[0],W=-S[1],ca=-S[2],da=S[3],ia=S[4],ja=S[5],aa=S[6],ea=S[7],la=T*T+W*W+ca*ca+da*da;0<la?(ha[0]=2*(ia*da+ea*T+ja*ca-aa*W)/la,ha[1]=2*(ja*da+ea*W+aa*T-ia*ca)/la,ha[2]=2*(aa*da+ea*ca+ia*W-ja*T)/la):(ha[0]=2*(ia*da+ea*T+ja*ca-aa*W),ha[1]=2*(ja*da+ea*W+aa*T-ia*ca),ha[2]=2*(aa*da+ea*ca+ia*
W-ja*T));z(G,S,ha);return G}function y(G,S){G[0]=S[12];G[1]=S[13];G[2]=S[14];return G}function E(G,S){const ha=S[0],T=S[1],W=S[2],ca=S[4],da=S[5],ia=S[6],ja=S[8],aa=S[9];S=S[10];G[0]=Math.sqrt(ha*ha+T*T+W*W);G[1]=Math.sqrt(ca*ca+da*da+ia*ia);G[2]=Math.sqrt(ja*ja+aa*aa+S*S);return G}function H(G,S){const ha=S[0]+S[5]+S[10];let T=0;0<ha?(T=2*Math.sqrt(ha+1),G[3]=.25*T,G[0]=(S[6]-S[9])/T,G[1]=(S[8]-S[2])/T,G[2]=(S[1]-S[4])/T):S[0]>S[5]&&S[0]>S[10]?(T=2*Math.sqrt(1+S[0]-S[5]-S[10]),G[3]=(S[6]-S[9])/T,
G[0]=.25*T,G[1]=(S[1]+S[4])/T,G[2]=(S[8]+S[2])/T):S[5]>S[10]?(T=2*Math.sqrt(1+S[5]-S[0]-S[10]),G[3]=(S[8]-S[2])/T,G[0]=(S[1]+S[4])/T,G[1]=.25*T,G[2]=(S[6]+S[9])/T):(T=2*Math.sqrt(1+S[10]-S[0]-S[5]),G[3]=(S[1]-S[4])/T,G[0]=(S[8]+S[2])/T,G[1]=(S[6]+S[9])/T,G[2]=.25*T);return G}function J(G,S,ha,T){var W=S[0],ca=S[1],da=S[2],ia=S[3],ja=W+W,aa=ca+ca,ea=da+da;S=W*ja;const la=W*aa;W*=ea;const qa=ca*aa;ca*=ea;da*=ea;ja*=ia;aa*=ia;ia*=ea;ea=T[0];const sa=T[1];T=T[2];G[0]=(1-(qa+da))*ea;G[1]=(la+ia)*ea;G[2]=
(W-aa)*ea;G[3]=0;G[4]=(la-ia)*sa;G[5]=(1-(S+da))*sa;G[6]=(ca+ja)*sa;G[7]=0;G[8]=(W+aa)*T;G[9]=(ca-ja)*T;G[10]=(1-(S+qa))*T;G[11]=0;G[12]=ha[0];G[13]=ha[1];G[14]=ha[2];G[15]=1;return G}function P(G,S,ha,T,W){var ca=S[0],da=S[1],ia=S[2],ja=S[3],aa=ca+ca,ea=da+da,la=ia+ia;S=ca*aa;var qa=ca*ea,sa=ca*la;ca=da*ea;da*=la;var wa=ia*la;ia=ja*aa;ea*=ja;const za=ja*la;var Da=T[0],Ja=T[1];la=T[2];T=W[0];ja=W[1];W=W[2];aa=(1-(ca+wa))*Da;const Ga=(qa+za)*Da;Da*=sa-ea;qa=(qa-za)*Ja;wa=(1-(S+wa))*Ja;Ja*=da+ia;sa=
(sa+ea)*la;da=(da-ia)*la;S=(1-(S+ca))*la;G[0]=aa;G[1]=Ga;G[2]=Da;G[3]=0;G[4]=qa;G[5]=wa;G[6]=Ja;G[7]=0;G[8]=sa;G[9]=da;G[10]=S;G[11]=0;G[12]=ha[0]+T-(aa*T+qa*ja+sa*W);G[13]=ha[1]+ja-(Ga*T+wa*ja+da*W);G[14]=ha[2]+W-(Da*T+Ja*ja+S*W);G[15]=1;return G}function O(G,S){var ha=S[0],T=S[1],W=S[2];S=S[3];var ca=ha+ha,da=T+T;const ia=W+W;ha*=ca;const ja=T*ca;T*=da;const aa=W*ca,ea=W*da;W*=ia;ca*=S;da*=S;S*=ia;G[0]=1-T-W;G[1]=ja+S;G[2]=aa-da;G[3]=0;G[4]=ja-S;G[5]=1-ha-W;G[6]=ea+ca;G[7]=0;G[8]=aa+da;G[9]=ea-
ca;G[10]=1-ha-T;G[11]=0;G[12]=0;G[13]=0;G[14]=0;G[15]=1;return G}function K(G,S,ha,T,W,ca,da){const ia=1/(ha-S),ja=1/(W-T),aa=1/(ca-da);G[0]=2*ca*ia;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=2*ca*ja;G[6]=0;G[7]=0;G[8]=(ha+S)*ia;G[9]=(W+T)*ja;G[10]=(da+ca)*aa;G[11]=-1;G[12]=0;G[13]=0;G[14]=da*ca*2*aa;G[15]=0;return G}function D(G,S,ha,T,W){S=1/Math.tan(S/2);let ca=void 0;G[0]=S/ha;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=S;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[11]=-1;G[12]=0;G[13]=0;G[15]=0;null!=W&&Infinity!==W?(ca=1/(T-
W),G[10]=(W+T)*ca,G[14]=2*W*T*ca):(G[10]=-1,G[14]=-2*T);return G}function I(G,S,ha,T){const W=Math.tan(S.upDegrees*Math.PI/180),ca=Math.tan(S.downDegrees*Math.PI/180),da=Math.tan(S.leftDegrees*Math.PI/180);S=Math.tan(S.rightDegrees*Math.PI/180);const ia=2/(da+S),ja=2/(W+ca);G[0]=ia;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=ja;G[6]=0;G[7]=0;G[8]=-((da-S)*ia*.5);G[9]=(W-ca)*ja*.5;G[10]=T/(ha-T);G[11]=-1;G[12]=0;G[13]=0;G[14]=T*ha/(ha-T);G[15]=0;return G}function L(G,S,ha,T,W,ca,da){const ia=1/(S-ha),ja=1/(T-
W),aa=1/(ca-da);G[0]=-2*ia;G[1]=0;G[2]=0;G[3]=0;G[4]=0;G[5]=-2*ja;G[6]=0;G[7]=0;G[8]=0;G[9]=0;G[10]=2*aa;G[11]=0;G[12]=(S+ha)*ia;G[13]=(W+T)*ja;G[14]=(da+ca)*aa;G[15]=1;return G}function R(G,S,ha,T){let W=void 0,ca=void 0;var da=void 0,ia=void 0;let ja=void 0,aa=void 0;var ea=void 0,la=void 0;let qa=void 0,sa=void 0;const wa=S[0],za=S[1];S=S[2];da=T[0];ia=T[1];T=T[2];ea=ha[0];la=ha[1];ha=ha[2];if(Math.abs(wa-ea)<F.EPSILON&&Math.abs(za-la)<F.EPSILON&&Math.abs(S-ha)<F.EPSILON)return A(G);ea=wa-ea;la=
za-la;qa=S-ha;sa=1/Math.sqrt(ea*ea+la*la+qa*qa);ea*=sa;la*=sa;qa*=sa;W=ia*qa-T*la;ca=T*ea-da*qa;da=da*la-ia*ea;(sa=Math.sqrt(W*W+ca*ca+da*da))?(sa=1/sa,W*=sa,ca*=sa,da*=sa):da=ca=W=0;ia=la*da-qa*ca;ja=qa*W-ea*da;aa=ea*ca-la*W;(sa=Math.sqrt(ia*ia+ja*ja+aa*aa))?(sa=1/sa,ia*=sa,ja*=sa,aa*=sa):aa=ja=ia=0;G[0]=W;G[1]=ia;G[2]=ea;G[3]=0;G[4]=ca;G[5]=ja;G[6]=la;G[7]=0;G[8]=da;G[9]=aa;G[10]=qa;G[11]=0;G[12]=-(W*wa+ca*za+da*S);G[13]=-(ia*wa+ja*za+aa*S);G[14]=-(ea*wa+la*za+qa*S);G[15]=1;return G}function Z(G,
S,ha,T){const W=S[0],ca=S[1];S=S[2];var da=T[0];const ia=T[1];var ja=T[2];T=W-ha[0];let aa=ca-ha[1];ha=S-ha[2];let ea=T*T+aa*aa+ha*ha;0<ea&&(ea=1/Math.sqrt(ea),T*=ea,aa*=ea,ha*=ea);let la=ia*ha-ja*aa;ja=ja*T-da*ha;da=da*aa-ia*T;ea=la*la+ja*ja+da*da;0<ea&&(ea=1/Math.sqrt(ea),la*=ea,ja*=ea,da*=ea);G[0]=la;G[1]=ja;G[2]=da;G[3]=0;G[4]=aa*da-ha*ja;G[5]=ha*la-T*da;G[6]=T*ja-aa*la;G[7]=0;G[8]=T;G[9]=aa;G[10]=ha;G[11]=0;G[12]=W;G[13]=ca;G[14]=S;G[15]=1;return G}function X(G){return"mat4("+G[0]+", "+G[1]+
", "+G[2]+", "+G[3]+", "+G[4]+", "+G[5]+", "+G[6]+", "+G[7]+", "+G[8]+", "+G[9]+", "+G[10]+", "+G[11]+", "+G[12]+", "+G[13]+", "+G[14]+", "+G[15]+")"}function Q(G){return Math.sqrt(G[0]**2+G[1]**2+G[2]**2+G[3]**2+G[4]**2+G[5]**2+G[6]**2+G[7]**2+G[8]**2+G[9]**2+G[10]**2+G[11]**2+G[12]**2+G[13]**2+G[14]**2+G[15]**2)}function M(G,S,ha){G[0]=S[0]+ha[0];G[1]=S[1]+ha[1];G[2]=S[2]+ha[2];G[3]=S[3]+ha[3];G[4]=S[4]+ha[4];G[5]=S[5]+ha[5];G[6]=S[6]+ha[6];G[7]=S[7]+ha[7];G[8]=S[8]+ha[8];G[9]=S[9]+ha[9];G[10]=
S[10]+ha[10];G[11]=S[11]+ha[11];G[12]=S[12]+ha[12];G[13]=S[13]+ha[13];G[14]=S[14]+ha[14];G[15]=S[15]+ha[15];return G}function V(G,S,ha){G[0]=S[0]-ha[0];G[1]=S[1]-ha[1];G[2]=S[2]-ha[2];G[3]=S[3]-ha[3];G[4]=S[4]-ha[4];G[5]=S[5]-ha[5];G[6]=S[6]-ha[6];G[7]=S[7]-ha[7];G[8]=S[8]-ha[8];G[9]=S[9]-ha[9];G[10]=S[10]-ha[10];G[11]=S[11]-ha[11];G[12]=S[12]-ha[12];G[13]=S[13]-ha[13];G[14]=S[14]-ha[14];G[15]=S[15]-ha[15];return G}function fa(G,S,ha){G[0]=S[0]*ha;G[1]=S[1]*ha;G[2]=S[2]*ha;G[3]=S[3]*ha;G[4]=S[4]*
ha;G[5]=S[5]*ha;G[6]=S[6]*ha;G[7]=S[7]*ha;G[8]=S[8]*ha;G[9]=S[9]*ha;G[10]=S[10]*ha;G[11]=S[11]*ha;G[12]=S[12]*ha;G[13]=S[13]*ha;G[14]=S[14]*ha;G[15]=S[15]*ha;return G}function oa(G,S,ha,T){G[0]=S[0]+ha[0]*T;G[1]=S[1]+ha[1]*T;G[2]=S[2]+ha[2]*T;G[3]=S[3]+ha[3]*T;G[4]=S[4]+ha[4]*T;G[5]=S[5]+ha[5]*T;G[6]=S[6]+ha[6]*T;G[7]=S[7]+ha[7]*T;G[8]=S[8]+ha[8]*T;G[9]=S[9]+ha[9]*T;G[10]=S[10]+ha[10]*T;G[11]=S[11]+ha[11]*T;G[12]=S[12]+ha[12]*T;G[13]=S[13]+ha[13]*T;G[14]=S[14]+ha[14]*T;G[15]=S[15]+ha[15]*T;return G}
function ua(G,S){return G[0]===S[0]&&G[1]===S[1]&&G[2]===S[2]&&G[3]===S[3]&&G[4]===S[4]&&G[5]===S[5]&&G[6]===S[6]&&G[7]===S[7]&&G[8]===S[8]&&G[9]===S[9]&&G[10]===S[10]&&G[11]===S[11]&&G[12]===S[12]&&G[13]===S[13]&&G[14]===S[14]&&G[15]===S[15]}function xa(G,S){if(G===S)return!0;const ha=G[0],T=G[1],W=G[2],ca=G[3],da=G[4],ia=G[5],ja=G[6],aa=G[7],ea=G[8],la=G[9],qa=G[10],sa=G[11],wa=G[12],za=G[13],Da=G[14];G=G[15];const Ja=S[0],Ga=S[1],Ha=S[2],Ia=S[3],La=S[4],Oa=S[5],ya=S[6],Va=S[7],Qa=S[8],Na=S[9],
N=S[10],Wa=S[11],Ua=S[12],ib=S[13],ra=S[14];S=S[15];return Math.abs(ha-Ja)<=F.EPSILON*Math.max(1,Math.abs(ha),Math.abs(Ja))&&Math.abs(T-Ga)<=F.EPSILON*Math.max(1,Math.abs(T),Math.abs(Ga))&&Math.abs(W-Ha)<=F.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ha))&&Math.abs(ca-Ia)<=F.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Ia))&&Math.abs(da-La)<=F.EPSILON*Math.max(1,Math.abs(da),Math.abs(La))&&Math.abs(ia-Oa)<=F.EPSILON*Math.max(1,Math.abs(ia),Math.abs(Oa))&&Math.abs(ja-ya)<=F.EPSILON*Math.max(1,Math.abs(ja),
Math.abs(ya))&&Math.abs(aa-Va)<=F.EPSILON*Math.max(1,Math.abs(aa),Math.abs(Va))&&Math.abs(ea-Qa)<=F.EPSILON*Math.max(1,Math.abs(ea),Math.abs(Qa))&&Math.abs(la-Na)<=F.EPSILON*Math.max(1,Math.abs(la),Math.abs(Na))&&Math.abs(qa-N)<=F.EPSILON*Math.max(1,Math.abs(qa),Math.abs(N))&&Math.abs(sa-Wa)<=F.EPSILON*Math.max(1,Math.abs(sa),Math.abs(Wa))&&Math.abs(wa-Ua)<=F.EPSILON*Math.max(1,Math.abs(wa),Math.abs(Ua))&&Math.abs(za-ib)<=F.EPSILON*Math.max(1,Math.abs(za),Math.abs(ib))&&Math.abs(Da-ra)<=F.EPSILON*
Math.max(1,Math.abs(Da),Math.abs(ra))&&Math.abs(G-S)<=F.EPSILON*Math.max(1,Math.abs(G),Math.abs(S))}function Ca(G){const S=F.EPSILON,ha=G[0],T=G[1],W=G[2],ca=G[4],da=G[5],ia=G[6],ja=G[8],aa=G[9];G=G[10];return Math.abs(1-(ha*ha+ca*ca+ja*ja))<=S&&Math.abs(1-(T*T+da*da+aa*aa))<=S&&Math.abs(1-(W*W+ia*ia+G*G))<=S}const va=t.create();t=Object.freeze({__proto__:null,copy:C,set:v,identity:A,transpose:w,invert:l,adjoint:e,determinant:h,multiply:k,translate:n,scale:p,rotate:c,rotateX:d,rotateY:a,rotateZ:b,
fromTranslation:f,fromScaling:m,fromRotation:g,fromXRotation:x,fromYRotation:q,fromZRotation:B,fromRotationTranslation:z,fromQuat2:u,getTranslation:y,getScaling:E,getRotation:H,fromRotationTranslationScale:J,fromRotationTranslationScaleOrigin:P,fromQuat:O,frustum:K,perspective:D,perspectiveFromFieldOfView:I,ortho:L,lookAt:R,targetTo:Z,str:X,frob:Q,add:M,subtract:V,multiplyScalar:fa,multiplyScalarAndAdd:oa,exactEquals:ua,equals:xa,isOrthoNormal:Ca,mul:k,sub:V});r.add=M;r.adjoint=e;r.copy=C;r.determinant=
h;r.equals=xa;r.exactEquals=ua;r.frob=Q;r.fromQuat=O;r.fromQuat2=u;r.fromRotation=g;r.fromRotationTranslation=z;r.fromRotationTranslationScale=J;r.fromRotationTranslationScaleOrigin=P;r.fromScaling=m;r.fromTranslation=f;r.fromXRotation=x;r.fromYRotation=q;r.fromZRotation=B;r.frustum=K;r.getRotation=H;r.getScaling=E;r.getTranslation=y;r.identity=A;r.invert=l;r.isOrthoNormal=Ca;r.lookAt=R;r.mat4=t;r.mul=k;r.multiply=k;r.multiplyScalar=fa;r.multiplyScalarAndAdd=oa;r.ortho=L;r.perspective=D;r.perspectiveFromFieldOfView=
I;r.rotate=c;r.rotateX=d;r.rotateY=a;r.rotateZ=b;r.scale=p;r.set=v;r.str=X;r.sub=V;r.subtract=V;r.targetTo=Z;r.translate=n;r.transpose=w})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(r,t,F,C,v){function A(){return!!t._pe}function w(){return!!v("esri-wasm")}function l(){return c?c:c=(new Promise((a,b)=>r(["./pe-wasm"],a,b))).then(a=>a.peWasm).then(({default:a})=>a({locateFile:b=>C.getAssetUrl(`esri/geometry/support/${b}`)})).then(a=>
{e(a)})}function e(a){function b(g,x,q){g[x]=q(g[x])}t._pe=a;t.PeDefs.init();t.PeGTlistExtended.init();t.PeNotationMgrs.init();t.PeNotationUtm.init();t.PePCSInfo.init();t.PeGCSExtent=function(g){function x(){return g.apply(this,arguments)||this}F._inheritsLoose(x,g);x.prototype.destroy=function(){t._pe.destroy(this)};return x}(t._pe.PeGCSExtent);a=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(var f of a)b(f.prototype,
"getName",g=>function(){return g.call(this,Array(t.PeDefs.PE_NAME_MAX))});for(const g of[t._pe.PeGeogtran,t._pe.PeProjcs])b(g.prototype,"getParameters",x=>function(){const q=Array(t.PeDefs.PE_PARM_MAX);let B=x.call(this);for(let z=0;z<q.length;z++){const u=t._pe.getValue(B,"*");q[z]=u?t._pe.wrapPointer(u,t._pe.PeParameter):null;B+=Int32Array.BYTES_PER_ELEMENT}return q});b(t._pe.PeHorizon.prototype,"getCoord",g=>function(){const x=this.getSize();if(!x)return null;const q=[],B=g.call(this);p(q,x,B);
return q});b(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",g=>{const x=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let q=null;var B=g.call(this);if(!t._pe.compare(B,t._pe.NULL)){q=[B];const z=this.getSteps();if(1<z){B=t._pe.getPointer(B);for(let u=1;u<z;u++)q.push(t._pe.wrapPointer(B+x*u,t._pe.PeGTlistExtendedGTs))}}return q}});const m=t._pe._pe_getPeHorizonSize();f=g=>function(){let x=this._cache;x||(this._cache=x=new Map);if(x.has(g))return x.get(g);let q=null;var B=g.call(this);
if(!t._pe.compare(B,t._pe.NULL)){q=[B];const z=B.getNump();if(1<z){B=t._pe.getPointer(B);for(let u=1;u<z;u++)q.push(t._pe.wrapPointer(B+m*u,t._pe.PeHorizon))}}x.set(g,q);return q};b(t._pe.PeProjcs.prototype,"horizonGcsGenerate",f);b(t._pe.PeProjcs.prototype,"horizonPcsGenerate",f);t._pe.PeObject.prototype.toString=function(g=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();const x=t._pe.getPointer(this),q=t._pe.ensureInt8(Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(x,
g,q))}}function h(a){if(a){var b=t._pe.getClass(a);b&&(b=t._pe.getCache(b))&&(a=t._pe.getPointer(a))&&delete b[a]}}function k(a,b){const f=[];b=Array(b);for(let m=0;m<a;m++)f.push(t._pe.ensureInt8(b));return f}function n(a){let b;Array.isArray(a[0])?(b=[],a.forEach(f=>{b.push(f[0],f[1])})):b=a;return b}function p(a,b,f,m=!1){if(m)for(m=0;m<2*b;m++)a[m]=t._pe.getValue(f+m*Float64Array.BYTES_PER_ELEMENT,"double");else{m=0===a.length;for(let g=0;g<b;g++)m&&(a[g]=Array(2)),a[g][0]=t._pe.getValue(f,"double"),
a[g][1]=t._pe.getValue(f+Float64Array.BYTES_PER_ELEMENT,"double"),f+=2*Float64Array.BYTES_PER_ELEMENT}}let c;t._pe=null;t.PeCSTransformations=void 0;(function(a){function b(g,x,q){t._pe.ensureCache.prepare();var B=n(q);const z=q===B;B=t._pe.ensureFloat64(B);(g=t._pe._pe_geog_to_proj(t._pe.getPointer(g),x,B))&&p(q,x,B,z);return g}function f(g,x,q){return m(g,x,q,0)}function m(g,x,q,B){t._pe.ensureCache.prepare();var z=n(q);const u=q===z;z=t._pe.ensureFloat64(z);(g=t._pe._pe_proj_to_geog_center(t._pe.getPointer(g),
x,z,B))&&p(q,x,z,u);return g}a.geogToProj=b;a.projGeog=function(g,x,q,B){switch(B){case t.PeDefs.PE_TRANSFORM_P_TO_G:return f(g,x,q);case t.PeDefs.PE_TRANSFORM_G_TO_P:return b(g,x,q)}return 0};a.projToGeog=f;a.projToGeogCenter=m})(t.PeCSTransformations||(t.PeCSTransformations={}));t.PeDefs=void 0;(function(a){a.init=function(){a.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX;a.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX;a.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX;
a.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
a.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT;a.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;
a.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;a.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY;a.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE;a.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t.PeDefs||(t.PeDefs={}));t.PeFactory=void 0;(function(a){function b(x,q){let B=
null,z=f[x];z||(z={},f[x]=z);z.hasOwnProperty(String(q))?B=z[q]:(x=t._pe.PeFactory.prototype.factoryByType(x,q),t._pe.compare(x,t._pe.NULL)||(B=x,z[q]=B));return B=g(B)}const f={},m={},g=x=>{if(x){const q=x.getType();switch(q){case t.PeDefs.PE_TYPE_GEOGCS:x=t._pe.castObject(x,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:x=t._pe.castObject(x,t._pe.PeProjcs);break;case t.PeDefs.PE_TYPE_GEOGTRAN:x=t._pe.castObject(x,t._pe.PeGeogtran);break;default:q&t.PeDefs.PE_TYPE_UNIT&&(x=t._pe.castObject(x,
t._pe.PeUnit))}}return x};a.initialize=function(){t._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(x){return b(t.PeDefs.PE_TYPE_COORDSYS,x)};a.factoryByType=b;a.fromString=function(x,q){let B=null,z=m[x];z||(z={},m[x]=z);z.hasOwnProperty(q)?B=z[q]:(x=t._pe.PeFactory.prototype.fromString(x,q),t._pe.compare(x,t._pe.NULL)||(B=x,z[q]=B));return B=g(B)};a.geogcs=function(x){return b(t.PeDefs.PE_TYPE_GEOGCS,x)};a.geogtran=function(x){return b(t.PeDefs.PE_TYPE_GEOGTRAN,x)};a.getCode=function(x){return t._pe.PeFactory.prototype.getCode(x)};
a.projcs=function(x){return b(t.PeDefs.PE_TYPE_PROJCS,x)};a.unit=function(x){return b(t.PeDefs.PE_TYPE_UNIT,x)}})(t.PeFactory||(t.PeFactory={}));t.PeGCSExtent=null;t.PeGTlistExtended=void 0;(function(a){let b;a.init=function(){a.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;b=t._pe._pe_getPeGTlistExtendedEntrySize()};a.getGTlist=function(f,m,g,x,q,B){let z=null;const u=new t._pe.PeInteger(B);try{const y=t._pe.PeGTlistExtended.prototype.getGTlist(f,m,g,x,q,u);if(B=u.val)if(z=
[y],1<B){const E=t._pe.getPointer(y);for(f=1;f<B;f++)z.push(t._pe.wrapPointer(E+b*f,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(u)}return z}})(t.PeGTlistExtended||(t.PeGTlistExtended={}));t.PeGTlistExtendedEntry=void 0;(function(a){a.destroy=function(b){if(b&&b.length){for(const f of b)h(f),f.getEntries().forEach(m=>{h(m);m=m.getGeogtran();h(m);m.getParameters().forEach(h);[m.getGeogcs1(),m.getGeogcs2()].forEach(g=>{h(g);const x=g.getDatum();h(x);h(x.getSpheroid());h(g.getPrimem());h(g.getUnit())})});
t._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={}));t.PeGTTransformations=void 0;(function(a){a.geogToGeog=function(b,f,m,g,x){t._pe.ensureCache.prepare();var q=n(m);const B=m===q;q=t._pe.ensureFloat64(q);let z=0;g&&(z=t._pe.ensureFloat64(g));(b=t._pe._pe_geog_to_geog(t._pe.getPointer(b),f,q,z,x))&&p(m,f,q,B);return b}})(t.PeGTTransformations||(t.PeGTTransformations={}));t.PeNotationDms=void 0;(function(a){const b=(m,g,x,q,B,z)=>{t._pe.ensureCache.prepare();
switch(m){case "dd":var u=t._pe._pe_geog_to_dd;var y=t.PeDefs.PE_DD_MAX;break;case "ddm":u=t._pe._pe_geog_to_ddm;y=t.PeDefs.PE_DDM_MAX;break;case "dms":u=t._pe._pe_geog_to_dms,y=t.PeDefs.PE_DMS_MAX}m=0;g&&(m=t._pe.getPointer(g));g=n(q);g=t._pe.ensureFloat64(g);y=k(x,y);q=t._pe.ensureInt32(y);if(B=u(m,x,g,B,q))for(u=0;u<x;u++)z[u]=t._pe.UTF8ToString(y[u]);return B},f=(m,g,x,q,B)=>{t._pe.ensureCache.prepare();switch(m){case "dd":var z=t._pe._pe_dd_to_geog;break;case "ddm":z=t._pe._pe_ddm_to_geog;break;
case "dms":z=t._pe._pe_dms_to_geog}m=0;g&&(m=t._pe.getPointer(g));g=q.map(u=>t._pe.ensureString(u));q=t._pe.ensureInt32(g);g=t._pe.ensureFloat64(Array(2*x));(z=z(m,x,q,g))&&p(B,x,g);return z};a.geogToDms=function(m,g,x,q,B){return b("dms",m,g,x,q,B)};a.dmsToGeog=function(m,g,x,q){return f("dms",m,g,x,q)};a.geogToDdm=function(m,g,x,q,B){return b("ddm",m,g,x,q,B)};a.ddmToGeog=function(m,g,x,q){return f("ddm",m,g,x,q)};a.geogToDd=function(m,g,x,q,B){return b("dd",m,g,x,q,B)};a.ddToGeog=function(m,g,
x,q){return f("dd",m,g,x,q)}})(t.PeNotationDms||(t.PeNotationDms={}));t.PeNotationMgrs=void 0;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;a.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;a.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geogToMgrsExtended=
function(b,f,m,g,x,q,B){t._pe.ensureCache.prepare();let z=0;b&&(z=t._pe.getPointer(b));b=n(m);m=t._pe.ensureFloat64(b);b=k(f,t.PeDefs.PE_MGRS_MAX);const u=t._pe.ensureInt32(b);if(g=t._pe._pe_geog_to_mgrs_extended(z,f,m,g,x,q,u))for(x=0;x<f;x++)B[x]=t._pe.UTF8ToString(b[x]);return g};a.mgrsToGeogExtended=function(b,f,m,g,x){t._pe.ensureCache.prepare();let q=0;b&&(q=t._pe.getPointer(b));b=m.map(B=>t._pe.ensureString(B));m=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*f));(g=t._pe._pe_mgrs_to_geog_extended(q,
f,m,g,b))&&p(x,f,b);return g}})(t.PeNotationMgrs||(t.PeNotationMgrs={}));t.PeNotationUsng=void 0;(function(a){a.geogToUsng=function(b,f,m,g,x,q,B){t._pe.ensureCache.prepare();let z=0;b&&(z=t._pe.getPointer(b));b=n(m);m=t._pe.ensureFloat64(b);b=k(f,t.PeDefs.PE_MGRS_MAX);const u=t._pe.ensureInt32(b);if(g=t._pe._pe_geog_to_usng(z,f,m,g,x,q,u))for(x=0;x<f;x++)B[x]=t._pe.UTF8ToString(b[x]);return g};a.usngToGeog=function(b,f,m,g){t._pe.ensureCache.prepare();var x=0;b&&(x=t._pe.getPointer(b));b=m.map(q=>
t._pe.ensureString(q));m=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*f));(x=t._pe._pe_usng_to_geog(x,f,m,b))&&p(g,f,b);return x}})(t.PeNotationUsng||(t.PeNotationUsng={}));t.PeNotationUtm=void 0;(function(a){a.init=function(){a.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;a.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};a.geogToUtm=function(b,f,m,g,x){t._pe.ensureCache.prepare();var q=
0;b&&(q=t._pe.getPointer(b));b=n(m);m=t._pe.ensureFloat64(b);b=k(f,t.PeDefs.PE_UTM_MAX);const B=t._pe.ensureInt32(b);if(g=t._pe._pe_geog_to_utm(q,f,m,g,B))for(q=0;q<f;q++)x[q]=t._pe.UTF8ToString(b[q]);return g};a.utmToGeog=function(b,f,m,g,x){t._pe.ensureCache.prepare();let q=0;b&&(q=t._pe.getPointer(b));b=m.map(B=>t._pe.ensureString(B));m=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*f));(g=t._pe._pe_utm_to_geog(q,f,m,g,b))&&p(x,f,b);return g}})(t.PeNotationUtm||(t.PeNotationUtm={}));t.PePCSInfo=
void 0;(function(a){const b=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(f,m=a.PE_PCSINFO_OPTION_DOMAIN){let g,x;b.has(f)&&(x=b.get(f),x[m]&&(g=x[m]));g||(g=t._pe.PePCSInfo.prototype.generate(f,m),x||(x=[],b.set(f,
x)),x[m]=g);return g}})(t.PePCSInfo||(t.PePCSInfo={}));t.PeVersion=void 0;(function(a){a.versionString=function(){return t._pe.PeVersion.prototype.version_string()}})(t.PeVersion||(t.PeVersion={}));const d=Object.freeze({__proto__:null,get _pe(){return t._pe},isLoaded:A,isSupported:w,load:l,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},get PeFactory(){return t.PeFactory},get PeGCSExtent(){return t.PeGCSExtent},get PeGTlistExtended(){return t.PeGTlistExtended},
get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeGTTransformations(){return t.PeGTTransformations},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:e});t._init=e;t.isLoaded=A;t.isSupported=w;t.load=l;t.pe=d})},"esri/geometry/support/geodesicConstants":function(){define(["exports",
"./Ellipsoid"],function(r,t){const F=Math.PI/180;var C=t.earth.radius;const v=t.earth.eccentricitySquared;C={a1:C*v,a2:C*v*C*v,a3:C*v*v/2,a4:C*v*C*v*2.5,a5:C*v+C*v*v/2,a6:1-v};t={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:t.earth.radius,f:t.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:t.moon.radius,f:t.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:t.mars.radius,f:t.mars.flattening},104906:{a:6200,
f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,
f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},
104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:t.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};
r.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;r.earthEllipsoidConstants=C;r.spheroids=t;r.toRadians=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(r){return function(){function t(C){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(C&&C.steps)for(const v of C.steps)v instanceof r?this.steps.push(v):this.steps.push(new r({wkid:v.wkid,wkt:v.wkt,isInverse:v.isInverse}))}
t.cacheKey=function(C,v){return[void 0!==C.wkid&&null!==C.wkid?C.wkid.toString():"-1",void 0!==C.wkt&&null!==C.wkt?C.wkt.toString():"",void 0!==v.wkid&&null!==v.wkid?v.wkid.toString():"-1",void 0!==v.wkt&&null!==v.wkt?v.wkt.toString():""].join()};t.fromGE=function(C){const v=new t;let A="";for(const w of C.steps)C=r.fromGE(w),v.steps.push(C),A+=C.uid.toString()+",";v._cached_projection={};v._gtlistentry=null;v._chain=A;return v};var F=t.prototype;F.getInverse=function(){const C=new t;C.steps=[];for(let v=
this.steps.length-1;0<=v;v--)C.steps.push(this.steps[v].getInverse());return C};F.getGTListEntry=function(){let C="";for(const v of this.steps)C+=v.uid.toString()+",";C!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=C);return this._gtlistentry};F.assignCachedGe=function(C,v,A){this._cached_projection[t.cacheKey(C,v)]=A};F.getCachedGeTransformation=function(C,v){let A="";for(const w of this.steps)A+=w.uid.toString()+",";A!==this._chain&&(this._gtlistentry=null,this._cached_projection=
{},this._chain=A);C=this._cached_projection[t.cacheKey(C,v)];return void 0===C?null:C};return t}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){let t=0;return function(){function F(C=null){this.uid=t++;C?(this._wkt=void 0!==C.wkt?C.wkt:null,this._wkid=void 0!==C.wkid?C.wkid:-1,this._isInverse=void 0!==C.isInverse?!0===C.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}F.fromGE=function(C){const v=new F;
v._wkt=C.wkt;v._wkid=C.wkid;v._isInverse=C.isInverse;return v};F.prototype.getInverse=function(){const C=new F;C._wkt=this.wkt;C._wkid=this._wkid;C._isInverse=!this.isInverse;return C};r._createClass(F,[{key:"wkt",get:function(){return this._wkt},set:function(C){this._wkt=C;this.uid=t++}},{key:"wkid",get:function(){return this._wkid},set:function(C){this._wkid=C;this.uid=t++}},{key:"isInverse",get:function(){return this._isInverse},set:function(C){this._isInverse=C;this.uid=t++}}]);return F}()})},
"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(r,t,F,C){r.getGeometryZScaler=function(v,A,w){if(t.isNone(A)||t.isNone(w)||w.vcsWkid||C.equals(A,w))return null;A=F.getMetersPerVerticalUnitForSR(A);w=F.getMetersPerVerticalUnitForSR(w);const l=A/w;if(1===l)return null;switch(v){case "point":case "esriGeometryPoint":return e=>{e&&null!=e.z&&(e.z*=l)};case "polyline":case "esriGeometryPolyline":return e=>{if(e)for(const h of e.paths)for(const k of h)2<
k.length&&(k[2]*=l)};case "polygon":case "esriGeometryPolygon":return e=>{if(e)for(const h of e.rings)for(const k of h)2<k.length&&(k[2]*=l)};case "multipoint":case "esriGeometryMultipoint":return e=>{if(e)for(const h of e.points)2<h.length&&(h[2]*=l)};case "extent":case "esriGeometryExtent":return e=>{e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=l,e.zmax*=l)};default:return null}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(r){let t=
function(w,l,e){this.x=w;this.y=l;this.spatialReference=e;this.m=this.z=void 0},F=function(w,l,e,h){this.rings=w;this.spatialReference=l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);h&&(this.hasM=h)},C=function(w,l,e,h){this.paths=w;this.spatialReference=l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);h&&(this.hasM=h)},v=function(w,l,e,h){this.points=w;this.spatialReference=l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);h&&(this.hasM=h)},A=function(w,l,e,h,k){this.xmin=w;this.ymin=l;this.xmax=e;this.ymax=
h;this.spatialReference=k;this.mmax=this.mmin=this.zmax=this.zmin=void 0};r.jsonAdapter={convertToGEGeometry:function(w,l){return null==l?null:w.convertJSONToGeometry(l)},exportPoint:function(w,l,e){e=new t(w.getPointX(l),w.getPointY(l),e);const h=w.hasZ(l),k=w.hasM(l);h&&(e.z=w.getPointZ(l));k&&(e.m=w.getPointM(l));return e},exportPolygon:function(w,l,e){return new F(w.exportPaths(l),e,w.hasZ(l),w.hasM(l))},exportPolyline:function(w,l,e){return new C(w.exportPaths(l),e,w.hasZ(l),w.hasM(l))},exportMultipoint:function(w,
l,e){return new v(w.exportPoints(l),e,w.hasZ(l),w.hasM(l))},exportExtent:function(w,l,e){var h=w.hasZ(l);const k=w.hasM(l);e=new A(w.getXMin(l),w.getYMin(l),w.getXMax(l),w.getYMax(l),e);h&&(h=w.getZExtent(l),e.zmin=h.vmin,e.zmax=h.vmax);k&&(w=w.getMExtent(l),e.mmin=w.vmin,e.mmax=w.vmax);return e}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(r){r.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,
supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,
supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b){function f(x,q,B,z,u,y){u-=B;y-=z;x=Math.min(1,Math.max(0,((x-B)*u+(q-z)*y)/(u*u+y*y)));return{x:B+u*x,y:z+y*x}}function m(x,q){return x?q?4:3:q?3:2}let g=function(){function x(B,z,u){this.items=B;this.queryGeometry=z;this.definitionExpression=u.definitionExpression;this.geometryType=u.geometryType;this.hasM=u.hasM;this.hasZ=u.hasZ;this.objectIdField=u.objectIdField;this.spatialReference=u.spatialReference;this.fieldsIndex=u.fieldsIndex;this.timeInfo=u.timeInfo;
this.featureAdapter=u.featureAdapter;this.aggregateAdapter=u.aggregateAdapter}var q=x.prototype;q.createQueryResponseForCount=function(B){const z=new h(B,this.featureAdapter,this.fieldsIndex);if(!B.outStatistics)return z.countDistinctValues(this.items);const {groupByFieldsForStatistics:u,having:y}=B;if(null==u||!u.length)return 1;const E=new Map,H=new Map,J=new Set;B=B.outStatistics;for(const O of B){({statisticType:B}=O);B="exceedslimit"!==B?O.onStatisticField:void 0;if(!H.has(B)){var P=[];for(const K of u){const D=
this._getAttributeValues(z,K,E);P.push(D)}H.set(B,this._calculateUniqueValues(P,z.returnDistinctValues))}B=H.get(B);for(const K in B){const {data:D,items:I}=B[K];P=D.join(",");y&&!z.validateItems(I,y)||J.add(P)}}return J.size};q.createQueryResponse=function(){var B=F._asyncToGenerator(function*(z){let u;u=z.outStatistics?z.outStatistics.some(y=>"exceedslimit"===y.statisticType)?this._createExceedsLimitQueryResponse(z):yield this._createStatisticsQueryResponse(z):this._createFeatureQueryResponse(z);
z.returnQueryGeometry&&(l.isValid(z.outSR)&&!l.equals(this.queryGeometry.spatialReference,z.outSR)?u.queryGeometry=c.cleanFromGeometryEngine({spatialReference:z.outSR,...n.project(this.queryGeometry,this.queryGeometry.spatialReference,z.outSR)}):u.queryGeometry=c.cleanFromGeometryEngine({spatialReference:z.outSR,...this.queryGeometry}));return u});return function(z){return B.apply(this,arguments)}}();q.createSnappingResponse=function(B,z){const u=this.featureAdapter,y=m(this.hasZ,this.hasM),{x:E,
y:H}=B.point,J="number"===typeof B.distance?B.distance:B.distance.x,P="number"===typeof B.distance?B.distance:B.distance.y,O={candidates:[]},K="esriGeometryPolygon"===this.geometryType;z=this._getPointCreator(B.point,this.spatialReference,z);for(const M of this.items){var D=u.getGeometry(M);if(C.isNone(D))continue;const {coords:V,lengths:fa}=D;if(B.types&t.SnappingTypes.EDGE){D=0;for(var I=0;I<fa.length;I++){var L=fa[I];for(var R=0;R<L;R++,D+=y){var Z=V[D],X=V[D+1];if(R!==L-1){const oa=V[D+y],ua=
V[D+y+1],{x:xa,y:Ca}=f(E,H,Z,X,oa,ua);var Q=(E-xa)/J;const va=(H-Ca)/P;Q=Q*Q+va*va;1>=Q&&O.candidates.push({type:"edge",objectId:u.getObjectId(M),distance:Math.sqrt(Q),target:z(xa,Ca),start:z(Z,X),end:z(oa,ua)})}}}}if(B.types&t.SnappingTypes.VERTEX)for(D=K?V.length-y:V.length,I=0;I<D;I+=y)L=V[I],R=V[I+1],Z=(E-L)/J,X=(H-R)/P,Z=Z*Z+X*X,1>=Z&&O.candidates.push({type:"vertex",objectId:u.getObjectId(M),distance:Math.sqrt(Z),target:z(L,R)})}O.candidates.sort((M,V)=>M.distance-V.distance);return O};q._getPointCreator=
function(B,z,u){const y=C.isSome(u)&&!l.equals(z,u)?E=>n.project(E,z,u):E=>E;return null!=B.z&&null!=B.m?(E,H)=>y({x:E,y:H,z:B.z,m:B.m}):null!=B.z?(E,H)=>y({x:E,y:H,z:B.z}):null!=B.m?(E,H)=>y({x:E,y:H,m:B.m}):(E,H)=>y({x:E,y:H})};q.executeAttributesQuery=function(B){var z=k.getWhereClause(B.where,this.fieldsIndex);if(!z)return Promise.resolve(this);if(z.isStandardized){let u=0;const y=[];for(const E of this.items)z.testFeature(E,this.featureAdapter)&&(y[u++]=E);z=new x(y,this.queryGeometry,this);
z.definitionExpression=B.where;return Promise.resolve(z)}return Promise.reject(new TypeError("Where clause is not standardized"))};q.executeAggregateIdsQuery=function(B){if(!B.aggregateIds||!B.aggregateIds.length||C.isNone(this.aggregateAdapter))return Promise.resolve(this);const z=new Set;for(const y of B.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(y).forEach(E=>z.add(E));const u=this.featureAdapter.getObjectId;return Promise.resolve(new x(this.items.filter(y=>z.has(u(y))),this.queryGeometry,
this))};q.executeObjectIdsQuery=function(B){if(!B.objectIds||!B.objectIds.length)return Promise.resolve(this);const z=new Set(B.objectIds),u=this.featureAdapter.getObjectId;return Promise.resolve(new x(this.items.filter(y=>z.has(u(y))),this.queryGeometry,this))};q.executeTimeQuery=function(B){B=p.getTimeOperator(this.timeInfo,B.timeExtent,this.featureAdapter);if(!C.isSome(B))return Promise.resolve(this);B=this.items.filter(B);return Promise.resolve(new x(B,this.queryGeometry,this))};q.filterLatest=
function(){const {trackIdField:B,startTimeField:z,endTimeField:u}=this.timeInfo;var y=u||z;const E=new Map,H=this.featureAdapter.getAttribute;for(const J of this.items){const P=H(J,B),O=H(J,y),K=E.get(P);(!K||O>H(K,y))&&E.set(P,J)}y=Array.from(E.values());return Promise.resolve(new x(y,this.queryGeometry,this))};q.project=function(){var B=F._asyncToGenerator(function*(z){if(!z||l.equals(this.spatialReference,z))return this;const u=this.featureAdapter,y=(yield n.projectMany(this.items.map(E=>c.getGeometry(this.geometryType,
this.hasZ,this.hasM,u.getGeometry(E))),this.spatialReference,z)).map((E,H)=>u.cloneWithGeometry(this.items[H],e.convertFromGeometry(E,this.hasZ,this.hasM)));return new x(y,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:z,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})});return function(z){return B.apply(this,arguments)}}();q.createSummaryStatisticsResponse=
function(){var B=F._asyncToGenerator(function*(z,u){const {field:y,valueExpression:E,normalizationField:H,normalizationType:J,normalizationTotal:P,minValue:O,maxValue:K,scale:D}=u;u=this.fieldsIndex.isDateField(y);z=yield this._getDataValues(z,{field:y,valueExpression:E,normalizationField:H,normalizationType:J,normalizationTotal:P,scale:D});const I=a.isNullCountSupported({normalizationType:J,normalizationField:H,minValue:O,maxValue:K}),L=this.fieldsIndex.get(y),R={value:.5,fieldType:null==L?void 0:
L.type};z=d.isStringField(L)?a.calculateStringStatistics({values:z,supportsNullCount:I,percentileParams:R}):a.calculateStatistics({values:z,minValue:O,maxValue:K,useSampleStdDev:!J,supportsNullCount:I,percentileParams:R});return a.processSummaryStatisticsResult(z,u)});return function(z,u){return B.apply(this,arguments)}}();q.createUniqueValuesResponse=function(){var B=F._asyncToGenerator(function*(z,u){const {field:y,valueExpression:E,domain:H,returnAllCodedValues:J,scale:P}=u;z=yield this._getDataValues(z,
{field:y,valueExpression:E,scale:P});z=a.calculateUniqueValuesCount(z);return a.createUVResult(z,H,J)});return function(z,u){return B.apply(this,arguments)}}();q.createClassBreaksResponse=function(){var B=F._asyncToGenerator(function*(z,u){const {field:y,valueExpression:E,normalizationField:H,normalizationType:J,normalizationTotal:P,classificationMethod:O,standardDeviationInterval:K,minValue:D,maxValue:I,numClasses:L,scale:R}=u;z=yield this._getDataValues(z,{field:y,valueExpression:E,normalizationField:H,
normalizationType:J,normalizationTotal:P,scale:R});z=a.calculateClassBreaks(z,{field:y,normalizationField:H,normalizationType:J,normalizationTotal:P,classificationMethod:O,standardDeviationInterval:K,minValue:D,maxValue:I,numClasses:L});return a.resolveCBResult(z,O)});return function(z,u){return B.apply(this,arguments)}}();q.createHistogramResponse=function(){var B=F._asyncToGenerator(function*(z,u){const {field:y,valueExpression:E,normalizationField:H,normalizationType:J,normalizationTotal:P,classificationMethod:O,
standardDeviationInterval:K,minValue:D,maxValue:I,numBins:L,scale:R}=u;z=yield this._getDataValues(z,{field:y,valueExpression:E,normalizationField:H,normalizationType:J,normalizationTotal:P,scale:R});return a.calculateHistogram(z,{field:y,normalizationField:H,normalizationType:J,normalizationTotal:P,classificationMethod:O,standardDeviationInterval:K,minValue:D,maxValue:I,numBins:L})});return function(z,u){return B.apply(this,arguments)}}();q._sortFeatures=function(B,z,u){if(1<B.length&&z&&z.length)for(const y of z.reverse()){z=
y.split(" ");const E=z[0],H=this.fieldsIndex.get(E);z=z[1]&&"desc"===z[1].toLowerCase();const J=a.getAttributeComparator(null==H?void 0:H.type,z);B.sort((P,O)=>{P=u(P,E,H);O=u(O,E,H);return J(P,O)})}};q._createFeatureQueryResponse=function(B){const z=this.items,{geometryType:u,hasM:y,hasZ:E,objectIdField:H,spatialReference:J}=this,{outFields:P,outSR:O,quantizationParameters:K,resultRecordCount:D,resultOffset:I,returnZ:L,returnM:R}=B,Z=null!=D?z.length>(I||0)+D:!1,X=P&&(P.includes("*")?[...this.fieldsIndex.fields]:
P.map(Q=>this.fieldsIndex.get(Q)));return{exceededTransferLimit:Z,features:this._createFeatures(B,z),fields:X,geometryType:u,hasM:y&&R,hasZ:E&&L,objectIdFieldName:H,spatialReference:c.cleanFromGeometryEngine(O?O:J),transform:K&&w.toQuantizationTransform(K)||null}};q._createFeatures=function(B,z){const u=new h(B,this.featureAdapter,this.fieldsIndex),{hasM:y,hasZ:E}=this,{orderByFields:H,quantizationParameters:J,returnGeometry:P,returnCentroid:O,maxAllowableOffset:K,resultOffset:D,resultRecordCount:I,
returnZ:L=!1,returnM:R=!1}=B,Z=E&&L,X=y&&R;B=[];var Q=0;z=[...z];this._sortFeatures(z,H,(fa,oa,ua)=>u.getFieldValue(fa,oa,ua));if(P||O){var M=w.toQuantizationTransform(J);if(P&&!O)for(var V of z)B[Q++]={attributes:u.getAttributes(V),geometry:c.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(V),K,M,Z,X)};else if(!P&&O)for(const fa of z)B[Q++]={attributes:u.getAttributes(fa),centroid:c.transformCentroid(this,this.featureAdapter.getCentroid(fa,this),M)};else for(const fa of z)B[Q++]=
{attributes:u.getAttributes(fa),centroid:c.transformCentroid(this,this.featureAdapter.getCentroid(fa,this),M),geometry:c.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(fa),K,M,Z,X)}}else for(M of z)(V=u.getAttributes(M))&&(B[Q++]={attributes:V});Q=D||0;null!=I&&(B=B.slice(Q,Math.min(B.length,Q+I)));return B};q._createExceedsLimitQueryResponse=function(B){var z=!1;let u=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY;z=Number.POSITIVE_INFINITY;for(const E of B.outStatistics)if("exceedslimit"===
E.statisticType){u=null!=E.maxPointCount?E.maxPointCount:Number.POSITIVE_INFINITY;y=null!=E.maxRecordCount?E.maxRecordCount:Number.POSITIVE_INFINITY;z=null!=E.maxVertexCount?E.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)z=this.items.length>u;else if(this.items.length>y)z=!0;else{B=this.hasZ?this.hasM?4:3:this.hasM?3:2;const E=this.featureAdapter;z=this.items.reduce((H,J)=>{J=E.getGeometry(J);return H+(C.isSome(J)&&J.coords.length||0)},0)/B>z}return{fields:[{name:"exceedslimit",
type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(z)}}]}};q._createStatisticsQueryResponse=function(){var B=F._asyncToGenerator(function*(z){var u={attributes:{}};const y=[],E=new Map,H=new Map,J=new Map,P=new Map,O=new h(z,this.featureAdapter,this.fieldsIndex);var K=z.outStatistics;const {groupByFieldsForStatistics:D,having:I,orderByFields:L}=z;z=D&&D.length;const R=!!z,Z=R&&D[0],X=R&&!this.fieldsIndex.get(Z);
for(const oa of K){const {outStatisticFieldName:ua,statisticType:xa}=oa;K=oa;var Q="exceedslimit"!==xa?oa.onStatisticField:void 0;const Ca="percentile_disc"===xa||"percentile_cont"===xa,va="EnvelopeAggregate"===xa||"CentroidAggregate"===xa||"ConvexHullAggregate"===xa,G=R&&1===z&&(Q===Z||X)&&"count"===xa;if(R){if(!J.has(Q)){var M=[];for(const S of D){var V=this._getAttributeValues(O,S,E);M.push(V)}J.set(Q,this._calculateUniqueValues(M,O.returnDistinctValues))}M=J.get(Q);for(const S in M){const {count:ha,
data:T,items:W,itemPositions:ca}=M[S];V=T.join(",");if(!I||O.validateItems(W,I)){const da=P.get(V)||{attributes:{}};if(va){da.aggregateGeometries||(da.aggregateGeometries={});const {aggregateGeometries:ia,outStatisticFieldName:ja}=yield this._getAggregateGeometry(K,W);da.aggregateGeometries[ja]=ia}else{var fa=null;if(G)fa=ha;else{const ia=this._getAttributeValues(O,Q,E);fa=ca.map(ja=>ia[ja]);fa=Ca&&"statisticParameters"in K?this._getPercentileValue(K,fa):this._getStatisticValue(K,fa,null,O.returnDistinctValues)}da.attributes[ua]=
fa}D.forEach((ia,ja)=>da.attributes[this.fieldsIndex.get(ia)?ia:`EXPR_${ja+1}`]=T[ja]);P.set(V,da)}}}else if(va){u.aggregateGeometries||(u.aggregateGeometries={});const {aggregateGeometries:S,outStatisticFieldName:ha}=yield this._getAggregateGeometry(K,this.items);u.aggregateGeometries[ha]=S}else Q=this._getAttributeValues(O,Q,E),u.attributes[ua]=Ca&&"statisticParameters"in K?this._getPercentileValue(K,Q):this._getStatisticValue(K,Q,H,O.returnDistinctValues);y.push({name:ua,alias:ua,type:"esriFieldTypeDouble"})}u=
R?Array.from(P.values()):[u];this._sortFeatures(u,L,(oa,ua)=>oa.attributes[ua]);return{fields:y,features:u}});return function(z){return B.apply(this,arguments)}}();q._getAggregateGeometry=function(){var B=F._asyncToGenerator(function*(z,u){var y=yield new Promise((L,R)=>r(["../../../geometry/geometryEngineJSON"],L,R));const {statisticType:E,outStatisticFieldName:H}=z,{featureAdapter:J,spatialReference:P,geometryType:O,hasZ:K,hasM:D}=this;u=u.map(L=>c.getGeometry(O,K,D,J.getGeometry(L)));const I=y.convexHull(P,
u,!0)[0];z={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===E?(y=I?A.getPolygonExtent(I):A.getGeometryExtent(y.union(P,u)),z.aggregateGeometries={...y,spatialReference:P},z.outStatisticFieldName=H||"extent"):"CentroidAggregate"===E?(y=I?v.polygonCentroid(I):v.extentCentroid(A.getGeometryExtent(y.union(P,u))),z.aggregateGeometries={x:y[0],y:y[1],spatialReference:P},z.outStatisticFieldName=H||"centroid"):"ConvexHullAggregate"===E&&(z.aggregateGeometries=I,z.outStatisticFieldName=
H||"convexHull");return z});return function(z,u){return B.apply(this,arguments)}}();q._getStatisticValue=function(B,z,u,y){const {onStatisticField:E,statisticType:H}=B;B=null;B=null!=u&&u.has(E)?u.get(E):d.isStringField(this.fieldsIndex.get(E))?a.calculateStringStatistics({values:z,returnDistinct:y}):a.calculateStatistics({values:z,minValue:null,maxValue:null,useSampleStdDev:!0});u&&u.set(E,B);return B["var"===H?"variance":H]};q._getPercentileValue=function(B,z){const {onStatisticField:u,statisticParameters:y,
statisticType:E}=B,{value:H,orderBy:J}=y;B=this.fieldsIndex.get(u);return a.calculatePercentile(z,{value:H,orderBy:J,fieldType:null==B?void 0:B.type,isDiscrete:"percentile_disc"===E})};q._getAttributeValues=function(B,z,u){if(u.has(z))return u.get(z);const y=this.fieldsIndex.get(z),E=this.items.map(H=>B.getFieldValue(H,z,y));u.set(z,E);return E};q._getAttributeNormalizedValues=function(B,z){return this.items.map(u=>B.getNormalizedValue(u,{field:z.field,fieldInfo:this.fieldsIndex.get(z.field),normalizationField:z.normalizationField,
normalizationFieldInfo:this.fieldsIndex.get(z.normalizationField),normalizationType:z.normalizationType,normalizationTotal:z.normalizationTotal}))};q._getAttributeExpressionValues=function(){var B=F._asyncToGenerator(function*(z,u,y){const {arcadeUtils:E}=yield b.loadArcade(),H=E.createFunction(u),J=y&&E.getViewInfo(y);return this.items.map(P=>z.getExpressionValue(P,{compiledFunc:H,viewInfo:J},E))});return function(z,u,y){return B.apply(this,arguments)}}();q._calculateUniqueValues=function(B,z){const u=
{},y=this.items,E=y.length;for(let H=0;H<E;H++){const J=y[H],P=[];for(const K of B)P.push(K[H]);const O=P.join(",");z?null==u[O]&&(u[O]={count:1,data:P,items:[J],itemPositions:[H]}):null==u[O]?u[O]={count:1,data:P,items:[J],itemPositions:[H]}:(u[O].count++,u[O].items.push(J),u[O].itemPositions.push(H))}return u};q._getDataValues=function(){var B=F._asyncToGenerator(function*(z,u){const y=new h(z,this.featureAdapter,this.fieldsIndex),{valueExpression:E,field:H,normalizationField:J,normalizationType:P,
normalizationTotal:O,scale:K}=u;z=E?{viewingMode:"map",scale:K,spatialReference:z.outSR||this.spatialReference}:null;return E?this._getAttributeExpressionValues(y,E,z):this._getAttributeNormalizedValues(y,{field:H,normalizationField:J,normalizationType:P,normalizationTotal:O})});return function(z,u){return B.apply(this,arguments)}}();F._createClass(x,[{key:"size",get:function(){return this.items.length}}]);return x}();t.SnappingTypes=void 0;(function(x){x[x.NONE=0]="NONE";x[x.EDGE=1]="EDGE";x[x.VERTEX=
2]="VERTEX"})(t.SnappingTypes||(t.SnappingTypes={}));t.default=g;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(r,t,F){function C({scale:E,translate:H},J){return Math.round((J-H[0])/E[0])}function v({scale:E,translate:H},J){return Math.round((H[1]-J)/E[1])}function A(E,H,J){const P=[];let O,K,D,I;for(let L=0;L<J.length;L++){const R=J[L];if(0<L){if(D=C(E,R[0]),I=v(E,R[1]),D!==O||I!==
K)P.push(H(R,D-O,I-K)),O=D,K=I}else O=C(E,R[0]),K=v(E,R[1]),P.push(H(R,O,K))}return 0<P.length?P:null}function w(E,H,J,P){return A(E,J?P?y:u:P?u:z,H)}function l(E,H,J,P){const O=[];J=J?P?y:u:P?u:z;for(P=0;P<H.length;P++){const K=A(E,J,H[P]);K&&3<=K.length&&O.push(K)}return O.length?O:null}function e(E,H,J,P){const O=[];J=J?P?y:u:P?u:z;for(P=0;P<H.length;P++){const K=A(E,J,H[P]);K&&2<=K.length&&O.push(K)}return O.length?O:null}function h({scale:E,translate:H},J){return J*E[0]+H[0]}function k({scale:E,
translate:H},J){return H[1]-J*E[1]}function n(E,H,J){const P=Array(J.length);if(!J.length)return P;const [O,K]=E.scale;let D=h(E,J[0][0]);E=k(E,J[0][1]);P[0]=H(J[0],D,E);for(let I=1;I<J.length;I++){const L=J[I];D+=L[0]*O;E-=L[1]*K;P[I]=H(L,D,E)}return P}function p(E,H,J){const P=Array(J.length);for(let O=0;O<J.length;O++)P[O]=n(E,H,J[O]);return P}function c(E,H,J,P){return n(E,J?P?y:u:P?u:z,H)}function d(E,H,J,P){return p(E,J?P?y:u:P?u:z,H)}function a(E,H,J,P){return p(E,J?P?y:u:P?u:z,H)}function b(E,
H,J){let [P,O]=J[0],K=Math.min(P,H[0]),D=Math.min(O,H[1]),I=Math.max(P,H[2]);H=Math.max(O,H[3]);for(let L=1;L<J.length;L++){const [R,Z]=J[L];P+=R;O+=Z;0>R&&(K=Math.min(K,P));0<R&&(I=Math.max(I,P));0>Z?D=Math.min(D,O):0<Z&&(H=Math.max(H,O))}E[0]=K;E[1]=D;E[2]=I;E[3]=H;return E}function f(E,H){if(!H.length)return null;E[0]=E[1]=Number.POSITIVE_INFINITY;E[2]=E[3]=Number.NEGATIVE_INFINITY;for(let J=0;J<H.length;J++)b(E,E,H[J]);return E}function m(E,H,J,P,O){H.xmin=C(E,J.xmin);H.ymin=v(E,J.ymin);H.xmax=
C(E,J.xmax);H.ymax=v(E,J.ymax);H!==J&&(P&&(H.zmin=J.zmin,H.zmax=J.zmax),O&&(H.mmin=J.mmin,H.mmax=J.mmax));return H}function g(E,H,J,P,O){H.points=w(E,J.points,P,O);return H}function x(E,H,J,P,O){H.x=C(E,J.x);H.y=v(E,J.y);H!==J&&(P&&(H.z=J.z),O&&(H.m=J.m));return H}function q(E,H,J,P,O){E=l(E,J.rings,P,O);if(!E)return null;H.rings=E;return H}function B(E,H,J,P,O){E=e(E,J.paths,P,O);if(!E)return null;H.paths=E;return H}const z=(E,H,J)=>[H,J],u=(E,H,J)=>[H,J,E[2]],y=(E,H,J)=>[H,J,E[2],E[3]];r.equals=
function(E,H){if(E===H||null==E&&null==H)return!0;if(null==E||null==H)return!1;let J,P,O,K;E&&"upperLeft"===E.originPosition?(J=E.translate[0],P=E.translate[1],E=E.scale[0]):(J=t.isSome(E.extent)?E.extent.xmin:0,P=t.isSome(E.extent)?E.extent.ymax:0,E=E.tolerance);H&&"upperLeft"===H.originPosition?(O=H.translate[0],K=H.translate[1],H=H.scale[0]):(O=t.isSome(H.extent)?H.extent.xmin:0,K=t.isSome(H.extent)?H.extent.ymax:0,H=H.tolerance);return J===O&&P===K&&E===H};r.getQuantizedBoundsCoordsArray=b;r.getQuantizedBoundsCoordsArrayArray=
f;r.getQuantizedBoundsPaths=function(E){return f([0,0,0,0],E)};r.getQuantizedBoundsPoints=function(E){const H=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(H,H,E)};r.getQuantizedBoundsRings=function(E){return f([0,0,0,0],E)};r.quantizeBounds=function(E,H,J){H[0]=C(E,J[0]);H[3]=v(E,J[1]);H[2]=C(E,J[2]);H[1]=v(E,J[3]);return H};r.quantizeExtent=m;r.quantizeGeometry=function(E,H){return E&&H?F.isPoint(H)?x(E,{},H,!1,!1):F.isPolyline(H)?
B(E,{},H,!1,!1):F.isPolygon(H)?q(E,{},H,!1,!1):F.isMultipoint(H)?g(E,{},H,!1,!1):F.isExtent(H)?m(E,{},H,!1,!1):null:null};r.quantizeMultipoint=g;r.quantizePaths=e;r.quantizePoint=x;r.quantizePoints=w;r.quantizePolygon=q;r.quantizePolyline=B;r.quantizeRings=l;r.quantizeX=C;r.quantizeY=v;r.toQuantizationTransform=function(E){return E?{originPosition:"upper-left"===E.originPosition?"upperLeft":"lower-left"===E.originPosition?"lowerLeft":E.originPosition,scale:E.tolerance?[E.tolerance,E.tolerance]:[1,
1],translate:t.isSome(E.extent)?[E.extent.xmin,E.extent.ymax]:[0,0]}:null};r.unquantizeBounds=function(E,H,J){return J?(H[0]=h(E,J[0]),H[1]=k(E,J[3]),H[2]=h(E,J[2]),H[3]=k(E,J[1]),H):[h(E,H[0]),k(E,H[3]),h(E,H[2]),k(E,H[1])]};r.unquantizeCoordsArray=n;r.unquantizeCoordsArrayArray=p;r.unquantizeExtent=function(E,H,J,P,O){H.xmin=h(E,J.xmin);H.ymin=k(E,J.ymin);H.xmax=h(E,J.xmax);H.ymax=k(E,J.ymax);H!==J&&(P&&(H.zmin=J.zmin,H.zmax=J.zmax),O&&(H.mmin=J.mmin,H.mmax=J.mmax));return H};r.unquantizeMultipoint=
function(E,H,J,P,O){t.isSome(J)&&(H.points=c(E,J.points,P,O));return H};r.unquantizePaths=d;r.unquantizePoint=function(E,H,J,P,O){if(t.isNone(J))return H;H.x=h(E,J.x);H.y=k(E,J.y);H!==J&&(P&&(H.z=J.z),O&&(H.m=J.m));return H};r.unquantizePoints=c;r.unquantizePolygon=function(E,H,J,P,O){t.isSome(J)&&(H.rings=a(E,J.rings,P,O));return H};r.unquantizePolyline=function(E,H,J,P,O){t.isSome(J)&&(H.paths=d(E,J.paths,P,O));return H};r.unquantizeRings=a;r.unquantizeX=h;r.unquantizeY=k;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],function(r,t,F){return function(){function C(A,w,l){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=A.returnDistinctValues;this.fieldsIndex=l;this.featureAdapter=w;if((w=A.outFields)&&-1===w.indexOf("*")){this.outFields=w;A=0;for(const h of w){var e=t.getExpressionFromFieldName(h);e=(w=this.fieldsIndex.get(e))?
null:t.getWhereClause(e,l);w=w?w.name:t.getAliasFromFieldName(h)||`FIELD_EXP_${A++}`;this._fieldDataCache.set(h,{alias:w,clause:e})}}}var v=C.prototype;v.countDistinctValues=function(A){if(!this.returnDistinctValues)return A.length;A.forEach(w=>this.getAttributes(w));return this._returnDistinctMap.size};v.getAttributes=function(A){A=this._processAttributesForOutFields(A);return this._processAttributesForDistinctValues(A)};v.getFieldValue=function(A,w,l){const e=l?l.name:w;let h=null;this._fieldDataCache.has(e)?
h=this._fieldDataCache.get(e).clause:l||(h=t.getWhereClause(w,this.fieldsIndex),this._fieldDataCache.set(e,{alias:e,clause:h}));return l?this.featureAdapter.getAttribute(A,e):h.calculateValue(A,this.featureAdapter)};v.getNormalizedValue=function(A,w){const l=w.normalizationType,e=w.normalizationTotal;let h=this.getFieldValue(A,w.field,w.fieldInfo);l&&Number.isFinite(h)&&(A=this.getFieldValue(A,w.normalizationField,w.normalizationFieldInfo),h=F.getNormalizedValue(h,l,A,e));return h};v.getExpressionValue=
function(A,w,l){A={attributes:this.featureAdapter.getAttributes(A)};A=l.createExecContext(A,w.viewInfo);return l.executeFunction(w.compiledFunc,A)};v.validateItem=function(A,w){this._fieldDataCache.has(w)||this._fieldDataCache.set(w,{alias:w,clause:t.getWhereClause(w,this.fieldsIndex)});return this._fieldDataCache.get(w).clause.testFeature(A,this.featureAdapter)};v.validateItems=function(A,w){this._fieldDataCache.has(w)||this._fieldDataCache.set(w,{alias:w,clause:t.getWhereClause(w,this.fieldsIndex)});
return this._fieldDataCache.get(w).clause.testSet(A,this.featureAdapter)};v._processAttributesForOutFields=function(A){const w=this.outFields;if(!w||!w.length)return this.featureAdapter.getAttributes(A);const l={};for(const e of w){const {alias:h,clause:k}=this._fieldDataCache.get(e);l[h]=k?k.calculateValue(A,this.featureAdapter):this.featureAdapter.getAttribute(A,h)}return l};v._processAttributesForDistinctValues=function(A){if(r.isNone(A)||!this.returnDistinctValues)return A;var w=this.outFields,
l=[];if(w)for(const h of w){var {alias:e}=this._fieldDataCache.get(h);l.push(A[e])}else for(e in A)l.push(A[e]);w=`${(w||["*"]).join(",")}=${l.join(",")}`;l=this._returnDistinctMap.get(w)||0;this._returnDistinctMap.set(w,++l);return 1<l?null:A};return C}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(r,t,F){function C(g){const x=null!=g.minValue||null!=g.maxValue,q=!!g.sqlExpression&&g.supportsSQLExpression;
return!(null!=g.normalizationField||null!=g.normalizationType)&&!x&&!q}function v(g){const {values:x,useSampleStdDev:q,supportsNullCount:B}=g;var z=Number.POSITIVE_INFINITY;let u=Number.NEGATIVE_INFINITY,y=null,E=null;var H=null;let J=null,P=0;const O=null==g.minValue?-Infinity:g.minValue,K=null==g.maxValue?Infinity:g.maxValue;for(const D of x)Number.isFinite(D)?D>=O&&D<=K&&(y+=D,z=Math.min(z,D),u=Math.max(u,D),P++):"string"===typeof D&&P++;if(P&&null!=y){E=y/P;H=0;for(const D of x)Number.isFinite(D)&&
D>=O&&D<=K&&(H+=(D-E)**2);J=q?1<P?H/(P-1):0:0<P?H/P:0;H=Math.sqrt(J)}else u=z=null;z={avg:E,count:P,max:u,min:z,stddev:H,sum:y,variance:J};B&&(z.nullcount=x.length-P);g.percentileParams&&(z.median=A(x,g.percentileParams));return z}function A(g,x){const {fieldType:q,value:B,orderBy:z,isDiscrete:u}=x,y=w(q,"desc"===z);g=[...g].filter(P=>null!=P).sort((P,O)=>y(P,O));if(0===g.length)return null;if(0>=B)return g[0];if(1<=B)return g[g.length-1];var E=(g.length-1)*B,H=Math.floor(E);x=H+1;E%=1;H=g[H];const J=
g[x];return x>=g.length||u||"string"===typeof H||"string"===typeof J?H:H*(1-E)+J*E}function w(g,x){const q=x?1:-1,B=e(x),z=l(x);if(!g||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...f].includes(g))return(u,y)=>"number"===typeof u&&"number"===typeof y?B(u,y):"string"===typeof u&&"string"===typeof y?z(u,y):q;if("esriFieldTypeDate"===g)return(u,y)=>{u=(new Date(u)).getTime();y=(new Date(y)).getTime();return isNaN(u)||isNaN(y)?q:B(u,y)};if(f.has(g))return(u,
y)=>B(u,y);if("esriFieldTypeString"===g)return(u,y)=>z(u,y);if("esriFieldTypeGUID"===g||"esriFieldTypeGlobalID"===g){const u=l(x);return(y,E)=>u(h(y),h(E))}return x?(u,y)=>1:(u,y)=>-1}function l(g){return g?(x,q)=>{var B,z;x=null==(B=x)?void 0:B.toUpperCase();q=null==(z=q)?void 0:z.toUpperCase();return x>q?-1:x<q?1:0}:(x,q)=>{var B,z;x=null==(B=x)?void 0:B.toUpperCase();q=null==(z=q)?void 0:z.toUpperCase();return x<q?-1:x>q?1:0}}function e(g){return g?(x,q)=>q-x:(x,q)=>x-q}function h(g){return g.substr(24,
12)+g.substr(19,4)+g.substr(16,2)+g.substr(14,2)+g.substr(11,2)+g.substr(9,2)+g.substr(6,2)+g.substr(4,2)+g.substr(2,2)+g.substr(0,2)}function k(g,x){const q=p({field:x.field,normalizationType:x.normalizationType,normalizationField:x.normalizationField,classificationMethod:x.classificationMethod,standardDeviationInterval:x.standardDeviationInterval,breakCount:x.numClasses||5});g=n(g,x.minValue,x.maxValue);return F.createGenerateRendererClassBreaks({definition:q,values:g,normalizationTotal:x.normalizationTotal})}
function n(g,x,q){x=null==x?-Infinity:x;q=null==q?Infinity:q;return g.filter(B=>Number.isFinite(B)&&B>=x&&B<=q)}function p(g){const x=g.field,q=g.classificationMethod||"equal-interval",B=g.normalizationType,z=g.normalizationField,u=new t;u.classificationField=x;u.breakCount=g.breakCount;u.classificationMethod=q;u.standardDeviationInterval="standard-deviation"===q?g.standardDeviationInterval||1:void 0;u.normalizationType=B;u.normalizationField="field"===B?z:void 0;return u}function c(g,x){const {field:q,
classificationMethod:B,standardDeviationInterval:z,normalizationType:u,normalizationField:y,normalizationTotal:E,minValue:H,maxValue:J}=x,P=x.numBins||10;let O=x=null,K=null;B&&"equal-interval"!==B||u?({classBreaks:g}=k(g,{field:q,normalizationType:u,normalizationField:y,normalizationTotal:E,classificationMethod:B,standardDeviationInterval:z,minValue:H,maxValue:J,numClasses:P}),x=g[0].minValue,O=g[g.length-1].maxValue,K=g.map(D=>[D.minValue,D.maxValue])):(null!=H&&null!=J?(x=H,O=J):(g=v({values:g,
minValue:H,maxValue:J,useSampleStdDev:!u,supportsNullCount:C({normalizationType:u,normalizationField:y,minValue:H,maxValue:J})}),x=g.min,O=g.max),K=a(x,O,P));return{min:x,max:O,intervals:K}}function d(g,x){let q=-1;for(let B=g.length-1;0<=B;B--)if(x>=g[B][0]){q=B;break}return q}function a(g,x,q){const B=(x-g)/q,z=[];let u;for(let y=1;y<=q;y++)u=g+B,u=Number(u.toFixed(16)),z.push([g,y===q?x:u]),g=u;return z}const b=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,f=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger",
"esriFieldTypeSingle","esriFieldTypeDouble"]),m="min max avg stddev count sum variance nullcount median".split(" ");r.calculateClassBreaks=k;r.calculateHistogram=function(g,x){const {min:q,max:B,intervals:z}=c(g,x),u=z.map((y,E)=>({minValue:z[E][0],maxValue:z[E][1],count:0}));for(const y of g)null!=y&&y>=q&&y<=B&&(g=d(z,y),-1<g&&u[g].count++);return{bins:u,minValue:q,maxValue:B,normalizationTotal:x.normalizationTotal}};r.calculatePercentile=A;r.calculateStatistics=v;r.calculateStringStatistics=function(g){const x=
g.returnDistinct?[...new Set(g.values)]:g.values,q=x.filter(z=>null!=z).length,B={count:q};g.supportsNullCount&&(B.nullcount=x.length-q);g.percentileParams&&(B.median=A(x,g.percentileParams));return B};r.calculateUniqueValuesCount=function(g){const x={};for(let q of g){if(null==q||"string"===typeof q&&""===q.trim())q=null;null==x[q]?x[q]={count:1,data:q}:x[q].count++}return{count:x}};r.createClassBreaksDefinition=p;r.createUVResult=function(g,x,q){const B=g.count;g=[];q&&x&&"coded-value"===x.type&&
x.codedValues.forEach(z=>{z=z.code;B.hasOwnProperty(z)||(B[z]={data:z,count:0})});for(const z in B)x=B[z],g.push({value:x.data,count:x.count,label:x.label});return{uniqueValueInfos:g}};r.getAttributeComparator=w;r.getEqualIntervalBins=a;r.getNormalizedValue=function(g,x,q,B){let z=null;switch(x){case "log":0!==g&&(z=Math.log(g)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(B)&&0!==B&&(z=g/B*100);break;case "field":Number.isFinite(q)&&0!==q&&(z=g/q);break;case "natural-log":0<g&&(z=Math.log(g));
break;case "square-root":0<g&&(z=g**.5)}return z};r.isNullCountSupported=C;r.processSummaryStatisticsResult=function(g,x){let q;for(q in g)-1<m.indexOf(q)&&(Number.isFinite(g[q])||(g[q]=null));if(!x)return g;["avg","stddev","variance"].forEach(B=>{null!=g[B]&&(g[B]=Math.ceil(g[B]))});return g};r.resolveCBResult=function(g,x){let q=g.classBreaks;const B=q[0].minValue,z=q[q.length-1].maxValue,u="standard-deviation"===x;q=q.map(y=>{const E=y.label;y={minValue:y.minValue,maxValue:y.maxValue,label:E};
if(u&&E){const H=E.match(b).map(J=>+J.trim());2===H.length?(y.minStdDev=H[0],y.maxStdDev=H[1],0>H[0]&&0<H[1]&&(y.hasAvg=!0)):1===H.length&&(E.includes("\x3c")?(y.minStdDev=null,y.maxStdDev=H[0]):E.includes("\x3e")&&(y.minStdDev=H[0],y.maxStdDev=null))}return y});return{minValue:B,maxValue:z,classBreakInfos:q,normalizationTotal:g.normalizationTotal}};r.statisticTypes=m;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),
function(r,t,F,C,v,A,w,l,e){v=new F.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});F=new F.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});e=function(h){function k(){var n=h.apply(this,arguments)||this;n.breakCount=null;n.classificationField=
null;n.classificationMethod=null;n.normalizationField=null;n.normalizationType=null;n.type="class-breaks-definition";return n}r._inheritsLoose(k,h);r._createClass(k,[{key:"standardDeviationInterval",set:function(n){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",n)}},{key:"definedInterval",set:function(n){"defined-interval"===this.classificationMethod&&this._set("definedInterval",n)}}]);return k}(e);t.__decorate([C.property({json:{write:!0}})],e.prototype,"breakCount",
void 0);t.__decorate([C.property({json:{write:!0}})],e.prototype,"classificationField",void 0);t.__decorate([C.property({type:String,json:{read:v.read,write:v.write}})],e.prototype,"classificationMethod",void 0);t.__decorate([C.property({json:{write:!0}})],e.prototype,"normalizationField",void 0);t.__decorate([C.property({json:{read:F.read,write:F.write}})],e.prototype,"normalizationType",void 0);t.__decorate([C.property({value:null,json:{write:!0}})],e.prototype,"standardDeviationInterval",null);
t.__decorate([C.property({value:null,json:{write:!0}})],e.prototype,"definedInterval",null);t.__decorate([C.property()],e.prototype,"type",void 0);return e=t.__decorate([l.subclass("esri.rest.support.ClassBreaksDefinition")],e)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){F=new F.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});C=function(n){function p(){var c=n.apply(this,arguments)||this;c.baseSymbol=null;c.colorRamp=null;c.type=null;return c}r._inheritsLoose(p,n);return p}(C.JSONSupport);t.__decorate([v.property({type:k,json:{write:!0}})],C.prototype,"baseSymbol",void 0);t.__decorate([v.property({types:h.types,json:{read:{reader:h.fromJSON},write:!0}})],C.prototype,"colorRamp",void 0);t.__decorate([v.property({json:{read:F.read,
write:F.write}})],C.prototype,"type",void 0);return C=t.__decorate([e.subclass("esri.rest.support.ClassificationDefinition")],C)})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(r,t,F,C){F={key:"type",base:F,typeMap:{algorithmic:t,multipart:C}};r.fromJSON=function(v){return v&&v.type?"algorithmic"===v.type?t.fromJSON(v):"multipart"===v.type?C.fromJSON(v):null:null};r.types=F;Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(r,t,F,C,v,A,w,l,e){var h;e=h=function(k){function n(p){p=k.call(this,p)||this;p.algorithm=null;p.fromColor=null;p.toColor=
null;p.type="algorithmic";return p}r._inheritsLoose(n,k);n.prototype.clone=function(){return new h({fromColor:C.clone(this.fromColor),toColor:C.clone(this.toColor),algorithm:this.algorithm})};return n}(e);t.__decorate([w.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],e.prototype,"algorithm",void 0);t.__decorate([v.property({type:F,json:{type:[A.Integer],write:!0}})],e.prototype,"fromColor",void 0);t.__decorate([v.property({type:F,json:{type:[A.Integer],
write:!0}})],e.prototype,"toColor",void 0);t.__decorate([v.property({type:["algorithmic"]})],e.prototype,"type",void 0);return e=h=t.__decorate([l.subclass("esri.rest.support.AlgorithmicColorRamp")],e)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(r,t,F){r.enumeration=function(C,v={}){var A;C=C instanceof t.JSONMap?C:new t.JSONMap(C,v);C={type:(null!=(A=null==v?void 0:v.ignoreUnknown)?A:1)?C.apiValues:String,json:{type:C.jsonValues,
read:null!=v&&v.readOnly?!1:{reader:C.read},write:{writer:C.write}}};void 0!==(null==v?void 0:v.readOnly)&&(C.readOnly=!!v.readOnly);void 0!==(null==v?void 0:v.default)&&(C.json.default=v.default);void 0!==(null==v?void 0:v.name)&&(C.json.name=v.name);return F.property(C)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/ColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l){F=function(e){function h(k){k=e.call(this,k)||this;k.type=null;return k}r._inheritsLoose(h,e);return h}(F.JSONSupport);t.__decorate([C.property({readOnly:!0,json:{read:!1,write:!0}})],F.prototype,"type",void 0);return F=t.__decorate([l.subclass("esri.rest.support.ColorRamp")],F)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(r,t,F,C,v,A,w,l){var e;v=e=function(h){function k(n){n=h.call(this,n)||this;n.colorRamps=null;n.type="multipart";return n}r._inheritsLoose(k,h);k.prototype.clone=function(){return new e({colorRamps:F.clone(this.colorRamps)})};return k}(l);t.__decorate([C.property({type:[w],json:{write:!0}})],v.prototype,"colorRamps",void 0);t.__decorate([C.property({type:["multipart"]})],v.prototype,"type",void 0);return v=e=t.__decorate([A.subclass("esri.rest.support.MultipartColorRamp")],v)})},"esri/symbols/Symbol":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){C=new C.JSONMap({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let n=0;v=function(p){function c(a){a=p.call(this,a)||this;a.id=`sym${n++}`;a.type=null;a.color=new F([0,0,0,1]);
return a}r._inheritsLoose(c,p);var d=c.prototype;d.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};d.collectRequiredFields=function(){var a=r._asyncToGenerator(function*(b,f){});return function(b,f){return a.apply(this,arguments)}}();d.hash=function(){return JSON.stringify(this.toJSON())};d.clone=function(){};return c}(v.JSONSupport);t.__decorate([A.property({type:C.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:C.write}}})],v.prototype,"type",void 0);t.__decorate([A.property({type:F,
json:{write:{allowNull:!0}}})],v.prototype,"color",void 0);t.__decorate([h.reader("color")],v.prototype,"readColor",null);return v=t.__decorate([k.subclass("esri.symbols.Symbol")],v)})},"esri/rest/support/generateRendererUtils":function(){define(["exports"],function(r){function t(k){const {classificationMethod:n,breakCount:p,normalizationType:c,definedInterval:d}=k.definition,a=[];var b=k.values;if(0===b.length)return[];b=b.sort((B,z)=>B-z);var f=b[0],m=b[b.length-1];if("equal-interval"===n)if(b.length>=
p){b=(m-f)/p;k=f;for(var g=1;g<p;g++){var x=Number((f+g*b).toFixed(6));a.push({minValue:k,maxValue:x,label:F(k,x,c)});k=x}a.push({minValue:k,maxValue:m,label:F(k,m,c)})}else b.forEach(B=>{a.push({minValue:B,maxValue:B,label:F(B,B,c)})});else if("natural-breaks"===n){b=C(b);k=v(b.uniqueValues,k.valueFrequency||b.valueFrequency,p);for(g=1;g<p;g++)b.uniqueValues.length>g&&(x=Number(b.uniqueValues[k[g]].toFixed(6)),a.push({minValue:f,maxValue:x,label:F(f,x,c)}),f=x);a.push({minValue:f,maxValue:m,label:F(f,
m,c)})}else if("quantile"===n)if(b.length>=p&&f!==m){k=Math.ceil(b.length/p);g=0;for(x=1;x<p;x++){var q=k+g-1;q>b.length&&(q=b.length-1);0>q&&(q=0);a.push({minValue:f,maxValue:b[q],label:F(f,b[q],c)});f=b[q];g+=k;k=Math.ceil((b.length-g)/(p-x))}a.push({minValue:f,maxValue:m,label:F(f,m,c)})}else for(m=-1,f=0;f<b.length;f++)k=b[f],k!==m&&(m=k,a.push({minValue:m,maxValue:k,label:F(m,k,c)}),m=k);else if("standard-deviation"===n)if(k=l(b),g=e(b,k),0===g)a.push({minValue:b[0],maxValue:b[0],label:F(b[0],
b[0],c)});else{b=w(f,m,p,k,g)*g;g=0;for(x=p;1<=x;x--)q=Number((k-(x-.5)*b).toFixed(6)),a.push({minValue:f,maxValue:q,label:F(f,q,c)}),f=q,g++;x=Number((k+.5*b).toFixed(6));a.push({minValue:f,maxValue:x,label:F(f,x,c)});f=x;g++;for(q=1;q<=p;q++)x=g===2*p?m:Number((k+(q+.5)*b).toFixed(6)),a.push({minValue:f,maxValue:x,label:F(f,x,c)}),f=x,g++}else if("defined-interval"===n){if(!d)return a;m=b[0];b=b[b.length-1];f=Math.ceil((b-m)/d);k=m;for(g=1;g<f;g++)x=Number((m+g*d).toFixed(6)),a.push({minValue:k,
maxValue:x,label:F(k,x,c)}),k=x;a.push({minValue:k,maxValue:b,label:F(k,b,c)})}return a}function F(k,n,p){let c=null;return c=k===n?p&&"percent-of-total"===p?k+"%":k.toString():p&&"percent-of-total"===p?k+"% - "+n+"%":k+" - "+n}function C(k){const n=[],p=[];let c=Number.MIN_VALUE,d=1,a=-1;for(let b=0;b<k.length;b++){const f=k[b];f===c?(d++,p[a]=d):null!==f&&(n.push(f),c=f,d=1,p.push(d),a++)}return{uniqueValues:n,valueFrequency:p}}function v(k,n,p){var c=k.length;const d=[];p>c&&(p=c);for(var a=0;a<
p;a++)d.push(Math.round(a*c/p-1));d.push(c-1);a=A(d,k,n,p);{c=a.mean;a=a.sdcm;var b=p,f=0,m=0;let x=0,q=0,B=!0;for(let z=0;2>z&&B;z++){0===z&&(B=!1);for(var g=0;g<b-1;g++)for(;d[g+1]+1!==d[g+2];)if(d[g+1]+=1,f=h(g,d,k,n),x=f.sbMean,f=f.sbSdcm,m=h(g+1,d,k,n),q=m.sbMean,m=m.sbSdcm,f+m<a[g]+a[g+1])a[g]=f,a[g+1]=m,c[g]=x,c[g+1]=q,B=!0;else{--d[g+1];break}for(g=b-1;0<g;g--)for(;d[g]!==d[g-1]+1;)if(--d[g],f=h(g-1,d,k,n),x=f.sbMean,f=f.sbSdcm,m=h(g,d,k,n),q=m.sbMean,m=m.sbSdcm,f+m<a[g-1]+a[g])a[g-1]=f,a[g]=
m,c[g-1]=x,c[g]=q,B=!0;else{d[g]+=1;break}}c=B}c&&(a=A(d,k,n,p));return d}function A(k,n,p,c){let d=[];var a=[],b=[];let f=0;const m=[],g=[];for(var x=0;x<c;x++){var q=h(x,k,n,p);m.push(q.sbMean);g.push(q.sbSdcm);f+=g[x]}q=f;for(x=!0;x||f<q;){x=!1;d=[];for(a=0;a<c;a++)d.push(k[a]);for(b=0;b<c;b++)for(q=k[b]+1;q<=k[b+1];q++)if(a=n[q],0<b&&q!==k[b+1]&&Math.abs(a-m[b])>Math.abs(a-m[b-1]))k[b]=q;else if(b<c-1&&k[b]!==q-1&&Math.abs(a-m[b])>Math.abs(a-m[b+1])){k[b+1]=q-1;break}q=f;f=0;a=[];b=[];for(let B=
0;B<c;B++){a.push(m[B]);b.push(g[B]);const z=h(B,k,n,p);m[B]=z.sbMean;g[B]=z.sbSdcm;f+=g[B]}}if(f>q){for(n=0;n<c;n++)k[n]=d[n],m[n]=a[n],g[n]=b[n];f=q}return{mean:m,sdcm:g}}function w(k,n,p,c,d){k=Math.max(c-k,n-c)/d/p;return 1<=k?1:.5<=k?.5:.25}function l(k){let n=0;for(let p=0;p<k.length;p++)n+=k[p];return n/=k.length}function e(k,n){let p=0;for(let c=0;c<k.length;c++){const d=k[c];p+=(d-n)*(d-n)}p/=k.length;return Math.sqrt(p)}function h(k,n,p,c){var d=0,a=0;for(var b=n[k]+1;b<=n[k+1];b++){const f=
c[b];d+=p[b]*f;a+=f}0>=a&&console.log("Exception in Natural Breaks calculation");d/=a;a=0;for(b=n[k]+1;b<=n[k+1];b++)a+=c[b]*(p[b]-d)**2;return{sbMean:d,sbSdcm:a}}r.createGenerateRendererClassBreaks=function(k){const {normalizationTotal:n}=k;return{classBreaks:t(k),normalizationTotal:n}};r.createGenerateRendererUniqueValues=function(k){k=C(k);const n=[],p=k.uniqueValues.length;for(let c=0;c<p;c++){const d=k.uniqueValues[c];n.push({value:d,count:k.valueFrequency[c],label:d.toString()})}return{uniqueValues:n}};
Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(r){function t(v,A,w,l,e){if(null!=l&&null!=e)return h=>{const k=v.getAttribute(h,A);h=v.getAttribute(h,w);return(null==k||k<=e)&&(null==h||h>=l)};if(null!=l)return h=>{h=v.getAttribute(h,w);return null==h||h>=l};if(null!=e)return h=>{h=v.getAttribute(h,A);return null==h||h<=e}}function F(v,A,w,l){if(null!=w&&null!=l&&w===l)return e=>v.getAttribute(e,A)===w;if(null!=w&&
null!=l)return e=>{e=v.getAttribute(e,A);return e>=w&&e<=l};if(null!=w)return e=>v.getAttribute(e,A)>=w;if(null!=l)return e=>v.getAttribute(e,A)<=l}function C(){return()=>!1}r.getTimeExtent=function(v,A){if(!v)return null;const w=A.featureAdapter,{startTimeField:l,endTimeField:e}=v;let h=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;if(l&&e)A.forEach(n=>{const p=w.getAttribute(n,l);n=w.getAttribute(n,e);null==p||isNaN(p)||(h=Math.min(h,p));null==n||isNaN(n)||(k=Math.max(k,n))});else{const n=
l||e;A.forEach(p=>{p=w.getAttribute(p,n);null==p||isNaN(p)||(h=Math.min(h,p),k=Math.max(k,p))})}return{start:h,end:k}};r.getTimeOperator=function(v,A,w){if(!A||!v)return null;const {startTimeField:l,endTimeField:e}=v;if(!l&&!e)return null;const {start:h,end:k}=A;return null===h&&null===k?null:void 0===h&&void 0===k?C():l&&e?t(w,l,e,h,k):F(w,l||e,h,k)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c){function d(O,K,D,I=O.hasZ,L=O.hasM){if(v.isNone(K))return null;const R=O.hasZ&&I,Z=O.hasM&&L;return D?(O=n.quantizeOptimizedGeometry(H,K,O.hasZ,O.hasM,"esriGeometryPoint",D,I,L),n.convertToPoint(O,R,Z)):n.convertToPoint(K,R,Z)}function a(){a=F._asyncToGenerator(function*(O,K,D){const {outFields:I,orderByFields:L,groupByFieldsForStatistics:R,outStatistics:Z}=O;if(I)for(var X=0;X<I.length;X++)I[X]=I[X].trim();if(L)for(X=0;X<L.length;X++)L[X]=L[X].trim();if(R)for(X=
0;X<R.length;X++)R[X]=R[X].trim();if(Z)for(X=0;X<Z.length;X++)Z[X].onStatisticField&&(Z[X].onStatisticField=Z[X].onStatisticField.trim());O.geometry&&!O.outSR&&(O.outSR=O.geometry.spatialReference);return f(O,K,D)});return a.apply(this,arguments)}function b(){b=F._asyncToGenerator(function*(O,K,D){return f(O,K,D)});return b.apply(this,arguments)}function f(O,K,D){return m.apply(this,arguments)}function m(){m=F._asyncToGenerator(function*(O,K,D){if(!O)return null;var {where:I}=O;O.where=I=I&&I.trim();
if(!I||/^1 *= *1$/.test(I)||K&&K===I)O.where=null;if(!O.geometry)return O;K=yield g(O);O.distance=0;O.units=null;"esriSpatialRelEnvelopeIntersects"===O.spatialRel&&({spatialReference:I}=O.geometry,K=w.getGeometryExtent(K),K.spatialReference=I);O.geometry=K;yield c.checkProjectionSupport(K.spatialReference,D);K=(yield e.normalizeCentralMeridian(l.fromJSON(K)))[0];if(v.isNone(K))throw u;K=K.toJSON();K=yield c.project(K,K.spatialReference,D);if(!K)throw u;K.spatialReference=D;O.geometry=K;return O});
return m.apply(this,arguments)}function g(O){return x.apply(this,arguments)}function x(){x=F._asyncToGenerator(function*(O){const {geometry:K,distance:D,units:I}=O;if(null==D||"vertexAttributes"in K)return K;var L=K.spatialReference;O=I?z.fromJSON(I):A.getUnitString(L);L=L&&(h.isGeographic(L)||h.isWebMercator(L))?K:yield c.checkProjectionSupport(L,h.WGS84).then(()=>c.project(K,h.WGS84));return(yield q())(L.spatialReference,L,D,O)});return x.apply(this,arguments)}function q(){return B.apply(this,arguments)}
function B(){B=F._asyncToGenerator(function*(){return(yield new Promise((O,K)=>r(["../../../geometry/geometryEngineJSON"],O,K))).geodesicBuffer});return B.apply(this,arguments)}const z=new C.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),u=Object.freeze({}),y=new p,E=new p,H=new p,J={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,
esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint},P=(O,K)=>"_geVersion"!==O?K:void 0;t.QUERY_ENGINE_EMPTY_RESULT=u;t.cleanFromGeometryEngine=function(O){return O&&"_geVersion"in O?JSON.parse(JSON.stringify(O,P)):O};t.getCentroid=function(O,K,D){if("esriGeometryPolygon"!==O.geometryType||!K||!K.centroid&&!K.geometry)return null;K.centroid||(K.centroid=k.getCentroidOptimizedGeometry(new p,K.geometry,O.hasZ,O.hasM));return d(O,K.centroid,D)};t.getGeometry=function(O,
K,D,I,L,R,Z=K,X=D){const Q=K&&Z,M=D&&X;I=v.isSome(I)?"coords"in I?I:I.geometry:null;if(v.isNone(I))return null;if(L)return K=n.generalizeOptimizedGeometry(E,I,K,D,O,L,Z,X),R&&(K=n.quantizeOptimizedGeometry(H,K,Q,M,O,R)),J[O](K,Q,M);if(R)return R=n.quantizeOptimizedGeometry(H,I,K,D,O,R,Z,X),J[O](R,Q,M);n.removeZMValues(y,I,K,D,Z,X);return J[O](y,Q,M)};t.normalizeFilter=function(O,K,D){return b.apply(this,arguments)};t.normalizeQuery=function(O,K,D){return a.apply(this,arguments)};t.normalizeQueryLike=
f;t.transformCentroid=d;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(r,t){function F(v,A,w,l,e,h,k=1){h=e?h?4:3:h?3:2;let n=w,p=w+h,c=0,d=0,a=w=0,b=0;for(let f=0,m=l-1;f<m;f++,n+=h,p+=h){l=A[n];const g=A[n+1],x=A[n+2],q=A[p],B=A[p+1],z=A[p+2];let u=l*B-q*g;a+=u;c+=(l+q)*u;d+=(g+B)*u;e&&(u=l*z-q*x,w+=(x+z)*u,b+=u);l<v[0]&&(v[0]=l);l>v[1]&&(v[1]=l);g<v[2]&&(v[2]=g);g>v[3]&&(v[3]=g);e&&(x<v[4]&&(v[4]=x),
x>v[5]&&(v[5]=x))}0<a*k&&(a*=-1);0<b*k&&(b*=-1);if(!a)return null;v=[c,d,.5*a];e&&(v[3]=w,v[4]=.5*b);return v}function C(v,A,w,l,e){e=l?e?4:3:e?3:2;let h=A,k=A+e,n=0,p=0,c=0,d=0;for(let m=0,g=w-1;m<g;m++,h+=e,k+=e){var a=v[h];const x=v[h+1],q=v[h+2],B=v[k],z=v[k+1],u=v[k+2];if(l){{var b=B-a;var f=z-x;const y=u-q;b=Math.sqrt(b*b+f*f+y*y)}}else b=B-a,f=z-x,b=Math.sqrt(b*b+f*f);b&&(n+=b,l?(a=[a+.5*(B-a),x+.5*(z-x),q+.5*(u-q)],p+=b*a[0],c+=b*a[1],d+=b*a[2]):(a=[a+.5*(B-a),x+.5*(z-x)],p+=b*a[0],c+=b*a[1]))}return 0<
n?l?[p/n,c/n,d/n]:[p/n,c/n]:0<w?l?[v[A],v[A+1],v[A+2]]:[v[A],v[A+1]]:null}r.getCentroidOptimizedGeometry=function(v,A,w,l,e){if(t.isNone(A)||!A.lengths.length)return null;const h="upperLeft"===(null==e?void 0:e.originPosition)?-1:1;v.lengths.length&&(v.lengths.length=0);v.coords.length&&(v.coords.length=0);e=v.coords;const k=[],n=w?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:p,coords:c}=A,d=w?l?4:3:l?3:2;let a=0;for(var b of p){const f=F(n,c,a,b,w,l,h);f&&k.push(f);a+=b*d}k.sort((f,m)=>{let g=h*f[2]-h*m[2];0===g&&w&&(g=f[4]-m[4]);return g});k.length&&(b=6*k[0][2],e[0]=k[0][0]/b,e[1]=k[0][1]/b,w&&(b=6*k[0][4],e[2]=0!==b?k[0][3]/b:0),e[0]<n[0]||e[0]>n[1]||e[1]<n[2]||e[1]>n[3]||w&&(e[2]<n[4]||e[2]>n[5]))&&(e.length=0);if(!e.length)if(A=A.lengths[0]?C(c,0,p[0],w,l):null)e[0]=A[0],e[1]=A[1],
w&&2<A.length&&(e[2]=A[2]);else return null;return v};r.lineCentroid=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(r,t,F,C,v,A,w,l){function e(aa,ea,la){if(aa)for(const qa of aa)(aa=(aa=A.getDeepValue(qa,ea))&&"function"!==typeof aa&&la.get(aa))&&A.setDeepValue(qa,aa.name,
ea)}function h(aa,ea){if(!aa||!ea)return[];S.clear();k(S,aa,ea);return Array.from(S).sort()}function k(aa,ea,la){var qa;if(la)if(null!=ea&&null!=(qa=ea.fields)&&qa.length)if(la.includes("*"))for(const {name:sa}of ea.fields)aa.add(sa);else for(const sa of la)n(aa,ea,sa);else if(la.includes("*"))aa.clear(),aa.add("*");else for(const sa of la)aa.add(sa)}function n(aa,ea,la){"string"===typeof la&&(ea?(ea=ea.get(la))&&aa.add(ea.name):aa.add(la))}function p(aa,ea,la){return c.apply(this,arguments)}function c(){c=
F._asyncToGenerator(function*(aa,ea,la){var qa;if(la){var {arcadeUtils:sa}=yield l.loadArcade();la=sa.extractFieldNames(la,null==ea?void 0:null==(qa=ea.fields)?void 0:qa.map(wa=>wa.name));for(const wa of la)n(aa,ea,wa)}});return c.apply(this,arguments)}function d(aa,ea,la){return a.apply(this,arguments)}function a(){a=F._asyncToGenerator(function*(aa,ea,la){if(la&&"1\x3d1"!==la){la=(yield new Promise((qa,sa)=>r(["../../core/sql/WhereClause"],qa,sa))).WhereClause.create(la,ea);if(!la.isStandardized)throw new C("fieldUtils:collectFilterFields",
"Where clause is not standardized");k(aa,ea,la.fieldNames)}});return a.apply(this,arguments)}function b(aa,ea){for(const la of aa)if(la&&la.valueType&&la.valueType===ea)return la.name;return null}function f(){f=F._asyncToGenerator(function*(aa){if(!aa)return[];const ea=new Set;yield m(ea,aa);return Array.from(ea).sort()});return f.apply(this,arguments)}function m(aa,ea){return g.apply(this,arguments)}function g(){g=F._asyncToGenerator(function*(aa,ea){if(ea){var la=A.getDeepValue("elevationInfo.featureExpressionInfo",
ea);if(la)return la.collectRequiredFields(aa,ea.fieldsIndex)}});return g.apply(this,arguments)}function x(aa,ea,la){return q.apply(this,arguments)}function q(){q=F._asyncToGenerator(function*(aa,ea,la){la.outStatistic.onStatisticValueExpression?p(aa,ea,la.outStatistic.onStatisticValueExpression):aa.add(la.outStatistic.onStatisticField)});return q.apply(this,arguments)}function B(){B=F._asyncToGenerator(function*(aa,ea,la){var qa,sa;if(ea&&la&&"cluster"===la.type){var wa=[];null!=(qa=la.popupTemplate)&&
qa.expressionInfos&&wa.push(...la.popupTemplate.expressionInfos.map(za=>p(aa,ea.fieldsIndex,za.expression)));if(Array.isArray(null==(sa=la.popupTemplate)?void 0:sa.content)){qa=la.popupTemplate.content;for(const za of qa)"expression"===za.type&&za.expressionInfo&&wa.push(p(aa,ea.fieldsIndex,za.expressionInfo.expression))}la.fields&&wa.push(...la.fields.map(za=>x(aa,ea.fieldsIndex,za)));yield Promise.all(wa)}});return B.apply(this,arguments)}function z(){z=F._asyncToGenerator(function*(aa,ea,la){ea&&
(ea.timeInfo&&v.isSome(la)&&la.timeExtent&&k(aa,ea.fieldsIndex,[ea.timeInfo.startField,ea.timeInfo.endField]),ea.floorInfo&&k(aa,ea.fieldsIndex,[ea.floorInfo.floorField]),v.isSome(la)&&v.isSome(la.where)&&(yield d(aa,ea.fieldsIndex,la.where)))});return z.apply(this,arguments)}function u(){u=F._asyncToGenerator(function*(aa,ea,la){ea&&la&&(yield Promise.all(la.map(qa=>y(aa,ea,qa))))});return u.apply(this,arguments)}function y(aa,ea,la){return E.apply(this,arguments)}function E(){E=F._asyncToGenerator(function*(aa,
ea,la){ea&&la&&(la.valueExpression?yield p(aa,ea.fieldsIndex,la.valueExpression):la.field&&n(aa,ea.fieldsIndex,la.field))});return E.apply(this,arguments)}function H(){H=F._asyncToGenerator(function*(aa){if(!aa)return[];const ea="timeInfo"in aa&&aa.timeInfo;return ea?h(aa.fieldsIndex,[aa.trackIdField,ea.startField,ea.endField]):[]});return H.apply(this,arguments)}function J(){J=F._asyncToGenerator(function*(aa){if(!aa)return[];const ea=new Set;yield P(ea,aa);return Array.from(ea).sort()});return J.apply(this,
arguments)}function P(aa,ea){return O.apply(this,arguments)}function O(){O=F._asyncToGenerator(function*(aa,ea){const {labelingInfo:la,fieldsIndex:qa}=ea;la&&la.length&&(yield Promise.all(la.map(sa=>K(aa,qa,sa))))});return O.apply(this,arguments)}function K(aa,ea,la){return D.apply(this,arguments)}function D(){D=F._asyncToGenerator(function*(aa,ea,la){if(la){var qa=la.getLabelExpression();la=la.where;"arcade"===qa.type?yield p(aa,ea,qa.expression):(qa=qa.expression.match(/{[^}]*}/g))&&qa.forEach(sa=>
{n(aa,ea,sa.slice(1,-1))});yield d(aa,ea,la)}});return D.apply(this,arguments)}function I(aa){return"number"===typeof aa&&!isNaN(aa)&&isFinite(aa)}function L(aa){return null===aa||I(aa)}function R(aa){return null===aa||ha(aa)}function Z(aa){return null!=aa&&"string"===typeof aa}function X(aa){return null===aa||Z(aa)}function Q(){return!0}function M(aa,ea){let la;switch(aa.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":la=
aa.nullable?R:ha;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":la=aa.nullable?L:I;break;case "string":case "esriFieldTypeString":la=aa.nullable?X:Z;break;default:la=Q}return 1===arguments.length?la:la(ea)}function V(aa){return null!=aa&&W.has(aa.type)}function fa(aa,ea){return aa.nullable&&null===ea?null:V(aa)&&!oa(aa.type,Number(ea))?t.NumericRangeValidationError.OUT_OF_RANGE:M(aa,ea)?aa.domain?w.validateDomainValue(aa.domain,ea):null:t.TypeValidationError.INVALID_TYPE}
function oa(aa,ea){return(aa="string"===typeof aa?ua(aa):aa)?aa.isInteger?ha(ea)&&ea>=aa.min&&ea<=aa.max:ea>=aa.min&&ea<=aa.max:!1}function ua(aa){switch(aa){case "esriFieldTypeSmallInteger":case "small-integer":return ca;case "esriFieldTypeInteger":case "integer":return da;case "esriFieldTypeSingle":case "single":return ia;case "esriFieldTypeDouble":case "double":return ja}}function xa(aa,ea,la){if(!ea||!ea.attributes||!aa){if(v.isSome(la))for(var qa of aa)la.add(qa);return!0}ea=ea.attributes;qa=
!1;for(const sa of aa)if(!(sa in ea))if(qa=!0,v.isSome(la))la.add(sa);else break;return qa}function Ca(){Ca=F._asyncToGenerator(function*(aa,ea){const la=new Set;for(const qa of ea)yield p(la,aa.fieldsIndex,qa);return Array.from(la).sort()});return Ca.apply(this,arguments)}const va="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),G=["field","normalizationField"],
S=new Set,ha=(()=>"isInteger"in Number?Number.isInteger:aa=>"number"===typeof aa&&isFinite(aa)&&Math.floor(aa)===aa)(),T=["integer","small-integer","single","double"],W=new Set([...T,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);t.NumericRangeValidationError=void 0;(t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";t.TypeValidationError=void 0;(t.TypeValidationError||(t.TypeValidationError=
{})).INVALID_TYPE="type-validation-error::invalid-type";const ca={min:-32768,max:32767,isInteger:!0},da={min:-2147483648,max:2147483647,isInteger:!0},ia={min:-3.4E38,max:1.2E38,isInteger:!1},ja={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};t.collectArcadeFieldNames=p;t.collectElevationFields=m;t.collectFeatureReductionFields=function(aa,ea,la){return B.apply(this,arguments)};t.collectField=n;t.collectFields=k;t.collectFilterFields=function(aa,ea,la){return z.apply(this,arguments)};t.collectLabelingFields=
P;t.collectOrderByInfos=function(aa,ea,la){return u.apply(this,arguments)};t.doubleRange=ja;t.featureHasFields=function(aa,ea){return!xa(aa,ea,null)};t.fixFields=h;t.fixRendererFields=function(aa,ea){if(null!=aa&&null!=ea)for(const la of Array.isArray(aa)?aa:[aa])if(e(va,la,ea),"visualVariables"in la&&la.visualVariables)for(const qa of la.visualVariables)e(G,qa,ea)};t.fixTimeInfoFields=function(aa,ea){if(null!=aa&&null!=ea&&ea.fields.length)if("startField"in aa){var la=ea.get(aa.startField);ea=ea.get(aa.endField);
aa.startField=la&&la.name||null;aa.endField=ea&&ea.name||null}else la=ea.get(aa.startTimeField),ea=ea.get(aa.endTimeField),aa.startTimeField=la&&la.name||null,aa.endTimeField=ea&&ea.name||null};t.getDisplayFieldName=function({displayField:aa,fields:ea}){if(aa)return aa;if(!ea||!ea.length)return null;if(!(aa=b(ea,"name-or-title")||b(ea,"unique-identifier")||b(ea,"type-or-category")))a:{for(const la of ea)if(la&&la.name&&(ea=la.name.toLowerCase(),-1<ea.indexOf("name")||-1<ea.indexOf("title"))){aa=la.name;
break a}aa=null}return aa};t.getElevationFields=function(aa){return f.apply(this,arguments)};t.getExpressionFields=function(aa,ea){return Ca.apply(this,arguments)};t.getFeatureEditFields=function(aa){if(!aa)return[];const ea="editFieldsInfo"in aa&&aa.editFieldsInfo;return ea?h(aa.fieldsIndex,[ea&&ea.creatorField,ea&&ea.creationDateField,ea&&ea.editorField,ea&&ea.editDateField]):[]};t.getFeatureGeometryFields=function(aa){if(!aa)return[];const ea=aa.geometryFieldsInfo;return ea?h(aa.fieldsIndex,[ea.shapeAreaField,
ea.shapeLengthField]):[]};t.getFieldDefaultValue=function(aa){const ea=aa.defaultValue;if(void 0!==ea&&M(aa,ea))return ea;if(aa.nullable)return null};t.getFieldRange=function(aa){const ea=w.getDomainRange(aa.domain);if(ea)return ea;if(V(aa))return ua(aa.type)};t.getLabelingFields=function(aa){return J.apply(this,arguments)};t.getNumericTypeForValue=function(aa){if(!I(aa))return null;if(ha(aa)){if(aa>=ca.min&&aa<=ca.max)return"esriFieldTypeSmallInteger";if(aa>=da.min&&aa<=da.max)return"esriFieldTypeInteger"}return aa>=
ia.min&&aa<=ia.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};t.getTimeFields=function(aa){return H.apply(this,arguments)};t.integerRange=da;t.isDateField=function(aa){return null!=aa&&("date"===aa.type||"esriFieldTypeDate"===aa.type)};t.isNumberInRange=oa;t.isNumericField=V;t.isStringField=function(aa){return null!=aa&&("string"===aa.type||"esriFieldTypeString"===aa.type)};t.isValidFieldValue=function(aa,ea){return null===fa(aa,ea)};t.isValueMatchingFieldType=M;t.numericTypes=T;t.packFields=function(aa,
ea,la=1){if(!ea||!aa)return[];if(ea.includes("*"))return["*"];ea=h(aa,ea);return ea.length/aa.fields.length>=la?["*"]:ea};t.populateMissingFields=xa;t.rendererFields=va;t.sanitizeNullFieldValue=function(aa){return null==aa||"number"===typeof aa&&isNaN(aa)?null:aa};t.singleRange=ia;t.smallIntegerRange=ca;t.unpackFieldNames=function(aa,ea){return v.isNone(ea)||v.isNone(aa)?[]:ea.includes("*")?aa.fields.map(la=>la.name):ea};t.validateFieldValue=fa;t.validationErrorToString=function(aa,ea,la){switch(aa){case w.DomainValidationError.INVALID_CODED_VALUE:return`Value ${la} is not in the coded domain - field: ${ea.name}, domain: ${JSON.stringify(ea.domain)}`;
case w.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${la} is out of the range of valid values - field: ${ea.name}, domain: ${JSON.stringify(ea.domain)}`;case t.TypeValidationError.INVALID_TYPE:return`Value ${la} is not a valid value for the field type - field: ${ea.name}, type: ${ea.type}, nullable: ${ea.nullable}`;case t.NumericRangeValidationError.OUT_OF_RANGE:{const {min:qa,max:sa}=ua(ea.type);return`Value ${la} is out of range for the number type - field: ${ea.name}, type: ${ea.type}, value range is ${qa} to ${sa}`}}};
t.visualVariableFields=G;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(r){function t(F,C){switch(F.type){case "range":{const v="range"in F?F.range[1]:F.maxValue;if(+C<("range"in F?F.range[0]:F.minValue)||+C>v)return r.DomainValidationError.VALUE_OUT_OF_RANGE;break}case "coded-value":case "codedValue":if(null==F.codedValues||F.codedValues.every(v=>null==v||v.code!==C))return r.DomainValidationError.INVALID_CODED_VALUE}return null}
r.DomainValidationError=void 0;(function(F){F.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";F.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(r.DomainValidationError||(r.DomainValidationError={}));r.getDomainRange=function(F){if(F&&"range"===F.type)return{min:"range"in F?F.range[0]:F.minValue,max:"range"in F?F.range[1]:F.maxValue}};r.isValidDomainValue=function(F,C){return null===t(F,C)};r.validateDomainValue=t;Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/maybe ../geometry/SpatialReference".split(" "),function(r,t,F,C,v,A){function w(){l||(l=F._asyncToGenerator(function*(){const h=yield new Promise((k,n)=>r(["./arcadeUtils"],k,n));return{arcade:h.arcade,arcadeUtils:h,Dictionary:h.Dictionary,Feature:h.arcadeFeature}})());return l}let l;C=(h,k,n)=>e.create(h,k,n,null,["$feature","$view"]);let e=function(){function h(n,p,c,d,a,b,f,
m){this.script=n;this.evaluate=a;this.fields=Array.isArray(f)?f:f.fields;this._syntaxTree=d;this._arcade=p;this._arcadeDictionary=c;this._arcadeFeature=b;this._spatialReference=m;this._referencesGeometry=p.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}h.create=function(){var n=F._asyncToGenerator(function*(p,c,d,a,b,f){const {arcade:m,Feature:g,Dictionary:x}=yield w(),q=A.fromJSON(c);c=m.parseScript(p,f);b=b.reduce((E,H)=>({...E,
[H]:null}),{});let B=null;v.isSome(a)&&(B=new x(a),B.immutable=!0,b.$config=null);a=m.scriptUsesGeometryEngine(c)&&m.enableGeometrySupport();f=m.scriptUsesFeatureSet(c)&&m.enableFeatureSetSupport();const z=m.scriptIsAsync(c)&&m.enableAsyncSupport();b={vars:b,spatialReference:q,useAsync:!!z};const u=new x;u.immutable=!1;u.setField("scale",0);const y=m.compileScript(c,b);yield Promise.all([a,f,z]);return new h(p,m,x,c,E=>{"$view"in E&&E.$view&&(u.setField("scale",E.$view.scale),E.$view=u);B&&(E.$config=
B);return y({vars:E,spatialReference:q})},new g,d,q)});return function(p,c,d,a,b,f){return n.apply(this,arguments)}}();var k=h.prototype;k.repurposeFeature=function(n){n.geometry&&!n.geometry.spatialReference&&(n.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(n.geometry,n.attributes,{fields:this.fields});return this._arcadeFeature};k.createDictionary=function(){return new this._arcadeDictionary};k.referencesMember=function(n){return this._arcade.referencesMember(this._syntaxTree,
n)};k.referencesFunction=function(n){return this._arcade.referencesFunction(this._syntaxTree,n)};k.referencesGeometry=function(){return this._referencesGeometry};k.referencesScale=function(){return this._referencesScale};k.extractFieldLiterals=function(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)};return h}();t.ArcadeExpression=e;t.createDictionaryExpression=(h,k,n,p)=>e.create(h,k,n,p,["$feature","$view"]);t.createLabelExpression=(h,k,n)=>e.create(h,k,n,null,["$feature"]);
t.createRendererExpression=C;t.createVVExpression=C;t.loadArcade=w;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){function c(){return new Promise((f,m)=>r(["../../../geometry/geometryEngineJSON"],f,m))}function d(){d=F._asyncToGenerator(function*(f,m,g){const {spatialRel:x,geometry:q}=f;if(q){if(!0!==b.spatialRelationship[x])throw new C("feature-store:unsupported-query","Unsupported query spatial relationship",{query:f});if(l.isValid(q.spatialReference)&&l.isValid(g)){if(!0!==b.queryGeometry[w.getJsonType(q)])throw new C("feature-store:unsupported-query","Unsupported query geometry type",
{query:f});if(!0!==b.layerGeometry[m])throw new C("feature-store:unsupported-query","Unsupported layer geometry type",{query:f});if(f.outSR)return n.checkProjectionSupport(f.geometry&&f.geometry.spatialReference,f.outSR)}}});return d.apply(this,arguments)}const a={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",
esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},
layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.canQueryWithRBush=function(f){if(w.isExtent(f))return!0;if(w.isPolygon(f)){for(const m of f.rings)if(5!==m.length||m[0][0]!==m[1][0]||m[0][0]!==m[4][0]||m[2][0]!==m[3][0]||m[0][1]!==m[3][1]||m[0][1]!==m[4][1]||m[1][1]!==m[2][1])return!1;return!0}return!1};t.checkSpatialQuerySupport=function(f,m,g){return d.apply(this,arguments)};t.getSpatialQueryOperator=function(f,
m,g,x,q){if(w.isPolygon(m)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===f||"esriSpatialRelContains"===f)){const B=h.convertFromPolygon(new k,m,!1,!1);return Promise.resolve(z=>e.polygonContainsPoint(B,!1,!1,z))}if(w.isPolygon(m)&&"esriGeometryMultipoint"===g){const B=h.convertFromPolygon(new k,m,!1,!1);if("esriSpatialRelContains"===f)return Promise.resolve(z=>e.polygonContainsMultipoint(B,!1,!1,z,x,q))}if(w.isExtent(m)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===f||"esriSpatialRelContains"===
f))return Promise.resolve(B=>v.extentContainsPoint(m,p.getGeometry(g,x,q,B)));if(w.isExtent(m)&&"esriGeometryMultipoint"===g&&"esriSpatialRelContains"===f)return Promise.resolve(B=>v.extentContainsMultipoint(m,p.getGeometry(g,x,q,B)));if(w.isExtent(m)&&"esriSpatialRelIntersects"===f){const B=A.getExtentIntersector(g);return Promise.resolve(z=>B(m,p.getGeometry(g,x,q,z)))}return c().then(B=>{const z=B[a[f]].bind(null,m.spatialReference,m);return u=>z(p.getGeometry(g,x,q,u))})};Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(r,t){r.extentIntersectsExtent=t.extentIntersectsExtent;r.extentIntersectsMultipoint=t.extentIntersectsMultipoint;r.extentIntersectsPoint=t.extentIntersectsPoint;r.extentIntersectsPolygon=t.extentIntersectsPolygon;r.extentIntersectsPolyline=t.extentIntersectsPolyline;r.getFeatureExtentIntersector=t.getFeatureExtentIntersector;r.isSelfIntersecting=t.isSelfIntersecting;r.segmentIntersects=
t.segmentIntersects;r.getExtentIntersector=function(F){return"mesh"===F?t.extentIntersectsExtent:t.getFeatureExtentIntersector(F)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/contains":function(){define(["exports"],function(r){function t(F,C,v,A,w){if(!F)return!1;C=C?v?4:3:v?3:2;const {coords:l,lengths:e}=F;v=!1;F=0;for(const k of e){var h=F;for(let n=F,p=F+k*C;n<p;n+=C){h=n+C;h===p&&(h=F);const c=l[n],d=l[n+1],a=l[h];h=l[h+1];(d<w&&h>=w||h<w&&d>=w)&&c+(w-d)/(h-d)*(a-
c)<A&&(v=!v)}F+=k*C}return v}r.polygonContainsCoords=t;r.polygonContainsMultipoint=function(F,C,v,A,w,l){w=w?l?4:3:l?3:2;const {coords:e,lengths:h}=A;if(!h)return!1;for(let k=0,n=0;k<h.length;k++,n+=w)if(!t(F,C,v,e[n],e[n+1]))return!1;return!0};r.polygonContainsPoint=function(F,C,v,A){return t(F,C,v,A.coords[0],A.coords[1])};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers","./fieldUtils"],function(r,t){function F(v){return"oid"===
v.type||"esriFieldTypeOID"===v.type}function C(v){return"global-id"===v.type||"esriFieldTypeGlobalID"===v.type}return function(){function v(w){this.fields=w;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=null;if(w){var l=[];for(const e of w)if(w=e&&e.name){const h=w.toLowerCase().trim();this._fieldsMap.set(w,e);this._fieldsMap.set(h,e);l.push(h);"date"===e.type||"esriFieldTypeDate"===e.type?(this.dateFields.push(e),
this._dateFieldsSet.add(e)):t.isNumericField(e)&&(this._numericFieldsSet.add(e),this.numericFields.push(e));F(e)||C(e)||(e.editable=null==e.editable?!0:!!e.editable,e.nullable=null==e.nullable?!0:!!e.nullable)}l.sort();this.uid=l.join(",")}}var A=v.prototype;A.destroy=function(){this._fieldsMap.clear()};A.has=function(w){return null!=this.get(w)};A.get=function(w){return null!=w?this._fieldsMap.get(w)||this._fieldsMap.get(w.toLowerCase().trim()):void 0};A.isDateField=function(w){return this._dateFieldsSet.has(this.get(w))};
A.isNumericField=function(w){return this._numericFieldsSet.has(this.get(w))};A.normalizeFieldName=function(w){if(w=this.get(w))return w.name};r._createClass(v,[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];for(const w of this.fields)F(w)||C(w)||w.nullable||void 0!==t.getFieldDefaultValue(w)||this._requiredFields.push(w)}return this._requiredFields}}]);return v}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/PromiseQueue ./debugFlags".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m){function g(K){return q.has(K)?q.get(K):"number"===typeof K?K:1}const x=A.getLogger("esri.views.support.Scheduler");r.TaskPriority=void 0;(function(K){K.RESOURCE_CONTROLLER="schedule";K.SLIDE="slide";K.STREAM_DATA_LOADER="stream loader";K.ELEVATION_QUERY="elevation query";K.TERRAIN_SURFACE="terrain";K.SURFACE_GEOMETRY_UPDATES="surface geometry updates";K.GRAPHICS_CORE="Graphics3D";K.I3S_CONTROLLER="I3S";K.POINT_CLOUD_LAYER="point cloud";K.FEATURE_TILE_FETCHER=
"feature fetcher";K.OVERLAY="overlay";K.STAGE="stage";K.GRAPHICS_DECONFLICTOR="graphics deconflictor";K.FILTER_VISIBILITY="Graphics3D filter visibility";K.SCALE_VISIBILITY="Graphics3D scale visibility";K.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";K.POINT_OF_INTEREST_FREQUENT="POI frequent";K.POINT_OF_INTEREST_INFREQUENT="POI infrequent";K.LABELER="labeler";K.FEATURE_QUERY_ENGINE="feature query";K.FEATURE_TILE_TREE="feature tile tree";K.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";K.ELEVATION_ALIGNMENT=
"elevation alignment";K.TEXT_TEXTURE_ATLAS="text texture atlas";K.TEXTURE_UNLOAD="texture unload";K.LINE_OF_SIGHT_TOOL="line of sight tool";K.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";K.ELEVATION_PROFILE="elevation profile";K.SNAPPING="snapping";K.SHADOW_ACCUMULATOR="shadow accumulator";K.CLOUDS_GENERATOR="cloud generator";K[K.TEST_PRIO=1]="TEST_PRIO"})(r.TaskPriority||(r.TaskPriority={}));const q=new Map([[r.TaskPriority.RESOURCE_CONTROLLER,0],[r.TaskPriority.SLIDE,0],[r.TaskPriority.STREAM_DATA_LOADER,
0],[r.TaskPriority.ELEVATION_QUERY,0],[r.TaskPriority.TERRAIN_SURFACE,1],[r.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[r.TaskPriority.GRAPHICS_CORE,2],[r.TaskPriority.I3S_CONTROLLER,2],[r.TaskPriority.POINT_CLOUD_LAYER,2],[r.TaskPriority.FEATURE_TILE_FETCHER,2],[r.TaskPriority.OVERLAY,4],[r.TaskPriority.STAGE,4],[r.TaskPriority.GRAPHICS_DECONFLICTOR,4],[r.TaskPriority.FILTER_VISIBILITY,4],[r.TaskPriority.SCALE_VISIBILITY,4],[r.TaskPriority.FRUSTUM_VISIBILITY,4],[r.TaskPriority.POINT_OF_INTEREST_FREQUENT,
6],[r.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[r.TaskPriority.LABELER,8],[r.TaskPriority.FEATURE_QUERY_ENGINE,8],[r.TaskPriority.FEATURE_TILE_TREE,16],[r.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[r.TaskPriority.ELEVATION_ALIGNMENT,12],[r.TaskPriority.TEXT_TEXTURE_ATLAS,12],[r.TaskPriority.CLOUDS_GENERATOR,12],[r.TaskPriority.TEXTURE_UNLOAD,12],[r.TaskPriority.LINE_OF_SIGHT_TOOL,16],[r.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[r.TaskPriority.SNAPPING,0],[r.TaskPriority.SHADOW_ACCUMULATOR,
30]]);r.State=void 0;(function(K){K[K.ANIMATING=0]="ANIMATING";K[K.INTERACTING=1]="INTERACTING";K[K.IDLE=2]="IDLE"})(r.State||(r.State={}));const B=n.Milliseconds(6.5),z=n.Milliseconds(1),u=n.Milliseconds(30),y=n.Milliseconds(1E3/30),E=n.Milliseconds(100);var H;(function(K){let D=function(R){function Z(Q){var M=R.call(this,Q)||this;M.updating=!0;M._microTaskQueued=!1;M.performanceInfo={total:new l("total"),tasks:new Map};M._frameTaskTimes=new Map;M._budget=null;M._state=r.State.INTERACTING;M._tasks=
new e;M._runQueue=new e;M._load=0;M._idleStateCallbacks=new e;M._idleUpdatesStartFired=!1;M._maxReschedule=O;M._forceTask=!1;M._debug=!1;M._debugHandle=k.watch(()=>m.SCHEDULER_LOG_SLOW_TASKS,oa=>M._debug=oa,k.initial);M._budget=new L(Q.nowFunc);for(const oa of Object.keys(r.TaskPriority))M.performanceInfo.tasks.set(r.TaskPriority[oa],new l(r.TaskPriority[oa]));let V;const fa=t._assertThisInitialized(M);M._test={get state(){return w.unwrapOr(V,fa._state)},set state(oa){V=oa},FRAME_SAFETY_BUDGET:B,
INTERACTING_BUDGET:y,IDLE_BUDGET:E,get budget(){return fa._budget.budget},usedBudget:0,setBudget:oa=>fa._budget=oa,updateTask:oa=>M._updateTask(oa),getState:oa=>M._getState(oa),getRuntime:oa=>M._getRuntime(oa),frameTaskTimes:M._frameTaskTimes,resetRuntimes:()=>M._resetRuntimes(),getRunning:()=>M._getRunning()};return M}t._inheritsLoose(Z,R);var X=Z.prototype;X.destroy=function(){this._tasks.toArray().forEach(Q=>Q.remove());this._tasks.clear();w.removeMaybe(this._debugHandle);this.updating=this._microTaskQueued=
!1};X.activate=function(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=O,this._schedule(),this.frame()))}))};X.registerTask=function(Q,M){const V=g(Q);M=new I(this,Q,M,V);this._tasks.push(M);this.performanceInfo.tasks.has(Q)||this.performanceInfo.tasks.set(Q,new l(Q));return M};X.registerIdleStateCallbacks=function(Q,M){const V={idleBegin:Q,idleEnd:M};this._idleStateCallbacks.push(V);
this.state===r.State.IDLE&&this._idleUpdatesStartFired&&V.idleBegin();const fa=this;return{remove:()=>this._removeIdleStateCallbacks(V),set idleBegin(oa){fa._idleUpdatesStartFired&&(V.idleEnd(),fa._state===r.State.IDLE&&oa());V.idleBegin=oa},set idleEnd(oa){V.idleEnd=oa}}};X.updateBudget=function(Q){this._test.usedBudget=0;let M=B,V=Q.frameDuration,fa=z;switch(this.state){case r.State.IDLE:M=n.Milliseconds(0);V=n.Milliseconds(Math.max(E,Q.frameDuration));fa=u;break;case r.State.INTERACTING:V=n.Milliseconds(Math.max(y,
Q.frameDuration))}V=n.Milliseconds(V-Q.elapsedFrameTime-M);if(this.state!==r.State.IDLE&&V<z&&!this._forceTask)return this._forceTask=!0,!1;V=n.Milliseconds(Math.max(V,fa));this._budget.reset(V,this.state);this._maxReschedule=O;this._updateLoad();return this._schedule()};X.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case r.State.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(Q=>Q.idleBegin()));this._runIdle();break;
case r.State.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};X.stopFrame=function(){this._budget.reset(n.Milliseconds(0),this._state);this._budget.madeProgress()};X._removeIdleStateCallbacks=function(Q){this._idleUpdatesStartFired&&Q.idleEnd();this._idleStateCallbacks.removeUnordered(Q)};X.removeTask=function(Q){this._tasks.removeUnordered(Q);this._runQueue.removeUnordered(Q)};X._updateTask=function(Q){this._tasks.forAll(M=>{M.name===
Q&&M.setPriority(Q)})};X._getState=function(Q){if(this._runQueue.some(V=>V.name===Q))return r.TaskState.SCHEDULED;let M=r.TaskState.IDLE;this._tasks.forAll(V=>{V.name===Q&&V.needsUpdate&&(1>=V.schedulePriority?M=r.TaskState.READY:M!==r.TaskState.READY&&(M=r.TaskState.WAITING))});return M};X._getRuntime=function(Q){let M=0;this._tasks.forAll(V=>{V.name===Q&&(M+=V.runtime)});return M};X._resetRuntimes=function(){this._tasks.forAll(Q=>Q.runtime=0)};X._getRunning=function(){const Q=new Map;this._tasks.forAll(V=>
{V.needsUpdate&&Q.set(V.name,(Q.get(V.name)||0)+1)});if(0===Q.size)return null;let M="";Q.forEach((V,fa)=>{M=1<V?M+` ${V}x ${fa}`:M+` ${fa}`});return M};X._runIdle=function(){this._run()};X._runInteracting=function(){this._run()};X._runAnimating=function(){this._run()};X._updateLoad=function(){const Q=this._tasks.reduce((M,V)=>V.needsUpdate?++M:M,0);this._load=.9*this._load+Q*(1-.9)};X._schedule=function(){if(0>=this._maxReschedule)return!1;this._runQueue.filterInPlace(Q=>{if(Q.needsUpdate)return!0;
Q.schedulePriority=Q.basePriority;return!1});for(this._tasks.forAll(Q=>{0===Q.basePriority&&Q.needsUpdate&&!this._runQueue.some(M=>M===Q)&&this._runQueue.unshift(Q)});0===this._runQueue.length;){let Q=!1,M=0;this._tasks.forAll(V=>{if(V.needsUpdate&&0!==V.schedulePriority&&0!==V.basePriority)switch(Q=!0,M=Math.max(M,V.basePriority),V.schedulePriority){case 1:V.schedulePriority=0;this._runQueue.push(V);break;default:--V.schedulePriority}});if(!Q)return this.updating=!1;this._maxReschedule===O&&(this._maxReschedule=
M);--this._maxReschedule}return this.updating=!0};X._run=function(){const Q=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var M=this._budget.now();const V=this._runQueue.pop();this._budget.resetProgress();try{V.task.runTask(this._budget)}catch(fa){x.error(`Exception in task "${V.name}"`,fa)}V.schedulePriority=V.basePriority;M=this._budget.now()-M;V.runtime+=M;this._frameTaskTimes.set(V.priority,this._frameTaskTimes.get(V.priority)+M);this._debug&&this._budget.elapsed>
2*this._budget.budget&&console.log("Task",V.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this.updating=this._tasks.some(fa=>fa.needsUpdate);this._recordFrameTaskTimes(this._budget.now()-Q);return}}while(this._schedule());this.updating=this._tasks.some(V=>V.needsUpdate);this._recordFrameTaskTimes(this._budget.now()-Q)};X._startFrameTaskTimes=function(){for(const Q of Object.keys(r.TaskPriority))this._frameTaskTimes.set(r.TaskPriority[Q],0)};X._recordFrameTaskTimes=
function(Q){this._frameTaskTimes.forEach((M,V)=>this.performanceInfo.tasks.get(V).record(M));this.performanceInfo.total.record(Q)};t._createClass(Z,[{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return w.isNone(this._test.state)?this._state:this._test.state},set:function(Q){this._state!==Q&&(this._state=Q,this.state!==r.State.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(M=>
M.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return Z}(C);F.__decorate([p.property()],D.prototype,"updating",void 0);F.__decorate([p.property()],D.prototype,"nowFunc",void 0);D=F.__decorate([b.subclass("esri.views.support.Scheduler")],D);K.Scheduler=D;let I=function(R){function Z(Q,M,V,fa){var oa=R.call(this,{})||this;oa._scheduler=Q;oa.name=M;oa._basePriority=fa;oa.runtime=0;oa._queue=new f.PromiseQueue;oa._handles=new v;oa.schedulePriority=oa._basePriority;oa.task=w.isSome(V)?
V:oa._queue;oa._handles.add(k.when(()=>oa.task.running,()=>Q.activate()));return oa}t._inheritsLoose(Z,R);var X=Z.prototype;X.normalizeCtorArgs=function(){return{}};X.remove=function(){this.processQueue(J);this._scheduler.removeTask(this);this.schedule=P.schedule;this.reschedule=P.reschedule;this._handles.destroy()};X.setPriority=function(Q){this.name=Q;Q=g(Q);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=Q;this._basePriority=Q};X.schedule=function(Q,M,V){return this._queue.push(Q,
M,V)};X.reschedule=function(Q,M,V){return this._queue.unshift(Q,M,V)};X.processQueue=function(Q){this._queue.runTask(Q)};t._createClass(Z,[{key:"updating",get:function(){return this._queue.running}},{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(Q){this.setPriority(Q)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return Z}(C);F.__decorate([p.property({constructOnly:!0})],I.prototype,"task",
void 0);F.__decorate([p.property({readOnly:!0})],I.prototype,"updating",null);I=F.__decorate([b.subclass("esri.views.support.SchedulerTask")],I);let L=function(){function R(X){this.now=X;this._budget=this._begin=0;this._state=r.State.IDLE;this._didWork=!1;this._enabled=!0}var Z=R.prototype;Z.run=function(X){if(this.done)return!1;!0===X()&&(this._didWork=!0);return!0};Z.madeProgress=function(){this._didWork=!0};Z.reset=function(X,Q){this._begin=this.now();this._budget=X;this._state=Q;this._didWork=
!1};Z.resetProgress=function(){this._didWork=!1};t._createClass(R,[{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(X){this._enabled=X}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"hasProgressed",
get:function(){return this._didWork}}]);return R}();K.Budget=L})(H||(H={}));r.TaskState=void 0;(function(K){K.SCHEDULED="s";K.READY="r";K.WAITING="w";K.IDLE="i"})(r.TaskState||(r.TaskState={}));const J=(()=>{const K=new H.Budget(()=>performance.now());K.enabled=!1;return K})(),P=new (function(){function K(){}var D=K.prototype;D.remove=function(){};D.processQueue=function(){};D.schedule=function(I,L,R){try{if(h.isAborted(L)){const Z=h.createAbortError();return R?Promise.resolve(R(Z)):Promise.reject(Z)}return h.when(I(J))}catch(Z){return Promise.reject(Z)}};
D.reschedule=function(I,L,R){return this.schedule(I,L,R)};return K}()),O=Number.MAX_SAFE_INTEGER;r.ImmediateTask=P;r.getTaskPriority=g;r.newScheduler=function(K){return new H.Scheduler({nowFunc:K})};r.noBudget=J;r.taskPriorities=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/PromiseQueue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h){r.PromiseQueue=function(n){function p(){var d=n.apply(this,arguments)||this;d._tasks=[];d.running=!1;return d}t._inheritsLoose(p,n);var c=p.prototype;c.destroy=function(){this.cancelAll()};c.runTask=function(d){for(;!d.done&&this._process(d);)d.madeProgress()};c.push=function(d,a,b){this.running=!0;return new Promise((f,m)=>this._tasks.push(new k(f,m,d,a,b)))};c.unshift=function(d,a,b){this.running=!0;return new Promise((f,m)=>this._tasks.unshift(new k(f,m,d,a,b)))};
c._process=function(d){if(0===this._tasks.length)return!1;const a=this._tasks.shift();try{const b=v.isAborted(a.signal);if(b&&!a.abortCallback)a.reject(v.createAbortError());else{const f=b?a.abortCallback(v.createAbortError()):a.callback(d);v.isPromiseLike(f)?f.then(a.resolve,a.reject):a.resolve(f)}}catch(b){a.reject(b)}this.running=0<this._tasks.length;return!0};c.cancelAll=function(){const d=v.createAbortError();for(const a of this._tasks)if(a.abortCallback){const b=a.abortCallback(d);a.resolve(b)}else a.reject(d);
this._tasks.length=0;this.running=!1};t._createClass(p,[{key:"length",get:function(){return this._tasks.length}}]);return p}(C);F.__decorate([A.property()],r.PromiseQueue.prototype,"running",void 0);r.PromiseQueue=F.__decorate([h.subclass("esri.layers.support.PromiseQueue")],r.PromiseQueue);let k=function(n,p,c,d,a){this.resolve=n;this.reject=p;this.callback=c;this.signal=d;this.abortCallback=a};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l){F=function(e){function h(){var k=e.apply(this,arguments)||this;k.SCHEDULER_LOG_SLOW_TASKS=!1;k.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return k}r._inheritsLoose(h,e);return h}(F);t.__decorate([C.property()],F.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);t.__decorate([C.property()],F.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);F=t.__decorate([l.subclass("esri.views.support.DebugFlags")],F);return new F})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),
function(r,t,F,C,v,A,w,l,e,h){const k={getObjectId(n){return n.getObjectId()},getAttributes(n){return n.readAttributes()},getAttribute(n,p){return n.readAttribute(p)},cloneWithGeometry(n,p){return n},getGeometry(n){return n.readHydratedGeometry()},getCentroid(n,p){return n.readCentroid()}};v=function(n){function p(d,a,b){var f=n.call(this,d,a)||this;f.featureAdapter=k;f.events=new C;f._featureSetsByInstance=new Map;f._objectIdToDisplayId=new Map;f._spatialIndexInvalid=!0;f._indexSearchCache=new F(50);
f._index=w.rbush(9,m=>({minX:f._storage.getXMin(m),minY:f._storage.getYMin(m),maxX:f._storage.getXMax(m),maxY:f._storage.getYMax(m)}));f._storage=a;f.mode=b;return f}t._inheritsLoose(p,n);var c=p.prototype;c.hasInstance=function(d){return this._featureSetsByInstance.has(d)};c.onTileData=function(d,a){if(A.isNone(a.addOrUpdate))return a;a.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var b=a.addOrUpdate.getCursor();b.next();){const f=b.getDisplayId();this.setComputedAttributes(this._storage,
b,f,d.scale)}return a}this._featureSetsByInstance.set(a.addOrUpdate.instance,a.addOrUpdate);for(b=a.addOrUpdate.getCursor();b.next();)this._insertFeature(b,d.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return a};c.search=function(d){this._rebuildIndex();const a=d.id;var b=this._indexSearchCache.find(g=>g.tileId===a);if(A.isSome(b))return b.readers;b=new Map;d=this._searchIndex(d.bounds);const f=[];for(const g of d){var m=this._storage.getInstanceId(g);d=(4294901760&m)>>>16;m&=
65535;b.has(d)||b.set(d,[]);b.get(d).push(m)}b.forEach((g,x)=>{x=this._featureSetsByInstance.get(x);f.push(h.FeatureSetReaderIndirect.from(x,g))});this._indexSearchCache.enqueue({tileId:a,readers:f});return f};c.insert=function(d){const a=d.getCursor(),b=this._storage;for(;a.next();){var f,m=a.getIndex();m|=a.instance<<16;const g=a.getObjectId(),x=null!=(f=this._objectIdToDisplayId.get(g))?f:this._storage.createDisplayId();a.setDisplayId(x);b.setInstanceId(x,m);this._objectIdToDisplayId.set(g,x)}this._featureSetsByInstance.set(d.instance,
d);this._spatialIndexInvalid=!0};c.remove=function(d){const a=this._objectIdToDisplayId.get(d);if(a){var b=this._storage.getInstanceId(a),f=65535&b;b=(4294901760&b)>>>16;var m=this._featureSetsByInstance.get(b);this._objectIdToDisplayId.delete(d);this._storage.releaseDisplayId(a);m.removeAtIndex(f);m.isEmpty&&this._featureSetsByInstance.delete(b);this._spatialIndexInvalid=!0}};c.forEach=function(d){this._objectIdToDisplayId.forEach(a=>{a=this._storage.getInstanceId(a);a=this._lookupFeature(a);d(a)})};
c.forEachUnsafe=function(d){this._objectIdToDisplayId.forEach(a=>{var b=this._storage.getInstanceId(a);a=65535&b;b=this._getFeatureSet((4294901760&b)>>>16);b.setIndex(a);d(b)})};c.forEachInBounds=function(d,a){d=this._searchIndex(d);for(const b of d)d=this.lookupFeatureByDisplayId(b,this._storage),a(A.unwrap(d))};c.forEachBounds=function(d,a,b){this._rebuildIndex();const f=[0,0,0,0];for(const m of d)m.readGeometry()&&(d=m.getDisplayId(),f[0]=this._storage.getXMin(d),f[1]=this._storage.getYMin(d),
f[2]=this._storage.getXMax(d),f[3]=this._storage.getYMax(d),a(l.fromRect(b,f)))};c.sweepFeatures=function(d,a,b){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((f,m)=>{d.has(f)||(a.releaseDisplayId(f),b&&b.unsetAttributeData(f),this._objectIdToDisplayId.delete(m))});this.events.emit("changed")};c.sweepFeatureSets=function(d){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((a,b)=>{d.has(b)||this._featureSetsByInstance.delete(b)})};c.lookupObjectId=function(d,a){d=this.lookupFeatureByDisplayId(d,
a);return A.isNone(d)?null:d.getObjectId()};c.lookupDisplayId=function(d){return this._objectIdToDisplayId.get(d)};c.lookupFeatureByDisplayId=function(d,a){d=a.getInstanceId(d);return this._lookupFeature(d)};c.lookupByDisplayIdUnsafe=function(d){var a=this._storage.getInstanceId(d);d=65535&a;a=this._getFeatureSet((4294901760&a)>>>16);if(!a)return null;a.setIndex(d);return a};c._insertFeature=function(d,a){const b=this._storage,f=d.getObjectId();var m=d.getIndex();m|=d.instance<<16;b.getInstanceId(d.getDisplayId());
let g=this._objectIdToDisplayId.get(f);g||(g=b.createDisplayId(),this._objectIdToDisplayId.set(f,g),this._spatialIndexInvalid=!0);d.setDisplayId(g);b.setInstanceId(g,m);this.setComputedAttributes(b,d,g,a)};c._searchIndex=function(d){this._rebuildIndex();return this._index.search({minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]})};c._rebuildIndex=function(){if(this._spatialIndexInvalid){var d=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(a=>{for(a=a.getCursor();a.next();){const b=a.getDisplayId();
this._storage.setBounds(b,a)&&d.push(b)}}):this._objectIdToDisplayId.forEach(a=>{const b=this._storage.getInstanceId(a);this._storage.setBounds(a,this._lookupFeature(b))&&d.push(a)});this._index.clear();this._index.load(d);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};c._lookupFeature=function(d){const a=65535&d;d=this._getFeatureSet((4294901760&d)>>>16);if(!d)return null;d=d.getCursor();d.setIndex(a);return d};c._getFeatureSet=function(d){return this._featureSetsByInstance.get(d)};
t._createClass(p,[{key:"storage",get:function(){return this._storage}},{key:"storeStatistics",get:function(){let d=0,a=0,b=0;this.forEach(f=>{if(f=f.readGeometry())a+=f.isPoint?1:f.lengths.reduce((m,g)=>m+g,0),b+=f.isPoint?1:f.lengths.length,d+=1});return{featureCount:d,vertexCount:a,ringCount:b}}}]);return p}(e.Store2D);r.FeatureStore2D=v;r.featureAdapter=k;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],
function(r,t){return function(){function F(v){this._start=this.size=0;this.maxSize=v;this._buffer=Array(v)}var C=F.prototype;C.enqueue=function(v){if(this.size===this.maxSize){const A=this._buffer[this._start];this._buffer[this._start]=v;this._start=(this._start+1)%this.maxSize;return A}this._buffer[(this._start+this.size++)%this.maxSize]=v;return null};C.dequeue=function(){if(0===this.size)return null;const v=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+
1)%this.maxSize;return v};C.peek=function(){return 0===this.size?null:this._buffer[this._start]};C.find=function(v){if(0===this.size)return null;for(const A of this._buffer)if(t.isSome(A)&&v(A))return A;return null};C.clear=function(v){let A=this.dequeue();for(;t.isSome(A);)v&&v(A),A=this.dequeue()};r._createClass(F,[{key:"entries",get:function(){return this._buffer}}]);return F}()})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(r,t){function F(d,a){if(!(this instanceof
F))return new F(d,a);this._maxEntries=Math.max(4,d||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));a&&("function"===typeof a?this.toBBox=a:this._initFormat(a));this.clear()}function C(d,a){v(d,0,d.children.length,a,d)}function v(d,a,b,f,m){m||(m=p(null));m.minX=Infinity;m.minY=Infinity;m.maxX=-Infinity;m.maxY=-Infinity;for(var g;a<b;a++)g=d.children[a],A(m,d.leaf?f(g):g);return m}function A(d,a){d.minX=Math.min(d.minX,a.minX);d.minY=Math.min(d.minY,a.minY);d.maxX=Math.max(d.maxX,a.maxX);
d.maxY=Math.max(d.maxY,a.maxY);return d}function w(d,a){return d.minX-a.minX}function l(d,a){return d.minY-a.minY}function e(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function h(d){return d.maxX-d.minX+(d.maxY-d.minY)}function k(d,a){return d.minX<=a.minX&&d.minY<=a.minY&&a.maxX<=d.maxX&&a.maxY<=d.maxY}function n(d,a){return a.minX<=d.maxX&&a.minY<=d.maxY&&a.maxX>=d.minX&&a.maxY>=d.minY}function p(d){return{children:d,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function c(d,
a,b,f,m){for(var g=[a,b],x;g.length;)b=g.pop(),a=g.pop(),b-a<=f||(x=a+Math.ceil((b-a)/f/2)*f,t.quickselect(d,x,a,b,m),g.push(a,x,x,b))}F.prototype={all:function(){return this._all(this.data,[])},search:function(d){var a=this.data,b=[],f=this.toBBox;if(!n(d,a))return b;for(var m=[],g,x,q,B;a;){g=0;for(x=a.children.length;g<x;g++)q=a.children[g],B=a.leaf?f(q):q,n(d,B)&&(a.leaf?b.push(q):k(d,B)?this._all(q,b):m.push(q));a=m.pop()}return b},collides:function(d){var a=this.data,b=this.toBBox;if(!n(d,a))return!1;
for(var f=[],m,g,x,q;a;){m=0;for(g=a.children.length;m<g;m++)if(x=a.children[m],q=a.leaf?b(x):x,n(d,q)){if(a.leaf||k(d,q))return!0;f.push(x)}a=f.pop()}return!1},load:function(d){if(!d||!d.length)return this;if(d.length<this._minEntries){for(var a=0,b=d.length;a<b;a++)this.insert(d[a]);return this}d=this._build(d.slice(),0,d.length-1,0);this.data.children.length?this.data.height===d.height?this._splitRoot(this.data,d):(this.data.height<d.height&&(a=this.data,this.data=d,d=a),this._insert(d,this.data.height-
d.height-1,!0)):this.data=d;return this},insert:function(d){d&&this._insert(d,this.data.height-1);return this},clear:function(){this.data=p([]);return this},remove:function(d,a){if(!d)return this;for(var b=this.data,f=this.toBBox(d),m=[],g=[],x,q,B,z;b||m.length;){b||(b=m.pop(),q=m[m.length-1],x=g.pop(),z=!0);if(b.leaf){a:{B=d;var u=b.children,y=a;if(y){for(var E=0;E<u.length;E++)if(y(B,u[E])){B=E;break a}B=-1}else B=u.indexOf(B)}if(-1!==B){b.children.splice(B,1);m.push(b);this._condense(m);break}}z||
b.leaf||!k(b,f)?q?(x++,b=q.children[x],z=!1):b=null:(m.push(b),g.push(x),x=0,q=b,b=b.children[0])}return this},toBBox:function(d){return d},compareMinX:w,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(d){this.data=d;return this},_all:function(d,a){for(var b=[];d;)d.leaf?a.push.apply(a,d.children):b.push.apply(b,d.children),d=b.pop();return a},_build:function(d,a,b,f){var m=b-a+1,g=this._maxEntries;if(m<=g){var x=p(d.slice(a,b+1));C(x,this.toBBox);return x}f||(f=Math.ceil(Math.log(m)/
Math.log(g)),g=Math.ceil(m/Math.pow(g,f-1)));x=p([]);x.leaf=!1;x.height=f;m=Math.ceil(m/g);g=m*Math.ceil(Math.sqrt(g));var q;for(c(d,a,b,g,this.compareMinX);a<=b;a+=g){var B=Math.min(a+g-1,b);c(d,a,B,m,this.compareMinY);for(q=a;q<=B;q+=m){var z=Math.min(q+m-1,B);x.children.push(this._build(d,q,z,f-1))}}C(x,this.toBBox);return x},_chooseSubtree:function(d,a,b,f){for(var m,g,x,q,B,z,u,y;;){f.push(a);if(a.leaf||f.length-1===b)break;u=y=Infinity;m=0;for(g=a.children.length;m<g;m++)x=a.children[m],B=e(x),
z=(Math.max(x.maxX,d.maxX)-Math.min(x.minX,d.minX))*(Math.max(x.maxY,d.maxY)-Math.min(x.minY,d.minY))-B,z<y?(y=z,u=B<u?B:u,q=x):z===y&&B<u&&(u=B,q=x);a=q||a.children[0]}return a},_insert:function(d,a,b){var f=this.toBBox;b=b?d:f(d);f=[];var m=this._chooseSubtree(b,this.data,a,f);m.children.push(d);for(A(m,b);0<=a;)if(f[a].children.length>this._maxEntries)this._split(f,a),a--;else break;this._adjustParentBBoxes(b,f,a)},_split:function(d,a){var b=d[a],f=b.children.length,m=this._minEntries;this._chooseSplitAxis(b,
m,f);f=this._chooseSplitIndex(b,m,f);f=p(b.children.splice(f,b.children.length-f));f.height=b.height;f.leaf=b.leaf;C(b,this.toBBox);C(f,this.toBBox);a?d[a-1].children.push(f):this._splitRoot(b,f)},_splitRoot:function(d,a){this.data=p([d,a]);this.data.height=d.height+1;this.data.leaf=!1;C(this.data,this.toBBox)},_chooseSplitIndex:function(d,a,b){var f,m;var g=m=Infinity;for(f=a;f<=b-a;f++){var x=v(d,0,f,this.toBBox);var q=v(d,f,b,this.toBBox);var B=Math.max(0,Math.min(x.maxX,q.maxX)-Math.max(x.minX,
q.minX))*Math.max(0,Math.min(x.maxY,q.maxY)-Math.max(x.minY,q.minY));x=e(x)+e(q);if(B<g){g=B;var z=f;m=x<m?x:m}else B===g&&x<m&&(m=x,z=f)}return z},_chooseSplitAxis:function(d,a,b){var f=d.leaf?this.compareMinX:w,m=d.leaf?this.compareMinY:l,g=this._allDistMargin(d,a,b,f);a=this._allDistMargin(d,a,b,m);g<a&&d.children.sort(f)},_allDistMargin:function(d,a,b,f){d.children.sort(f);f=this.toBBox;var m=v(d,0,a,f),g=v(d,b-a,b,f),x=h(m)+h(g),q;for(q=a;q<b-a;q++){var B=d.children[q];A(m,d.leaf?f(B):B);x+=
h(m)}for(q=b-a-1;q>=a;q--)B=d.children[q],A(g,d.leaf?f(B):B),x+=h(g);return x},_adjustParentBBoxes:function(d,a,b){for(;0<=b;b--)A(a[b],d)},_condense:function(d){for(var a=d.length-1,b;0<=a;a--)0===d[a].children.length?0<a?(b=d[a-1].children,b.splice(b.indexOf(d[a]),1)):this.clear():C(d[a],this.toBBox)},_initFormat:function(d){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(d[0]));this.compareMinY=new Function("a","b",a.join(d[1]));this.toBBox=new Function("a","return {minX: a"+
d[0]+", minY: a"+d[1]+", maxX: a"+d[2]+", maxY: a"+d[3]+"};")}};r.rbush=F})},"esri/chunks/quickselect":function(){define(["exports"],function(r){var t={exports:{}};(function(F){(function(C){C=C();void 0!==C&&(F.exports=C)})(function(){function C(w,l,e,h,k){for(;h>e;){if(600<h-e){var n=h-e+1,p=l-e+1,c=Math.log(n),d=.5*Math.exp(2*c/3);c=.5*Math.sqrt(c*d*(n-d)/n)*(0>p-n/2?-1:1);C(w,l,Math.max(e,Math.floor(l-p*d/n+c)),Math.min(h,Math.floor(l+(n-p)*d/n+c)),k)}n=w[l];p=e;d=h;v(w,e,l);for(0<k(w[h],n)&&v(w,
e,h);p<d;){v(w,p,d);p++;for(d--;0>k(w[p],n);)p++;for(;0<k(w[d],n);)d--}0===k(w[e],n)?v(w,e,d):(d++,v(w,d,h));d<=l&&(e=d+1);l<=d&&(h=d-1)}}function v(w,l,e){var h=w[l];w[l]=w[e];w[e]=h}function A(w,l){return w<l?-1:w>l?1:0}return function(w,l,e,h,k){C(w,l,e||0,h||w.length-1,k||A)}})})(t);r.quickselect=t.exports})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),
function(r,t,F,C,v,A,w,l){const e=new Promise((k,n)=>r(["../../../../layers/support/labelFormatUtils"],k,n));let h=function(){function k(p,c){this._canCacheExpressionValue=!1;this._sourceInfo=p;this._bitsets={computed:c.getBitset(c.createBitset())}}var n=k.prototype;n.invalidate=function(){this._bitsets.computed.clear()};n.updateSchema=function(){var p=F._asyncToGenerator(function*(c,d){var a=A.diff(this._schema,d);if((this._schema=d)&&!v.isNone(a)&&A.hasDiff(a,"attributes")){C("esri-2d-update-debug")&&
console.debug("Applying Update - Store:",a);this._bitsets.computed.clear();c.targets[d.name]=!0;c=d.attributes;d=[];a=[];for(const b in c){const f=c[b];switch(f.type){case "expression":d.push(this._createArcadeComputedField(f));break;case "label-expression":d.push(this._createLabelArcadeComputedField(f));break;case "statistic":a.push(f)}}this._computedFields=yield Promise.all(d);this._canCacheExpressionValue=!this._computedFields.some(b=>"expression"===b.type&&b.expression.referencesScale());this._statisticFields=
a}});return function(c,d){return p.apply(this,arguments)}}();n.setComputedAttributes=function(p,c,d,a){var b=this._bitsets.computed;if(!this._canCacheExpressionValue||!b.has(d)){b.set(d);for(const f of this._computedFields)switch(b=this._evaluateField(c,f,a),f.resultType){case "numeric":p.setComputedNumericAtIndex(d,f.fieldIndex,b);break;case "string":p.setComputedStringAtIndex(d,f.fieldIndex,b)}}};n._createArcadeComputedField=function(){var p=F._asyncToGenerator(function*(c){return{...c,expression:yield w.createRendererExpression(c.valueExpression,
this._sourceInfo.spatialReference,this._sourceInfo.fieldsIndex)}});return function(c){return p.apply(this,arguments)}}();n._createLabelArcadeComputedField=function(){var p=F._asyncToGenerator(function*(c){var d=this._sourceInfo.spatialReference;const a=this._sourceInfo.fieldsIndex,{createLabelFunction:b}=yield e;d=yield b(c.label,a,d);return{...c,builder:d}});return function(c){return p.apply(this,arguments)}}();n._evaluateField=function(p,c,d){switch(c.type){case "label-expression":return p=p.readArcadeFeature(),
c.builder.evaluate(p)||"";case "expression":return{expression:c}=c,l(c,p,{$view:{scale:d}})}};return k}();t.Store2D=h;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(r,t,F,C,v){function A(c){return c instanceof F?Object.keys(c.items):c instanceof t?v.getProperties(c).keys():c?Object.keys(c):[]}function w(c,d){return c instanceof F?c.items[d]:c[d]}function l(c,d){return Array.isArray(c)&&
Array.isArray(d)?c.length!==d.length:!1}function e(c){return c?c.declaredClass:null}function h(c,d){const a=c.diff;if(a&&"function"===typeof a)return a(c,d);const b=A(c),f=A(d);if(0!==b.length||0!==f.length){if(!b.length||!f.length||l(c,d))return{type:"complete",oldValue:c,newValue:d};var m=f.filter(q=>-1===b.indexOf(q)),g=b.filter(q=>-1===f.indexOf(q));g=b.filter(q=>-1<f.indexOf(q)&&w(c,q)!==w(d,q)).concat(m,g).sort();if((m=e(c))&&-1<p.indexOf(m)&&g.length)return{type:"complete",oldValue:c,newValue:d};
var x;m=c instanceof t&&d instanceof t;for(const q of g){g=w(c,q);const B=w(d,q);!(m||"function"!==typeof g&&"function"!==typeof B)||g===B||null==g&&null==B||(g=a&&a[q]&&"function"===typeof a[q]?a[q](g,B):"object"===typeof g&&"object"===typeof B&&e(g)===e(B)?h(g,B):{type:"complete",oldValue:g,newValue:B},C.isSome(g)&&(C.isSome(x)?x.diff[q]=g:x={type:"partial",diff:{[q]:g}}))}return x}}function k(c,d){if(C.isNone(c))return!1;d=d.split(".");for(const a of d){if("complete"===c.type)break;if("partial"===
c.type){if(c=c.diff[a],!c)return!1}else return!1}return!0}function n(c){if(C.isNone(c))return!0;switch(c.type){case "complete":return!1;case "collection":for(const d of c.added)if(!n(d))return!1;for(const d of c.removed)if(!n(d))return!1;for(const d of c.changed)if(!n(d))return!1;return!0;case "partial":for(const d in c.diff)if(!n(c.diff[d]))return!1;return!0}}const p=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];
r.diff=function(c,d){if(!("function"===typeof c||"function"===typeof d||C.isNone(c)&&C.isNone(d)))return C.isNone(c)||C.isNone(d)||"object"===typeof c&&"object"===typeof d&&e(c)!==e(d)?{type:"complete",oldValue:c,newValue:d}:h(c,d)};r.hasDiff=k;r.hasDiffAny=function(c,d){for(const a of d)if(k(c,a))return!0;return!1};r.isEmpty=n;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger"],function(r){return function(t,
F,C){t.referencesGeometry();F=F.readArcadeFeature();try{return t.evaluate({...C,$feature:F})}catch(v){return r.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",v),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(r,t,F){let C=function(v){function A(l,e){var h=v.call(this,F.FeatureSetReader.createInstance(),l.fullSchema())||
this;h._currentIndex=-1;h._reader=l;h._indices=e;return h}t._inheritsLoose(A,v);A.from=function(l,e){return new A(l.copy(),e)};var w=A.prototype;w.getSize=function(){return this._indices.length};w.getCursor=function(){return this.copy()};w.copy=function(){const l=new A(this._reader.copy(),this._indices);l._currentIndex=this._currentIndex;return l};w.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};w._nextIndex=function(){return++this._currentIndex<
this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),!0):!1};w.setArcadeSpatialReference=function(l){this._reader.setArcadeSpatialReference(l)};w.attachStorage=function(l){this._reader.attachStorage(l)};w.getStorage=function(){return this._reader.getStorage()};w.getComputedNumeric=function(l){return this._reader.getComputedNumericAtIndex(0)};w.setComputedNumeric=function(l,e){return this._reader.setComputedNumericAtIndex(e,0)};w.getComputedString=function(l){return this._reader.getComputedStringAtIndex(0)};
w.setComputedString=function(l,e){return this._reader.setComputedStringAtIndex(0,e)};w.getComputedNumericAtIndex=function(l){return this._reader.getComputedNumericAtIndex(l)};w.setComputedNumericAtIndex=function(l,e){this._reader.setComputedNumericAtIndex(l,e)};w.getComputedStringAtIndex=function(l){return this._reader.getComputedStringAtIndex(l)};w.setComputedStringAtIndex=function(l,e){return this._reader.setComputedStringAtIndex(l,e)};w.transform=function(l,e,h,k){const n=this.copy();n._reader=
this._reader.transform(l,e,h,k);return n};w.readAttribute=function(l,e=!1){return this._reader.readAttribute(l,e)};w.readAttributes=function(){return this._reader.readAttributes()};w.joinAttributes=function(l){return this._reader.joinAttributes(l)};w.readArcadeFeature=function(){return this._reader.readArcadeFeature()};w.geometry=function(){return this._reader.geometry()};w.field=function(l){return this.readAttribute(l,!0)};w.hasField=function(l){return this._reader.hasField(l)};w.setField=function(l,
e){return this._reader.setField(l,e)};w.keys=function(){return this._reader.keys()};w.castToText=function(){return this._reader.castToText()};w.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};w.getFieldNames=function(){return this._reader.getFieldNames()};w.getAttributeHash=function(){return this._reader.getAttributeHash()};w.getObjectId=function(){return this._reader.getObjectId()};w.getDisplayId=function(){return this._reader.getDisplayId()};w.setDisplayId=function(l){return this._reader.setDisplayId(l)};
w.getGroupId=function(){return this._reader.getGroupId()};w.setGroupId=function(l){return this._reader.setGroupId(l)};w.getXHydrated=function(){return this._reader.getXHydrated()};w.getYHydrated=function(){return this._reader.getYHydrated()};w.getX=function(){return this._reader.getX()};w.getY=function(){return this._reader.getY()};w.setIndex=function(l){return this._reader.setIndex(l)};w.getIndex=function(){return this._reader.getIndex()};w.readLegacyFeature=function(){return this._reader.readLegacyFeature()};
w.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};w.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};w.readLegacyGeometry=function(){return this._reader.readLegacyGeometry()};w.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};w.readGeometryArea=function(){return this._reader.readGeometryArea()};w.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};w.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};
w.readGeometry=function(){return this._reader.readGeometry()};w.readCentroid=function(){return this._reader.readCentroid()};w._readAttribute=function(l,e){throw Error("Error: Should not be called. Underlying _reader should be used instead");};w._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");};t._createClass(A,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},
{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}}]);return A}(F.FeatureSetReader);r.FeatureSetReaderIndirect=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k,n,p;let c=0;F=null!=(k=C("featurelayer-simplify-thresholds"))?k:[.5,.5,.5,.5];const d=F[0],a=F[1],b=F[2],f=F[3];k=null!=(n=C("featurelayer-simplify-payload-size-factors"))?n:[1,2,4];const m=k[0],g=k[1],x=k[2],q=null!=(p=C("featurelayer-simplify-mobile-factor"))?p:2,B=C("esri-mobile");C=function(){function z(y,E){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=
null;this._joined=[];this._objectIdToIndex=null;this._level=0;this.instance=y;this._layerSchema=E}z.createInstance=function(){c++;return c=65535<c?0:c};var u=z.prototype;u.getAreaSimplificationThreshold=function(y,E){let H=1;const J=B?q:1;4E6<E?H=x*J:1E6<E?H=g*J:5E5<E?H=m*J:1E5<E&&(H=J);E=0;4E3<y?E=f*H:2E3<y?E=b*H:100<y?E=a:15<y&&(E=d);y=8;4>this._level?y=1:5>this._level?y=2:6>this._level&&(y=4);return E*y};u.setArcadeSpatialReference=function(y){this._arcadeSpatialReference=y};u.attachStorage=function(y){this._storage=
y};u.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};u.getStorage=function(){return this._storage};u.getComputedNumeric=function(y){return this.getComputedNumericAtIndex(0)};u.setComputedNumeric=function(y,E){return this.setComputedNumericAtIndex(E,0)};u.getComputedString=function(y){return this.getComputedStringAtIndex(0)};u.setComputedString=function(y,E){return this.setComputedStringAtIndex(0,E)};u.getComputedNumericAtIndex=function(y){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
y)};u.setComputedNumericAtIndex=function(y,E){this._storage.setComputedNumericAtIndex(this.getDisplayId(),y,E)};u.getComputedStringAtIndex=function(y){return this._storage.getComputedStringAtIndex(this.getDisplayId(),y)};u.setComputedStringAtIndex=function(y,E){return this._storage.setComputedStringAtIndex(this.getDisplayId(),y,E)};u.transform=function(y,E,H,J){const P=this.copy();P._tx+=y;P._ty+=E;P._sx*=H;P._sy*=J;return P};u.readAttribute=function(y,E=!1){var H=this._readAttribute(y,E);if(void 0!==
H)return H;for(const J of this._joined)if(J.setIndex(this.getIndex()),H=J._readAttribute(y,E),void 0!==H)return H};u.readAttributes=function(){const y=this._readAttributes();for(const E of this._joined){E.setIndex(this.getIndex());const H=E._readAttributes();for(const J of Object.keys(H))y[J]=H[J]}return y};u.joinAttributes=function(y){this._joined.push(y)};u.readArcadeFeature=function(){return this};u.geometry=function(){var y=this.readHydratedGeometry();y=w.convertToGeometry(y,this.geometryType,
this.hasZ,this.hasM);if(y=h.fromJSON(y))y.spatialReference=this._arcadeSpatialReference;return y};u.field=function(y){if(this.hasField(y))return this.readAttribute(y,!0);for(const E of this._joined)if(E.setIndex(this.getIndex()),E.hasField(y))return E._readAttribute(y,!0);throw Error(`Field ${y} does not exist`);};u.setField=function(y,E){throw Error("Unable to update feature attribute values, feature is readonly");};u.keys=function(){return this.getFieldNames()};u.castToText=function(){return JSON.stringify(this.readLegacyFeature())};
u.gdbVersion=function(){return null};u.fullSchema=function(){return this._layerSchema};u.castAsJson=function(y=null){return{attributes:this._readAttributes(),geometry:!0===(null==y?void 0:y.keepGeometryType)?this.geometry():this.geometry().toJSON()}};u.castAsJsonAsync=function(y,E=null){return Promise.resolve(this.castAsJson(E))};u.removeIds=function(y){if(v.isNone(this._objectIdToIndex)){var E=new Map;const H=this.getCursor();for(;H.next();)E.set(H.getObjectId(),H.getIndex());this._objectIdToIndex=
E}E=this._objectIdToIndex;for(const H of y)E.has(H)&&this.removeAtIndex(E.get(H))};u.removeAtIndex=function(y){v.isNone(this._deleted)&&(this._deleted=e.StaticBitSet.create(this.getSize()));this._deleted.set(y)};u.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};u.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};u.features=function*(){const y=this.getCursor();for(;y.next();)yield y.readOptimizedFeature()};u._getExists=function(){return v.isNone(this._deleted)||
!this._deleted.has(this.getIndex())};u._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const y=this.readUnquantizedGeometry();if(!y||y.hasIndeterminateRingOrder)return null;const E=v.unwrapOr(this.getQuantizationTransform(),null);return A.getCentroidOptimizedGeometry(new l,y,this.hasM,this.hasZ,E)};u.copyInto=function(y){y.seen=this.seen;y._storage=this._storage;y._arcadeSpatialReference=this._arcadeSpatialReference;y._joined=this._joined;y._tx=this._tx;y._ty=
this._ty;y._sx=this._sx;y._sy=this._sy;y._deleted=this._deleted;y._objectIdToIndex=this._objectIdToIndex};t._createClass(z,[{key:"isEmpty",get:function(){return v.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(y){this._level=y}}]);return z}();r.FeatureSetReader=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(r){let t=function(){function F(v,A){this._mask=
0;this._buf=v;this._mask=A}F.fromBuffer=function(v,A){return new F(v,A)};F.create=function(v,A=4294967295){v=new Uint32Array(Math.ceil(v/32));return new F(v,A)};var C=F.prototype;C._getIndex=function(v){return Math.floor(v/32)};C.has=function(v){v&=this._mask;return!!(this._buf[this._getIndex(v)]&1<<v%32)};C.hasRange=function(v,A){for(;v%32&&v!==A;){if(this.has(v))return!0;v++}for(;A%32&&v!==A;){if(this.has(v))return!0;A--}if(v===A)return!1;for(v/=32;v!==A/32;v++)if(this._buf[v])return!0;return!1};
C.set=function(v){v&=this._mask;const A=this._getIndex(v);this._buf[A]|=1<<v%32};C.setRange=function(v,A){for(;v%32&&v!==A;)this.set(v++);for(;A%32&&v!==A;)this.set(A--);if(v!==A)for(v/=32;v!==A/32;v++)this._buf[v]=4294967295};C.unset=function(v){v&=this._mask;const A=this._getIndex(v);this._buf[A]&=4294967295^1<<v%32};C.resize=function(v){const A=this._buf;v=new Uint32Array(Math.ceil(v/32));v.set(A);this._buf=v};C.or=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]|=v._buf[A];return this};
C.and=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]&=v._buf[A];return this};C.xor=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]^=v._buf[A];return this};C.ior=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]|=~v._buf[A];return this};C.iand=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]&=~v._buf[A];return this};C.ixor=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]^=~v._buf[A];return this};C.any=function(){for(let v=0;v<this._buf.length;v++)if(this._buf[v])return!0;
return!1};C.copy=function(v){for(let A=0;A<this._buf.length;A++)this._buf[A]=v._buf[A];return this};C.clone=function(){return new F(this._buf.slice(),this._mask)};C.clear=function(){for(let v=0;v<this._buf.length;v++)this._buf[v]=0};C.forEachSet=function(v){for(let A=0;A<this._buf.length;A++){let w=this._buf[A],l=32*A;if(w)for(;w;)w&1&&v(l),w>>>=1,l++}};C.countSet=function(){let v=0;this.forEachSet(A=>{v++});return v};return F}();r.StaticBitSet=t;Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./GeoEventSource ./PagedFeatureSource ./SnapshotFeatureSource".split(" "),function(r,t,F,C,v,A,w){r.createSource=function(l,e,h,k,n,p){a:{switch(l.type){case "snapshot":l={type:"feature",origin:"snapshot",featureCount:t.unwrapOr(l.featureCount,0),serviceInfo:l,onMessage:k,outSR:e,tileInfoView:h,canAcceptRequest:n,store:p};break a;
case "stream":l={type:"geoevent",serviceInfo:l,onMessage:k,outSR:e,canAcceptRequest:n};break a;case "memory":case "on-demand":p=l.source;p=Array.isArray(p)?"local":"path"in p&&F.isHostedAgolService(p.path)?"hosted":"unknown";l={type:"feature",serviceInfo:l,onMessage:k,outSR:e,origin:p,tileInfoView:h,canAcceptRequest:n};break a}l=void 0}switch(l.type){case "feature":switch(l.origin){case "hosted":case "local":return new A.PagedFeatureSource(l);case "snapshot":return new w.SnapshotFeatureSource(l);
case "unknown":return new C.DrillDownFeatureSource(l)}case "geoevent":return new v.GeoEventSource(l)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/maybe","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(r,t,F,C){function v(p){p=F.urlToObject(p);p=p.path.match(h)||p.path.match(k);if(!p)return null;const [,c,d,a,b]=p;p=d.indexOf("/");return{title:w(-1!==p?d.slice(p+1):d),serverType:l[a.toLowerCase()],
sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:c}}}function A(p){return(p=F.urlToObject(p).path.match(n))?{serviceUrl:p[1],sublayerId:Number(p[2])}:null}function w(p){p=p.replace(/\s*[/_]+\s*/g," ");return p[0].toUpperCase()+p.slice(1)}const l={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},e=Object.values(l),h=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${e.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,
"i"),k=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${e.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),n=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;r.cleanTitle=w;r.isAGOLUrl=function(p){return p?(new F.Url(F.makeAbsolute(p))).authority.toLowerCase().includes("arcgis.com"):!1};r.isArcGISUrl=function(p){return!!h.test(p)};r.isHostedAgolService=function(p){if(!p)return!1;p=p.toLowerCase();const c=-1!==p.indexOf(".arcgis.com/");p=-1!==p.indexOf("//services")||-1!==p.indexOf("//tiles")||-1!==p.indexOf("//features");
return c&&p};r.isHostedSecuredProxyService=function(p,c){return c&&p&&-1!==p.toLowerCase().indexOf(c.toLowerCase())};r.isServerOrServicesAGOLUrl=function(p){if(!p)return!1;p=(new F.Url(F.makeAbsolute(p))).authority.toLowerCase();return"server.arcgisonline.com"===p||"services.arcgisonline.com"===p};r.isWmsServer=function(p){if(!p)return!1;var c=p.toLowerCase();p=-1!==c.indexOf("/services/");const d=-1!==c.indexOf("/mapserver/wmsserver"),a=-1!==c.indexOf("/imageserver/wmsserver");c=-1!==c.indexOf("/wmsserver");
return p&&(d||a||c)};r.parse=v;r.parseNonStandardSublayerUrl=A;r.sanitizeUrl=function(p,c){return p?F.removeTrailingSlash(F.removeQueryParameters(p,c)):p};r.sanitizeUrlWithLayerId=function(p){let {url:c}=p;if(!c)return{url:c};c=F.removeQueryParameters(c,p.logger);const d=F.urlToObject(c),a=v(d.path);let b;t.isSome(a)?(null!=a.sublayer&&null==p.layer.layerId&&(b=a.sublayer),c=a.url.path):p.nonStandardUrlAllowed&&(p=A(d.path),t.isSome(p)&&(c=p.serviceUrl,b=p.sublayerId));return{url:F.removeTrailingSlash(c),
layerId:b}};r.serverTypes=e;r.titleFromUrlAndName=function(p,c){const d=[];p&&(p=v(p),t.isSome(p)&&p.title&&d.push(p.title));c&&(c=w(c),d.push(c));if(2===d.length){if(-1!==d[0].toLowerCase().indexOf(d[1].toLowerCase()))return d[0];if(-1!==d[1].toLowerCase().indexOf(d[0].toLowerCase()))return d[1]}return d.join(" - ")};r.writeUrlWithLayerId=function(p,c,d,a,b){C.write(c,a,"url",b);a.url&&null!=p.layerId&&(a.url=F.join(a.url,d,p.layerId.toString()))};Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(r,t,F){function C(p,c){var d=c&&c.url&&c.url.path;p&&d&&(p=F.makeAbsolute(p,d,{preserveProtocolRelative:!0}),c.portalItem&&c.readResourcePaths&&(d=F.makeRelative(p,c.portalItem.itemUrl),k.test(d)&&c.readResourcePaths.push(c.portalItem.resourceFromPath(d).path)));return e(p,c&&c.portal)}function v(p,c,d=r.MarkKeep.YES){if(!p)return p;!F.isAbsolute(p)&&c&&c.blockedRelativeUrls&&c.blockedRelativeUrls.push(p);
var a=F.makeAbsolute(p);if(c){var b=c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.rootPath||c.url&&c.url.path;b&&(b=e(b,c.portal),a=F.makeRelative(e(a,c.portal),b,b),a!==p&&c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.writtenUrls.push(a))}p=a;a=(a=c&&c.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?F.changeDomain(p,`${a.urlKey}.${a.customBaseUrl}`,a.portalHostname):p;F.isAbsolute(a)&&(a=F.normalize(a));null!=c&&c.resources&&null!=c&&c.portalItem&&!F.isAbsolute(a)&&!F.isDataProtocol(a)&&
d===r.MarkKeep.YES&&c.resources.toKeep.push({resource:c.portalItem.resourceFromPath(a)});return a}function A(p,c,d){return C(p,d)}function w(p,c,d,a){p=v(p,a);void 0!==p&&(c[d]=p)}function l(p){p=t.isSome(p)?p.match(h):null;return t.isSome(p)?p[1]:null}function e(p,c){if(!c||c.isPortal||!c.urlKey||!c.customBaseUrl)return p;const d=`${c.urlKey}.${c.customBaseUrl}`,a=F.getAppUrl();return F.hasSameOrigin(a,`${a.scheme}://${d}`)?F.changeDomain(p,c.portalHostname,d):F.changeDomain(p,d,c.portalHostname)}
const h=/\/items\/([^\/]+)\/resources\//,k=/^\.\/resources\//;r.MarkKeep=void 0;(function(p){p[p.YES=0]="YES";p[p.NO=1]="NO"})(r.MarkKeep||(r.MarkKeep={}));const n=Object.freeze({__proto__:null,fromJSON:C,toJSON:v,read:A,write:w,itemIdFromResourceUrl:l,get MarkKeep(){return r.MarkKeep}});r.fromJSON=C;r.itemIdFromResourceUrl=l;r.persistableUrlUtils=n;r.read=A;r.toJSON=v;r.write=w})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],function(r,t,F,C,v){var A=(F=F("esri-mobile"))?1:4,w=F?1:3;v=function(l){function e(h){return l.call(this,h)||this}t._inheritsLoose(e,l);e.prototype._fetchDataTile=function(){var h=t._asyncToGenerator(function*(k){var n=this;const p=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,c=this._subscriptions.get(k.key.id),d=c.signal,a=k.getQuantizationParameters();let b=0;const f=function(){var m=t._asyncToGenerator(function*(g,
x){const q=n._queryInfo,B=n.createTileQuery(g,{maxRecordCountFactor:p?w:void 0,returnExceededLimitFeatures:!1,quantizationParameters:a});b++;try{const u=yield n._queue.push({tile:k,query:B,signal:d,depth:x});b--;C.throwIfAborted(d);if(u)if(q!==n._queryInfo)f(g,x);else if(u.exceededTransferLimit&&x<A)for(const y of g.createChildTiles())f(y,x+1);else{var z={id:k.id,addOrUpdate:u,end:0===b,type:"append"};c.add({query:B,message:z});n._onMessage(z)}}catch(u){C.isAbortError(u)||n._onMessage({id:k.id,addOrUpdate:null,
end:!0,type:"append"})}});return function(g,x){return m.apply(this,arguments)}}();f(k,0)});return function(k){return h.apply(this,arguments)}}();return e}(v.BaseFeatureSource);r.DrillDownFeatureSource=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){const n=A.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource");A=function(p){function c(a){var b=p.call(this,a)||this;b.type="feature";b.mode="on-demand";b._adapter=e.createSourceAdapter(a.serviceInfo);b._queue=new k.QueueProcessor({concurrency:8,process:function(){var f=t._asyncToGenerator(function*(m){l.throwIfAborted(m);if(w.isSome(m.tile)){var g=m.tile.key.id,{signal:x}=m;g=v("esri-tiles-debug")?{tile:g.replace(/\//g,"."),depth:m.depth}:void 0;x=
yield b._adapter.executeQuery(m.query,{signal:x,query:{...g,...b._schema.customParameters}});x.level=m.tile.key.level;return x}return b._adapter.executeQuery(m.query,{...m,query:b._schema.customParameters})});return function(m){return f.apply(this,arguments)}}()});b._patchQueue=new k.QueueProcessor({concurrency:8,process:function(){var f=t._asyncToGenerator(function*(m){l.throwIfAborted(m);if(w.isSome(m.tile)){var g=m.tile.key.id,{signal:x}=m;g=v("esri-tiles-debug")?{tile:g.replace(/\//g,"."),depth:m.depth}:
void 0;x=yield b._adapter.executeQuery(m.query,{signal:x,query:{...g,...b._schema.customParameters}});x.level=m.tile.key.level;return x}return b._adapter.executeQuery(m.query,{...m,query:b._schema.customParameters})});return function(m){return f.apply(this,arguments)}}()});return b}t._inheritsLoose(c,p);var d=c.prototype;d.destroy=function(){p.prototype.destroy.call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};d.enableEvent=function(a,b){};d.subscribe=function(a){p.prototype.subscribe.call(this,
a);const b=this._subscriptions.get(a.id);this._fetchDataTile(a).catch(f=>{l.isAbortError(f)||n.error(new C("mapview-query-error","Encountered error when fetching tile",{tile:a,error:f}))}).then(()=>b.end())};d.unsubscribe=function(a){p.prototype.unsubscribe.call(this,a)};d.readers=function(a){return this._subscriptions.get(a).readers()};d.query=function(){var a=t._asyncToGenerator(function*(b){return this._adapter.executeQuery(b,{query:this._schema.customParameters})});return function(b){return a.apply(this,
arguments)}}();d.queryLastEditDate=function(){var a=t._asyncToGenerator(function*(){const b=this._serviceInfo.source;return(yield F(b.path,{query:{...b.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate});return function(){return a.apply(this,arguments)}}();d.createTileQuery=function(a,b={}){var f;const m=this._serviceInfo.geometryType,g=this.createQuery(b);g.quantizationParameters=null!=(f=b.quantizationParameters)?f:a.getQuantizationParameters();g.resultType="tile";g.geometry=
a.extent;if(this._serviceInfo.capabilities.query.supportsQuantization)"esriGeometryPolyline"===m&&(g.maxAllowableOffset=a.resolution*v("feature-polyline-generalization-factor"));else if("esriGeometryPolyline"===m||"esriGeometryPolygon"===m)g.maxAllowableOffset=a.resolution,"esriGeometryPolyline"===m&&(g.maxAllowableOffset*=v("feature-polyline-generalization-factor"));a=this._serviceInfo.capabilities.query;g.defaultSpatialReferenceEnabled=a.supportsDefaultSpatialReference;g.compactGeometryEnabled=
a.supportsCompactGeometry;return g};d._executePatchQuery=function(){var a=t._asyncToGenerator(function*(b,f,m,g){f=f.clone();f.outFields=[this._serviceInfo.objectIdField,...m];f.returnCentroid=!1;f.returnGeometry=!1;m=w.isSome(f.start)?f.start/8E3:0;return this._patchQueue.push({tile:b,query:f,signal:g.signal,depth:m})});return function(b,f,m,g){return a.apply(this,arguments)}}();d._resend=function(){var a=t._asyncToGenerator(function*(b,f){const {query:m,message:g}=b,x=w.isSome(m.outFields)?m.outFields:
[];b=this._queryInfo.outFields;const q=b.filter(B=>!x.includes(B));if(w.isNone(g.addOrUpdate))this._onMessage({...g,type:"append"});else if(q.length)try{const B=this._subscriptions.get(g.id).tile,z=yield this._executePatchQuery(B,m,q,f);l.throwIfAborted(f);m.outFields=b;g.addOrUpdate.joinAttributes(z);this._onMessage({...g,end:g.end,type:"append"})}catch(B){}else this._onMessage({...g,type:"append"})});return function(b,f){return a.apply(this,arguments)}}();d._resendSubscription=function(){var a=
t._asyncToGenerator(function*(b){if(b.empty)return this._onMessage({id:b.tile.id,addOrUpdate:null,end:!1,type:"append"});const f=b.signal;for(const m of b.requests.done)yield this._resend(m,{signal:f});if(w.isSome(b.edits))return this._onMessage(b.edits)});return function(b){return a.apply(this,arguments)}}();d.resend=function(){var a=t._asyncToGenerator(function*(){const b=Array.from(this._subscriptions.values());yield Promise.all(b.map(f=>this._resendSubscription(f)))});return function(){return a.apply(this,
arguments)}}();t._createClass(c,[{key:"updating",get:function(){return!!this._queue.length||Array.from(this._subscriptions.values()).some(a=>!a.done)}},{key:"maxRecordCountFactor",get:function(){const {query:a}=this._serviceInfo.capabilities;return a.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var a,{query:b}=this._serviceInfo.capabilities;b=null!=(a=b.maxRecordCount)?a:8E3;a=w.unwrapOr(this.maxRecordCountFactor,1);return b*a}},{key:"pageSize",get:function(){return Math.min(8E3,
this.maxPageSize)}}]);return c}(h.DataTileSource);r.BaseFeatureSource=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){function n(m){return p.apply(this,arguments)}function p(){p=t._asyncToGenerator(function*(m){const g=new v;yield g.open(m,{});return g});return p.apply(this,arguments)}let c=function(){function m(g){this.service=g}m.prototype.destroy=function(){};return m}(),d=function(m){function g(q){var B=m.call(this,q)||this;B._portsOpen=n(q.source).then(z=>B.client=z);return B}t._inheritsLoose(g,m);var x=g.prototype;x.destroy=function(){this.client.close();this.client=null};x.executeQuery=
function(){var q=t._asyncToGenerator(function*(B,z){yield this._portsOpen;B=yield this.client.invoke("queryFeatures",B.toJSON(),z);return h.FeatureSetReaderJSON.fromFeatureSet(B,this.service)});return function(B,z){return q.apply(this,arguments)}}();return g}(c),a=function(m){function g(){return m.apply(this,arguments)||this}t._inheritsLoose(g,m);g.prototype.executeQuery=function(){var x=t._asyncToGenerator(function*(q,B){({data:B}=yield e.executeQueryPBFBuffer(this.service.source,q,B));return k.FeatureSetReaderPBF.fromBuffer(B,
this.service,!q.quantizationParameters)});return function(q,B){return x.apply(this,arguments)}}();return g}(c),b=function(m){function g(){return m.apply(this,arguments)||this}t._inheritsLoose(g,m);g.prototype.executeQuery=function(){var x=t._asyncToGenerator(function*(q,B){const {source:z,capabilities:u,spatialReference:y,objectIdField:E,geometryType:H}=this.service;if(C.isSome(q.quantizationParameters)&&!u.query.supportsQuantization){q=q.clone();var J=A.toQuantizationTransform(C.unwrap(q.quantizationParameters));
q.quantizationParameters=null;({data:B}=yield e.executeQuery(z,q,y,B));B=w.convertFromFeatureSet(B,E);w.quantizeOptimizedFeatureSet(J,B);return h.FeatureSetReaderJSON.fromOptimizedFeatureSet(B,this.service)}({data:B}=yield e.executeQuery(z,q,this.service.spatialReference,B));"esriGeometryPoint"===H&&(B.features=null==(J=B.features)?void 0:J.filter(P=>C.isSome(P.geometry)?(P=P.geometry,Number.isFinite(P.x)&&Number.isFinite(P.y)):!0));return h.FeatureSetReaderJSON.fromFeatureSet(B,this.service)});return function(q,
B){return x.apply(this,arguments)}}();return g}(c),f=function(m){function g(){return m.apply(this,arguments)||this}t._inheritsLoose(g,m);g.prototype.executeQuery=function(){var x=t._asyncToGenerator(function*(q,B){var {capabilities:z}=this.service;if(q.quantizationParameters&&!z.query.supportsQuantization){const u=q.clone();z=A.toQuantizationTransform(C.unwrap(u.quantizationParameters));u.quantizationParameters=null;q=yield l.queryOptimizedFeatureSet(this.service.source,q,B);w.quantizeOptimizedFeatureSet(z,
q);return h.FeatureSetReaderJSON.fromOptimizedFeatureSet(q,this.service)}q=yield l.queryOptimizedFeatureSet(this.service.source,q,B);return h.FeatureSetReaderJSON.fromOptimizedFeatureSet(q,this.service)});return function(q,B){return x.apply(this,arguments)}}();return g}(c);r.SourceAdapter=c;r.createSourceAdapter=function(m){const {capabilities:g}=m;var x=m.source;return x&&x.capabilities&&x.collection&&x.layerDefinition?new f(m):Array.isArray(m.source)?new d(m):g.query.supportsFormatPBF&&F("featurelayer-pbf")?
new a(m):new b(m)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/workers/Connection":function(){define(["../../chunks/_rollupPluginBabelHelpers","../handleUtils","../Logger","../promiseUtils","./RemoteClient"],function(r,t,F,C,v){const A=F.getLogger("esri.core.workers.Connection");return function(){function w(){this._clients=[];this._clientPromises=[];this._clientIdx=0}var l=w.prototype;l.destroy=function(){this.close()};l.open=function(e,h){return new Promise((k,n)=>{let p=!0;const c=
d=>{C.throwIfAborted(h.signal);p&&(p=!1,d())};this._clients.length=e.length;this._clientPromises.length=e.length;for(let d=0;d<e.length;++d){const a=e[d];C.isPromiseLike(a)?this._clientPromises[d]=a.then(b=>{this._clients[d]=new v(b,h);c(k);return this._clients[d]},()=>{c(n);return null}):(this._clients[d]=new v(a,h),this._clientPromises[d]=Promise.resolve(this._clients[d]),c(k))}})};l.broadcast=function(e,h,k){const n=Array(this._clientPromises.length);for(let p=0;p<this._clientPromises.length;++p)n[p]=
this._clientPromises[p].then(c=>c.invoke(e,h,k));return n};l.close=function(){for(const e of this._clientPromises)e.then(h=>h.close());this._clients.length=0;this._clientPromises.length=0};l.getAvailableClient=function(){let e;for(let h=0;h<this._clients.length;++h){const k=this._clients[h];if(!k)e=e||[],e.push(this._clientPromises[h]);else if(!k.isBusy())return Promise.resolve(k)}return e?Promise.race(e):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))};
l.invoke=function(e,h,k){let n=null;Array.isArray(k)?(A.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:k}):n=k;return this.closed?Promise.reject(Error("Connection closed")):this.getAvailableClient().then(p=>p.invoke(e,h,n))};l.on=function(e,h){return Promise.all(this._clientPromises).then(()=>t.handlesGroup(this._clients.map(k=>k.on(e,h))))};l.openPorts=function(){return new Promise(e=>{const h=Array(this._clientPromises.length);let k=h.length;
for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(p=>{h[n]=p.openPort();0===--k&&e(h)})})};r._createClass(w,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);return w}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a){function b(){b=t._asyncToGenerator(function*(K,D,I={},L=5){({links:K}=K);K=P(K,"items","application/geo+json")||P(K,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(w.isNone(K))throw new v("ogc-feature-layer:missing-items-page","Missing items url");({data:I}=yield C(K.href,{signal:I.signal,query:{limit:L,...I.customParameters,token:I.apiKey},headers:{accept:"application/geo+json"}}));yield n.validateGeoJSON(I);const R=n.inferLayerProperties(I,
{geometryType:D.geometryType});I=D.fields||R.fields||[];L=null!=D.hasZ?D.hasZ:R.hasZ;K=R.geometryType;const Z=D.objectIdField||R.objectIdFieldName||"OBJECTID";D=D.timeInfo;var X=I.find(M=>M.name===Z);if(X)X.type="esriFieldTypeOID",X.editable=!1,X.nullable=!1;else{if(!R.objectIdFieldType)throw new v("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");I.unshift({name:Z,alias:Z,type:"esriFieldTypeOID",editable:!1,nullable:!1})}Z!==R.objectIdFieldName&&
(X=I.find(M=>M.name===R.objectIdFieldName))&&(X.type="esriFieldTypeInteger");I===R.fields&&0<R.unknownFields.length&&O.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:R.unknownFields}});for(var Q of I){null==Q.name&&(Q.name=Q.alias);null==Q.alias&&(Q.alias=Q.name);"esriFieldTypeOID"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&(Q.editable=null==Q.editable?!0:!!Q.editable,Q.nullable=null==Q.nullable?
!0:!!Q.nullable);if(!Q.name)throw new v("ogc-feature-layer:invalid-field-name","field name is missing",{field:Q});if(-1===d.kebabDict.jsonValues.indexOf(Q.type))throw new v("ogc-feature-layer:invalid-field-type",`invalid type for field "${Q.name}"`,{field:Q});}D&&(Q=new c(I),D.startTimeField&&((X=Q.get(D.startTimeField))?(D.startTimeField=X.name,X.type="esriFieldTypeDate"):D.startTimeField=null),D.endTimeField&&((X=Q.get(D.endTimeField))?(D.endTimeField=X.name,X.type="esriFieldTypeDate"):D.endTimeField=
null),D.trackIdField&&((Q=Q.get(D.trackIdField))?D.trackIdField=Q.name:(D.trackIdField=null,O.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:D}}))),D.startTimeField||D.endTimeField||(O.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:D}}),D=null));return{drawingInfo:K?p.createDrawingInfo(K):null,geometryType:K,fields:I,hasZ:!!L,objectIdField:Z,timeInfo:D}});return b.apply(this,
arguments)}function f(){f=t._asyncToGenerator(function*(K,D={}){({links:K}=K);K=P(K,"data","application/json")||P(K,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(w.isNone(K))throw new v("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:I,customParameters:L,signal:R}=D;({data:D}=yield C(K.href,{signal:R,headers:{accept:"application/json"},query:{...L,token:I}}));return D});return f.apply(this,arguments)}function m(){m=t._asyncToGenerator(function*(K,
D={}){({links:K}=K);K=P(K,"conformance","application/json")||P(K,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(w.isNone(K))throw new v("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:I,customParameters:L,signal:R}=D;({data:D}=yield C(K.href,{signal:R,headers:{accept:"application/json"},query:{...L,token:I}}));return D});return m.apply(this,arguments)}function g(){g=t._asyncToGenerator(function*(K,D={}){const {apiKey:I,customParameters:L,
signal:R}=D;({data:K}=yield C(K,{signal:R,headers:{accept:"application/json"},query:{...L,token:I}}));return K});return g.apply(this,arguments)}function x(){x=t._asyncToGenerator(function*(K,D={}){K=P(K.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(w.isNone(K))return O.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const {apiKey:I,customParameters:L,signal:R}=D;({data:D}=yield C(K.href,{signal:R,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},
query:{...L,token:I}}));return D});return x.apply(this,arguments)}function q(){q=t._asyncToGenerator(function*(K,D,I){K=yield B(K,D,I);return h.convertToFeatureSet(K)});return q.apply(this,arguments)}function B(K,D,I){return z.apply(this,arguments)}function z(){z=t._asyncToGenerator(function*(K,D,I){const {capabilities:{query:{maxRecordCount:L}},collection:R,layerDefinition:Z,queryParameters:{apiKey:X,customParameters:Q},spatialReference:M,supportedCrs:V}=K;({links:K}=R);var fa=P(K,"items","application/geo+json")||
P(K,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(w.isNone(fa))throw new v("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:oa,num:ua,start:xa,timeExtent:Ca,where:va}=D;if(D.objectIds)throw new v("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");K=a.fromJSON(M);D=w.unwrapOr(D.outSpatialReference,K);K=D.isWGS84?null:u(D,V);var G=J(oa,V),S=E(Ca);const ha=H(va);({data:G}=yield C(fa.href,{...I,query:{...Q,
...G,crs:K,datetime:S,query:ha,limit:null!=ua?ua:null!=xa&&void 0!==xa?10:L,startindex:xa,token:X},headers:{accept:"application/geo+json"}}));I=!1;G.links&&(I=!!G.links.find(ea=>"next"===ea.rel));!I&&Number.isInteger(G.numberMatched)&&Number.isInteger(G.numberReturned)&&(I=G.numberReturned<G.numberMatched);const {fields:T,globalIdField:W,hasM:ca,hasZ:da,objectIdField:ia}=Z;fa=Z.geometryType;G=n.createOptimizedFeatures(G,{geometryType:fa,hasZ:da,objectIdField:ia});if(!K&&D.isWebMercator)for(var ja of G)w.isSome(ja.geometry)&&
(S=h.convertToGeometry(ja.geometry,fa,da,!1),S.spatialReference=a.WGS84,ja.geometry=h.convertFromGeometry(e.project(S,D)));for(var aa of G)aa.objectId=aa.attributes[ia];ja=K||!K&&D.isWebMercator?D.toJSON():l.WGS84;aa=new k;aa.exceededTransferLimit=I;aa.features=G;aa.fields=T;aa.geometryType=fa;aa.globalIdFieldName=W;aa.hasM=ca;aa.hasZ=da;aa.objectIdFieldName=ia;aa.spatialReference=ja;return aa});return z.apply(this,arguments)}function u(K,D){var I,L,R;const {isWebMercator:Z,wkid:X}=K;return X?(K=
Z?null!=(I=null!=(L=null!=(R=D[3857])?R:D[102100])?L:D[102113])?I:D[900913]:D[K.wkid])?`${"http://www.opengis.net/def/crs/"}${K}`:null:null}function y(K){if(w.isNone(K))return"";const {xmin:D,ymin:I,xmax:L,ymax:R}=K;return`${D},${I},${L},${R}`}function E(K){if(w.isNone(K))return null;const {start:D,end:I}=K;return`${w.isSome(D)?D.toISOString():".."}/${w.isSome(I)?I.toISOString():".."}`}function H(K){return w.isNone(K)||!K||"1\x3d1"===K?null:K}function J(K,D){if(!w.isSome(K)||"extent"!==K.type)return null;
const {spatialReference:I}=K;if(!I||I.isWGS84)return{bbox:y(K)};D=u(I,D);return w.isSome(D)?{bbox:y(K),"bbox-crs":D}:I.isWebMercator?{bbox:y(e.project(K,a.WGS84))}:null}function P(K,D,I){return K.find(L=>L.rel===D&&L.type===I)||K.find(L=>L.rel===D&&!L.type)}const O=A.getLogger("esri.layers.graphics.sources.ogcfeature");r.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";r.crsPrefix="http://www.opengis.net/def/crs/";r.getCollectionDefinition=function(K,D){return b.apply(this,arguments)};r.getServerCollections=
function(K){return f.apply(this,arguments)};r.getServerConformance=function(K){return m.apply(this,arguments)};r.getServerLandingPage=function(K){return g.apply(this,arguments)};r.getServerOpenApi=function(K){return x.apply(this,arguments)};r.getSpatialReferenceWkid=function(K){K=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(K);K=null==K?void 0:K.groups;if(!K)return null;const {authority:D,code:I}=K;switch(D.toLowerCase()){case "ogc":switch(I.toLowerCase()){case "crs27":return a.GCS_NAD_1927.wkid;
case "crs83":return 4269;case "crs84":case "crs84h":return a.WGS84.wkid;default:return null}case "esri":case "epsg":return K=Number.parseInt(I,10),Number.isNaN(K)?null:K;default:return null}};r.queryFeatureSetJSON=function(K,D,I){return q.apply(this,arguments)};r.queryOptimizedFeatureSet=B;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],
function(r,t,F,C,v){function*A(m){switch(m.type){case "Feature":yield m;break;case "FeatureCollection":for(const g of m.features)g&&(yield g)}}function*w(m){if(!m)return null;switch(m.type){case "Point":yield m.coordinates;break;case "LineString":case "MultiPoint":yield*m.coordinates;break;case "MultiLineString":case "Polygon":for(const g of m.coordinates)yield*g;break;case "MultiPolygon":for(const g of m.coordinates)for(const x of g)yield*x}}function*l(m,g={}){const {geometryType:x,objectIdField:q}=
g;for(const z of m){var B;const {geometry:u,properties:y,id:E}=z;if(u&&f[u.type]!==x)continue;m=y||{};let H=null!=(B=m[q])?B:null;q&&null!=E&&!m[q]&&(m[q]=H=E);yield new F.OptimizedFeature(u?n(new C,u,g):null,m,null,H)}}function e(m){for(const g of m)if(2<g.length)return!0;return!1}function h(m){let g=0;for(let x=0;x<m.length;x++){const q=m[x],B=m[(x+1)%m.length];g+=q[0]*B[1]-B[0]*q[1]}return 0>=g}function k(m){const g=m[0],x=m[m.length-1];g[0]===x[0]&&g[1]===x[1]&&g[2]===x[2]||m.push(g);return m}
function n(m,g,x){switch(g.type){case "LineString":return d(m,g.coordinates,x),m;case "MultiLineString":for(const B of g.coordinates)d(m,B,x);return m;case "MultiPoint":return d(m,g.coordinates,x),m;case "MultiPolygon":for(var q of g.coordinates)for(p(m,q[0],x),g=1;g<q.length;g++)c(m,q[g],x);return m;case "Point":return b(m,g.coordinates,x),m;case "Polygon":q=g.coordinates;p(m,q[0],x);for(g=1;g<q.length;g++)c(m,q[g],x);return m}}function p(m,g,x){g=k(g);h(g)?d(m,g,x):a(m,g,x)}function c(m,g,x){g=
k(g);h(g)?a(m,g,x):d(m,g,x)}function d(m,g,x){for(const q of g)b(m,q,x);m.lengths.push(g.length)}function a(m,g,x){for(let q=g.length-1;0<=q;q--)b(m,g[q],x);m.lengths.push(g.length)}function b(m,g,x){const [q,B,z]=g;m.coords.push(q,B);x.hasZ&&m.coords.push(z||0)}const f={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};r.createOptimizedFeatures=function(m,
g){return Array.from(l(A(m),g))};r.getGeometryType=function(m){return f[m]};r.inferLayerProperties=function(m,g={}){const x=[];var q=new Set;const B=new Set;var z=!1;let u=null,y=!1,E=void 0;({geometryType:g=null}=g);var H=!1;for(const J of A(m)){const {geometry:P,properties:O,id:K}=J;if(P&&(g||(g=f[P.type]),f[P.type]!==g))continue;z||(z=w(P),z=e(z));!y&&(y=null!=K)&&(E=typeof K,u=Object.keys(O).filter(D=>O[D]===K));y&&null!=K&&(1<u.length?u=u.filter(D=>O[D]===K):1===u.length&&(u=O[u[0]]===K?u:[]));
if(!H&&O){m=!0;for(const D in O)if(!q.has(D))if(H=O[D],null==H)m=!1,B.add(D);else{a:switch(typeof H){case "string":H="esriFieldTypeString";break a;case "number":H="esriFieldTypeDouble";break a;default:H="unknown"}"unknown"===H?B.add(D):(B.delete(D),q.add(D),x.push({name:D,alias:D,type:H}))}H=m}}if(q=u&&1===u.length&&u[0]||null)for(const J of x)if(J.name===q&&v.isNumericField(J)){J.type="esriFieldTypeOID";break}return{fields:x,geometryType:g,hasZ:z,objectIdFieldName:q,objectIdFieldType:E,unknownFields:Array.from(B)}};
r.validateGeoJSON=function(m){if(!m)throw new t("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==m.type&&"FeatureCollection"!==m.type)throw new t("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:m});({crs:m}=m);if(m){var g="string"===typeof m?m:"name"===m.type?m.properties.name:"EPSG"===m.type?m.properties.code:null,x=/.*(CRS84H?|4326)$/i;if(!g||!x.test(g))throw new t("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:m});
}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(r,t,F,C,v){const A=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let w=1;r.createCapabilities=function(l,e){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:l},metadata:{supportsAdvancedFieldProperties:!1},
operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0},query:C.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,
supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};r.createDefaultAttributesFunction=function(l,e){if(t("esri-csp-restrictions"))return()=>({[e]:null,...l});try{let h=`this.${e} = null;`;for(const n in l){const p=A.test(n)?`.${n}`:`["${n}"]`;h+=`this${p} = ${JSON.stringify(l[n])};`}const k=(new Function(`\n      return class AttributesClass$${w++} {\n        constructor() {\n          ${h};\n        }\n      }\n    `))();
return()=>new k}catch(h){return()=>({[e]:null,...l})}};r.createDefaultTemplate=function(l={}){return[{name:"New Feature",description:"",prototype:{attributes:F.clone(l)}}]};r.createDrawingInfo=function(l){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===l||"esriGeometryMultipoint"===l?v.defaultPointSymbolJSON:"esriGeometryPolyline"===l?v.defaultPolylineSymbolJSON:v.defaultPolygonSymbolJSON}}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],
function(r){const t=[252,146,31,255],F={type:"esriSMS",style:"esriSMSCircle",size:6,color:t,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},C={type:"esriSLS",style:"esriSLSSolid",width:.75,color:t};r.defaultColor=t;r.defaultOutlineColor=[153,153,153,255];r.defaultPointSymbolJSON=F;r.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};r.defaultPolylineSymbolJSON=
C;r.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};r.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};r.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};r.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",
color:[0,0,0,255],width:1.5};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(r,t){t=new t.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",
esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});r.kebabDict=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/query":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),function(r,t,F,C,v,A,w,l,e,h){function k(b,
f){if(f&&"extent"===b.type)return`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`;if(f&&"point"===b.type)return`${b.x},${b.y}`;b=b.toJSON();delete b.spatialReference;return JSON.stringify(b)}function n(b,f){const m=b.geometry,g=b.toJSON();delete g.compactGeometryEnabled;delete g.defaultSpatialReferenceEnabled;const x=b.outSpatialReference;let q,B;C.isSome(m)&&(q=m.spatialReference,B=m.spatialReference.wkid||JSON.stringify(m.spatialReference),g.geometryType=A.getJsonType(m),g.geometry=k(m,b.compactGeometryEnabled),
g.inSR=B);g.groupByFieldsForStatistics&&(g.groupByFieldsForStatistics=g.groupByFieldsForStatistics.join(","));g.objectIds&&(g.objectIds=g.objectIds.join(","));g.orderByFields&&(g.orderByFields=g.orderByFields.join(","));!g.outFields||!g.returnDistinctValues&&(null!=f&&f.returnCountOnly||null!=f&&f.returnExtentOnly||null!=f&&f.returnIdsOnly)?delete g.outFields:-1!==g.outFields.indexOf("*")?g.outFields="*":g.outFields=g.outFields.join(",");g.outSR?g.outSR=g.outSR.wkid||JSON.stringify(g.outSR):m&&(g.returnGeometry||
g.returnCentroid)&&(g.outSR=g.inSR);g.returnGeometry&&delete g.returnGeometry;g.outStatistics&&(g.outStatistics=JSON.stringify(g.outStatistics));g.pixelSize&&(g.pixelSize=JSON.stringify(g.pixelSize));g.quantizationParameters&&(b.defaultSpatialReferenceEnabled&&C.isSome(q)&&C.isSome(b.quantizationParameters)&&C.isSome(b.quantizationParameters.extent)&&q.equals(b.quantizationParameters.extent.spatialReference)&&delete g.quantizationParameters.extent.spatialReference,g.quantizationParameters=JSON.stringify(g.quantizationParameters));
g.parameterValues&&(g.parameterValues=JSON.stringify(g.parameterValues));g.rangeValues&&(g.rangeValues=JSON.stringify(g.rangeValues));g.dynamicDataSource&&(g.layer=JSON.stringify({source:g.dynamicDataSource}),delete g.dynamicDataSource);if(g.timeExtent){const {start:z,end:u}=g.timeExtent;if(null!=z||null!=u)g.time=z===u?z:`${null==z?"null":z},${null==u?"null":u}`;delete g.timeExtent}b.defaultSpatialReferenceEnabled&&C.isSome(q)&&C.isSome(x)&&q.equals(x)&&(g.defaultSR=g.inSR,delete g.inSR,delete g.outSR);
return g}function p(){p=t._asyncToGenerator(function*(b,f,m,g){b=C.isSome(f.timeExtent)&&f.timeExtent.isEmpty?{data:{features:[]}}:yield a(b,f,"json",g);h.applyFeatureSetZUnitScaling(f,m,b.data);return b});return p.apply(this,arguments)}function c(){c=t._asyncToGenerator(function*(b,f,m,g){if(C.isSome(f.timeExtent)&&f.timeExtent.isEmpty)return Promise.resolve({data:m.createFeatureResult()});b=yield d(b,f,g);b.data=e.parsePBFFeatureQuery(b.data,m);return b});return c.apply(this,arguments)}function d(b,
f,m){return a(b,f,"pbf",m)}function a(b,f,m,g={},x={}){const q="string"===typeof b?v.urlToObject(b):b;b=f.geometry?[f.geometry]:[];g.responseType="pbf"===m?"array-buffer":"json";return w.normalizeCentralMeridian(b,null,g).then(B=>{B=B&&B[0];C.isSome(B)&&(f=f.clone(),f.geometry=B);B=l.mapParameters({...q.query,f:m,...x,...n(f,x)});return F(v.join(q.path,"query"),{...g,query:{...B,...g.query}})})}r.encodeGeometry=k;r.executeQuery=function(b,f,m,g){return p.apply(this,arguments)};r.executeQueryForCount=
function(b,f,m){return C.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):a(b,f,"json",m,{returnIdsOnly:!0,returnCountOnly:!0})};r.executeQueryForExtent=function(b,f,m){return C.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):a(b,f,"json",m,{returnExtentOnly:!0,returnCountOnly:!0}).then(g=>{const x=g.data;if(x.hasOwnProperty("extent"))return g;if(x.features)throw Error("Layer does not support extent calculation.");if(x.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");
return g})};r.executeQueryForIds=function(b,f,m){return C.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):a(b,f,"json",m,{returnIdsOnly:!0})};r.executeQueryPBF=function(b,f,m,g){return c.apply(this,arguments)};r.executeQueryPBFBuffer=d;r.queryToQueryStringParameters=n;r.runQuery=a;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(r){function t(F){const C={};for(const v in F){if("declaredClass"===
v)continue;const A=F[v];if(null!=A&&"function"!==typeof A)if(Array.isArray(A)){C[v]=[];for(let w=0;w<A.length;w++)C[v][w]=t(A[w])}else"object"===typeof A?A.toJSON&&(C[v]=JSON.stringify(A)):C[v]=A}return C}r.mapParameters=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(r,t){r.parsePBFFeatureQuery=function(F,C){var v=t.parseFeatureQuery(F,C);F=v.queryResult.featureResult;C=v.queryResult.queryGeometry;
v=v.queryResult.queryGeometryType;if(F&&F.features&&F.features.length&&F.objectIdFieldName){const A=F.objectIdFieldName;for(const w of F.features)w.attributes&&(w.objectId=w.attributes[A])}F&&(F.queryGeometry=C,F.queryGeometryType=v);return F};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),
function(r,t,F,C,v,A){function w(u){return u>=q.length?null:q[u]}function l(u,y,E){for(E=y.createPointGeometry(E);u.next();)switch(u.tag()){case 3:{var H=u.getUInt32();H=u.pos()+H;let J=0;for(;u.pos()<H;)y.addCoordinatePoint(E,u.getSInt64(),J++);break}default:u.skip()}return E}function e(u,y,E){const H=y.createGeometry(E);for(E=2+(E.hasZ?1:0)+(E.hasM?1:0);u.next();)switch(u.tag()){case 2:var J=u.getUInt32();J=u.pos()+J;for(var P=0;u.pos()<J;)y.addLength(H,u.getUInt32(),P++);break;case 3:J=u.getUInt32();
J=u.pos()+J;P=0;for(y.allocateCoordinates(H);u.pos()<J;)y.addCoordinate(H,u.getSInt64(),P),P++,P===E&&(P=0);break;default:u.skip()}return H}function h(u){const y=new v;let E="esriGeometryPoint";for(;u.next();)switch(u.tag()){case 2:var H=u.getUInt32();for(H=u.pos()+H;u.pos()<H;)y.lengths.push(u.getUInt32());break;case 3:H=u.getUInt32();for(H=u.pos()+H;u.pos()<H;)y.coords.push(u.getSInt64());break;case 1:E=A.OPTIMIZED_GEOMETRY_TYPES[u.getEnum()];break;default:u.skip()}return{queryGeometry:y,queryGeometryType:E}}
function k(u){for(;u.next();)switch(u.tag()){case 1:return u.getString();case 2:return u.getFloat();case 3:return u.getDouble();case 4:return u.getSInt32();case 5:return u.getUInt32();case 6:return u.getInt64();case 7:return u.getUInt64();case 8:return u.getSInt64();case 9:return u.getBool();default:return u.skip(),null}return null}function n(u){const y={type:w(0)};for(;u.next();)switch(u.tag()){case 1:y.name=u.getString();break;case 2:y.type=w(u.getEnum());break;case 3:y.alias=u.getString();break;
case 4:var E=u.getEnum();E=E>=B.length?null:B[E];y.sqlType=E;break;case 5:u.skip();break;case 6:y.defaultValue=u.getString();break;default:u.skip()}return y}function p(u){const y={};for(;u.next();)switch(u.tag()){case 1:y.name=u.getString();break;case 2:y.isSystemMaintained=u.getBool();break;default:u.skip()}return y}function c(u,y,E,H){const J=y.createFeature(E);let P=0;for(;u.next();)switch(u.tag()){case 1:{const O=H[P++].name;J.attributes[O]=u.processMessage(k);break}case 2:J.geometry=u.processMessageWithArgs(e,
y,E);break;case 4:J.centroid=u.processMessageWithArgs(l,y,E);break;default:u.skip()}return J}function d(u){const y=[1,1,1,1];for(;u.next();)switch(u.tag()){case 1:y[0]=u.getDouble();break;case 2:y[1]=u.getDouble();break;case 4:y[2]=u.getDouble();break;case 3:y[3]=u.getDouble();break;default:u.skip()}return y}function a(u){const y=[0,0,0,0];for(;u.next();)switch(u.tag()){case 1:y[0]=u.getDouble();break;case 2:y[1]=u.getDouble();break;case 4:y[2]=u.getDouble();break;case 3:y[3]=u.getDouble();break;
default:u.skip()}return y}function b(u){const y={originPosition:0>=z.length?null:z[0]};for(;u.next();)switch(u.tag()){case 1:var E=u.getEnum();y.originPosition=E>=z.length?null:z[E];break;case 2:y.scale=u.processMessage(d);break;case 3:y.translate=u.processMessage(a);break;default:u.skip()}return y}function f(u){const y={};for(;u.next();)switch(u.tag()){case 1:y.shapeAreaFieldName=u.getString();break;case 2:y.shapeLengthFieldName=u.getString();break;case 3:y.units=u.getString();break;default:u.skip()}return y}
function m(u,y){for(y=y.createSpatialReference();u.next();)switch(u.tag()){case 1:y.wkid=u.getUInt32();break;case 5:y.wkt=u.getString();break;case 2:y.latestWkid=u.getUInt32();break;case 3:y.vcsWkid=u.getUInt32();break;case 4:y.latestVcsWkid=u.getUInt32();break;default:u.skip()}return y}function g(u,y){const E=y.createFeatureResult();E.geometryType=0>=y.geometryTypes.length?null:y.geometryTypes[0];let H=!1;for(;u.next();)switch(u.tag()){case 1:E.objectIdFieldName=u.getString();break;case 3:E.globalIdFieldName=
u.getString();break;case 4:E.geohashFieldName=u.getString();break;case 5:E.geometryProperties=u.processMessage(f);break;case 7:var J=u.getEnum();E.geometryType=J>=y.geometryTypes.length?null:y.geometryTypes[J];break;case 8:E.spatialReference=u.processMessageWithArgs(m,y);break;case 10:E.hasZ=u.getBool();break;case 11:E.hasM=u.getBool();break;case 12:E.transform=u.processMessage(b);break;case 9:J=u.getBool();E.exceededTransferLimit=J;break;case 13:y.addField(E,u.processMessage(n));break;case 15:H||
(y.prepareFeatures(E),H=!0);y.addFeature(E,u.processMessageWithArgs(c,y,E,E.fields));break;case 2:E.uniqueIdField=u.processMessage(p);break;default:u.skip()}y.finishFeatureResult(E);return E}function x(u,y){const E={};let H=null;for(;u.next();)switch(u.tag()){case 4:H=u.processMessageWithArgs(h);break;case 1:E.featureResult=u.processMessageWithArgs(g,y);break;default:u.skip()}F.isSome(H)&&E.featureResult&&y.addQueryGeometry(E,H);return E}const q="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
B="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),z=["upperLeft","lowerLeft"];r.parseFeatureQuery=function(u,y){try{const E=new C(new Uint8Array(u),new DataView(u));
for(u={};E.next();)switch(E.tag()){case 2:u.queryResult=E.processMessageWithArgs(x,y);break;default:E.skip()}return u}catch(E){throw new t("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:E});}};r.parseFieldType=w;r.parseTransform=b;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(r,t,F,C,v,A){const w=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let l=function(){function e(k){this.options=k;this.geometryTypes=w;this._vertexDimension=this._coordinatePtr=0}var h=e.prototype;h.createFeatureResult=function(){return new v};h.prepareFeatures=function(k){this._vertexDimension=2;k.hasZ&&this._vertexDimension++;k.hasM&&this._vertexDimension++};h.finishFeatureResult=function(k){if(k&&k.features&&k.hasZ&&this.options.sourceSpatialReference&&
k.spatialReference&&!F.equals(k.spatialReference,this.options.sourceSpatialReference)&&!k.spatialReference.vcsWkid){var n=t.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference),p=t.getMetersPerVerticalUnitForSR(k.spatialReference);n/=p;if(1!==n)for(const c of k.features)if(C.hasGeometry(c))for(k=c.geometry.coords,p=2;p<k.length;p+=3)k[p]*=n}};h.addFeature=function(k,n){k.features.push(n)};h.createFeature=function(){return new C.OptimizedFeature};h.createSpatialReference=function(){return{wkid:0}};
h.createGeometry=function(){return new A};h.addField=function(k,n){k.fields.push(n)};h.allocateCoordinates=function(k){k.coords.length=k.lengths.reduce((n,p)=>n+p,0)*this._vertexDimension;this._coordinatePtr=0};h.addCoordinate=function(k,n){k.coords[this._coordinatePtr++]=n};h.addCoordinatePoint=function(k,n){k.coords.push(n)};h.addLength=function(k,n){k.lengths.push(n)};h.addQueryGeometry=function(k,n){k.queryGeometry=n.queryGeometry;k.queryGeometryType=n.queryGeometryType};h.createPointGeometry=
function(){return new A};return e}();r.OPTIMIZED_GEOMETRY_TYPES=w;r.OptimizedFeatureSetParserContext=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(r,t,F){r.applyFeatureSetZUnitScaling=function(C,v,A){if(A&&A.features&&A.hasZ&&(C=F.getGeometryZScaler(A.geometryType,v,C.outSpatialReference),!t.isNone(C)))for(const w of A.features)C(w.geometry)};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(r,t,F,C,v,A){function w({coords:e,lengths:h}){let k=0;for(const n of h){for(h=1;h<n;h++)e[2*(k+h)]+=e[2*(k+h)-2],e[2*(k+h)+1]+=e[2*(k+h)-1];k+=n}}let l=function(e){function h(n,
p,c){n=e.call(this,n,c)||this;n._featureIndex=-1;n._dateFields=new Set;n._geometryType=null==c?void 0:c.geometryType;n._features=p;return n}t._inheritsLoose(h,e);h.fromFeatures=function(n,p){const {objectIdField:c,geometryType:d}=p,a=C.convertFromFeatures([],n,d,!1,!1,c);for(let b=0;b<a.length;b++)a[b].displayId=n[b].displayId;return h.fromOptimizedFeatures(a,p)};h.fromFeatureSet=function(n,p){n=C.convertFromFeatureSet(n,p.objectIdField);return h.fromOptimizedFeatureSet(n,p)};h.fromOptimizedFeatureSet=
function(n,p){const {features:c}=n;p=h.fromOptimizedFeatures(c,p);p._exceededTransferLimit=n.exceededTransferLimit;p._transform=n.transform;for(const d of n.fields)"esriFieldTypeDate"===d.type&&p._dateFields.add(d.name);return p};h.fromOptimizedFeatures=function(n,p,c){const d=A.FeatureSetReader.createInstance();n=new h(d,n,p);n._transform=c;return n};var k=h.prototype;k.removeIds=function(n){const p=new Set(n);this._features=this._features.filter(c=>!p.has(c.objectId))};k.append=function(n){for(const p of n)this._features.push(p)};
k.getSize=function(){return this._features.length};k.getCursor=function(){return this.copy()};k.getQuantizationTransform=function(){return this._transform};k.getAttributeHash=function(){let n="";for(const p in this._current.attributes)n+=this._current.attributes[p];return n};k.getIndex=function(){return this._featureIndex};k.setIndex=function(n){this._featureIndex=n};k.getObjectId=function(){return this._current.objectId};k.getDisplayId=function(){return this._current.displayId};k.setDisplayId=function(n){this._current.displayId=
n};k.getGroupId=function(){return this._current.groupId};k.setGroupId=function(n){this._current.groupId=n};k.copy=function(){const n=new h(this.instance,this._features,this.fullSchema());this.copyInto(n);return n};k.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};k.readLegacyFeature=function(){return C.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};k.readOptimizedFeature=function(){return this._current};
k.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};k.readLegacyGeometry=function(){const n=this.readGeometry();return C.convertToGeometry(n,this.geometryType,this.hasZ,this.hasM)};k.readLegacyCentroid=function(){const n=this.readCentroid();return F.isNone(n)?null:{x:n.coords[0]*this._sx+this._tx,y:n.coords[1]*this._sy+this._ty}};k.readGeometryArea=function(){return v.hasGeometry(this._current)?C.getQuantizedArea(this._current.geometry,2):0};k.readUnquantizedGeometry=
function(){var n=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!n)return n;n=n.clone();w(n);return n};k.readHydratedGeometry=function(){var n=this._current.geometry;if(F.isNone(n))return null;n=n.clone();F.isSome(this._transform)&&C.unquantizeOptimizedGeometry(n,n,this.hasZ,this.hasM,this._transform);return n};k.getXHydrated=function(){if(!v.hasGeometry(this._current))return 0;const n=this._current.geometry.coords[0],p=this.getQuantizationTransform();return F.isNone(p)?n:n*p.scale[0]+
p.translate[0]};k.getYHydrated=function(){if(!v.hasGeometry(this._current))return 0;const n=this._current.geometry.coords[1],p=this.getQuantizationTransform();return F.isNone(p)?n:p.translate[1]-n*p.scale[1]};k.getX=function(){return v.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0};k.getY=function(){return v.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};k.readGeometry=function(){if(!v.hasGeometry(this._current))return null;const n=
this._current.geometry.clone();if(n.isPoint)return n.coords[0]=n.coords[0]*this._sx+this._tx,n.coords[1]=n.coords[1]*this._sy+this._ty,n;let p=0;for(const c of n.lengths)n.coords[2*p]=n.coords[2*p]*this._sx+this._tx,n.coords[2*p+1]=n.coords[2*p+1]*this._sy+this._ty,p+=c;return n};k.readCentroid=function(){if(!v.hasGeometry(this._current))return null;if(F.isNone(this._current.centroid)){var n=this._computeCentroid();if(F.isNone(n))return null;n.coords[0]=(n.coords[0]-this._tx)/this._sx;n.coords[1]=
(n.coords[1]-this._ty)/this._sy;this._current.centroid=n}n=this._current.centroid.clone();n.coords[0]=n.coords[0]*this._sx+this._tx;n.coords[1]=n.coords[1]*this._sx+this._ty;return n};k.hasField=function(n){return n in this._current.attributes?!0:this.getFieldNames().map(p=>p.toLowerCase()).includes(n.toLowerCase())};k.getFieldNames=function(){return Object.keys(this._current.attributes)};k._readAttribute=function(n,p){var c=this._current.attributes[n];if(void 0!==c)return null!=c&&p&&this._dateFields.has(n)?
new Date(c):c;c=this.readAttributes();n=n.toLocaleLowerCase().trim();for(const d in c)if(d.toLocaleLowerCase().trim()===n)return n=this._current.attributes[d],null!=n&&p&&this._dateFields.has(d)?new Date(n):n};k.copyInto=function(n){e.prototype.copyInto.call(this,n);n._featureIndex=this._featureIndex;n._transform=this._transform;n._dateFields=this._dateFields};k._readAttributes=function(){return this._current.attributes};t._createClass(h,[{key:"_current",get:function(){return this._features[this._featureIndex]}},
{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return h}(A.FeatureSetReader);r.FeatureSetReaderJSON=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){function n(b){if(b<=a.small.delta.length)return a.small;if(b<=a.large.delta.length)return a.large;a.large.delta=new Int32Array(Math.round(1.25*b));a.large.decoded=new Int32Array(Math.round(1.25*b));return a.large}function p(b){var f=b.getLength();for(f=b.pos()+f;b.pos()<f&&b.next();)switch(b.tag()){case 1:return b.getString();case 2:return b.getFloat();case 3:return b.getDouble();case 4:return b.getSInt32();case 5:return b.getUInt32();case 6:return b.getInt64();case 7:return b.getUInt64();
case 8:return b.getSInt64();case 9:return b.getBool();default:return b.skip(),null}return null}function c(b,f,m,g){return 0===b*g-m*f&&0<b*m+f*g}const d=C.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF"),a={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};C=function(b){function f(g,x,q,B){g=b.call(this,g,B)||this;g._hasNext=!1;g._isPoints=!1;g._featureIndex=-1;g._featureOffset=0;g._cache={area:0,unquantGeometry:void 0,
geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};g._geometryType=B.geometryType;g._reader=x;g._header=q;g._hasNext=q.hasFeatures;g._isPoints="esriGeometryPoint"===B.geometryType;return g}t._inheritsLoose(f,b);f.fromBuffer=function(g,x,q=!1){var B=x.geometryType;a:{try{const y=new A(new Uint8Array(g),new DataView(g));for(;y.next();)switch(y.tag()){case 2:b:{for(var z=y.getMessage();z.next();)switch(z.tag()){case 1:var u=z.getMessage();break b;default:z.skip()}u=null}break a;
default:y.skip()}}catch(y){g=new F("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:y}),d.error(g)}u=null}g=u;q=k.parseHeader(g,"esriGeometryPoint"===B,q);B=h.FeatureSetReader.createInstance();return new f(B,g,q,x)};var m=f.prototype;m.hasField=function(g){return this._header.hasField(g)||this._header.hasField(g.toLowerCase().trim())};m.getFieldNames=function(){return this._header.fields.map(g=>g.fieldName)};m.getSize=function(){return this.size};m.getQuantizationTransform=
function(){return this._header.transform};m.getCursor=function(){return this.copy()};m.getIndex=function(){return this._featureIndex};m.setIndex=function(g){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=g};m.getAttributeHash=function(){let g="";this._header.fields.forEach(({index:x})=>{g+=this._readAttributeAtIndex(x)+"."});return g};m.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};
m.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};m.setDisplayId=function(g){this._header.displayIds[this._featureIndex]=g};m.getGroupId=function(){return this._header.groupIds[this._featureIndex]};m.setGroupId=function(g){this._header.groupIds[this._featureIndex]=g};m.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var g,x=this.readCentroid();x={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),
centroid:null!=(g=x&&{x:x.coords[0],y:x.coords[1]})?g:null};return this._cache.legacyFeature=x}return this._cache.legacyFeature};m.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){const g=new l.OptimizedFeature(this.readGeometry(),this.readAttributes(),this.readCentroid());g.objectId=this.getObjectId();g.displayId=this.getDisplayId();return this._cache.optFeature=g}return this._cache.optFeature};m.getXHydrated=function(){const g=this._header.centroid[2*this._featureIndex],x=this.getQuantizationTransform();
return v.isNone(x)?g:g*x.scale[0]+x.translate[0]};m.getYHydrated=function(){const g=this._header.centroid[2*this._featureIndex+1],x=this.getQuantizationTransform();return v.isNone(x)?g:x.translate[1]-g*x.scale[1]};m.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};m.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};m.readLegacyPointGeometry=function(){const g=this.getX(),x=this.getY();return{x:g,y:x}};m.readLegacyGeometry=
function(g){g=this.readGeometry(g);return w.convertToGeometry(g,this.geometryType,!1,!1)};m.readLegacyCentroid=function(){const g=this.readCentroid();if(!g)return null;const [x,q]=g.coords;return{x,y:q}};m.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};m.readUnquantizedGeometry=function(g=!1){if(void 0===this._cache.unquantGeometry){g=this.readGeometry(g);if(!g)return this._cache.unquantGeometry=null;var x=n(g.coords.length).decoded;g=g.clone(x);x=g.coords;
let q=0;for(const B of g.lengths){for(let z=1;z<B;z++){const u=2*(q+z),y=2*(q+z-1);x[u]+=x[y];x[u+1]+=x[y+1]}q+=B}return this._cache.unquantGeometry=g}return this._cache.unquantGeometry};m.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var g=this.getXHydrated(),x=this.getYHydrated();return new e([],[g,x])}g=this.readGeometry();if(!g)return null;g=g.clone();x=this.getQuantizationTransform();v.isSome(x)&&w.unquantizeOptimizedGeometry(g,
g,this.hasZ,this.hasM,x);return g};m.readGeometry=function(g=!1){if(void 0===this._cache.geometry){var x=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;g=this.getX();x=this.getY();x=new e([],[g,x])}else{const q=this._header.offsets.geometry[this._featureIndex],B=this._reader;if(0===q)return null;B.move(q);try{x=g?this._parseGeometryForDisplay(B):this._parseGeometry(B)}catch(z){return console.error("Failed to parse geometry!",z),null}}return this._cache.geometry=
x}return this._cache.geometry};m.readCentroid=function(){if(void 0===this._cache.centroid){var g=null;g=this._header.centroid[2*this._featureIndex]+this._tx;const x=this._header.centroid[2*this._featureIndex+1]+this._ty;if(268435455===g){if(g=this._computeCentroid())this._header.centroid[2*this._featureIndex]=g.coords[0]-this._tx,this._header.centroid[2*this._featureIndex+1]=g.coords[1]-this._ty}else g=new e([],[g,x]);return this._cache.centroid=g}return this._cache.centroid};m.copy=function(){var g=
this._reader.clone();g=new f(this.instance,g,this._header,this.fullSchema());this.copyInto(g);return g};m.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this.size&&!this._getExists(););return this._featureIndex<this.size};m._readAttribute=function(g,x){g=this._header.hasField(g)?g:g.toLowerCase().trim();var q=this._header.getFieldIndex(g);
if(null!=q)return q=this._readAttributeAtIndex(q),x&&null!=q?this._header.isDateField(g)?new Date(q):q:q};m._readAttributes=function(){const g={};this._header.fields.forEach(({fieldName:x,index:q})=>{g[x]=this._readAttributeAtIndex(q)});return g};m.copyInto=function(g){b.prototype.copyInto.call(this,g);g._featureIndex=this._featureIndex;g._featureOffset=this._featureOffset;g._hasNext=this._hasNext};m._readAttributeAtIndex=function(g){const x=this._reader;x.move(this._header.offsets.attributes[this._featureIndex*
this._header.fieldCount+g]);return p(x)};m._parseGeometry=function(g){var x=g.getLength();x=g.pos()+x;const q=[],B=[];for(;g.pos()<x&&g.next();)switch(g.tag()){case 2:var z=g.getUInt32();for(z=g.pos()+z;g.pos()<z;)B.push(g.getUInt32());break;case 3:z=g.getUInt32();z=g.pos()+z;q.push(g.getSInt32()+this._tx);q.push(g.getSInt32()+this._ty);this.hasZ&&g.getSInt32();for(this.hasM&&g.getSInt32();g.pos()<z;)q.push(g.getSInt32()),q.push(g.getSInt32()),this.hasZ&&g.getSInt32(),this.hasM&&g.getSInt32();break;
default:g.skip()}return new e(B,q)};m._parseGeometryForDisplay=function(g){var x=g.getLength();const q=g.pos()+x,B=[];x=[];let z=0,u=0;var y=null;let E=0;const H="esriGeometryPolygon"===this.geometryType;for(;g.pos()<q&&g.next();)switch(g.tag()){case 2:y=g.getUInt32();for(y=g.pos()+y;g.pos()<y;){var J=g.getUInt32();B.push(J);z+=J}y=n(2*z).delta;break;case 3:g.getUInt32();J=2+(this.hasZ?1:0)+(this.hasM?1:0);for(const X of B)if(u+J*X>y.length)for(var P=0;P<X;P++)g.getSInt32(),g.getSInt32(),this.hasZ&&
g.getSInt32(),this.hasM&&g.getSInt32();else if(H){P=this.getAreaSimplificationThreshold(X,this._header.vertexCount);var O=2,K=1,D=g.getSInt32(),I=g.getSInt32();y[u++]=D;y[u++]=I;this.hasZ&&g.getSInt32();this.hasM&&g.getSInt32();var L=g.getSInt32(),R=g.getSInt32();this.hasZ&&g.getSInt32();for(this.hasM&&g.getSInt32();O<X;){var Z=g.getSInt32();let Q=g.getSInt32();this.hasZ&&g.getSInt32();this.hasM&&g.getSInt32();const M=D+L,V=I+R,fa=M+Z,oa=V+Q;.5*Math.abs(D*V+M*oa+fa*I-D*oa-M*I-fa*V)>=P?(E+=-.5*(M-
D)*(V+I),1<K&&c(y[u-2],y[u-1],L,R)?(y[u-2]+=L,y[u-1]+=R):(y[u++]=L,y[u++]=R,K++),D=M,I=V):(Z+=L,Q+=R);L=Z;R=Q;O++}3>K?u-=2*K:(E+=-.5*(D+L-D)*(I+R+I),c(y[u-2],y[u-1],L,R)?(y[u-2]+=L,y[u-1]+=R,x.push(K)):(y[u++]=L,y[u++]=R,x.push(++K)))}else{P=0;O=g.getSInt32();K=g.getSInt32();this.hasZ&&g.getSInt32();this.hasM&&g.getSInt32();y[u++]=O;y[u++]=K;P+=1;for(D=1;D<X;D++)I=g.getSInt32(),L=g.getSInt32(),R=O+I,Z=K+L,E+=-.5*(R-O)*(Z+K),this.hasZ&&g.getSInt32(),this.hasM&&g.getSInt32(),2<D&&c(y[u-2],y[u-1],I,
L)?(y[u-2]+=I,y[u-1]+=L):(y[u++]=I,y[u++]=L,P+=1),O=R,K=Z;x.push(P)}break;default:g.skip()}this._cache.area=E;if(!x.length)return null;if(this._tx||this._ty){g=0;for(const X of x)y[2*g]+=this._tx,y[2*g+1]+=this._ty,g+=X}return new e(x,y)};t._createClass(f,[{key:"geometryType",get:function(){return this._geometryType}},{key:"size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?
1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);return f}(h.FeatureSetReader);r.FeatureSetReaderPBF=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../core/Error","../../../../../rest/query/operations/pbfFeatureServiceParser"],
function(r,t,F){let C=function(){function v(){this.fieldMap=new Map;this.fields=[];this.hasFeatures=!1;this.vertexCount=this.objectIdFieldIndex=this.featureCount=this.fieldCount=0;this.offsets={attributes:[],geometry:[]};this.centroid=[]}var A=v.prototype;A.hasField=function(w){return this.fieldMap.has(w)};A.isDateField=function(w){var l;return null==(l=this.fieldMap.get(w))?void 0:l.isDate};A.getFieldIndex=function(w){var l;return null==(l=this.fieldMap.get(w))?void 0:l.index};return v}();r.FeatureSetHeader=
C;r.parseHeader=function(v,A,w=!1){const l=v.pos(),e=new C;let h=0,k=0,n=null,p=null,c=null,d=!1;for(;v.next();)switch(v.tag()){case 1:n=v.getString();break;case 3:p=v.getString();break;case 12:c=v.processMessage(F.parseTransform);break;case 9:e.exceededTransferLimit=v.getBool();if(e.exceededTransferLimit){e.offsets.geometry=w?new Float64Array(8E3):new Int32Array(8E3);e.centroid=w?new Float64Array(16E3):new Int32Array(16E3);for(var a=0;a<e.centroid.length;a++)e.centroid[a]=268435455}break;case 13:a=
v;var b=a.getLength();b=a.pos()+b;for(var f={name:"",isDate:!1};a.pos()<b&&a.next();)switch(a.tag()){case 1:f.name=a.getString();break;case 2:"esriFieldTypeDate"===F.parseFieldType(a.getEnum())&&(f.isDate=!0);break;default:a.skip()}a=f;f=a.name;b=a.name.toLowerCase().trim();f={fieldName:f,index:h++,isDate:a.isDate};e.fields.push(f);e.fieldMap.set(a.name,f);e.fieldMap.set(b,f);break;case 15:a=v.getLength();a=v.pos()+a;e.exceededTransferLimit||(b=e.centroid,e.offsets.geometry.push(0),b.push(268435455),
b.push(268435455));!d&&e.exceededTransferLimit&&(d=!0,e.offsets.attributes=w?new Float64Array(8E3*h):new Uint32Array(8E3*h));for(b=k*h;v.pos()<a&&v.next();)switch(v.tag()){case 1:d?e.offsets.attributes[b++]=v.pos():e.offsets.attributes.push(v.pos());f=v.getLength();v.skipLen(f);break;case 2:if(A)for(f=v.getLength(),f=v.pos()+f;v.pos()<f&&v.next();)switch(v.tag()){case 3:v.getUInt32();var m=v.getSInt64(),g=v.getSInt64();e.centroid[2*k]=m;e.centroid[2*k+1]=g;break;default:v.skip()}else e.offsets.geometry[k]=
v.pos(),f=v.getLength(),e.vertexCount+=f,v.skipLen(f);break;case 4:f=v.getLength();for(f=v.pos()+f;v.pos()<f&&v.next();)switch(v.tag()){case 3:v.getUInt32();m=v.getSInt64();g=v.getSInt64();e.centroid[2*k]=m;e.centroid[2*k+1]=g;break;default:v.skip()}break;default:v.skip()}k++;e.hasFeatures=!0;break;default:v.skip()}A=n||p;if(!A)throw new t("FeatureSet has no objectId or globalId field name");e.featureCount=k;e.fieldCount=h;e.objectIdFieldIndex=e.getFieldIndex(A);e.transform=c;e.displayIds=new Uint32Array(e.featureCount);
e.groupIds=new Uint16Array(e.featureCount);v.move(l);return e};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../rest/support/Query ./DataTileSubscription ../support/UpdateToken".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){function n(c,d){const a=new Set;c&&c.forEach(b=>a.add(b));d&&d.forEach(b=>a.add(b));return a.has("*")?["*"]:Array.from(a)}let p=function(){function c(a){this.events=new C;this._resolver=w.createResolver();this._didEdit=!1;this._subscriptions=new Map;this._outSR=a.outSR;this._serviceInfo=a.serviceInfo;this._onTileUpdateMessage=a.onMessage}var d=c.prototype;d.destroy=function(){};d._onMessage=function(){var a=t._asyncToGenerator(function*(b){var f,m;const g=this._subscriptions.get(b.id);
if(g)return b={...b,remove:null!=(f=b.remove)?f:[],status:null!=(m=b.status)?m:k.UpdateToken.empty()},w.ignoreAbortErrors(this._onTileUpdateMessage(b,g.options))});return function(b){return a.apply(this,arguments)}}();d.update=function(a,b){var f,m=b.fields.length;b.outFields=n(null==(f=this._schema)?void 0:f.outFields,b.outFields);b.outFields=b.outFields.length>=.75*m?["*"]:b.outFields;b.outFields.sort();if(f=l.diff(this._schema,b)){v("esri-2d-update-debug")&&console.debug("Applying Update - Source:",
f);m="orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC";m={returnCentroid:v("esri-2d-query-centroid-enabled")&&"esriGeometryPolygon"===this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:b.outFields,outSpatialReference:this._outSR,orderByFields:[m],where:b.definitionExpression||"1\x3d1",gdbVersion:b.gdbVersion,
historicMoment:b.historicMoment,timeExtent:F.fromJSON(b.timeExtent)};var g=this._schema&&l.hasDiff(f,"outFields");this._schema&&l.hasDiffAny(f,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(a.why.mesh.push("Layer filter and/or custom parameters changed"),a.why.source.push("Layer filter and/or custom parameters changed"),a.mesh=!0,a.source=!0,a.queryFilter=!0);g&&(a.why.source.push("Layer required fields changed"),a.source=!0);l.diff(m,this._queryInfo)&&(this._queryInfo=
m);this._schema=b;this._resolver.resolve()}};d.whenInitialized=function(){return this._resolver.promise};d.applyUpdate=function(){var a=t._asyncToGenerator(function*(b){b.queryFilter||b.source&&this._didEdit?(this.refresh(),this._didEdit=!1):(this._subscriptions.forEach(f=>f.applyUpdate(b)),yield this.resend())});return function(b){return a.apply(this,arguments)}}();d.refresh=function(){for(const a of this._tiles())this.unsubscribe(a),this.subscribe(a)};d.subscribe=function(a){const b=new h.DataTileSubscription(a);
this._subscriptions.set(a.id,b)};d.unsubscribe=function(a){const b=this.get(a.id);A.isSome(b)&&b.abort();this._subscriptions.delete(a.id)};d.createQuery=function(a={}){return new e({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...a})};d.get=function(a){return this._subscriptions.has(a)?this._subscriptions.get(a):null};d.queryLastEditDate=function(){var a=t._asyncToGenerator(function*(){throw Error("Service does not support query type");
});return function(){return a.apply(this,arguments)}}();d.query=function(){var a=t._asyncToGenerator(function*(b){throw Error("Service does not support query");});return function(b){return a.apply(this,arguments)}}();d._tiles=function*(){const a=Array.from(this._subscriptions.values());for(const b of a)yield b.tile};d.edit=function(){var a=t._asyncToGenerator(function*(b,f){var m=this,g=Array.from(this._subscriptions.values());const x=g.map(({tile:q})=>q);for(const q of g)q.removeIds(f);b.length&&
(g=x.map(q=>{const B=this.createTileQuery(q);B.objectIds=b;return{tile:q,query:B}}).map(function(){var q=t._asyncToGenerator(function*({tile:B,query:z}){return{tile:B,result:yield m.query(z),query:z}});return function(B){return q.apply(this,arguments)}}()),g=(yield w.eachAlwaysValues(g)).map(function(){var q=t._asyncToGenerator(function*({tile:B,result:z}){(z.hasFeatures||f.length||b.length)&&(B=m._subscriptions.get(B.key.id))&&B.edit(z,b)});return function(B){return q.apply(this,arguments)}}()),
yield w.eachAlways(g));this._didEdit=!0});return function(b,f){return a.apply(this,arguments)}}();return c}();r.DataTileSource=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/arrayUtils ./core/has ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){var p;F=p=function(a){function b(m){m=a.call(this,m)||this;m.end=null;m.start=null;return m}r._inheritsLoose(b,a);var f=b.prototype;f.readEnd=function(m,g){return null!=g.end?new Date(g.end):null};f.writeEnd=function(m,g){g.end=m?m.getTime():null};f.readStart=function(m,g){return null!=g.start?new Date(g.start):null};f.writeStart=function(m,g){g.start=m?m.getTime():null};f.clone=function(){return new p({end:this.end,start:this.start})};f.equals=function(m){if(!m)return!1;
const g=C.isSome(this.start)?this.start.getTime():this.start,x=C.isSome(this.end)?this.end.getTime():this.end,q=C.isSome(m.start)?m.start.getTime():m.start;m=C.isSome(m.end)?m.end.getTime():m.end;return g===q&&x===m};f.expandTo=function(m){if(this.isEmpty||this.isAllTime)return this.clone();const g=C.applySome(this.start,q=>v.truncateDate(q,m)),x=C.applySome(this.end,q=>v.offsetDate(v.truncateDate(q,m),1,m));return new p({start:g,end:x})};f.intersection=function(m){if(!m)return this.clone();if(this.isEmpty||
m.isEmpty)return p.empty;if(this.isAllTime)return m.clone();if(m.isAllTime)return this.clone();var g=C.mapOr(this.start,-Infinity,u=>u.getTime());const x=C.mapOr(this.end,Infinity,u=>u.getTime()),q=C.mapOr(m.start,-Infinity,u=>u.getTime());m=C.mapOr(m.end,Infinity,u=>u.getTime());let B,z;q>=g&&q<=x?B=q:g>=q&&g<=m&&(B=g);x>=q&&x<=m?z=x:m>=g&&m<=x&&(z=m);return isNaN(B)||isNaN(z)?p.empty:(g=new p,g.start=-Infinity===B?null:new Date(B),g.end=Infinity===z?null:new Date(z),g)};f.offset=function(m,g){if(this.isEmpty||
this.isAllTime)return this.clone();const x=new p,{start:q,end:B}=this;C.isSome(q)&&(x.start=v.offsetDate(q,m,g));C.isSome(B)&&(x.end=v.offsetDate(B,m,g));return x};f.union=function(m){if(!m||m.isEmpty)return this.clone();if(this.isEmpty)return m.clone();if(this.isAllTime||m.isAllTime)return c.clone();const g=C.isSome(this.start)&&C.isSome(m.start)?new Date(Math.min(this.start.getTime(),m.start.getTime())):null;m=C.isSome(this.end)&&C.isSome(m.end)?new Date(Math.max(this.end.getTime(),m.end.getTime())):
null;return new p({start:g,end:m})};r._createClass(b,[{key:"isAllTime",get:function(){return this.equals(p.allTime)}},{key:"isEmpty",get:function(){return this.equals(p.empty)}}],[{key:"allTime",get:function(){return c}},{key:"empty",get:function(){return d}}]);return b}(F.JSONSupport);t.__decorate([A.property({type:Date,json:{write:{allowNull:!0}}})],F.prototype,"end",void 0);t.__decorate([h.reader("end")],F.prototype,"readEnd",null);t.__decorate([n.writer("end")],F.prototype,"writeEnd",null);t.__decorate([A.property({readOnly:!0,
json:{read:!1}})],F.prototype,"isAllTime",null);t.__decorate([A.property({readOnly:!0,json:{read:!1}})],F.prototype,"isEmpty",null);t.__decorate([A.property({type:Date,json:{write:{allowNull:!0}}})],F.prototype,"start",void 0);t.__decorate([h.reader("start")],F.prototype,"readStart",null);t.__decorate([n.writer("start")],F.prototype,"writeStart",null);F=p=t.__decorate([k.subclass("esri.TimeExtent")],F);const c=new F,d=new F({start:void 0,end:void 0});return F})},"esri/core/timeUtils":function(){define(["exports",
"./has"],function(r,t){function F(A,w,l){return 0===A?0:A*C[w]/C[l]}const C={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},v={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",
setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};r.convertTime=F;r.makeUTCTime=function(A,w,l="milliseconds"){w=new Date(F(w,l,"milliseconds"));w.setUTCFullYear(A.getUTCFullYear(),A.getUTCMonth(),A.getUTCDate());
return w};r.offsetDate=function(A,w,l){A=new Date(A.getTime());if(w&&l){const {getter:h,setter:k,multiplier:n}=v[l];if("months"===l){l=A.getFullYear();var e=A.getMonth()+w;l=new Date(l,e+1,1);l.setDate(0);l=l.getDate();A.getDate()>l&&A.setDate(l)}A[k](A[h]()+w*n)}return A};r.offsetDateUTC=function(A,w,l="milliseconds"){A=A.getTime();w=F(w,l,"milliseconds");return new Date(A+w)};r.resetUTCDate=function(A,w){A=new Date(A.getTime());A.setUTCFullYear(w.getFullYear(),w.getMonth(),w.getDate());return A};
r.timeSinceUTCMidnight=function(A,w="milliseconds"){const l=F(A.getUTCHours(),"hours","milliseconds"),e=F(A.getUTCMinutes(),"minutes","milliseconds"),h=F(A.getUTCSeconds(),"seconds","milliseconds");A=A.getUTCMilliseconds();return F(l+e+h+A,"milliseconds",w)};r.truncateDate=function(A,w){switch(w){case "milliseconds":return new Date(A.getTime());case "seconds":return new Date(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours(),A.getMinutes(),A.getSeconds());case "minutes":return new Date(A.getFullYear(),
A.getMonth(),A.getDate(),A.getHours(),A.getMinutes());case "hours":return new Date(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours());case "days":return new Date(A.getFullYear(),A.getMonth(),A.getDate());case "weeks":return new Date(A.getFullYear(),A.getMonth(),A.getDate()-A.getDay());case "months":return new Date(A.getFullYear(),A.getMonth(),1);case "years":return new Date(A.getFullYear(),0,1);case "decades":return new Date(A.getFullYear()-A.getFullYear()%10,0,1);case "centuries":return new Date(A.getFullYear()-
A.getFullYear()%100,0,1);default:return new Date}};r.truncateLocalTime=function(A){const w=new Date(0);w.setHours(0);w.setMinutes(0);w.setSeconds(0);w.setMilliseconds(0);w.setFullYear(A.getUTCFullYear(),A.getUTCMonth(),A.getUTCDate());return w};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g){var x;const q=new v.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});v=new v.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});A=x=function(B){function z(y){y=B.call(this,y)||this;y.aggregateIds=null;y.cacheHint=void 0;y.compactGeometryEnabled=!1;y.datumTransformation=null;y.defaultSpatialReferenceEnabled=!1;y.distance=void 0;y.dynamicDataSource=void 0;y.formatOf3DObjects=null;y.gdbVersion=null;y.geometry=null;y.geometryPrecision=void 0;y.groupByFieldsForStatistics=null;y.having=null;
y.historicMoment=null;y.maxAllowableOffset=void 0;y.maxRecordCountFactor=1;y.multipatchOption=null;y.num=void 0;y.objectIds=null;y.orderByFields=null;y.outFields=null;y.outSpatialReference=null;y.outStatistics=null;y.parameterValues=null;y.pixelSize=null;y.quantizationParameters=null;y.rangeValues=null;y.relationParameter=null;y.resultType=null;y.returnCentroid=!1;y.returnDistinctValues=!1;y.returnExceededLimitFeatures=!0;y.returnGeometry=!1;y.returnQueryGeometry=!1;y.returnM=void 0;y.returnZ=void 0;
y.sourceSpatialReference=null;y.spatialRelationship="intersects";y.start=void 0;y.sqlFormat=null;y.text=null;y.timeExtent=null;y.timeReferenceUnknownClient=!1;y.units=null;y.where=null;return y}r._inheritsLoose(z,B);z.from=function(y){return c.ensureClass(x,y)};var u=z.prototype;u.castDatumTransformation=function(y){return"number"===typeof y||"object"===typeof y?y:null};u.writeHistoricMoment=function(y,E){E.historicMoment=y&&y.getTime()};u.writeParameterValues=function(y,E){if(y){const H={};for(const J in y){const P=
y[J];Array.isArray(P)?H[J]=P.map(O=>O instanceof Date?O.getTime():O):H[J]=P instanceof Date?P.getTime():P}E.parameterValues=H}};u.writeStart=function(y,E){E.resultOffset=this.start;E.resultRecordCount=this.num||10;E.where="1\x3d1"};u.writeWhere=function(y,E){E.where=y||"1\x3d1"};u.clone=function(){return new x(w.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,
distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:l.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,
outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,
returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return z}(A.JSONSupport);A.MAX_MAX_RECORD_COUNT_FACTOR=5;t.__decorate([e.property({json:{write:!0}})],A.prototype,"aggregateIds",void 0);t.__decorate([e.property({type:Boolean,
json:{write:!0}})],A.prototype,"cacheHint",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"compactGeometryEnabled",void 0);t.__decorate([e.property({json:{write:!0}})],A.prototype,"datumTransformation",void 0);t.__decorate([h.cast("datumTransformation")],A.prototype,"castDatumTransformation",null);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"defaultSpatialReferenceEnabled",void 0);t.__decorate([e.property({type:Number,
json:{write:{overridePolicy(B){return{enabled:0<B}}}}})],A.prototype,"distance",void 0);t.__decorate([e.property({type:a.DataLayerSource,json:{write:!0}})],A.prototype,"dynamicDataSource",void 0);t.__decorate([e.property({type:String,json:{write:!0}})],A.prototype,"formatOf3DObjects",void 0);t.__decorate([e.property({type:String,json:{write:!0}})],A.prototype,"gdbVersion",void 0);t.__decorate([e.property({types:F.geometryTypes,json:{read:d.fromJSON,write:!0}})],A.prototype,"geometry",void 0);t.__decorate([e.property({type:Number,
json:{write:!0}})],A.prototype,"geometryPrecision",void 0);t.__decorate([e.property({type:[String],json:{write:!0}})],A.prototype,"groupByFieldsForStatistics",void 0);t.__decorate([e.property({type:String,json:{write:!0}})],A.prototype,"having",void 0);t.__decorate([e.property({type:Date})],A.prototype,"historicMoment",void 0);t.__decorate([p.writer("historicMoment")],A.prototype,"writeHistoricMoment",null);t.__decorate([e.property({type:Number,json:{write:!0}})],A.prototype,"maxAllowableOffset",
void 0);t.__decorate([e.property({type:Number,cast(B){return 1>B?1:B>x.MAX_MAX_RECORD_COUNT_FACTOR?x.MAX_MAX_RECORD_COUNT_FACTOR:B},json:{write:{overridePolicy(B){return{enabled:1<B}}}}})],A.prototype,"maxRecordCountFactor",void 0);t.__decorate([e.property({type:["xyFootprint"],json:{write:!0}})],A.prototype,"multipatchOption",void 0);t.__decorate([e.property({type:Number,json:{read:{source:"resultRecordCount"}}})],A.prototype,"num",void 0);t.__decorate([e.property({json:{write:!0}})],A.prototype,
"objectIds",void 0);t.__decorate([e.property({type:[String],json:{write:!0}})],A.prototype,"orderByFields",void 0);t.__decorate([e.property({type:[String],json:{write:!0}})],A.prototype,"outFields",void 0);t.__decorate([e.property({type:m,json:{name:"outSR",write:!0}})],A.prototype,"outSpatialReference",void 0);t.__decorate([e.property({type:[f],json:{write:{enabled:!0,overridePolicy(){return{enabled:l.isSome(this.outStatistics)&&0<this.outStatistics.length}}}}})],A.prototype,"outStatistics",void 0);
t.__decorate([e.property({json:{write:!0}})],A.prototype,"parameterValues",void 0);t.__decorate([p.writer("parameterValues")],A.prototype,"writeParameterValues",null);t.__decorate([e.property({type:g,json:{write:!0}})],A.prototype,"pixelSize",void 0);t.__decorate([e.property({type:b,json:{write:!0}})],A.prototype,"quantizationParameters",void 0);t.__decorate([e.property({type:[Object],json:{write:!0}})],A.prototype,"rangeValues",void 0);t.__decorate([e.property({type:String,json:{read:{source:"relationParam"},
write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],A.prototype,"relationParameter",void 0);t.__decorate([e.property({type:String,json:{write:!0}})],A.prototype,"resultType",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnCentroid",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnDistinctValues",void 0);t.__decorate([e.property({type:Boolean,json:{default:!0,
write:!0}})],A.prototype,"returnExceededLimitFeatures",void 0);t.__decorate([e.property({type:Boolean,json:{write:!0}})],A.prototype,"returnGeometry",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnQueryGeometry",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnM",void 0);t.__decorate([e.property({type:Boolean,json:{write:{overridePolicy(B){return{enabled:B}}}}})],A.prototype,"returnZ",void 0);t.__decorate([e.property({type:m,
json:{write:!0}})],A.prototype,"sourceSpatialReference",void 0);t.__decorate([k.enumeration(q,{ignoreUnknown:!1,name:"spatialRel"})],A.prototype,"spatialRelationship",void 0);t.__decorate([e.property({type:Number,json:{read:{source:"resultOffset"}}})],A.prototype,"start",void 0);t.__decorate([p.writer("start"),p.writer("num")],A.prototype,"writeStart",null);t.__decorate([e.property({type:String,json:{write:!0}})],A.prototype,"sqlFormat",void 0);t.__decorate([e.property({type:String,json:{write:!0}})],
A.prototype,"text",void 0);t.__decorate([e.property({type:C,json:{write:!0}})],A.prototype,"timeExtent",void 0);t.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"timeReferenceUnknownClient",void 0);t.__decorate([k.enumeration(v,{ignoreUnknown:!1}),e.property({json:{write:{overridePolicy(B){return{enabled:B&&0<this.distance}}}}})],A.prototype,"units",void 0);t.__decorate([e.property({type:String,json:{write:{overridePolicy(B){return{enabled:null!=B||0<this.start}}}}})],
A.prototype,"where",void 0);t.__decorate([p.writer("where")],A.prototype,"writeWhere",null);return A=x=t.__decorate([n.subclass("esri.rest.support.Query")],A)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m){function g(){z||(z=c.createTypeReader({types:x()}));return z}function x(){u||(u={key:"type",base:null,typeMap:{"data-layer":r.DataLayerSource,"map-layer":a.MapLayerSource}});return u}var q,B;C=C.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});r.JoinTableDataSource=q=function(y){function E(J){J=y.call(this,J)||this;J.type="join-table";return J}t._inheritsLoose(E,y);var H=E.prototype;H.readLeftTableSource=function(J,
P,O){return g()(J,P,O)};H.castLeftTableSource=function(J){return p.ensureOneOfType(x(),J)};H.readRightTableSource=function(J,P,O){return g()(J,P,O)};H.castRightTableSource=function(J){return p.ensureOneOfType(x(),J)};H.clone=function(){var J,P;const {leftTableKey:O,rightTableKey:K,leftTableSource:D,rightTableSource:I,joinType:L}=this,R={leftTableKey:O,rightTableKey:K,leftTableSource:null!=(J=null==D?void 0:D.clone())?J:void 0,rightTableSource:null!=(P=null==I?void 0:I.clone())?P:void 0,joinType:L};
return new q(R)};return E}(v.JSONSupport);F.__decorate([h.enumeration({joinTable:"join-table"})],r.JoinTableDataSource.prototype,"type",void 0);F.__decorate([A.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableKey",void 0);F.__decorate([A.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableKey",void 0);F.__decorate([A.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableSource",void 0);F.__decorate([k.reader("leftTableSource")],
r.JoinTableDataSource.prototype,"readLeftTableSource",null);F.__decorate([e.cast("leftTableSource")],r.JoinTableDataSource.prototype,"castLeftTableSource",null);F.__decorate([A.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableSource",void 0);F.__decorate([k.reader("rightTableSource")],r.JoinTableDataSource.prototype,"readRightTableSource",null);F.__decorate([e.cast("rightTableSource")],r.JoinTableDataSource.prototype,"castRightTableSource",null);F.__decorate([h.enumeration(C)],
r.JoinTableDataSource.prototype,"joinType",void 0);r.JoinTableDataSource=q=F.__decorate([n.subclass("esri.layers.support.source.JoinTableDataSource")],r.JoinTableDataSource);let z=null,u=null;e={key:"type",base:null,typeMap:{"join-table":r.JoinTableDataSource,"query-table":b.QueryTableDataSource,raster:f.RasterDataSource,table:m.TableDataSource}};r.DataLayerSource=B=function(y){function E(H){H=y.call(this,H)||this;H.type="data-layer";return H}t._inheritsLoose(E,y);E.prototype.clone=function(){const {fields:H,
dataSource:J}=this;return new B({fields:H,dataSource:J})};return E}(v.JSONSupport);F.__decorate([h.enumeration({dataLayer:"data-layer"})],r.DataLayerSource.prototype,"type",void 0);F.__decorate([A.property({type:[d],json:{write:!0}})],r.DataLayerSource.prototype,"fields",void 0);F.__decorate([A.property({types:e,json:{write:!0}})],r.DataLayerSource.prototype,"dataSource",void 0);r.DataLayerSource=B=F.__decorate([n.subclass("esri.layers.support.source.DataLayerSource")],r.DataLayerSource);r.DataLayerSource.from=
p.ensureType(r.DataLayerSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){var c;const d=new F.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});F=c=function(a){function b(m){m=a.call(this,m)||this;
m.alias=null;m.defaultValue=void 0;m.description=null;m.domain=null;m.editable=!0;m.length=-1;m.name=null;m.nullable=!0;m.type=null;m.valueType=null;return m}r._inheritsLoose(b,a);var f=b.prototype;f.readDescription=function(m,{description:g}){let x;try{x=JSON.parse(g)}catch(q){}return x?x.value:null};f.readValueType=function(m,{description:g}){let x;try{x=JSON.parse(g)}catch(q){}return x?d.fromJSON(x.fieldValueType):null};f.clone=function(){return new c({alias:this.alias,defaultValue:this.defaultValue,
description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};return b}(C.JSONSupport);t.__decorate([v.property({type:String,json:{write:!0}})],F.prototype,"alias",void 0);t.__decorate([v.property({type:[String,Number],json:{write:{allowNull:!0}}})],F.prototype,"defaultValue",void 0);t.__decorate([v.property()],F.prototype,"description",void 0);t.__decorate([h.reader("description")],
F.prototype,"readDescription",null);t.__decorate([v.property({types:n.types,json:{read:{reader:n.fromJSON},write:!0}})],F.prototype,"domain",void 0);t.__decorate([v.property({type:Boolean,json:{write:!0}})],F.prototype,"editable",void 0);t.__decorate([v.property({type:l.Integer,json:{write:!0}})],F.prototype,"length",void 0);t.__decorate([v.property({type:String,json:{write:!0}})],F.prototype,"name",void 0);t.__decorate([v.property({type:Boolean,json:{write:!0}})],F.prototype,"nullable",void 0);t.__decorate([e.enumeration(p.kebabDict)],
F.prototype,"type",void 0);t.__decorate([v.property()],F.prototype,"valueType",void 0);t.__decorate([h.reader("valueType",["description"])],F.prototype,"readValueType",null);return F=c=t.__decorate([k.subclass("esri.layers.support.Field")],F)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(r,t,F,C,v,A){t={key:"type",base:C,typeMap:{range:A,"coded-value":F,inherited:v}};r.CodedValueDomain=F;
r.DomainBase=C;r.InheritedDomain=v;r.RangeDomain=A;r.fromJSON=function(w){if(!w||!w.type)return null;switch(w.type){case "range":return A.fromJSON(w);case "codedValue":return F.fromJSON(w);case "inherited":return v.fromJSON(w)}return null};r.types=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(r,t,F,C,v,A,w,l,e){var h;v=h=function(k){function n(c){c=k.call(this,c)||this;c.codedValues=null;c.type="coded-value";return c}r._inheritsLoose(n,k);var p=n.prototype;p.getName=function(c){let d=null;if(this.codedValues){const a=String(c);this.codedValues.some(b=>{String(b.code)===a&&(d=b.name);return!!d})}return d};p.clone=function(){return new h({codedValues:F.clone(this.codedValues),name:this.name})};return n}(e);t.__decorate([C.property({type:[l.default],json:{write:!0}})],v.prototype,
"codedValues",void 0);t.__decorate([A.enumeration({codedValue:"coded-value"})],v.prototype,"type",void 0);return v=h=t.__decorate([w.subclass("esri.layers.support.CodedValueDomain")],v)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e){var h;r.CodedValue=h=function(k){function n(p){p=k.call(this,p)||this;p.name=null;p.code=null;return p}t._inheritsLoose(n,k);n.prototype.clone=function(){return new h({name:this.name,code:this.code})};return n}(C.JSONSupport);F.__decorate([v.property({type:String,json:{write:!0}})],r.CodedValue.prototype,"name",void 0);F.__decorate([v.property({type:[String,Number],json:{write:!0}})],r.CodedValue.prototype,"code",void 0);r.CodedValue=h=F.__decorate([e.subclass("esri.layers.support.CodedValue")],
r.CodedValue);r.default=r.CodedValue;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w,l,e,h){F=
new F.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});C=function(k){function n(p){p=k.call(this,p)||this;p.name=null;p.type=null;return p}r._inheritsLoose(n,k);return n}(C.JSONSupport);t.__decorate([v.property({type:String,json:{write:!0}})],C.prototype,"name",void 0);t.__decorate([e.enumeration(F)],C.prototype,"type",void 0);return C=t.__decorate([h.subclass("esri.layers.support.Domain")],C)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/set ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k;F=k=function(n){function p(c){c=n.call(this,c)||this;c.type="inherited";return c}r._inheritsLoose(p,n);p.prototype.clone=function(){return new k};return p}(h);t.__decorate([l.enumeration({inherited:"inherited"})],F.prototype,"type",void 0);return F=k=t.__decorate([e.subclass("esri.layers.support.InheritedDomain")],F)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,t,F,C,v,A,w,l,e){var h;C=h=function(k){function n(p){p=k.call(this,p)||this;p.maxValue=null;p.minValue=null;p.type="range";return p}r._inheritsLoose(n,k);n.prototype.clone=function(){return new h({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return n}(e);t.__decorate([F.property({type:Number,json:{type:[Number],read:{source:"range",reader(k,n){return n.range&&n.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",
writer(k,n,p){n[p]=[this.minValue||0,k]}}}})],C.prototype,"maxValue",void 0);t.__decorate([F.property({type:Number,json:{type:[Number],read:{source:"range",reader(k,n){return n.range&&n.range[0]}},write:{target:"range",writer(k,n,p){n[p]=[k,this.maxValue||0]}}}})],C.prototype,"minValue",void 0);t.__decorate([w.enumeration({range:"range"})],C.prototype,"type",void 0);return C=h=t.__decorate([l.subclass("esri.layers.support.RangeDomain")],C)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k;r.MapLayerSource=k=function(n){function p(c){c=n.call(this,c)||this;c.type="map-layer";return c}t._inheritsLoose(p,n);p.prototype.clone=function(){const {mapLayerId:c,gdbVersion:d}=this;return new k({mapLayerId:c,gdbVersion:d})};return p}(C.JSONSupport);F.__decorate([e.enumeration({mapLayer:"map-layer"})],r.MapLayerSource.prototype,"type",void 0);F.__decorate([v.property({type:l.Integer,json:{write:!0}})],r.MapLayerSource.prototype,"mapLayerId",void 0);F.__decorate([v.property({type:String,
json:{write:!0}})],r.MapLayerSource.prototype,"gdbVersion",void 0);r.MapLayerSource=k=F.__decorate([h.subclass("esri.layers.support.source.MapLayerSource")],r.MapLayerSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){var c;r.QueryTableDataSource=c=function(d){function a(b){b=d.call(this,b)||this;b.type="query-table";return b}t._inheritsLoose(a,d);a.prototype.clone=function(){var b;const {workspaceId:f,query:m,oidFields:g,spatialReference:x,geometryType:q}=this,B={workspaceId:f,query:m,oidFields:g,spatialReference:null!=(b=null==x?void 0:x.clone())?b:void 0,geometryType:q};return new c(B)};return a}(v.JSONSupport);F.__decorate([h.enumeration({queryTable:"query-table"})],r.QueryTableDataSource.prototype,
"type",void 0);F.__decorate([A.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"workspaceId",void 0);F.__decorate([A.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"query",void 0);F.__decorate([A.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"oidFields",void 0);F.__decorate([A.property({type:n,json:{write:!0}})],r.QueryTableDataSource.prototype,"spatialReference",void 0);F.__decorate([h.enumeration(p.featureGeometryTypeKebabDictionary)],
r.QueryTableDataSource.prototype,"geometryType",void 0);r.QueryTableDataSource=c=F.__decorate([k.subclass("esri.layers.support.source.QueryTableDataSource")],r.QueryTableDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k;r.RasterDataSource=k=function(n){function p(c){c=n.call(this,c)||this;c.type="raster";return c}t._inheritsLoose(p,n);p.prototype.clone=function(){const {workspaceId:c,dataSourceName:d}=this;return new k({workspaceId:c,dataSourceName:d})};return p}(C.JSONSupport);F.__decorate([e.enumeration({raster:"raster"})],r.RasterDataSource.prototype,"type",void 0);F.__decorate([v.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"dataSourceName",void 0);
F.__decorate([v.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"workspaceId",void 0);r.RasterDataSource=k=F.__decorate([h.subclass("esri.layers.support.source.RasterDataSource")],r.RasterDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k;r.TableDataSource=k=function(n){function p(c){c=n.call(this,c)||this;c.type="table";return c}t._inheritsLoose(p,n);p.prototype.clone=function(){const {workspaceId:c,gdbVersion:d,dataSourceName:a}=this;return new k({workspaceId:c,gdbVersion:d,dataSourceName:a})};return p}(C.JSONSupport);F.__decorate([e.enumeration({table:"table"})],r.TableDataSource.prototype,"type",void 0);F.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"workspaceId",
void 0);F.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"gdbVersion",void 0);F.__decorate([v.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"dataSourceName",void 0);r.TableDataSource=k=F.__decorate([h.subclass("esri.layers.support.source.TableDataSource")],r.TableDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(r,t,F,C,v,A,w,l,e,h){var k;F=new C.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});v=k=function(n){function p(c){c=n.call(this,c)||this;c.extent=null;c.mode="view";c.originPosition="upper-left";c.tolerance=1;return c}r._inheritsLoose(p,n);p.prototype.clone=function(){return new k(A.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return p}(v.JSONSupport);t.__decorate([w.property({type:h,json:{write:{overridePolicy(){return{enabled:"view"===
this.mode}}}}})],v.prototype,"extent",void 0);t.__decorate([w.property({type:["view","edit"],json:{write:!0}})],v.prototype,"mode",void 0);t.__decorate([w.property({type:String,json:{read:F.read,write:F.write}})],v.prototype,"originPosition",void 0);t.__decorate([w.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"tolerance",void 0);return v=k=t.__decorate([e.subclass("esri.rest.support.QuantizationParameters")],v)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(r,t,F,C,v,A,w,l,e){var h;F=new F.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});C=h=function(k){function n(c){c=k.call(this,c)||this;c.maxPointCount=void 0;c.maxRecordCount=void 0;c.maxVertexCount=void 0;c.onStatisticField=
null;c.outStatisticFieldName=null;c.statisticType=null;c.statisticParameters=null;return c}r._inheritsLoose(n,k);var p=n.prototype;p.writeStatisticParameters=function(c,d){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)d.statisticParameters=v.clone(c)};p.clone=function(){return new h({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,
statisticType:this.statisticType,statisticParameters:v.clone(this.statisticParameters)})};return n}(C.JSONSupport);t.__decorate([A.property({type:Number,json:{write:!0}})],C.prototype,"maxPointCount",void 0);t.__decorate([A.property({type:Number,json:{write:!0}})],C.prototype,"maxRecordCount",void 0);t.__decorate([A.property({type:Number,json:{write:!0}})],C.prototype,"maxVertexCount",void 0);t.__decorate([A.property({type:String,json:{write:!0}})],C.prototype,"onStatisticField",void 0);t.__decorate([A.property({type:String,
json:{write:!0}})],C.prototype,"outStatisticFieldName",void 0);t.__decorate([A.property({type:String,json:{read:{source:"statisticType",reader:F.read},write:{target:"statisticType",writer:F.write}}})],C.prototype,"statisticType",void 0);t.__decorate([A.property({type:Object})],C.prototype,"statisticParameters",void 0);t.__decorate([e.writer("statisticParameters")],C.prototype,"writeStatisticParameters",null);return C=h=t.__decorate([l.subclass("esri.rest.support.StatisticDefinition")],C)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/maybe ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,t,F,C,v,A){let w=function(){function l(h){this.requests={done:[],stream:new F(10)};this._edits=null;this._abortController=new AbortController;this.didSend=this._done=!1;this.tile=h}var e=l.prototype;e.end=function(){this._done=!0};e.clear=function(){this.requests.done=[]};e.applyUpdate=function(h){this.requests.done.forEach(k=>k.message.status.unset(h));C.isSome(this._edits)&&this._edits.status.unset(h)};e.add=function(h){var k;h.message.status=null!=(k=h.message.status)?k:A.UpdateToken.empty();
h.message.end&&this.requests.done.forEach(n=>{C.isSome(n.message)&&n.message.end&&(n.message.end=!1)});this.requests.done.push(h)};e.edit=function(h,k){const n=h.getQuantizationTransform(),p=h.fullSchema(),c=Array.from(h.features()),d=c.map(a=>a.objectId);k=[...k,...d];this.removeIds(k);this._invalidate();C.isNone(this._edits)?this._edits={type:"append",addOrUpdate:v.FeatureSetReaderJSON.fromOptimizedFeatures(c,p,C.unwrap(n)),id:this.tile.id,status:A.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(a=>
a.message.end=!1),C.unwrap(this._edits.addOrUpdate).append(h.features()))};e.readers=function*(){for(const {message:h}of this.requests.done)C.isSome(h.addOrUpdate)&&(yield h.addOrUpdate);C.isSome(this._edits)&&C.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};e._invalidate=function(){for(const h of this.requests.done)h.message.status=A.UpdateToken.empty();C.isSome(this._edits)&&(this._edits.status=A.UpdateToken.empty())};e.removeIds=function(h){this._invalidate();for(const {message:k}of this.requests.done){const n=
k.addOrUpdate;C.isSome(n)&&(n.removeIds(h),n.isEmpty&&(k.addOrUpdate=null))}C.isSome(this._edits)&&C.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(h);this.requests.done=this.requests.done.filter(k=>k.message.addOrUpdate||k.message.end)};e.abort=function(){this._abortController.abort()};t._createClass(l,[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length}},
{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._done}}]);return l}();r.DataTileSubscription=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports"],function(r){let t=function(){function F(){this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}F.create=function(v){const A=new F;for(const w in v){const l=
v[w];if("object"===typeof l)for(const e in l)A[w][e]=l[e];A[w]=l}return A};F.empty=function(){return F.create({})};F.all=function(){return F.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})};var C=F.prototype;C.unset=function(v){v.source&&(this.source=!1);v.targets.feature&&(this.targets.feature=!1);v.targets.aggregate&&(this.targets.aggregate=!1);v.storage.filters&&(this.storage.filters=!1);v.storage.data&&(this.storage.data=!1);v.mesh&&(this.mesh=!1);v.queryFilter&&
(this.queryFilter=!1)};C.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};C.describe=function(){let v=0,A="";if(this.mesh){v+=20;A+="-\x3e (20) Mesh needs update\n";for(const w of this.why.mesh)A+=`    + ${w}\n`}if(this.source){v+=10;A+="-\x3e (10) The source needs update\n";for(const w of this.why.source)A+=`    + ${w}\n`}this.targets.feature&&(v+=5,A+="-\x3e (5) Feature target parameters changed\n");
this.storage.filters&&(v+=5,A+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(v+=4,A+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(v+=1,A+="-\x3e (1) Texture storage parameters changed");console.debug(`Applying ${5>v?"Fastest":10>v?"Fast":15>v?"Moderate":20>v?"Slow":"Very Slow"} update of cost ${v}/45 `);console.debug(A)};C.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};
return F}();r.UpdateToken=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),function(r,t,F,C,v,A){let w=function(e,h){this.item=e;this.controller=h;this.promise=null},l=function(){function e(k){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=
this._schedule=null;this.concurrency=1;k.concurrency&&(this.concurrency=k.concurrency);this._queue=new v(k.peeker);this.process=k.process;const n=k.scheduler;k.priority&&F.isSome(n)&&(this._task=n.registerTask(k.priority,this))}var h=e.prototype;h.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};h.abort=function(k){(k=this._controllers.get(k))&&k.abort()};h.clear=function(){this._queue.clear();const k=
[];this._controllers.forEach(n=>k.push(n));this._controllers.clear();k.forEach(n=>n.abort());this._processingItems.clear();this._cancelNext()};h.forEach=function(k){this._deferreds.forEach((n,p)=>k(p))};h.get=function(k){return(k=this._deferreds.get(k))?k.promise:void 0};h.isOngoing=function(k){return this._processingItems.has(k)};h.has=function(k){return this._deferreds.has(k)};h.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};h.push=function(k,n){const p=this.get(k);if(p)return p;
const c=new AbortController;let d=null;n&&(d=C.onAbort(n,()=>c.abort()));const a=()=>{b.remove();F.isSome(d)&&d.remove();this._deferreds.delete(k);this._controllers.delete(k);this._queue.remove(k);this._processingItems.delete(k);this._scheduleNext()},b=C.onAbortOrThrow(c.signal,()=>{const m=this._processingItems.get(k);m&&m.controller.abort();a();f.reject(C.createAbortError())}),f=C.createDeferred();this._deferreds.set(k,f);this._controllers.set(k,c);f.promise.then(a,a);this._queue.push(k);this._scheduleNext();
return f.promise};h.last=function(){return this._queue.last()};h.peek=function(){return this._queue.peek()};h.popLast=function(){return this._queue.popLast()};h.reset=function(){const k=[];this._processingItems.forEach(n=>k.push(n));this._processingItems.clear();for(const n of k)this._queue.push(n.item),n.controller.abort();this._scheduleNext()};h.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};h.takeAll=function(){const k=[];for(;this._queue.length;)k.push(this._queue.pop());
this.clear();return k};h.runTask=function(k){for(;!k.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),k.madeProgress()};h._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=A.schedule(()=>{this._schedule=null;this._next()}))};h._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};h._cancelNext=function(){this._schedule&&(this._schedule.remove(),
this._schedule=null)};h._processResult=function(k,n){this._canProcessFulfillment(k)&&(this._scheduleNext(),this._deferreds.get(k.item).resolve(n))};h._processError=function(k,n){this._canProcessFulfillment(k)&&(this._scheduleNext(),this._deferreds.get(k.item).reject(n))};h._canProcessFulfillment=function(k){return this._deferreds.get(k.item)&&this._processingItems.get(k.item)===k?!0:!1};h._process=function(k){if(!F.isNone(k)){var n=new AbortController,p=new w(k,n);this._processingItems.set(k,p);try{var c=
this.process(k,n.signal)}catch(d){this._processError(p,d)}C.isPromiseLike(c)?(p.promise=c,c.then(d=>this._processResult(p,d),d=>this._processError(p,d))):this._processResult(p,c)}};t._createClass(e,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:k=>this.runTask(k)}}}]);return e}();r.QueueProcessor=l;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(r,t){return function(){function F(v=A=>A.values().next().value){this._peeker=v;this._items=new Set}var C=F.prototype;C.clear=function(){this._items.clear()};C.last=function(){if(0!==this._items.size){for(var v of this._items);return v}};C.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};C.push=function(v){this.contains(v)||this._items.add(v)};C.contains=
function(v){return this._items.has(v)};C.pop=function(){if(0!==this.length){var v=this.peek();this._items.delete(t.assumeNonNull(v));return v}};C.popLast=function(){if(0!==this.length){var v=this.last();this._items.delete(t.assumeNonNull(v));return v}};C.remove=function(v){this._items.delete(v)};C.filter=function(v){this._items.forEach(A=>{v(A)||this._items.delete(A)});return this};r._createClass(F,[{key:"length",get:function(){return this._items.size}}]);return F}()})},"esri/views/2d/layers/features/sources/GeoEventSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){function p(b,f){const m=b.weakClone();if(C.isSome(b.geometry)){const g=A.quantizeX(f,b.geometry.coords[0]);b=A.quantizeY(f,b.geometry.coords[1]);m.geometry=new w([],[g,b])}return m}function c(b){switch(b){case "esriGeometryPoint":return p;default:return(f,m)=>{const g=f.weakClone(),x=new w;f=A.quantizeOptimizedGeometry(x,f.geometry,!1,!1,b,m,!1,!1);g.geometry=f;return g}}}function d(b){switch(b){case "esriGeometryPoint":return f=>C.isSome(f.geometry)?{minX:f.geometry.coords[0],
minY:f.geometry.coords[1],maxX:f.geometry.coords[0],maxY:f.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return f=>{let m=Infinity,g=Infinity,x=-Infinity,q=-Infinity;C.isSome(f.geometry)&&f.geometry.forEachVertex((B,z)=>{m=Math.min(m,B);g=Math.min(g,z);x=Math.max(x,B);q=Math.max(q,z)});return{minX:m,minY:g,maxX:x,maxY:q}}}}let a=function(){function b(m,g){this.onUpdate=m;this._geometryType=g;this._objectIdToFeature=new Map}var f=b.prototype;f.add=function(m){this._objectIdToFeature.set(m.objectId,
m);this._index=null};f.get=function(m){return this._objectIdToFeature.has(m)?this._objectIdToFeature.get(m):null};f.forEach=function(m){this._objectIdToFeature.forEach(m)};f.search=function(m){if(!this._index){{var g=this._features;const x=v.rbush(9,d(this._geometryType));x.load(g);g=x}this._index=g}return this._index.search({minX:m.bounds[0],minY:m.bounds[1],maxX:m.bounds[2],maxY:m.bounds[3]})};f.removeById=function(m){const g=this._objectIdToFeature.get(m);return g?(this._objectIdToFeature.delete(m),
this._index=null,g):null};f.update=function(m,g){this.onUpdate(m,g)};t._createClass(b,[{key:"_features",get:function(){const m=[];this._objectIdToFeature.forEach(g=>m.push(g));return m}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return b}();F=function(b){function f(g){var x=b.call(this,g)||this;x.type="geoevent";x._dataReceiveEventEnabled=!1;x._level=0;x._updateInfo={websocket:0,client:0};var {outSR:q}=g;const {geometryType:B,objectIdField:z,timeInfo:u,purgeOptions:y,source:E,
spatialReference:H,serviceFilter:J,maxReconnectionAttempts:P,maxReconnectionInterval:O,updateInterval:K,enableDataReceived:D,customParameters:I}=g.serviceInfo,L=new a(x._onUpdate.bind(t._assertThisInitialized(x)),B),R=new l.StreamFeatureManager(L,z,u,y);q=e.createConnection(E,H,q,B,J,P,O,I);x._store=L;x._manager=R;x._connection=q;x._quantize=c(B);x._dataReceiveEventEnabled=D;x._handles=[x._connection.on("feature",Z=>x._onFeature(Z)),x._connection.watch("connectionStatus",Z=>x.events.emit("connectionStatus",
Z)),x._connection.watch("errorString",Z=>x.events.emit("errorString",Z))];x._initUpdateInterval=()=>{let Z=performance.now();x._updateIntervalId=setInterval(()=>{var X=performance.now(),Q=X-Z;2500<Q&&(Z=X,X=Math.round(x._updateInfo.client/(Q/1E3)),Q=Math.round(x._updateInfo.websocket/(Q/1E3)),x._updateInfo.client=0,x._updateInfo.websocket=0,x.events.emit("updateRate",{client:X,websocket:Q}));g.canAcceptRequest()&&x._manager.checkForUpdates()},K)};x._initUpdateInterval();return x}t._inheritsLoose(f,
b);var m=f.prototype;m.destroy=function(){b.prototype.destroy.call(this);this._clearUpdateInterval();this._handles.forEach(g=>g.remove());this._connection.destroy()};m._fetchDataTile=function(){};m.pauseStream=function(){this._clearUpdateInterval()};m.resumeStream=function(){this._initUpdateInterval()};m.enableEvent=function(g,x){"data-received"===g&&(this._dataReceiveEventEnabled=x)};m.subscribe=function(g){b.prototype.subscribe.call(this,g);const x=this._subscriptions.get(g.id);this._level=g.level;
const q=this._getTileFeatures(g);this._onMessage({type:"append",id:g.key.id,addOrUpdate:q,end:!0});x.didSend=!0};m.unsubscribe=function(g){b.prototype.unsubscribe.call(this,g)};m.readers=function*(g){g=this._subscriptions.get(g);const {tile:x}=g;yield this._getTileFeatures(x);for(const q of g.requests.stream.entries)C.isSome(q)&&C.isSome(q.addOrUpdate)&&(yield q.addOrUpdate)};m.createTileQuery=function(g){throw Error("Service does not support tile  queries");};m.resend=function(){var g=t._asyncToGenerator(function*(){this._subscriptions.forEach(x=>
{({tile:x}=x);x={type:"append",id:x.id,addOrUpdate:this._getTileFeatures(x),end:!0};this._onMessage(x)})});return function(){return g.apply(this,arguments)}}();m._getTileFeatures=function(g){const x=this._store.search(g).map(q=>this._quantize(q,g.transform));return k.FeatureSetReaderJSON.fromOptimizedFeatures(x,this._serviceInfo,g.transform)};m._onFeature=function(g){this._updateInfo.websocket++;try{this._dataReceiveEventEnabled&&this.events.emit("feature",g);const x=A.convertFromFeature(g,this._serviceInfo.geometryType,
!1,!1,this._serviceInfo.objectIdField);this._manager.add(x)}catch(x){}};m._clearUpdateInterval=function(){clearInterval(this._updateIntervalId);this._updateIntervalId=0};m._onUpdate=function(g,x){C.isSome(g)&&(this._updateInfo.client+=g.length);this._subscriptions.forEach((q,B)=>{q.didSend&&q.tile.level===this._level&&this._onMessage({type:"append",id:B,addOrUpdate:null,clear:!0,end:!1})});this._subscriptions.forEach((q,B)=>{if(q.didSend&&q.tile.level===this._level){var z=this._getTileFeatures(q.tile);
B={type:"append",id:B,addOrUpdate:z,remove:[],end:!0,status:n.UpdateToken.empty()};q.requests.stream.enqueue(B);this._onMessage(B)}})};t._createClass(f,[{key:"updating",get:function(){return!1}}]);return f}(h.DataTileSource);r.GeoEventSource=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(r,t,F,C){let v=function(){function A(l,
e,h,k,n=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=h;this._purgeOptions=k;this.store=l;this.objectIdField=e;this.purgeInterval=n;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var w=A.prototype;w.add=function(l){if(this._useGeneratedIds){var e=this._nextId();l.attributes[this.objectIdField]=e;l.objectId=e}else l.objectId=l.attributes[this.objectIdField];this._addOrUpdated.set(l.objectId,
l);this._maxAge=Math.max(this._maxAge,l.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){e=l.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(e)){var h=C.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3;h=F.clamp(h,0,1E3);this._trackIdToObservations.set(e,new t(h))}l=this._trackIdToObservations.get(e).enqueue(l.objectId);C.isSome(l)&&(this._addOrUpdated.has(l)?this._addOrUpdated.delete(l):
this._removed.push(l))}else C.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=new t(1E5)),this._trackIdLessObservations.enqueue(l.objectId)};w.checkForUpdates=function(){const l=this._getToAdd();var e=this._getToRemove();const h=performance.now();h-this._lastPurge>=this.purgeInterval&&(this._purge(h),this._lastPurge=h);const k=[];if(C.isSome(e))for(const n of e)e=this.store.removeById(n),C.isSome(e)&&k.push(e);if(C.isSome(l))for(const n of l)n.attributes.__esri_timestamp__=h,
this.store.add(n);(l||k)&&this.store.update(l,k)};w._getToAdd=function(){if(!this._addOrUpdated.size)return null;const l=Array(this._addOrUpdated.size);let e=0;this._addOrUpdated.forEach(h=>l[e++]=h);this._addOrUpdated.clear();return l};w._getToRemove=function(){const l=this._removed;if(!this._removed.length)return null;this._removed=[];return l};w._nextId=function(){const l=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return l};w._purge=function(l){const e=this._purgeOptions;
C.isSome(e)&&(this._purgeSomeByDisplayCount(e),this._purgeByAge(e),this._purgeByAgeReceived(l,e),this._purgeTracks())};w._purgeSomeByDisplayCount=function(l){if(l.displayCount){var e=this.store.size;if(e>l.displayCount){if(this._timeInfo.trackIdField)for(const h of this._trackIdToObservations.values())if(e>l.displayCount&&h.size){const k=C.unwrap(h.dequeue());this._removed.push(k);e--}if(C.isSome(this._trackIdLessObservations))for(l=e-l.displayCount;0<l--;)e=this._trackIdLessObservations.dequeue(),
C.isSome(e)&&this._removed.push(e)}}};w._purgeByAge=function(l){var e;if(l.age&&null!=(e=this._timeInfo)&&e.startTimeField){var h=this._maxAge-6E4*l.age;this.store.forEach(k=>{k.attributes[this._timeInfo.startTimeField]<h&&this._removed.push(k.objectId)})}};w._purgeByAgeReceived=function(l,e){if(e.ageReceived){var h=l-6E4*e.ageReceived;this.store.forEach(k=>{k.attributes.__esri_timestamp__<h&&this._removed.push(k.objectId)})}};w._purgeTracks=function(){this._trackIdToObservations.forEach((l,e)=>{0===
l.size&&this._trackIdToObservations.delete(e)})};return A}();r.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";r.ESRI_TIMESTAMP="__esri_timestamp__";r.StreamFeatureManager=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection","./WebSocketConnection"],function(r,t,F){r.createConnection=function(C,v,A,w,l,e,h,k){const n=0===C.path.indexOf("wss://")||0===C.path.indexOf("ws://");C={source:C,sourceSpatialReference:v,
spatialReference:A,geometryType:w,filter:l,maxReconnectionAttempts:e,maxReconnectionInterval:h,customParameters:k};return n?new F.WebSocketConnection(C):new t(C)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g){const x=w.getLogger("esri.layers.graphics.sources.connections.GeoEventConnection"),q={maxQueryDepth:5,maxRecordCountFactor:3};C=function(B){function z(y){return B.call(this,{...q,...y})||this}t._inheritsLoose(z,B);var u=z.prototype;u._open=function(){var y=t._asyncToGenerator(function*(){var E=yield this._fetchServiceDefinition(this._config.source);E.timeInfo.trackIdField||x.warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
E=this._fetchWebSocketUrl(E.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());yield this._buddyServicesQuery;yield this._tryCreateWebSocket(E);const {filter:H,outFields:J}=this._config;this.destroyed||this._setFilter(H,J)});return function(){return y.apply(this,arguments)}}();u._onMessage=function(y){let E;try{E=this._enrich(JSON.parse(y.data)),l.isSome(this._featureZScaler)&&this._featureZScaler(E.geometry)}catch(H){x.error(new A("geoevent-connection",
"Failed to parse message",H));return}this.onFeature(E)};u._fetchServiceDefinition=function(){var y=t._asyncToGenerator(function*(E){return this._serviceDefinition=E=(yield v(E.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data});return function(E){return y.apply(this,arguments)}}();u._fetchWebSocketUrl=function(y,E){const {urls:H,token:J}=y[0];y=this._inferWebSocketBaseUrl(H);return h.addQueryParameters(`${y}/subscribe`,{outSR:""+E.wkid,token:J})};u._inferWebSocketBaseUrl=
function(y){if(1===y.length)return y[0];for(const E of y)if(-1!==E.indexOf("wss"))return E;x.error(new A("geoevent-connection","Unable to infer WebSocket url",y));return null};u._setFilter=function(){var y=t._asyncToGenerator(function*(E,H){const J=this._websocket;if(!(l.isNone(J)||l.isNone(E)&&l.isNone(H))){E=JSON.stringify({filter:this._serializeFilter(E,H)});var P=!1,O=e.createResolver();J.onmessage=K=>{K=JSON.parse(K.data);K.filter&&(K.error&&(x.error(new A("geoevent-connection","Failed to set service filter",
K.error)),this._set("errorString",`Could not set service filter - ${K.error}`),O.reject(K.error)),J.onmessage=this._onMessage.bind(this),P=!0,O.resolve())};J.send(E);setTimeout(()=>{P||(this.destroyed||this._websocket!==J||x.error(new A("geoevent-connection","Server timed out when setting filter")),O.reject())},1E4);return O.promise}});return function(E,H){return y.apply(this,arguments)}}();u._serializeFilter=function(y,E){const H={};if(l.isNone(y)&&l.isNone(E))return H;if(l.isSome(y)&&y.geometry)try{const J=
m.fromJSON(y.geometry);if("extent"!==J.type)throw new A(`Expected extent but found type ${J.type}`);H.geometry=JSON.stringify(J.shiftCentralMeridian())}catch(J){x.error(new A("geoevent-connection","Encountered an error when setting connection geometryDefinition",J))}l.isSome(y)&&y.where&&"1 \x3d 1"!==y.where&&(H.where=y.where);l.isSome(E)&&(H.outFields=E.join(","));return H};u._enrich=function(y){if(!this._relatedFeatures)return y;const E=y.attributes[this._serviceDefinition.relatedFeatures.joinField];
if(!this._relatedFeatures.has(E))return x.warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",y),y;const {attributes:H,geometry:J}=this._relatedFeatures.get(E);for(const P in H)y.attributes[P]=H[P];J&&(y.geometry=J);y.geometry||y.centroid||x.error(new A("geoevent-connection","Found malformed feature - no geometry found",y));return y};u._queryBuddyServices=function(){var y=t._asyncToGenerator(function*(){try{const {relatedFeatures:E,keepLatestArchive:H}=this._serviceDefinition,
J=this._queryRelatedFeatures(E),P=this._queryArchive(H);yield J;const O=yield P;if(O)for(const K of O.features)this.onFeature(this._enrich(K))}catch(E){x.error(new A("geoevent-connection","Encountered an error when querying buddy services",{error:E}))}});return function(){return y.apply(this,arguments)}}();u._queryRelatedFeatures=function(){var y=t._asyncToGenerator(function*(E){E&&(E=yield this._queryBuddy(E.featuresUrl),this._addRelatedFeatures(E))});return function(E){return y.apply(this,arguments)}}();
u._queryArchive=function(){var y=t._asyncToGenerator(function*(E){if(E)return this._queryBuddy(E.featuresUrl)});return function(E){return y.apply(this,arguments)}}();u._queryBuddy=function(){var y=t._asyncToGenerator(function*(E){const H=new (yield new Promise((L,R)=>r(["../../../FeatureLayer"],Z=>L(Object.freeze({__proto__:null,default:Z})),R))).default({url:E});var {capabilities:J}=yield H.load();const P=J.query.supportsMaxRecordCountFactor,O=J.query.supportsPagination;J=J.query.supportsCentroid;
const K=this._config.maxRecordCountFactor;var D=H.capabilities.query.maxRecordCount;D=P?D*K:D;const I=new f;I.outFields=l.unwrapOr(this._config.outFields,["*"]);I.where=l.unwrapOr(l.get(this._config.filter,"where"),"1\x3d1");I.returnGeometry=!0;I.returnExceededLimitFeatures=!0;I.outSpatialReference=g.fromJSON(this._config.spatialReference);J&&(I.returnCentroid=!0);P&&(I.maxRecordCountFactor=K);if(O)return I.num=D,H.destroy(),this._queryPages(E,I);E=yield b.executeQuery(E,I,this._config.sourceSpatialReference);
H.destroy();return E.data});return function(E){return y.apply(this,arguments)}}();u._queryPages=function(){var y=t._asyncToGenerator(function*(E,H,J=[],P=0){H.start=l.isSome(H.num)?P*H.num:null;const {data:O}=yield b.executeQuery(E,H,this._config.sourceSpatialReference);if(O.exceededTransferLimit&&P<this._config.maxQueryDepth)return O.features.forEach(K=>J.push(K)),this._queryPages(E,H,J,P+1);J.forEach(K=>O.features.push(K));return O});return function(E,H){return y.apply(this,arguments)}}();u._addRelatedFeatures=
function(y){const E=new Map;y=y.features;const H=this._serviceDefinition.relatedFeatures.joinField;for(const J of y)E.set(J.attributes[H],J);this._relatedFeatures=E};return z}(a.WebSocketConnection);return C=F.__decorate([d.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],C)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ./StreamConnection".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d){const a=v.getLogger("esri.layers.graphics.sources.connections.WebSocketConnection");r.ReadyState=void 0;(function(b){b[b.CONNECTING=0]="CONNECTING";b[b.OPEN=1]="OPEN";b[b.CLOSING=2]="CLOSING";b[b.CLOSED=3]="CLOSED"})(r.ReadyState||(r.ReadyState={}));r.WebSocketConnection=function(b){function f(g){var x=b.call(this)||this;x.errorString=null;const {geometryType:q,spatialReference:B,sourceSpatialReference:z}=g;x._config=g;x._featureZScaler=c.getGeometryZScaler(q,
z,B);x._open();return x}t._inheritsLoose(f,b);var m=f.prototype;m._open=function(){var g=t._asyncToGenerator(function*(){yield this._tryCreateWebSocket();this.destroyed||(yield this._handshake())});return function(){return g.apply(this,arguments)}}();m.destroy=function(){A.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};m._tryCreateWebSocket=function(){var g=
t._asyncToGenerator(function*(x=this._config.source.path,q=1E3,B=0){try{if(!this.destroyed){var z=l.addQueryParameters(x,this._config.customParameters);this._websocket=yield this._createWebSocket(z);this.notifyChange("connectionStatus")}}catch(u){if(z=q/1E3,this._config.maxReconnectionAttempts&&B>=this._config.maxReconnectionAttempts)a.error(new C("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return a.error(new C("websocket-connection",
`Failed to connect. Attempting to reconnect in ${z}s`,u)),yield w.after(q),this._tryCreateWebSocket(x,Math.min(1.5*q,1E3*this._config.maxReconnectionInterval),B+1)}});return function(){return g.apply(this,arguments)}}();m._createWebSocket=function(g){return new Promise((x,q)=>{const B=new WebSocket(g);B.onopen=()=>{B.onopen=null;this.destroyed?(B.onclose=null,B.close()):(B.onclose=z=>this._onClose(z),B.onerror=z=>this._onError(z),B.onmessage=z=>this._onMessage(z),x(B))};B.onclose=z=>{B.onopen=B.onclose=
null;q(z)}})};m._handshake=function(){var g=t._asyncToGenerator(function*(x=1E4){const q=this._websocket;if(!A.isNone(q)){var B=w.createResolver(),z=q.onmessage,{filter:u,outFields:y,spatialReference:E}=this._config;B.timeout(x);q.onmessage=H=>{var J;let P=null;try{P=JSON.parse(H.data)}catch(O){}P&&"object"===typeof P||(a.error(new C("websocket-connection","Protocol violation. Handshake failed - malformed message",H.data)),B.reject(),this.destroy());(null==(J=P.spatialReference)?void 0:J.wkid)!==
(null==E?void 0:E.wkid)&&(a.error(new C("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${E.wkid}`,H.data)),B.reject(),this.destroy());"json"!==P.format&&(a.error(new C("websocket-connection","Protocol violation. Handshake failed - format is not set",H.data)),B.reject(),this.destroy());u&&P.filter!==u&&a.error(new C("websocket-connection","Tried to set filter, but server doesn't support it"));y&&P.outFields!==y&&a.error(new C("websocket-connection","Tried to set outFields, but server doesn't support it"));
q.onmessage=z;B.resolve()};q.send(JSON.stringify({filter:u,outFields:y,format:"json",spatialReference:{wkid:E.wkid}}));return B.promise}});return function(){return g.apply(this,arguments)}}();m._onMessage=function(g){try{const x=JSON.parse(g.data);if("featureResult"!==x.type)throw new C("websocket-connection","Protocol violation - Expected to find message of type 'featureResult'",x);for(const q of x.features)A.isSome(this._featureZScaler)&&this._featureZScaler(q.geometry),this.onFeature(q)}catch(x){a.error(new C("websocket-connection",
"Failed to parse message",x)),this.destroy()}};m._onError=function(g){this._set("errorString","Encountered an error over WebSocket connection");a.error("websocket-connection","Encountered an error over WebSocket connection")};m._onClose=function(g){this._websocket=null;this.notifyChange("connectionStatus");1E3!==g.code&&a.error("websocket-connection",`WebSocket closed unexpectedly with error code ${g.code}`);this.destroyed||this._open()};t._createClass(f,[{key:"connectionStatus",get:function(){if(A.isNone(this._websocket))return"disconnected";
switch(this._websocket.readyState){case r.ReadyState.CONNECTING:case r.ReadyState.OPEN:return"connected";case r.ReadyState.CLOSING:case r.ReadyState.CLOSED:return"disconnected"}}}]);return f}(d);F.__decorate([e.property()],r.WebSocketConnection.prototype,"connectionStatus",null);F.__decorate([e.property()],r.WebSocketConnection.prototype,"errorString",void 0);r.WebSocketConnection=F.__decorate([p.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],r.WebSocketConnection);Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/StreamConnection":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/HandleOwner ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w,l,e,h){F=function(k){function n(){return k.apply(this,
arguments)||this}r._inheritsLoose(n,k);n.prototype.onFeature=function(p){this.emit("feature",p)};return n}(F.EventedMixin(C.HandleOwner));return F=t.__decorate([h.subclass("esri.layers.graphics.sources.connections.StreamConnection")],F)})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(r,t,F,C,v,A,w){const l=C.getLogger("esri.views.2d.layers.features.sources.FeatureSource");C=function(e){function h(n){return e.call(this,n)||this}t._inheritsLoose(h,e);var k=h.prototype;k._fetchDataTile=function(){var n=t._asyncToGenerator(function*(p){const c=this._subscriptions.get(p.key.id);let d=!1,a=0,b=0;const f=(x,q)=>{b--;A.throwIfAborted(c);const B=p.id,z=x.reader;x=x.query;z.exceededTransferLimit?(q={id:B,addOrUpdate:z,end:d&&0===b,type:"append"},c.add({message:q,query:x}),this._onMessage(q)):
(d=!0,q={id:B,addOrUpdate:z,end:0===b,type:"append"},c.add({message:q,query:x}),this._onMessage(q))};let m=0,g=0;for(;!d&&20>g++;){let x;for(let q=0;q<m+1;q++){const B=a++;b++;x=this._fetchDataTilePage(p,B,c).then(z=>z&&f(z,B)).catch(z=>{d=!0;A.isAbortError(z)||(l.error(new F("mapview-query-error","Encountered error when fetching tile",{tile:p,error:z})),this._onMessage({id:p.id,addOrUpdate:null,end:d,type:"append"}))})}yield x;A.throwIfAborted(c);m=Math.min(m+2,6)}});return function(p){return n.apply(this,
arguments)}}();k._fetchDataTilePage=function(){var n=t._asyncToGenerator(function*(p,c,d){A.throwIfAborted(d);const a=this._queryInfo;var b={start:this.pageSize*c,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:p.getQuantizationParameters()};v.isSome(this.maxRecordCountFactor)&&(b.maxRecordCountFactor=this.maxRecordCountFactor);b=this.createTileQuery(p,b);try{const f=yield this._queue.push({tile:p,query:b,signal:d.signal,depth:c});A.throwIfAborted(d);return f?a!==this._queryInfo?
this._fetchDataTilePage(p,c,d):{reader:f,query:b}:null}catch(f){return A.throwIfNotAbortError(f),null}});return function(p,c,d){return n.apply(this,arguments)}}();return h}(w.BaseFeatureSource);r.PagedFeatureSource=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(r,t,F,C,v,A,w,l,e,h){function k(c,d,a){var b=c.getXHydrated();c=c.getYHydrated();b=d.getColumnForX(b);b=Math.floor(d.normalizeCol(b));d=Math.floor(d.getRowForY(c));return`${a}/${d}/${b}`}function n(c,d){if(v.isNone(c))return null;d=d.transform;const a=c.getQuantizationTransform();if(v.isNone(a)){const [u,y]=d.scale,[E,H]=d.translate;return c.transform(-E/u,H/y,1/u,1/-y)}const [b,f]=a.scale,[m,g]=a.translate,[x,q]=d.scale,[B,z]=d.translate;return c.transform((m-B)/x,(-g+z)/q,b/x,f/q)}const p=
C.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource");F=function(c){function d(b){var f=c.call(this,b)||this;f.mode="snapshot";f._loading=!0;f._controller=new AbortController;f._downloadPromise=null;f._didSendEnd=!1;f._queries=[];f._invalidated=!1;f._hasAggregates=!1;f._random=new w(1E3);f._store=b.store;f._markedIdsBufId=f._store.storage.createBitset();return f}t._inheritsLoose(d,c);var a=d.prototype;a.destroy=function(){c.prototype.destroy.call(this);this._controller.abort()};
a.update=function(b,f){c.prototype.update.call(this,b,f);this._hasAggregates=b.targets.aggregate};a.resend=function(){var b=t._asyncToGenerator(function*(f=!1){yield this._downloadPromise;this._invalidated||f?(f=v.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(m=>m.clear()),this._downloadPromise=this._download(f),yield this._downloadPromise):(f=this._queries.map(({query:m,reader:g})=>this._sendPatchQuery(m,g)),yield Promise.all(f),
this._subscriptions.forEach(m=>{m.requests.done.forEach(g=>this._onMessage(g.message))}))});return function(){return b.apply(this,arguments)}}();a.refresh=function(){var b=t._asyncToGenerator(function*(){yield this.resend(!0)});return function(){return b.apply(this,arguments)}}();a._sendPatchQuery=function(){var b=t._asyncToGenerator(function*(f,m){const g=v.isSome(f.outFields)?f.outFields:[],x=this._queryInfo.outFields,q=x.filter(u=>-1===g.indexOf(u));if(q.length){var B=f.clone(),z=this._signal;
B.returnGeometry=!1;B.returnCentroid=!1;B.outFields=q;f.outFields=x;f=yield this._queue.push({query:B,depth:0,signal:z});A.throwIfAborted({signal:z});m.joinAttributes(f)}});return function(f,m){return b.apply(this,arguments)}}();a._fetchDataTile=function(){var b=t._asyncToGenerator(function*(f){if(!this._downloadPromise){var m=v.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(m)}var g=this._store.search(f);m=this._subscriptions.get(f.key.id);
const x=g.length-1;for(let B=0;B<x;B++){var q=n(g[B],f);q={type:"append",id:f.id,addOrUpdate:q,end:!1,status:h.UpdateToken.empty()};m.add({query:null,message:q});this._hasAggregates||(yield A.after(1));this._onMessage(q)}g=n(0<=x?g[x]:null,f);f={type:"append",id:f.id,addOrUpdate:g,end:this._didSendEnd,status:h.UpdateToken.empty()};m.add({query:null,message:f});this._onMessage(f)});return function(f){return b.apply(this,arguments)}}();a._download=function(){var b=t._asyncToGenerator(function*(f){try{yield this.whenInitialized();
const m=this._store.storage.getBitset(this._markedIdsBufId),g=new Set;m.clear();const x=Array.from({length:Math.ceil(f/this.pageSize)},(q,B)=>B).sort((q,B)=>this._random.getInt()-this._random.getInt()).map(q=>this._downloadPage(q,m,g));yield Promise.all(x);this._store.sweepFeatures(m,this._store.storage);this._store.sweepFeatureSets(g)}catch(m){p.error("mapview-snapshot-source","Encountered and error when downloading feature snapshot",m)}this._sendEnd();this._loading=!1});return function(f){return b.apply(this,
arguments)}}();a._downloadPage=function(){var b=t._asyncToGenerator(function*(f,m,g){var x=this.pageSize;x={start:f*x,num:x,cacheHint:!0};v.isSome(this.maxRecordCountFactor)&&(x.maxRecordCountFactor=this.maxRecordCountFactor);x=this.createQuery(x);const q=this._signal;f=yield this._queue.push({query:x,depth:f,signal:q});A.throwIfAborted({signal:q});this._queries.push({query:x,reader:f});this._store.insert(f);g.add(f.instance);for(g=f.getCursor();g.next();)m.set(g.getDisplayId());this._send(f)});return function(f,
m,g){return b.apply(this,arguments)}}();a._send=function(b){if(this._subscriptions.size){var f=null,m=new Map,g=new Set,x=new Map;this._subscriptions.forEach(B=>{var z,u=B.tile;m.set(u.key.id,null);f=u.tileInfoView;g.add(u.level);const {row:y,col:E}=u.key;u=`${u.level}/${y}/${E}`;const H=null!=(z=x.get(u))?z:[];H.push(B);x.set(u,H)});for(const B of g){const z=f.getLODInfoAt(B),u=b.getCursor();for(;u.next();){var q=k(u,z,B);const y=u.getIndex();if(x.has(q))for(const E of x.get(q)){q=E.tile.id;let H=
m.get(q);v.isNone(H)&&(H=[],m.set(q,H));H.push(y)}}}m.forEach((B,z)=>{if(v.isSome(B)){const u=this._subscriptions.get(z);B=n(e.FeatureSetReaderIndirect.from(b,B),u.tile);z={type:"append",id:z,addOrUpdate:B,end:!1,status:h.UpdateToken.empty()};u.add({query:null,message:z});this._onMessage(z)}})}};a._sendEnd=function(){this._subscriptions.forEach(b=>{const f={type:"append",id:b.tile.id,addOrUpdate:null,end:!0,status:h.UpdateToken.empty()};b.add({query:null,message:f});this._onMessage(f)});this._didSendEnd=
!0};t._createClass(d,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return d}(l.BaseFeatureSource);r.SnapshotFeatureSource=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a){function b(B,z){return u=>z(B(u))}const f=v.getLogger("esri.views.layers.2d.features.support.AttributeStore"),m=c.createDebugLogger(c.DEBUG_ATTR_UPDATES,f);var g=C("esri-shared-array-buffer"),x=C("esri-atomics");let q=function(){function B(u,y,E,H){this.size=0;this.texelSize=4;const {pixelType:J,layout:P,textureOnly:O}=H;this.textureOnly=O||!1;this.pixelType=J;this._ctype=y;this.layout=P;this._resetRange();this._shared=u;this.size=E;O||(this.data=this._initData(J,
E,u,y))}var z=B.prototype;z.unsetComponentAllTexels=function(u,y){const E=w.unwrap(this.data);for(let H=0;H<this.size*this.size;H++)E[H*this.texelSize+u]&=~y;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponentAllTexels=function(u,y){const E=w.unwrap(this.data);for(let H=0;H<this.size*this.size;H++)E[H*this.texelSize+u]|=255&y;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponent=function(u,y,E){const H=w.unwrap(this.data);for(const J of E)H[J*this.texelSize+u]|=y,
this.dirtyStart=Math.min(this.dirtyStart,J),this.dirtyEnd=Math.max(this.dirtyEnd,J)};z.setComponentTexel=function(u,y,E){w.unwrap(this.data)[E*this.texelSize+u]|=y;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};z.unsetComponentTexel=function(u,y,E){w.unwrap(this.data)[E*this.texelSize+u]&=~y;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};z.getData=function(u,y){u=n.getDisplayIdTexel(u);return w.unwrap(this.data)[u*this.texelSize+
y]};z.setData=function(u,y,E){u=n.getDisplayIdTexel(u);0===(this.layout&1<<y)?f.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[u*this.texelSize+y]=E,this.dirtyStart=Math.min(this.dirtyStart,u),this.dirtyEnd=Math.max(this.dirtyEnd,u))};z.lock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&this._shared&&x&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};z.unlock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&this._shared&&x&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};z.expand=function(u){this.size=u;if(!this.textureOnly){u=this._initData(this.pixelType,u,this._shared,this._ctype);const y=w.unwrap(this.data);u.set(y);this.data=u}};z.toMessage=function(){const u=this.dirtyStart,y=this.dirtyEnd;var E=this.texelSize;if(u>y)return null;this._resetRange();const H=!this._shared&&"local"!==this._ctype,J=this.pixelType,P=this.layout,O=w.unwrap(this.data);E=H&&O.slice(u*E,(y+1)*E)||null;return{start:u,end:y,data:E,pixelType:J,
layout:P}};z._initData=function(u,y,E,H){E=E&&"local"!==H?SharedArrayBuffer:ArrayBuffer;u=p.getPixelArrayCtor(u);y=new u(new E(y*y*4*u.BYTES_PER_ELEMENT));for(u=0;u<y.length;u+=4)y[u+1]=255;return y};z._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(B,[{key:"buffer",get:function(){return w.applySome(this.data,u=>u.buffer)}}]);return B}();return function(){function B(u,y){this._client=u;this.config=y;this._attributeComputeMap=new Map;this._blocks=[];this._filters=
Array(k.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;u=y.supportsTextureFloat?a.PixelType.FLOAT:a.PixelType.UNSIGNED_BYTE;m(`Creating AttributeStore ${g?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:a.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:u,layout:15},
{pixelType:u,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var z=B.prototype;z.destroy=function(){this._abortController.abort()};z.update=function(u,y){this.config=y;y=y.schema.processors[0].storage;const E=e.diff(this._schema,y);if(u.targets.feature||u.targets.aggregate)u.storage.data=!0;if(E&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",E),u.storage.data=!0,this._schema=y,this._attributeComputeMap.clear(),!w.isNone(y))){switch(y.target){case "feature":this._targetType=
n.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=n.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===y.type)for(const H in y.mapping){if(u=y.mapping[H],w.isSome(u))for(const J of u.mapping)this._bindAttribute(J)}else for(const H of y.mapping)this._bindAttribute(H)}};z.onTileData=function(u,y){if(!w.isNone(y.addOrUpdate))for(u=y.addOrUpdate.getCursor();u.next();)y=u.getDisplayId(),this.setAttributeData(y,u)};z.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();
this._abortController=new AbortController};z.setHighlight=function(){var u=t._asyncToGenerator(function*(y,E){const H=this._getBlock(0);E=E.map(J=>n.getDisplayIdTexel(J));H.lock();H.unsetComponentAllTexels(0,1);H.setComponent(0,1,E);H.unlock();this._idsToHighlight.clear();for(const J of y)this._idsToHighlight.add(J);yield this.sendUpdates()});return function(y,E){return u.apply(this,arguments)}}();z.updateFilters=function(){var u=t._asyncToGenerator(function*(y,E){const {config:H,service:J,spatialReference:P}=
E;({filters:E}=H);E=E.map((O,K)=>this._updateFilter(O,K,J,P));(yield Promise.all(E)).some(O=>O)&&(y.storage.filters=!0,C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(y,E){return u.apply(this,arguments)}}();z.setData=function(u,y,E,H){const J=n.getDisplayIdTexel(u);this._ensureSizeForTexel(J);this._getBlock(y).setData(u,E,H)};z.getData=function(u,y,E){return this._getBlock(y).getData(u,E)};z.getHighlightFlag=function(u){return this._idsToHighlight.has(u)?
k.HIGHLIGHT_FLAG:0};z.unsetAttributeData=function(u){u=n.getDisplayIdTexel(u);this._getBlock(0).setData(u,0,0)};z.setAttributeData=function(u,y){const E=n.getDisplayIdTexel(u);this._ensureSizeForTexel(E);this._getBlock(0).setData(E,0,this.getFilterFlags(y));if(this._targetType===n.getDisplayIdType(u)){u=this._attributeComputeMap;var H=this.config.supportsTextureFloat?1:2;u.size&&u.forEach((J,P)=>{const O=P*H%4;P=this._getBlock(Math.floor(P*H/4)+k.ATTRIBUTE_DATA_VV);J=J(y);if(this.config.supportsTextureFloat)P.setData(E,
O,J);else if(J===k.NAN_MAGIC_NUMBER)P.setData(E,O,255),P.setData(E,O+1,255);else{J=A.clamp(Math.round(J),-32767,32766)+32768;const K=(J&65280)>>8;P.setData(E,O,J&255);P.setData(E,O+1,K)}})}};z.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=l.createResolver(),this._nextUpdate.promise;const u={blocks:this._blocks.map(y=>w.isSome(y)?y.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var y=()=>{this._currUpdate=
null;if(this._nextUpdate){const E=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>E.resolve())}};y=this._client.update(u,this._signal).then(y).catch(y);this._client.render(this._signal);return y}).catch(y=>{if(l.isAbortError(y))return this._createResourcesPromise=null,this._createResources();f.error(new F("mapview-attribute-store","Encountered an error during client update",y));return Promise.resolve()})};z._ensureSizeForTexel=function(u){for(;u>=this._size*this._size&&!this._expand(););
};z._bindAttribute=function(u){function y(){return u.normalizationField?J=>{const P=J.readAttribute(u.normalizationField);return P?J.readAttribute(u.field)/P:null}:J=>J.readAttribute(u.field)}function E(){u.normalizationField&&f.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return J=>J.getComputedNumericAtIndex(u.fieldIndex)}let H;if(null!=u.fieldIndex)H=E();else if(u.field)H=y();else return;u.valueRepresentation&&(H=b(H,J=>d.getVisualVariableSizeValueRepresentationRatio(J,
u.valueRepresentation)));this._attributeComputeMap.set(u.binding,b(H,J=>null===J||isNaN(J)||Infinity===J?k.NAN_MAGIC_NUMBER:J))};z._createResources=function(){if(w.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(k.ATTRIBUTE_DATA_ANIMATION);this._getBlock(k.ATTRIBUTE_DATA_GPGPU);m("Initializing AttributeStore");var u={shared:g&&"local"!==this._client.type,size:this._size,blocks:w.mapMany(this._blocks,y=>({textureOnly:y.textureOnly,buffer:y.buffer,pixelType:y.pixelType}))};
this._createResourcesPromise=u=this._client.initialize(u,this._signal).catch(y=>{l.isAbortError(y)?this._createResourcesPromise=null:f.error(new F("mapview-attribute-store","Encountered an error during client initialization",y))});u.then(()=>w.isNone(this._createResourcesPromise)?this._createResources():void 0);return u};z._getBlock=function(u){var y=this._blocks[u];if(w.isSome(y))return y;m(`Initializing AttributeBlock at index ${u}`);y=new q(g,this._client.type,this._size,this._blockDescriptors[u]);
this._blocks[u]=y;this._createResourcesPromise=null;return y};z._expand=function(){if(this._size<this.config.maxTextureSize){const u=this._size<<=1;m("Expanding block size to",u,this._blocks);w.forEachSome(this._blocks,y=>y.expand(u));this._createResourcesPromise=null;this._size=u;return 0}f.error(new F("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};z._updateFilter=function(){var u=t._asyncToGenerator(function*(y,E,H,J){const P=this._filters[E],O=w.isSome(P)&&P.hash;
if(!P&&!y||O===JSON.stringify(y))return!1;if(w.isNone(y)){if(!P)return!1;y=1<<E+1;H=this._getBlock(0);this._filters[E]=null;H.setComponentAllTexels(0,y);this.sendUpdates();return!0}yield(yield this._getFilter(E,H)).update(y,J);return!0});return function(y,E,H,J){return u.apply(this,arguments)}}();z._getFilter=function(){var u=t._asyncToGenerator(function*(y,E){var H=this._filters[y];if(w.isSome(H))return H;({default:H}=yield new Promise((J,P)=>r(["./FeatureFilter"],O=>J(Object.freeze({__proto__:null,
default:O})),P)));E=new H({geometryType:E.geometryType,hasM:!1,hasZ:!1,timeInfo:E.timeInfo,fieldsIndex:new h(E.fields)});return this._filters[y]=E});return function(y,E){return u.apply(this,arguments)}}();z.isVisible=function(u){return!!(this._getBlock(0).getData(u,0)&2)};z.getFilterFlags=function(u){let y=0;var E=n.getDisplayIdFilterMask(u.getDisplayId());for(let J=0;J<this._filters.length;J++){var H=this._filters[J];H=!(E&1<<J)||w.isNone(H)||H.check(u);y|=(H?1:0)<<J}E=0;this._idsToHighlight.size&&
(u=u.getObjectId(),E=this.getHighlightFlag(u));return y<<1|E};t._createClass(B,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return B}()})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(r){r.AGGREGATE_VALID_FILTERS_MASK=254;r.DISPLAY_ID_TEXEL_MASK=8388607;r.DISPLAY_ID_TYPE_AGGREGATE=1;r.DISPLAY_ID_TYPE_FEATURE=
0;r.DISPLAY_ID_TYPE_MASK=8388608;r.NONAGGREGATE_VALID_FILTERS_MASK=255;r.createDisplayId=function(t,F){return((F?8388608:0)|t)>>>0};r.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;r.getDisplayIdTexel=t=>t&8388607;r.getDisplayIdType=t=>(t&8388608)>>>23;r.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){function p(M){const V={};for(const fa of M)V[fa.name]=fa.strideInBytes;return V}function c(M){switch(M){case l.WGLGeometryType.MARKER:return K;case l.WGLGeometryType.FILL:return D;case l.WGLGeometryType.LINE:return I;case l.WGLGeometryType.TEXT:return L;case l.WGLGeometryType.LABEL:return R}}function d(M){switch(M%4){case 0:case 2:return 4;case 1:case 3:return 1}}function a(M){switch(M){case h.DataType.BYTE:case h.DataType.UNSIGNED_BYTE:return 1;case h.DataType.SHORT:case h.DataType.UNSIGNED_SHORT:return 2;
case h.DataType.FLOAT:case h.DataType.INT:case h.DataType.UNSIGNED_INT:return 4}}function b(M){const V={};for(const fa in M){let oa=0;V[fa]=M[fa].map(ua=>{const xa=new n.VertexElementDescriptor(ua.name,ua.count,ua.type,oa,0,ua.normalized||!1);oa+=ua.count*a(ua.type);return xa});V[fa].forEach(ua=>ua.stride=oa)}return V}const f=F.getLogger("esri.views.2d.engine.webgl.Utils");F=[{name:"geometry",strideInBytes:36}];const m=[{name:"geometry",strideInBytes:32}],g=[{name:"geometry",strideInBytes:20}],x=
[{name:"geometry",strideInBytes:12}],q=[{name:"geometry",strideInBytes:40}],B=[{name:"geometry",strideInBytes:36}],z=[{name:"geometry",strideInBytes:36}],u=p(F),y=p(m),E=p(g),H=p(x),J=p(q),P=p(B),O=p(z),K=["geometry"],D=["geometry"],I=["geometry"],L=["geometry"],R=["geometry"],Z={["geometry"]:h.Usage.STATIC_DRAW},X=new Map,Q=M=>{if(!M)return!1;M=M.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(M)&&/[\dz]$/i.test(M)&&4<M.length?!0:!1};r.C_FILL_STRIDE_SPEC=y;r.C_FILL_STRIDE_SPEC_DD=H;r.C_FILL_STRIDE_SPEC_SIMPLE=
E;r.C_FILL_VERTEX_DEF=m;r.C_FILL_VERTEX_DEF_DD=x;r.C_FILL_VERTEX_DEF_SIMPLE=g;r.C_ICON_STRIDE_SPEC=u;r.C_ICON_VERTEX_DEF=F;r.C_LABEL_STRIDE_SPEC=O;r.C_LABEL_VERTEX_DEF=z;r.C_LINE_STRIDE_SPEC=J;r.C_LINE_VERTEX_DEF=q;r.C_TEXT_STRIDE_SPEC=P;r.C_TEXT_VERTEX_DEF=B;r.C_VBO_GEOMETRY="geometry";r.C_VBO_INFO=Z;r.C_VBO_PERINSTANCE="per_instance";r.C_VBO_PERINSTANCE_VV="per_instance_vv";r.allocateTypedArrayBuffer=function(M,V){switch(V%4){case 0:case 2:return new Uint32Array(Math.floor(M*V/4));case 1:case 3:return new Uint8Array(M*
V)}};r.allocateTypedArrayBufferwithData=function(M,V){switch(V%4){case 0:case 2:return new Uint32Array(M);case 1:case 3:return new Uint8Array(M)}};r.charCodes=function(M){const V=[];for(let fa=0;fa<M.length;fa++)V.push(M.charCodeAt(fa));return V};r.copyMeshData=function(M,V,fa,oa,ua,xa,Ca){for(const S in xa){var va=xa[S].stride,G=d(va);const ha=xa[S].data,T=fa[S].data,W=va*ua.vertexCount/G,ca=va*M/G;va=va*ua.vertexFrom/G;for(G=0;G<W;++G)T[G+ca]=ha[G+va]}fa=ua.indexCount;for(xa=0;xa<fa;++xa)oa[xa+
V]=Ca[xa+ua.indexFrom]-ua.vertexFrom+M};r.createGeometryData=function(M,V){const fa=[];for(let oa=0;5>oa;++oa){const ua=c(oa),xa={};for(const Ca of ua)xa[Ca]={data:V(oa,Ca)};fa.push({data:M(oa),buffers:xa})}return fa};r.createProgramDescriptor=(M,V)=>{if(!X.has(M)){const ua=b(V);var fa=ua;var oa={};for(const xa in fa){const Ca=fa[xa];oa[xa]=Ca.length?Ca[0].stride:0}fa=oa;oa=new Map;for(const xa in V)for(const Ca of V[xa])oa.set(Ca.name,Ca.location);V=oa;X.set(M,{strides:fa,bufferLayouts:ua,attributes:V})}return X.get(M)};
r.createTextureFromTexelData=function(M,V){let fa,oa;C.isPowerOfTwo(V.width)&&C.isPowerOfTwo(V.height)?(fa=!0,oa=h.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(fa=!1,oa=h.TextureSamplingMode.LINEAR);return new k.Texture(M,{target:h.TextureType.TEXTURE_2D,pixelFormat:h.PixelFormat.RGBA,internalFormat:h.PixelFormat.RGBA,dataType:h.PixelType.UNSIGNED_BYTE,hasMipmap:fa,samplingMode:oa,wrapMode:h.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},V)};r.forEachGeometryType=function(M){M(l.WGLGeometryType.FILL);M(l.WGLGeometryType.LINE);
M(l.WGLGeometryType.MARKER);M(l.WGLGeometryType.TEXT);M(l.WGLGeometryType.LABEL)};r.geometryToMappedGeometry=function(M){return{vertexFrom:void 0,vertexTo:void 0,geometry:M}};r.getBytes=a;r.getCapType=function(M){switch(M){case "butt":return A.CapType.BUTT;case "round":return A.CapType.ROUND;case "square":return A.CapType.SQUARE;default:return f.error(new t("mapview-invalid-type",`Cap type ${M} is not a valid option. Defaulting to round`)),A.CapType.ROUND}};r.getJoinType=function(M){switch(M){case "miter":return A.JoinType.MITER;
case "bevel":return A.JoinType.BEVEL;case "round":return A.JoinType.ROUND;default:return f.error(new t("mapview-invalid-type",`Join type ${M} is not a valid option. Defaulting to round`)),A.JoinType.ROUND}};r.getNamedBuffers=c;r.getPMSResourceSize=function(M){const V="maxVVSize"in M&&M.maxVVSize;M="width"in M&&M.width||"size"in M&&M.size||0;return V?V:M};r.getPixelArrayCtor=function(M){switch(M){case h.PixelType.UNSIGNED_BYTE:return Uint8Array;case h.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;
case h.PixelType.FLOAT:return Float32Array;default:f.error(new t("webgl-utils",`Unable to handle type ${M}`))}};r.getPixelBytes=function(M){switch(M){case h.PixelType.UNSIGNED_BYTE:return 1;case h.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case h.PixelType.FLOAT:return 4;default:f.error(new t("webgl-utils",`Unable to handle type ${M}`))}};r.getStrides=function(M,{fill:V}){switch(M){case l.WGLGeometryType.MARKER:return u;case l.WGLGeometryType.FILL:return"dot-density"===V?H:"simple"===V?E:y;case l.WGLGeometryType.LINE:return J;
case l.WGLGeometryType.TEXT:return P;case l.WGLGeometryType.LABEL:return O}};r.getTextProperties=function(M){return e.TextProperties.pool.acquire(M.color?w.copyAndPremultiply(M.color):[255,255,255,255],M.haloColor?w.copyAndPremultiply(M.haloColor):[255,255,255,255],v.pt2px(M.haloSize),v.pt2px(M.font.size),M.angle*Math.PI/180,M.xoffset/M.font.size,M.yoffset/M.font.size,"left"===M.horizontalAlignment?0:"right"===M.horizontalAlignment?1:.5,"top"===M.verticalAlignment?0:"bottom"===M.verticalAlignment?
1:.5)};r.getTransformParams=function(M){const {transform:V,hasZ:fa,hasM:oa}=M;return{transform:V,hasZ:fa,hasM:oa}};r.getUrl=M=>"imageData"in M&&M.imageData&&"contentType"in M&&M.contentType?`data:${M.contentType};base64,${M.imageData}`:"url"in M?M.url:null;r.getVVType=function(M){switch(M){case "opacity":return l.VVType.OPACITY;case "color":return l.VVType.COLOR;case "rotation":return l.VVType.ROTATION;case "size":return l.VVType.SIZE;default:return f.error(`Cannot interpret unknown vv: ${M}`),null}};
r.is3D=M=>M.type&&-1!==M.type.toLowerCase().indexOf("3d");r.isDefined=function(M){return null!=M};r.isGIF=M=>"url"in M&&M.url&&M.url.includes(".gif")||"contentType"in M&&"image/gif"===M.contentType||"imageData"in M&&M.imageData.includes("data:image/gif");r.isImageResource=M=>"url"in M&&M.url||"imageData"in M&&M.imageData;r.isNumber=function(M){return"number"===typeof M};r.isPNG=M=>"url"in M&&M.url&&M.url.includes(".png")||"contentType"in M&&"image/png"===M.contentType||"imageData"in M&&M.imageData.includes("data:image/png");
r.isSVGImage=M=>M.includes("data:image/svg+xml");r.isSVGResource=M=>"path"in M&&Q(M.path);r.isSimple=function(M){switch(M.type){case "line":return"CIMSolidStroke"===M.cim.type&&!M.dashTemplate;case "fill":return"CIMSolidFill"===M.cim.type;case "esriSFS":return"esriSFSSolid"===M.style||"esriSFSNull"===M.style;case "esriSLS":return"esriSLSSolid"===M.style||"esriSLSNull"===M.style;default:return!1}};r.isValidSVG=Q;r.shouldRepeat=function(M){switch("cim"in M?M.cim.type:M.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;
default:return!0}};r.strideToPackingFactor=d;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/screenUtils":function(){define(["exports"],function(r){function t(C){return C?72*C/96:0}const F=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;r.castRenderScreenPointArray=function(C){return C};r.castRenderScreenPointArray3=function(C){return C};r.castScreenPointArray=function(C){return C};r.createRenderScreenPoint=function(C=0,v=0){return{x:C,y:v}};r.createRenderScreenPointArray=function(C=0,v=0){return[C,
v]};r.createRenderScreenPointArray3=function(C=0,v=0,A=0){return[C,v,A]};r.createScreenPoint=function(C=0,v=0){return{x:C,y:v}};r.createScreenPointArray=function(C=0,v=0){return[C,v]};r.pt2px=function(C){return C?C/72*96:0};r.px2pt=t;r.screenPointArrayToObject=function(C,v){return v?(v.x=C[0],v.y=C[1],v):{x:C[0],y:C[1]}};r.screenPointObjectToArray=function(C,v){return v?(v[0]=C.x,v[1]=C.y,2<v.length&&(v[2]=0),v):[C.x,C.y]};r.toPt=function(C){if("string"===typeof C){var v=C.match(F);if(v){var A=Number(v[1]);
v=v[3]&&v[3].toLowerCase();C="-"===C.charAt(0);A="px"===v?t(A):A;return C?-A:A}console.warn("screenUtils.toPt: input not recognized!");return null}return C};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(r,t){function F(A,w){Array.isArray(w)?(A[0]=w[0],A[1]=w[1],A[2]=w[2],A[3]=w[3]):(A[0]=w.r,A[1]=w.g,A[2]=w.b,A[3]=w.a);return A}function C(A,w=0,l=!1){const e=A[w+3];A[w+0]*=e;A[w+1]*=e;A[w+2]*=e;l||(A[w+3]*=
255);return A}const v=[0,0,0,0];r.copyAndPremultiply=function(A){return C(F([],A))};r.premultiplyAlpha=C;r.premultiplyAlphaRGBA=function(A){if(!A)return 0;const {r:w,g:l,b:e,a:h}=A;return t.i8888to32(w*h,l*h,e*h,255*h)};r.premultiplyAlphaRGBAArray=function(A){if(!A)return 0;const [w,l,e,h]=A;return t.i8888to32(h/255*w,h/255*l,h/255*e,h)};r.premultiplyAlphaUint32=function(A){C(F(v,A));return t.i8888to32(v[0],v[1],v[2],v[3])};r.white=[255,255,255,1];Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(r){function t(v,A,w){return Math.round(Math.max(Math.min(v,w),A))}const F=new Float32Array(1),C=new Uint32Array(F.buffer);r.i16=function(v){return t(v,-32768,32767)};r.i1616to32=function(v,A){return 65535&v|A<<16};r.i32=function(v){return t(v,-2147483648,2147483647)};r.i8=function(v){return t(v,-128,127)};r.i8816to32=function(v,A,w){return v&255|(A&255)<<8|w<<16};r.i8888to32=function(v,A,w,l){return v&255|(A&255)<<8|(w&255)<<
16|l<<24};r.numTo32=function(v){return v|0};r.toFloat32=function(v){C[0]=v;return F[0]};r.toUint32=function(v){F[0]=v;return C[0]};r.u16=function(v){return t(v,0,65535)};r.u32=function(v){return t(v,0,4294967295)};r.u32to4Xu8=function(v){return[v&255,(v&65280)>>>8,(v&16711680)>>>16,(v&4278190080)>>>24]};r.u4u4to8=function(v,A){return 15&v|(15&A)<<4};r.u8=function(v){return t(v,0,255)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],
function(r){r.WGLGeometryType=void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(r.WGLGeometryType||(r.WGLGeometryType={}));r.WGLGeometryTransactionStatus=void 0;(function(t){t[t.SUCCEEDED=0]="SUCCEEDED";t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(r.WGLGeometryTransactionStatus||(r.WGLGeometryTransactionStatus={}));r.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=
4]="LABEL_ALPHA";t[t.HITTEST=8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]="CLIP";t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(r.WGLDrawPhase||(r.WGLDrawPhase={}));r.VVType=void 0;(function(t){t[t.SIZE=0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(r.VVType||(r.VVType={}));r.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";
t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(r.WGLVVFlag||(r.WGLVVFlag={}));r.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(r.WGLVVTarget||(r.WGLVVTarget={}));r.MosaicType=void 0;(function(t){t[t.SPRITE=0]=
"SPRITE";t[t.GLYPH=1]="GLYPH"})(r.MosaicType||(r.MosaicType={}));Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(r,t){let F=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var v=C.prototype;v.acquire=function(A,w,l,e,h,k,n,p,c){this.color=A;this.haloColor=w;this.haloSize=
l;this.size=e;this.angle=h;this.offsetX=k;this.offsetY=n;this.hAnchor=p;this.vAnchor=c};v.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return C}();F.pool=new t(F);r.TextProperties=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/Texture":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/maybe ./checkWebGLError ./context-util ./enums ./capabilities/isWebGL2Context".split(" "),
function(r,t,F,C,v,A,w,l,e){function h(c){return v.isSome(c)&&"type"in c&&"compressed"===c.type}function k(c){var d;if(d=v.isSome(c)&&!h(c))d=!(v.isSome(c)&&"byteLength"in c);return d}function n(c){return c===l.TextureType.TEXTURE_3D||c===l.TextureType.TEXTURE_2D_ARRAY}function p(c,d,a,b=1){d=Math.max(d,a);c===l.TextureType.TEXTURE_3D&&(d=Math.max(d,b));return Math.round(Math.log(d)/Math.LN2)+1}F=function(){function c(a,b,f=null){this._context=a;this.type="texture";this._glName=null;this._descriptor=
void 0;this._wasImmutablyAllocated=this._wrapModeDirty=this._samplingModeDirty=!1;a.instanceCounter.increment(l.ResourceType.Texture,this);this._descriptor={target:l.TextureType.TEXTURE_2D,samplingMode:l.TextureSamplingMode.LINEAR,wrapMode:l.TextureWrapMode.REPEAT,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,isImmutable:!1,...b};if(a.type!==w.ContextType.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=!1),n(this._descriptor.target)))throw Error("3D and array textures are not supported in WebGL1");
this._descriptor.target===l.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(f):this.setData(f)}var d=c.prototype;d.dispose=function(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(l.ResourceType.Texture,this))};d.release=function(){this.dispose()};d.resize=function(a,b){const f=this._descriptor;if(f.width!==a||f.height!==b){if(this._wasImmutablyAllocated)throw Error("Immutable textures can't be resized!");
f.width=a;f.height=b;this._descriptor.target===l.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}};d._setDataCubeMap=function(a=null){for(let b=l.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X;b<=l.TextureType.TEXTURE_CUBE_MAP_NEGATIVE_Z;b++)this._setData(a,b)};d.setData=function(a){this._setData(a)};d._setData=function(a,b){var f;if(this._context&&this._context.gl){var m=this._context.gl;this._glName||(this._glName=m.createTexture());void 0===a&&(a=null);var g=this._descriptor;
null!=(f=b)?f:b=g.target;f=n(b);if(null===a&&(g.width=g.width||4,g.height=g.height||4,f)){var x;g.depth=null!=(x=g.depth)?x:1}x=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);c._validateTexture(this._context,g);this._configurePixelStorage();var q=g.pixelFormat,B=g.internalFormat?g.internalFormat:this._deriveInternalFormat(q,g.dataType);if(k(a)){q=a.width;let z=a.height;a instanceof HTMLVideoElement&&(q=a.videoWidth,z=a.videoHeight);
g.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(b,B,g.hasMipmap,q,z,1);this._texImage(b,0,B,q,z,1,a);A.checkWebGLError(m);g.hasMipmap&&this.generateMipmap();void 0===g.width&&(g.width=q);void 0===g.height&&(g.height=z);f&&void 0===g.depth&&(g.depth=1)}else{const {width:z,height:u,depth:y}=g;null!=z&&null!=u||console.error("Width and height must be specified!");f&&null==y&&console.error("Depth must be specified!");g.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(b,B,g.hasMipmap,
z,u,y);m.DEPTH24_STENCIL8&&B===m.DEPTH_STENCIL&&(B=m.DEPTH24_STENCIL8);if(h(a)){const E=a.levels;a=p(b,z,u,y);f=Math.min(a-1,E.length-1);e(m)?m.texParameteri(g.target,m.TEXTURE_MAX_LEVEL,f):g.hasMipmap=g.hasMipmap&&a===E.length;const H=B;if(!(H in l.CompressedTextureFormat))throw Error("Attempting to use compressed data with an umcompressed format!");this._forEachMipmapLevel((J,P,O,K)=>{this._compressedTexImage(b,J,H,P,O,K,E[Math.min(J,E.length-1)])},f)}else v.isSome(a)?(this._texImage(b,0,B,z,u,
y,a),A.checkWebGLError(m),g.hasMipmap&&this.generateMipmap()):this._forEachMipmapLevel((E,H,J,P)=>{this._texImage(b,E,B,H,J,P,null);A.checkWebGLError(m)})}c._applySamplingMode(m,this._descriptor);c._applyWrapMode(m,this._descriptor);c._applyAnisotropicFilteringParameters(this._context,this._descriptor);A.checkWebGLError(m);this._context.bindTexture(x,c.TEXTURE_UNIT_FOR_UPDATES)}};d.updateData=function(a,b,f,m,g,x){x||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
const q=this._context.gl,B=this._descriptor,{pixelFormat:z,internalFormat:u,dataType:y,isImmutable:E,target:H}=B;if(E&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");const J=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);(0>b||0>f||m>B.width||g>B.height||b+m>B.width||f+g>B.height)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();k(x)?q.texSubImage2D(H,a,b,f,z,y,x):h(x)?q.compressedTexSubImage2D(H,
a,b,f,m,g,u,x.levels[a]):q.texSubImage2D(H,a,b,f,m,g,z,y,x);this._context.bindTexture(J,c.TEXTURE_UNIT_FOR_UPDATES)};d.updateData3D=function(a,b,f,m,g,x,q,B){B||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const z=this._context.gl;if(!e(z))throw Error("3D textures are not supported in WebGL1");const u=this._descriptor,{pixelFormat:y,dataType:E,isImmutable:H,target:J,internalFormat:P}=u;if(H&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");
n(J)||console.warn("Attempting to set 3D texture data on a non-3D texture");const O=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);(0>b||0>f||0>m||g>u.width||x>u.height||q>u.depth||b+g>u.width||f+x>u.height||m+q>u.depth)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();h(B)?(B=B.levels[a],z.compressedTexSubImage3D(J,a,b,f,m,g,x,q,P,B)):z.texSubImage3D(J,a,b,f,m,g,x,q,y,E,B);this._context.bindTexture(O,
c.TEXTURE_UNIT_FOR_UPDATES)};d.generateMipmap=function(){const a=this._descriptor;if(!a.hasMipmap){if(this._wasImmutablyAllocated)throw Error("Cannot add mipmaps to immutable texture after allocation");this._samplingModeDirty=a.hasMipmap=!0;c._validateTexture(this._context,a)}a.samplingMode===l.TextureSamplingMode.LINEAR?(this._samplingModeDirty=!0,a.samplingMode=l.TextureSamplingMode.LINEAR_MIPMAP_NEAREST):a.samplingMode===l.TextureSamplingMode.NEAREST&&(this._samplingModeDirty=!0,a.samplingMode=
l.TextureSamplingMode.NEAREST_MIPMAP_NEAREST);const b=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(a.target);this._context.bindTexture(b,c.TEXTURE_UNIT_FOR_UPDATES)};d.setSamplingMode=function(a){a!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=a,this._samplingModeDirty=!0)};d.setWrapMode=function(a){a!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=a,c._validateTexture(this._context,
this._descriptor),this._wrapModeDirty=!0)};d.applyChanges=function(){const a=this._context.gl,b=this._descriptor;this._samplingModeDirty&&(c._applySamplingMode(a,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(c._applyWrapMode(a,b),this._wrapModeDirty=!1)};d._deriveInternalFormat=function(a,b){if(this._context.type===w.ContextType.WEBGL1)return a;switch(b){case l.PixelType.FLOAT:switch(a){case l.PixelFormat.RGBA:return l.SizedPixelFormat.RGBA32F;case l.PixelFormat.RGB:return l.SizedPixelFormat.RGB32F;
default:throw Error("Unable to derive format");}case l.PixelType.UNSIGNED_BYTE:switch(a){case l.PixelFormat.RGBA:return l.SizedPixelFormat.RGBA8;case l.PixelFormat.RGB:return l.SizedPixelFormat.RGB8}default:return a}};d._configurePixelStorage=function(){const a=this._context.gl,{unpackAlignment:b,flipped:f,preMultiplyAlpha:m}=this._descriptor;a.pixelStorei(a.UNPACK_ALIGNMENT,b);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,f?1:0);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m?1:0)};d._texStorage=function(a,
b,f,m,g,x){const q=this._context.gl;if(!e(q))throw Error("Immutable textures are not supported in WebGL1");if(!(b in l.SizedPixelFormat))throw Error("Immutable textures must have a sized internal format");this._descriptor.isImmutable&&(f=f?p(a,m,g,x):1,n(a)?q.texStorage3D(a,f,b,m,g,x):q.texStorage2D(a,f,b,m,g),this._wasImmutablyAllocated=!0)};d._texImage=function(a,b,f,m,g,x,q){const B=this._context.gl;let z=null;const u=this._context.type===w.ContextType.WEBGL2,y=n(a),{isImmutable:E,pixelFormat:H,
dataType:J}=this._descriptor;u&&(z=B);!u&&k(q)?B.texImage2D(a,0,f,H,J,q):E?v.isSome(q)&&(y?z.texSubImage3D(a,b,0,0,0,m,g,x,H,J,q):B.texSubImage2D(a,b,0,0,m,g,H,J,q)):(q=v.unwrap(q),y?z.texImage3D(a,b,f,m,g,x,0,H,J,q):B.texImage2D(a,b,f,m,g,0,H,J,q))};d._compressedTexImage=function(a,b,f,m,g,x,q){const B=this._context.gl;let z=null;const u=n(a),y=this._descriptor.isImmutable;if(u){if(this._context.type!==w.ContextType.WEBGL2)throw Error("3D textures are not supported in WebGL1");z=B}y?v.isSome(q)&&
(u?z.compressedTexSubImage3D(a,b,0,0,0,m,g,x,f,q):B.compressedTexSubImage2D(a,b,0,0,m,g,f,q)):u?z.compressedTexImage3D(a,b,f,m,g,x,0,q):B.compressedTexImage2D(a,b,f,m,g,0,q)};d._forEachMipmapLevel=function(a,b=Infinity){let {width:f,height:m,depth:g,hasMipmap:x,target:q}=this._descriptor;const B=q===l.TextureType.TEXTURE_3D;for(let z=0;;++z){a(z,f,m,g);if(!x||1===f&&1===m&&(!B||1===g)||z>=b)break;f=Math.max(1,f>>1);m=Math.max(1,m>>1);B&&(g=Math.max(1,g>>1))}};c._validateTexture=function(a,b){(0>b.width||
0>b.height||0>b.depth)&&console.error("Negative dimension parameters are not allowed!");a=e(a.gl);const f=C.isPowerOfTwo(b.width)&&C.isPowerOfTwo(b.height);a||!b.isImmutable&&!n(b.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!");a||f||("number"===typeof b.wrapMode?b.wrapMode!==l.TextureWrapMode.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(b.wrapMode.s!==l.TextureWrapMode.CLAMP_TO_EDGE||b.wrapMode.t!==l.TextureWrapMode.CLAMP_TO_EDGE)&&
console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};c._applySamplingMode=function(a,b){let f=b.samplingMode,m=b.samplingMode;if(f===l.TextureSamplingMode.LINEAR_MIPMAP_NEAREST||f===l.TextureSamplingMode.LINEAR_MIPMAP_LINEAR)f=l.TextureSamplingMode.LINEAR,b.hasMipmap||(m=l.TextureSamplingMode.LINEAR);else if(f===l.TextureSamplingMode.NEAREST_MIPMAP_NEAREST||f===l.TextureSamplingMode.NEAREST_MIPMAP_LINEAR)f=
l.TextureSamplingMode.NEAREST,b.hasMipmap||(m=l.TextureSamplingMode.NEAREST);a.texParameteri(b.target,a.TEXTURE_MAG_FILTER,f);a.texParameteri(b.target,a.TEXTURE_MIN_FILTER,m)};c._applyWrapMode=function(a,b){"number"===typeof b.wrapMode?(a.texParameteri(b.target,a.TEXTURE_WRAP_S,b.wrapMode),a.texParameteri(b.target,a.TEXTURE_WRAP_T,b.wrapMode)):(a.texParameteri(b.target,a.TEXTURE_WRAP_S,b.wrapMode.s),a.texParameteri(b.target,a.TEXTURE_WRAP_T,b.wrapMode.t))};c._applyAnisotropicFilteringParameters=function(a,
b){var f;const m=a.capabilities.textureFilterAnisotropic;m&&a.gl.texParameterf(b.target,m.TEXTURE_MAX_ANISOTROPY,null!=(f=b.maxAnisotropy)?f:1)};t._createClass(c,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}}]);return c}();F.TEXTURE_UNIT_FOR_UPDATES=0;r.Texture=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/checkWebGLError":function(){define(["exports",
"../../core/Error","../../core/has","../../core/Logger"],function(r,t,F,C){function v(l,e){switch(e){case l.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case l.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case l.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case l.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";
case l.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case l.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const A=C.getLogger("esri/views/webgl"),w=!!F("enable-feature:webgl-debug");r.checkWebGLError=function(l){if(w){const e=l.getError();e&&(l=v(l,e),A.error(new t("webgl-error","WebGL error occured",{message:l,stack:Error().stack})))}};r.hasFeatureFlagWebGLDebug=w;r.webglDebugEnabled=function(){return w};r.webglValidateShadersEnabled=
function(){return w};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/context-util":function(){define(["exports","../../core/has","../../core/maybe"],function(r,t,F){function C(l){const e=t("esri-force-webgl");if(e===r.ContextType.WEBGL1||e===r.ContextType.WEBGL2)return[e];switch(l){case "2d":return[r.ContextType.WEBGL1];case "3d":return[r.ContextType.WEBGL2,r.ContextType.WEBGL1]}}function v(l,e,h={}){if(!window.WebGLRenderingContext)return w(l,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
null;e=A(l,e,h);F.isNone(e)&&w(l,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e');return e}function A(l,e,h={}){e=e===r.ContextType.WEBGL1?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let k=null;for(const n of e){try{k=l.getContext(n,h)}catch(p){}if(k)break}return k}function w(l,e){(l=l.parentNode)&&(l.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
e+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}r.ContextType=void 0;(function(l){l[l.WEBGL1=1]="WEBGL1";l[l.WEBGL2=2]="WEBGL2"})(r.ContextType||(r.ContextType={}));r.createContext=A;r.createContextOrErrorHTML=function(l,e,h={}){for(l=C(l);1<l.length;){const k=A(e,l.shift(),h);if(F.isSome(k))return k}return v(e,l.shift(),h)};r.getContextTypes=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(r){return window.WebGL2RenderingContext&&
r instanceof window.WebGL2RenderingContext}})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(r){r.DEBUG_ATTR_UPDATES=!1;r.createDebugLogger=(t,F)=>t&&((...C)=>F.warn("DEBUG:",...C))||(()=>null);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(r,t,F,C,v,A,w){function l(d){return{value:d.value,size:F.toPt(d.size)}}function e(d){return d.map(a=>l(a))}function h(d){return"string"===typeof d||"number"===typeof d?F.toPt(d):{type:"size",expression:d.expression,stops:e(d.stops)}}function k(d){const a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof d.field)if(d.stops){if(8<d.stops.length)return null;d=d.stops;for(var b=0;8>b;++b){const f=d[Math.min(b,d.length-1)];a.values[b]=f.value;a.opacities[b]=f.opacity}}else return null;
else if(d.stops&&0<=d.stops.length)for(d=d.stops&&0<=d.stops.length&&d.stops[0].opacity,b=0;8>b;b++)a.values[b]=Infinity,a.opacities[b]=d;else return null;return a}function n(d,a,b){d[4*a]=b.r/255;d[4*a+1]=b.g/255;d[4*a+2]=b.b/255;d[4*a+3]=b.a}function p(d){if(t.isNone(d)||d.normalizationField)return null;const a={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof d.field)if(d.stops){if(8<d.stops.length)return null;a.field=
d.field;d=d.stops;for(var b=0;8>b;++b){const f=d[Math.min(b,d.length-1)];a.values[b]=f.value;n(a.colors,b,f.color)}}else return null;else if(d.stops&&0<=d.stops.length)for(d=d.stops&&0<=d.stops.length&&d.stops[0].color,b=0;8>b;b++)a.values[b]=Infinity,n(a.colors,b,d);else return null;for(d=0;32>d;d+=4)C.premultiplyAlpha(a.colors,d,!0);return a}const c=d=>{const a=[],b=[];d=e(d);const f=d.length;for(let m=0;6>m;m++){const g=d[Math.min(m,f-1)];a.push(g.value);b.push(null==g.size?v.NAN_MAGIC_NUMBER:
F.pt2px(g.size))}return{values:new Float32Array(a),sizes:new Float32Array(b)}};r.convertColorVariable=p;r.convertVisualVariables=function(d){const a=d&&0<d.length?{}:null,b=a?{}:null;if(!a)return{vvFields:a,vvRanges:b};for(const f of d)if(f.field&&(a[f.type]=f.field),"size"===f.type)switch(b.size||(b.size={}),d=f,w.getTypeOfSizeVisualVariable(d)){case A.WGLVVFlag.SIZE_MINMAX_VALUE:b.size.minMaxValue={minDataValue:d.minDataValue,maxDataValue:d.maxDataValue,minSize:h(d.minSize),maxSize:h(d.maxSize)};
break;case A.WGLVVFlag.SIZE_SCALE_STOPS:b.size.scaleStops={stops:e(d.stops)};break;case A.WGLVVFlag.SIZE_FIELD_STOPS:if(d.levels){const m={};for(const g in d.levels)m[g]=c(d.levels[g]);b.size.fieldStops={type:"level-dependent",levels:m}}else b.size.fieldStops={type:"static",...c(d.stops)};break;case A.WGLVVFlag.SIZE_UNIT_VALUE:b.size.unitValue={unit:d.valueUnit,valueRepresentation:d.valueRepresentation}}else"color"===f.type?b.color=p(f):"opacity"===f.type?b.opacity=k(f):"rotation"===f.type&&(b.rotation=
{type:f.rotationType});return{vvFields:a,vvRanges:b}};r.getVisualVariableSizeValueRepresentationRatio=function(d,a){if(!d||!a)return d;switch(a){case "radius":case "distance":return 2*d;case "area":return Math.sqrt(d)}return d};r.getVisualVariablesFields=function(d){const a=d&&0<d.length?{}:null;a&&d.forEach(b=>{const f=b.type;b.field&&(a[f]=b.field)});return a};r.normalizeSizeElement=h;r.normalizeSizeStops=e;r.stopToSizeStop=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(r,t,F,C,v){const A=F.getLogger("esri.views.2d.engine.webgl");r.getTypeOfSizeVisualVariable=function(w){if(v.isNumber(w.minDataValue)&&v.isNumber(w.maxDataValue)&&null!=w.minSize&&null!=w.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((w.expression&&"view.scale"===w.expression||w.valueExpression&&"$view.scale"===w.valueExpression)&&Array.isArray(w.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=w.field||w.expression&&
"view.scale"!==w.expression||w.valueExpression&&"$view.scale"!==w.valueExpression)&&(Array.isArray(w.stops)||"levels"in w&&w.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=w.field||w.expression&&"view.scale"!==w.expression||w.valueExpression&&"$view.scale"!==w.valueExpression)&&null!=w.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;A.error(new t("mapview-bad-type","Found invalid size VisualVariable",w));return C.WGLVVFlag.NONE};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g){let x=function(q){function B(u,y,E,H,J){y=new c([],[y,E]);u=q.call(this,y,H,null,u)||this;u.geohashBoundsInfo=J;return u}t._inheritsLoose(B,q);B.create=function(u,y,E,H,J,P,O,K){y=new B(y,E,H,P,O);y.displayId=u.createDisplayId(!0);y.referenceId=K;y.tileLevel=J;return y};var z=B.prototype;z.update=function(u,y,E,H,J,P){this.geometry.coords[0]=u;this.geometry.coords[1]=y;this.tileLevel=E;this.attributes=H;this.geohashBoundsInfo=J;this.referenceId=null;
this.referenceId=P;return this};z.toJSON=function(){return{objectId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null,attributes:{...this.attributes,clusterId:this.objectId},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};t._createClass(B,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return B}(p.OptimizedFeatureWithGeometry);F=function(q){function B(u,y,E,H){var J=q.call(this,u,E)||this;J.events=new C;J._geohashLevel=0;J._tileLevel=
0;J._aggregateValueRanges={};J._aggregateValueRangesChanged=!1;J._geohashBuf=[];J._clusters=new Map;J._tiles=new Map;J._serviceInfo=H;J.geometryInfo=u.geometryInfo;J._spatialReference=y;J._projectionSupportCheck=d.checkProjectionSupport(y,g.WGS84);J._bitsets.geohash=E.getBitset(E.createBitset());J._bitsets.inserted=E.getBitset(E.createBitset());return J}t._inheritsLoose(B,q);var z=B.prototype;z.updateSchema=function(){var u=t._asyncToGenerator(function*(y,E){const H=this._schema;try{yield q.prototype.updateSchema.call(this,
y,E),yield this._projectionSupportCheck}catch(P){}const J=w.diff(H,E);if(!E||A.isNone(J)&&!y.source&&!y.storage.filters)H&&(y.mesh=!0);else{if(w.hasDiff(J,"params.fields")||!this._tree||y.source)this._tree=new l.GeohashTree(this._statisticFields,this._serviceInfo),this._rebuildTree(),v("esri-2d-update-debug")&&console.debug("Aggregate mesh needs update due to tree changing");v("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",J);y.targets[E.name]=!0;y.mesh=!1;this._aggregateValueRanges=
{}}});return function(y,E){return u.apply(this,arguments)}}();z.clear=function(){this._rebuildTree()};z.sweepFeatures=function(u,y){this._bitsets.inserted.forEachSet(E=>{u.has(E)||(E=y.lookupByDisplayIdUnsafe(E),this._remove(E))})};z.sweepClusters=function(u,y,E){this._clusters.forEach((H,J)=>{H&&H.tileLevel!==E&&(u.releaseDisplayId(H.displayId),y.unsetAttributeData(H.displayId),this._clusters.delete(J))})};z.onTileData=function(u,y,E,H,J=!0){if(!this._schema||A.isNone(y.addOrUpdate))return y;var P=
this._getTransforms(u,this._spatialReference);{const O=y.addOrUpdate.getCursor();for(;O.next();)this._update(O,H)}if(y.status.mesh||!J)return y;H=[];this._getClustersForTile(H,u,this._schema.params.clusterRadius,E,P);y.addOrUpdate=m.FeatureSetReaderJSON.fromOptimizedFeatures(H,this._serviceInfo);y.addOrUpdate.attachStorage(E);y.end=!0;for(P=y.addOrUpdate.getCursor();P.next();)H=P.getDisplayId(),this._bitsets.computed.unset(H),this.setComputedAttributes(E,P,H,u.scale);this._aggregateValueRangesChanged&&
y.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return y};z.onTileUpdate=function({added:u,removed:y}){u.length&&(this._tileLevel=u=u[0].level,this._setGeohashLevel(u));if(this._schema){var E=this._schema.params.clusterRadius;y.forEach(H=>{this._tiles.delete(H.key.id);this._markTileClustersForDeletion(H,E)})}};z.getAggregate=function(u){for(const y of this._clusters.values())if(((null==y?NaN:y.displayId)&b.DISPLAY_ID_TEXEL_MASK)===
(u&b.DISPLAY_ID_TEXEL_MASK))return y.toJSON();return null};z.getAggregates=function(){const u=[];for(const y of this._clusters.values())(null==y?void 0:y.tileLevel)===this._tileLevel&&u.push(y.toJSON());return u};z.getDisplayId=function(u){return(u=this._clusters.get(u))?u.displayId:null};z.getFeatureDisplayIdsForAggregate=function(u){u=this._clusters.get(u);if(!u)return[];u=u.geohashBoundsInfo;return this._tree.getRegionDisplayIds(u.xLL,u.yLL,u.xTR,u.yTR,u.level)};z.getDisplayIdForReferenceId=function(u){for(const y of this._clusters.values())if((null==
y?void 0:y.referenceId)===u)return y.displayId;return null};z.getAggregateValueRanges=function(){return this._aggregateValueRanges};z.forEach=function(u){for(const [y,E]of this._clusters)E&&u(E,y)};z.size=function(){let u=0;this.forEach(y=>u++);return u};z._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};z._remove=function(u){const y=u.getDisplayId(),E=u.getXHydrated(),H=u.getYHydrated(),J=this._geohashBuf[2*y],P=this._geohashBuf[2*
y+1];this._bitsets.inserted.has(y)&&(this._bitsets.inserted.unset(y),this._tree.removeCursor(u,E,H,J,P,this._geohashLevel))};z._update=function(u,y){const E=u.getDisplayId(),H=this._bitsets.inserted;y=y.isVisible(E);var J=H.has(E);y!==J&&(y?(y=u.getXHydrated(),J=u.getYHydrated(),this._setGeohash(E,y,J)&&(this._tree.insertCursor(u,E,y,J,this._geohashBuf[2*E],this._geohashBuf[2*E+1],this._geohashLevel),H.set(E))):this._remove(u))};z._setGeohash=function(u,y,E){if(this._bitsets.geohash.has(u))return!0;
const H=this._geohashBuf;if(this._spatialReference.isWebMercator)y=y/h.earth.radius*57.29577951308232,e.setGeohashBuf(H,u,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-E/h.earth.radius))),y-360*Math.floor((y+180)/360),12);else{E=d.project({x:y,y:E},this._spatialReference,g.WGS84);if(!E)return!1;e.setGeohashBuf(H,u,E.y,E.x,12)}this._bitsets.geohash.set(u);return!0};z._getClustersForTile=function(u,y,E,H,J,P=!0){var O=this._schema.params.clusterPixelBuffer,K=2*E;E=this._getGeohashLevel(y.key.level);
const D=Math.ceil(2**y.key.level*a.TILE_SIZE/K);var I=Math.ceil(O/K)+0,L=Math.ceil(a.TILE_SIZE/K);const {row:R,col:Z}=y.key;var X=Math.floor(Z*a.TILE_SIZE/K)-I;K=Math.floor(R*a.TILE_SIZE/K)-I;O=X+L+2*I;I=K+L+2*I;for(L=y.tileInfoView.getLODInfoAt(y.key.level);X<=O;X++)for(let V=K;V<=I;V++){var Q=X;L.wrap&&(Q=0>X?X+D:X%D);const fa=L.wrap&&0>X,oa=L.wrap&&X%D!==X;Q=this._lookupCluster(H,L,y.key.level,Q,V,E);if(A.isSome(Q)){var M=A.applySome(J,ua=>fa?ua.left:oa?ua.right:ua.tile);if((!P||!A.isNone(M))&&
Q.count&&A.isSome(M)&&P){const ua=Q.geometry.clone();let xa=Q.attributes;ua.coords[0]=n.quantizeX(M,ua.coords[0]);ua.coords[1]=n.quantizeY(M,ua.coords[1]);1===Q.count&&A.isSome(Q.referenceId)&&(xa={...Q.attributes,referenceId:Q.referenceId});M=new p.OptimizedFeature(ua,xa);M.displayId=Q.displayId;u.push(M)}}}};z._getGeohashLevel=function(u){return Math.min(Math.ceil(u/2+2),12)};z._setGeohashLevel=function(u){u=this._getGeohashLevel(u);u=1*(Math.floor(u/1)+1)-1;this._geohashLevel!==u&&(this._geohashLevel=
u,this._rebuildTree(),this._bitsets.geohash.clear())};z._getTransforms=function(u,y){const E={originPosition:"upperLeft",scale:[u.resolution,u.resolution],translate:[u.bounds[0],u.bounds[3]]};y=k.getInfo(y);if(!y)return{tile:E,left:null,right:null};const [H,J]=y.valid;return{tile:E,left:{...E,translate:[J,u.bounds[3]]},right:{...E,translate:[H-J+u.bounds[0],u.bounds[3]]}}};z._getClusterId=function(u,y,E){return(u&15)<<28|(y&16383)<<14|E&16383};z._markForDeletion=function(u,y,E){u=this._getClusterId(u,
y,E);this._clusters.delete(u)};z._getClusterBounds=function(u,y,E){var H=this._schema.params.clusterRadius,J=2*H;y=E%2?y*J:y*J-H;const P=E*J;H=y+J;E=2**u.level*a.TILE_SIZE;u.wrap&&0>y&&(y=0);u.wrap&&H>E&&(H=E);E=P/a.TILE_SIZE;H/=a.TILE_SIZE;J=(P-J)/a.TILE_SIZE;y=u.getXForColumn(y/a.TILE_SIZE);E=u.getYForRow(E);H=u.getXForColumn(H);u=u.getYForRow(J);return[y,E,H,u]};z._lookupCluster=function(u,y,E,H,J,P){const O=this._getClusterId(E,H,J),K=this._clusters.get(O),[D,I,L,R]=this._getClusterBounds(y,H,
J);var Z={x:D,y:I};J={x:L,y:R};var X=H=y=0,Q=0;if(this._spatialReference.isWebMercator)y=Z.x/h.earth.radius*57.29577951308232,y-=360*Math.floor((y+180)/360),H=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-Z.y/h.earth.radius))),X=J.x/h.earth.radius*57.29577951308232,X-=360*Math.floor((X+180)/360),Q=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-J.y/h.earth.radius)));else{H=d.project(Z,this._spatialReference,g.WGS84);J=d.project(J,this._spatialReference,g.WGS84);if(!H||!J)return null;y=H.x;
H=H.y;X=J.x;Q=J.y}Z={geohashX:0,geohashY:0};J={geohashX:0,geohashY:0};e.setGeohashXY(Z,H,y,P);e.setGeohashXY(J,Q,X,P);H=Z.geohashX;X=Z.geohashY;Q=J.geohashX;J=J.geohashY;y={xLL:H,yLL:X,xTR:Q,yTR:J,level:P};J=this._tree.getRegionStatistics(H,X,Q,J,P);const {count:M,xTotal:V,yTotal:fa,referenceId:oa}=J;P=M?V/M:0;H=M?fa/M:0;if(0===M)return this._clusters.set(O,null),null;J={cluster_count:M,...J.attributes};u=A.isSome(K)?K.update(P,H,E,J,y,oa):x.create(u,O,P,H,E,J,y,oa);0===M&&(u.geometry.coords[0]=(D+
L)/2,u.geometry.coords[1]=(I+R)/2);this._clusters.set(O,u);this._updateAggregateValueRangeForCluster(u,u.tileLevel);return u};z._updateAggregateValueRangeForCluster=function(u,y){const E=this._aggregateValueRanges[y]||{minValue:Infinity,maxValue:0},H=E.minValue,J=E.maxValue;E.minValue=Math.min(H,u.count);E.maxValue=Math.max(J,u.count);this._aggregateValueRanges[y]=E;if(H!==E.minValue||J!==E.maxValue)this._aggregateValueRangesChanged=!0};z._markTileClustersForDeletion=function(u,y){var E=2*y;y=Math.ceil(a.TILE_SIZE/
E);const {row:H,col:J}=u.key,P=Math.floor(J*a.TILE_SIZE/E);E=Math.floor(H*a.TILE_SIZE/E);for(let O=P;O<P+y;O++)for(let K=E;K<E+y;K++)this._markForDeletion(u.key.level,O,K)};return B}(f.Store2D);r.ClusterInfo=x;r.ClusterStore=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),function(r,t,
F,C,v,A){let w=function(){function e(k=[],n,p=8096){this._nodes=0;this._root=new l(0,0,0);this._statisticFields=k;this._pool=p?new F(8096):null;this._serviceInfo=n}var h=e.prototype;h._acquire=function(k,n,p){this._nodes++;let c=null;C.isSome(this._pool)&&(c=this._pool.dequeue());return C.isSome(c)?c.realloc(k,n,p):new l(k,n,p)};h._release=function(k){this._nodes--;C.isSome(this._pool)&&this._pool.enqueue(k)};h.dropLevels=function(k){this._forEachNode(n=>{if(n.depth>=k)for(let p=0;p<n.children.length;p++){const c=
n.children[p];n.children[p]=null;c&&this._release(c)}})};h.clear=function(){this.dropLevels(0)};h.insert=function(k,n,p=0){const c=A.FeatureSetReaderJSON.fromOptimizedFeatures([k],this._serviceInfo).getCursor();c.next();const d=c.readGeometry();if(d){var [a,b]=d.coords;this.insertCursor(c,k.displayId,a,b,k.geohashX,k.geohashY,n,p)}};h.insertCursor=function(k,n,p,c,d,a,b,f=0){let m=this._root,g=0,x=0,q=0;for(;null!==m;){m.depth>=f&&(m.count+=1,m.xTotal+=p,m.yTotal+=c,m.xGeohashTotal+=d,m.yGeohashTotal+=
a,m.displayId=n,this._updateStatisticsCursor(k,m,1));if(g>=b){m.add(n);break}var B=Math.ceil((g+1)/2),z=Math.floor((g+1)/2);const y=1-g%2;var u=30-(3*B+2*z);B=30-(2*B+3*z);u=(d&7*y+3*(1-y)<<u)>>u;B=(a&3*y+7*(1-y)<<B)>>B;z=u+B*(8*y+4*(1-y));const E=2*y+3*(1-y);x=x<<3*y+2*(1-y)|u;q=q<<E|B;null==m.children[z]&&(m.children[z]=this._acquire(x,q,g+1));g+=1;m=m.children[z]}};h.remove=function(k,n){const p=A.FeatureSetReaderJSON.fromOptimizedFeatures([k],this._serviceInfo).getCursor();p.next();const c=p.readGeometry();
if(c){var [d,a]=c.coords;this.removeCursor(p,d,a,k.geohashX,k.geohashY,n)}};h.removeCursor=function(k,n,p,c,d,a){let b=this._root,f=0;for(;null!==b;){--b.count;b.xTotal-=n;b.yTotal-=p;b.xGeohashTotal-=c;b.yGeohashTotal-=d;this._updateStatisticsCursor(k,b,-1);if(f>=a){b.remove(k.getDisplayId());break}var m=Math.ceil((f+1)/2);const q=Math.floor((f+1)/2);var g=1-f%2,x=30-(3*m+2*q);m=30-(2*m+3*q);g=((c&7*g+3*(1-g)<<x)>>x)+((d&3*g+7*(1-g)<<m)>>m)*(8*g+4*(1-g));x=b.children[g];1===x.count&&(this._release(x),
b.children[g]=null);f+=1;b=x}};h.find=function(k,n,p){return this._root.find(k,n,p,0,0,0)};h.findSingleOccupancyNode=function(k,n,p,c,d){let a=this._root;for(;null!==a;){var b=a.depth,f=a.xNode,m=a.yNode;const u=1-b%2;var g=a.xGeohashTotal/a.count,x=a.yGeohashTotal/a.count;if(1===a.count&&k<g&&g<=p&&n<x&&x<=c)return a;if(b>=d)a=a.next;else{x=Math.ceil((b+1)/2);b=Math.floor((b+1)/2);g=30-(3*x+2*b);var q=30-(2*x+3*b),B=~((1<<g)-1),z=~((1<<q)-1);f<<=3*u+2*(1-u);m<<=2*u+3*(1-u);b=Math.max(f,(k&B)>>g);
x=Math.max(m,(n&z)>>q);g=Math.min(f+8*u+4*(1-u),(p&B)>>g);q=Math.min(m+4*u+8*(1-u),(c&z)>>q);for(B=z=null;x<=q;x++)for(let y=b;y<=g;y++){const E=a.children[y-f+(x-m)*(8*u+4*(1-u))];E&&(z||(z=E,z.next=a.next),B&&(B.next=E),B=E,E.next=a.next)}a=z||a.next}}return null};h.getRegionDisplayIds=function(k,n,p,c,d){let a=this._root;const b=[];for(;null!==a;){var f=a.depth,m=a.xNode,g=a.yNode;if(f>=d)f=a.xGeohashTotal/a.count,m=a.yGeohashTotal/a.count,k<=f&&f<=p&&n<=m&&m<=c&&a.displayIds.forEach(E=>b.push(E)),
a=a.next;else{var x=Math.ceil((f+1)/2),q=Math.floor((f+1)/2);f=1-f%2;var B=30-(3*x+2*q),z=30-(2*x+3*q),u=~((1<<B)-1),y=~((1<<z)-1);m<<=3*f+2*(1-f);g<<=2*f+3*(1-f);x=Math.max(m,(k&u)>>B);q=Math.max(g,(n&y)>>z);B=Math.min(m+8*f+4*(1-f),(p&u)>>B);z=Math.min(g+4*f+8*(1-f),(c&y)>>z);for(u=y=null;q<=z;q++)for(let E=x;E<=B;E++){const H=a.children[E-m+(q-g)*(8*f+4*(1-f))];H&&(y||(y=H,y.next=a.next),u&&(u.next=H),u=H,H.next=a.next)}a=y||a.next}}return b};h.getRegionStatistics=function(k,n,p,c,d){let a=this._root,
b=0,f=0,m=0;const g={};let x=0;for(;null!==a;){var q=a.depth,B=a.xNode,z=a.yNode;if(q>=d)q=a.xGeohashTotal/a.count,B=a.yGeohashTotal/a.count,k<q&&q<=p&&n<B&&B<=c&&(b+=a.count,f+=a.xTotal,m+=a.yTotal,1===a.count&&(x=a.displayId),this._aggregateStatistics(g,a.statistics)),a=a.next;else{var u=Math.ceil((q+1)/2),y=Math.floor((q+1)/2);q=1-q%2;var E=30-(3*u+2*y),H=30-(2*u+3*y),J=~((1<<E)-1),P=~((1<<H)-1);B<<=3*q+2*(1-q);z<<=2*q+3*(1-q);u=Math.max(B,(k&J)>>E);y=Math.max(z,(n&P)>>H);E=Math.min(B+8*q+4*(1-
q),(p&J)>>E);H=Math.min(z+4*q+8*(1-q),(c&P)>>H);J=P=null;for(let O=y;O<=H;O++)for(let K=u;K<=E;K++){const D=a.children[K-B+(O-z)*(8*q+4*(1-q))];if(D)if(O!==y&&O!==H&&K!==u&&K!==E){const I=D.xGeohashTotal/D.count,L=D.yGeohashTotal/D.count;k<I&&I<=p&&n<L&&L<=c&&(b+=D.count,f+=D.xTotal,m+=D.yTotal,1===D.count&&(x=D.displayId),this._aggregateStatistics(g,D.statistics))}else P||(P=D,P.next=a.next),J&&(J.next=D),J=D,D.next=a.next}a=P||a.next}}k=this._normalizeStatistics(g,b);return{count:b,attributes:k,
xTotal:f,yTotal:m,referenceId:x}};h._forEachNode=function(k){let n=this._root;for(;null!==n;){const p=this._linkChildren(n)||n.next;k(n);n=p}};h._linkChildren=function(k){let n=null,p=null;for(let c=0;c<=k.children.length;c++){const d=k.children[c];d&&(n||(n=d,n.next=k.next),p&&(p.next=d),p=d,d.next=k.next)}return n};h._updateStatisticsCursor=function(k,n,p){for(const b of this._statisticFields){const f=b.name,m=b.inField?k.readAttribute(b.inField):k.getComputedNumericAtIndex(b.inFieldIndex);switch(b.statisticType){case "norm":n.statistics[f]||
(n.statistics[f]={});var c=k.readAttribute(b.inNormalizationField),d=n.statistics[f].onStatisticField||0,a=n.statistics[f].onStatisticNormalizationField||0;null==m||isNaN(m)||null==c||0===c||isNaN(c)||(n.statistics[f].onStatisticField=d+p*m,n.statistics[f].onStatisticNormalizationField=a+p*c);break;case "sum":case "avg":n.statistics[f]||(n.statistics[f]={value:0,nanCount:0});c=n.statistics[f].value;d=n.statistics[f].nanCount;null==m||isNaN(m)?n.statistics[f].nanCount=d+p:n.statistics[f].value=c+p*
m;break;case "avg_angle":{n.statistics[f]||(n.statistics[f]={x:0,y:0,nanCount:0});c=n.statistics[f].x;d=n.statistics[f].y;a=n.statistics[f].nanCount;const g=Math.PI/180;null==m||isNaN(m)?n.statistics[f].nanCount=a+p:(n.statistics[f].x=c+p*Math.cos(m*g),n.statistics[f].y=d+p*Math.sin(m*g));break}case "mode":n.statistics[f]||(n.statistics[f]={}),n.statistics[f][m]=(n.statistics[f][m]||0)+p}}};h._aggregateStatistics=function(k,n){for(const p of this._statisticFields){const c=p.name;switch(p.statisticType){case "sum":case "avg":case "avg_angle":case "mode":case "norm":k[c]||
(k[c]={});for(const d in n[c])k[c][d]=(k[c][d]||0)+n[c][d]}}};h._normalizeStatistics=function(k,n){const p={};for(const d of this._statisticFields){const a=d.name;switch(d.statisticType){case "norm":var c=k[a];if(n&&null==c.onStatisticNormalizationField)break;if(n&&c.onStatisticNormalizationField){p[a]=c.onStatisticField/c.onStatisticNormalizationField;break}p[a]=0;break;case "sum":{if(!n)break;const {value:b,nanCount:f}=k[a];if(!(n-f))break;p[a]=b;break}case "avg":{if(!n)break;const {value:b,nanCount:f}=
k[a];if(!(n-f))break;p[a]=b/(n-f);break}case "avg_angle":{if(!n)break;const {x:b,y:f,nanCount:m}=k[a];if(!(n-m))break;p[a]=180/Math.PI*Math.atan2(f/(n-m),b/(n-m));break}case "mode":{c=k[a];let b=0,f=null;for(const m in c){const g=c[m];g>b&&(b=g,f=m)}p[a]="null"===f?null:f}}}return p};t._createClass(e,[{key:"count",get:function(){return this._root.count}},{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return C.mapOr(this._pool,0,k=>k.size)}},{key:"depth",get:function(){let k=
0;this._forEachNode(n=>k=Math.max(k,n.depth));return k}}]);return e}(),l=function(){function e(k,n,p){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(let c=0;c<this.children.length;c++)this.children[c]=null;this.xNode=k;this.yNode=n;this.depth=p}var h=e.prototype;h.realloc=function(k,n,p){for(let c=0;c<this.children.length;c++)this.children[c]=
null;this.xNode=k;this.yNode=n;this.depth=p;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};h.add=function(k){this.displayIds.add(k)};h.remove=function(k){this.displayIds.delete(k)};h.getLngLatBounds=function(){var k=this.depth;const n=Math.ceil(k/2);k=Math.floor(k/2);return v.decodeGeohashXY({geohashX:this.xNode<<30-(3*n+2*k),geohashY:this.yNode<<30-(2*n+3*k)},this.depth)};h.find=function(k,n,p,c,d,
a){if(c>=p)return this;var b=1-c%2;const f=3*b+2*(1-b),m=2*b+3*(1-b),g=30-d-f,x=30-a-m;b=this.children[((k&7*b+3*(1-b)<<g)>>g)+((n&3*b+7*(1-b)<<x)>>x)*(8*b+4*(1-b))];return null==b?null:b.find(k,n,p,c+1,d+f,a+m)};return e}();r.GeohashTree=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(r){function t(d){return 57>=d?d-48:104>=d?d-88:107>=d?d-89:110>=d?d-90:d-91}function F(d,a,b){d[0]=a;d[1]=b;return d}function C(d,a){const b=
(d[0]+d[1])/2,f=!a;d[0]=f*d[0]+a*b;d[1]=f*b+a*d[1]}function v(d,a){a=a>(d[0]+d[1])/2;C(d,a);return a}function A(d,a){const b=F(p,-90,90),f=F(c,-180,180);for(let g=0;g<a.length;g++){var m=a.charCodeAt(g);m=t(m);0===g%2?(C(f,!!(16&m)),C(f,!!(4&m)),C(f,!!(1&m)),C(b,!!(8&m)),C(b,!!(2&m))):(C(b,!!(16&m)),C(b,!!(4&m)),C(b,!!(1&m)),C(f,!!(8&m)),C(f,!!(2&m)))}d[0]=(b[0]+b[1])/2;d[1]=(f[0]+f[1])/2;return d}function w(d,a,b){let f="";const m=F(p,-90,90),g=F(c,-180,180);for(let x=0;x<b;x++){let q=0;x%2?(q|=
v(m,d)<<4,q|=v(g,a)<<3,q|=v(m,d)<<2,q|=v(g,a)<<1,q|=v(m,d)<<0):(q|=v(g,a)<<4,q|=v(m,d)<<3,q|=v(g,a)<<2,q|=v(m,d)<<1,q|=v(g,a)<<0);f+="0123456789bcdefghjkmnpqrstuvwxyz"[q]}return f}function l(d){return 180/2**Math.floor(5*d/2)}function e(d){return 360/2**Math.ceil(5*d/2)}function h(d,a){return a?1&d|(4&d)>>1|(16&d)>>2:(2&d)>>1|(8&d)>>2}function k(d,a){return a?(2&d)>>1|(8&d)>>2:1&d|(4&d)>>1|(16&d)>>2}function n(d,a,b){var f=!((d.length-1)%2);const m=d.substring(0,d.length-1);var g=t(d.charCodeAt(d.length-
1)),x=0,q=0;let B=0;var z=0;f?(x=8,q=4,B=1&g|(4&g)>>1|(16&g)>>2,z=(2&g)>>1|(8&g)>>2):(x=4,q=8,z=1&g|(4&g)>>1|(16&g)>>2,B=(2&g)>>1|(8&g)>>2);a=B+a;g=z+b;b=Math.floor(a/x);z=Math.floor(g/q);x=a-b*x;q=g-z*q;f="0123456789bcdefghjkmnpqrstuvwxyz"[f?x&1|(q&1)<<1|(x&2)<<1|(q&2)<<2|(x&4)<<2:q&1|(x&1)<<1|(q&2)<<1|(x&2)<<2|(q&4)<<2];return 1<d.length&&(b||z)?n(m,b,z)+f:m+f}const p=new Float64Array(2),c=new Float64Array(2);r.convertGeohash32ToXY=function(d,a){let b=d=0,f=30,m=30;for(let q=0;q<a.length;q++){var g=
a.charCodeAt(q),x=t(g);g=0===q%2;const B=h(x,g);x=k(x,g);f-=g?3:2;m-=g?2:3;d|=B<<f;b|=x<<m}return{geohashX:d,geohashY:b}};r.decodeBase32Char=t;r.decodeGeohash=A;r.decodeGeohashXY=function(d,a){let b=-90,f=90,m=-180,g=180;for(let y=0;y<a;y++){var x=Math.ceil((y+1)/2),q=Math.floor((y+1)/2),B=1-y%2,z=30-(3*x+2*q),u=30-(2*x+3*q);q=3*B+2*(1-B);x=2*B+3*(1-B);z=(7*B+3*(1-B)<<z&d.geohashX)>>z;B=(3*B+7*(1-B)<<u&d.geohashY)>>u;for(--q;0<=q;q--){u=(m+g)/2;const E=z&1<<q?1:0;m=(1-E)*m+E*u;g=(1-E)*u+E*g}for(--x;0<=
x;x--)z=(b+f)/2,q=B&1<<x?1:0,b=(1-q)*b+q*z,f=(1-q)*z+q*f}return[m,b,g,f]};r.encodeBase32Char=function(d){return"0123456789bcdefghjkmnpqrstuvwxyz"[d]};r.encodeGeohash=w;r.forEachIntersectingGeohash=function(d,a,b,f,m,g){var x=Math.abs(b-d),q=Math.abs(f-a);const B=l(m),z=e(m);q=Math.ceil(q/z);x=Math.ceil(x/B);m=w(d,a,m);for(let u=0;u<q;u++)for(let y=0;y<x;y++){const E=n(m,u,y),[H,J]=A([0,0],E);g(E,Math.abs((Math.min(b,H+B/2)-Math.max(d,H-B/2))*(Math.min(f,J+z/2)-Math.max(a,J-z/2)))/(B*z))}};r.getIntersectingGeohashes=
function(d,a,b,f,m){b=Math.abs(b-d);f=Math.abs(f-a);var g=l(m);const x=e(m);f=Math.ceil(f/x);b=Math.ceil(b/g);d=w(d,a,m);a=[];for(m=0;m<f;m++)for(g=0;g<b;g++)a.push(n(d,m,g));return a};r.getRelativeGeohash=n;r.latDistPerGeohash=l;r.lonDistPerGeohash=e;r.setGeohashBuf=function(d,a,b,f,m){m%2&&(m+=1);let g=0,x=0,q=-90,B=90,z=-180,u=180;for(let J=0;J<m/2;J++){for(var y=0;5>y;y++){var E=(z+u)/2,H=f>E?1:0;g|=H<<29-(y+5*J);z=(1-H)*z+H*E;u=(1-H)*E+H*u}for(y=0;5>y;y++)E=(q+B)/2,H=b>E?1:0,x|=H<<29-(y+5*J),
q=(1-H)*q+H*E,B=(1-H)*E+H*B}d[2*a]=g;d[2*a+1]=x};r.setGeohashXY=function(d,a,b,f){f%2&&(f+=1);let m=0,g=0,x=-90,q=90,B=-180,z=180;for(let H=0;H<f/2;H++){for(var u=0;5>u;u++){var y=(B+z)/2,E=b>y?1:0;m|=E<<29-(u+5*H);B=(1-E)*B+E*y;z=(1-E)*y+E*z}for(u=0;5>u;u++)y=(x+q)/2,E=a>y?1:0,g|=E<<29-(u+5*H),x=(1-E)*x+E*y,q=(1-E)*y+E*q}d.geohashX=m;d.geohashY=g};r.unpackXBits=h;r.unpackYBits=k;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports",
"../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(r,t,F,C){function v(w,l,e){if(!(w.length>l))for(;w.length<=l;)w.push(e)}let A=function(){function w(){this._numerics=[];this._strings=[];this._idGenerator=new F.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var l=w.prototype;l.createBitset=function(){const e=this._bitsets.length;this._bitsets.push(C.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));
return e+1};l.getBitset=function(e){return this._bitsets[e-1]};l._expand=function(){this._allocatedSize<<=1;for(const e of this._bitsets)e.resize(this._allocatedSize)};l._ensureNumeric=function(e,h){this._numerics[e]||(this._numerics[e]=[]);v(this._numerics[e],h,0)};l._ensureInstanceId=function(e){v(this._instanceIds,e,0)};l._ensureString=function(e,h){this._strings[e]||(this._strings[e]=[]);v(this._strings[e],h,null)};l.createDisplayId=function(e=!1){const h=this._idGenerator.createId();h>this._allocatedSize&&
this._expand();return t.createDisplayId(h,e)};l.releaseDisplayId=function(e){for(const h of this._bitsets)h.unset(e);return this._idGenerator.releaseId(e&t.DISPLAY_ID_TEXEL_MASK)};l.getComputedNumeric=function(e,h){return this.getComputedNumericAtIndex(e&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedNumeric=function(e,h,k){return this.setComputedNumericAtIndex(e&t.DISPLAY_ID_TEXEL_MASK,k,0)};l.getComputedString=function(e,h){return this.getComputedStringAtIndex(e&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedString=
function(e,h,k){return this.setComputedStringAtIndex(e&t.DISPLAY_ID_TEXEL_MASK,0,k)};l.getComputedNumericAtIndex=function(e,h){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(h,e);return this._numerics[h][e]};l.setComputedNumericAtIndex=function(e,h,k){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(h,e);this._numerics[h][e]=k};l.getInstanceId=function(e){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(e);return this._instanceIds[e]};l.setInstanceId=function(e,h){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(e);
this._instanceIds[e]=h};l.getComputedStringAtIndex=function(e,h){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(h,e);return this._strings[h][e]};l.setComputedStringAtIndex=function(e,h,k){e&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(h,e);this._strings[h][e]=k};l.getXMin=function(e){return this._bounds[4*(e&t.DISPLAY_ID_TEXEL_MASK)]};l.getYMin=function(e){return this._bounds[4*(e&t.DISPLAY_ID_TEXEL_MASK)+1]};l.getXMax=function(e){return this._bounds[4*(e&t.DISPLAY_ID_TEXEL_MASK)+2]};l.getYMax=function(e){return this._bounds[4*
(e&t.DISPLAY_ID_TEXEL_MASK)+3]};l.setBounds=function(e,h){h=h.readHydratedGeometry();if(!h||!h.coords.length)return!1;let k=Infinity,n=Infinity,p=-Infinity,c=-Infinity;h.forEachVertex((d,a)=>{k=Math.min(k,d);n=Math.min(n,a);p=Math.max(p,d);c=Math.max(c,a)});e&=t.DISPLAY_ID_TEXEL_MASK;v(this._bounds,4*e+4,0);this._bounds[4*e]=k;this._bounds[4*e+1]=n;this._bounds[4*e+2]=p;this._bounds[4*e+3]=c;return!0};return w}();r.ComputedAttributeStorage=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports",
"../../../engine/webgl/DisplayId"],function(r,t){let F=function(){function C(){this._freeIds=[];this._idCounter=1}var v=C.prototype;v.createId=function(A=!1){return t.createDisplayId(this._getFreeId(),A)};v.releaseId=function(A){this._freeIds.push(A)};v._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return C}();r.DisplayIdGenerator=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(r,t,F,C,v,A,w){const l={added:[],removed:[]},e=new Set,h=new w(0,0,0,0);return function(k){function n(c){var d=k.call(this)||this;d._tiles=new Map;d._index=C.rbush(9,F("esri-csp-restrictions")?a=>({minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);d.tiles=[];d.tileScheme=c;return d}r._inheritsLoose(n,k);var p=n.prototype;p.destroy=function(){this.clear()};p.clear=function(){this.tiles.length=0;this._tiles.clear();
this._index.clear()};p.has=function(c){return this._tiles.has(c)};p.get=function(c){return this._tiles.get(c)};p.boundsIntersections=function(c){return this._index.search({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]})};p.updateTiles=function(c){const d={added:[],removed:[]};for(const a of c.added)if(!this.has(a)){const b=new v.Tile(this.tileScheme,a);this._tiles.set(a,b);this._index.insert(b);d.added.push(b)}for(const a of c.removed)this.has(a)&&(c=this.get(a),this._tiles.delete(a),this._index.remove(c),
d.removed.push(c));this.tiles.length=0;this._tiles.forEach(a=>this.tiles.push(a));(d.added.length||d.removed.length)&&this.emit("update",d)};p.setViewState=function(c){if(c=this.tileScheme.getTileCoverage(c,0)){var {spans:d,lodInfo:a}=c,{level:b}=a;if(0<d.length)for(const {row:m,colFrom:g,colTo:x}of d)for(var f=g;f<=x;f++){const q=h.set(b,m,a.normalizeCol(f),a.getWorldForColumn(f)).id;e.add(q);if(!this.has(q)){const B=new v.Tile(this.tileScheme,q);this._tiles.set(q,B);this._index.insert(B);this.tiles.push(B);
l.added.push(B)}}for(b=this.tiles.length-1;0<=b;b--)f=this.tiles[b],e.has(f.id)||(this._tiles.delete(f.id),this.tiles.splice(b,1),this._index.remove(f),l.removed.push(f));(l.added.length||l.removed.length)&&this.emit("update",l);A.pool.release(c);e.clear();l.added.length=0;l.removed.length=0}};return n}(t)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(r,t,F,C,v,A,w){let l=function(){function e(k,n){this.key=new w(0,0,0,0);this.bounds=v.create();this.objectIds=new Set;this.key.set(n);n=k.getLODInfoAt(this.key);this.tileInfoView=k;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=n.resolution;this.scale=n.scale;this.level=n.level}var h=e.prototype;h.createChildTiles=function(){const k=this.key.getChildKeys(),n=F.acquire();for(let p=0;p<k.length;p++)n[p]=new e(this.tileInfoView,k[p]);return n};h.getQuantizationParameters=
function(){return A.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};t._createClass(e,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return C.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,
this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return e}();r.Tile=l;r.default=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(r,t){let F=function(){function C(A,w,l,e){this.set(A,w,l,e)}C.getId=function(A,w,l,e){return"object"===typeof A?`${A.level}/${A.row}/${A.col}/${A.world}`:`${A}/${w}/${l}/${e}`};var v=C.prototype;v.acquire=function(A,w,l,e){this.set(A,
w,l,e)};v.contains=function(A){const w=A.level-this.level;return this.row===A.row>>w&&this.col===A.col>>w&&this.world===A.world};v.equals=function(A){return this.level===A.level&&this.row===A.row&&this.col===A.col&&this.world===A.world};v.clone=function(){return new C(this)};v.release=function(){this.world=this.col=this.row=this.level=0};v.set=function(A,w,l,e){if(null==A)this.world=this.col=this.row=this.level=0;else if("object"===typeof A)this.level=A.level||0,this.row=A.row||0,this.col=A.col||
0,this.world=A.world||0;else if("string"===typeof A){const [h,k,n,p]=A.split("/");this.level=parseFloat(h);this.row=parseFloat(k);this.col=parseFloat(n);this.world=parseFloat(p)}else this.level=+A,this.row=+w,this.col=+l,this.world=+e||0;return this};v.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};v.getParentKey=function(){return 0>=this.level?null:new C(this.level-1,this.row>>1,this.col>>1,this.world)};v.getChildKeys=function(){const A=this.level+1,w=this.row<<
1,l=this.col<<1,e=this.world;return[new C(A,w,l,e),new C(A,w,l+1,e),new C(A,w+1,l,e),new C(A,w+1,l+1,e)]};v.compareRowMajor=function(A){return this.row<A.row?-1:this.row>A.row?1:this.col<A.col?-1:this.col>A.col?1:0};r._createClass(C,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(A){this.set(A)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return C}();F.pool=new t(F,null,null,25,
50);return F})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool"],function(r){let t=function(){function F(){this.spans=[]}var C=F.prototype;C.acquire=function(v){this.lodInfo=v};C.release=function(){this.lodInfo=null;this.spans.length=0};C.forEach=function(v,A){const {spans:w,lodInfo:l}=this,{level:e}=l;if(0!==w.length)for(const {row:h,colFrom:k,colTo:n}of w)for(let p=k;p<=n;p++)v.call(A,e,h,l.normalizeCol(p),l.getWorldForColumn(p))};return F}();t.pool=new r(t);return t})},
"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(r,t,F,C,v,A){const w=new v("0/0/0/0");let l=function(){function h(n,p,c,d,a,b,f,m){this.x=n;this.ymin=p;this.ymax=c;this.invM=d;this.leftAdjust=a;this.rightAdjust=b;this.leftBound=f;this.rightBound=m}h.create=function(n,p){n[1]>p[1]&&([n,p]=[p,n]);const [c,d]=n,[a,b]=p;n=a-c;p=b-d;p=0!==p?
n/p:0;const f=(Math.ceil(d)-d)*p,m=(Math.floor(d)-d)*p;return new h(c,Math.floor(d),Math.ceil(b),p,0>n?f:m,0>n?m:f,0>n?a:c,0>n?c:a)};var k=h.prototype;k.incrRow=function(){this.x+=this.invM};k.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};k.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return h}();const e=[[0,0],[0,0],[0,0],[0,0]];return function(){function h(n,p=null){this.tileInfo=n;this.fullExtent=p;this.scales=[];this._lodInfos=
null;this._infoByScale={};this._infoByLevel={};const c=n.lods.slice();c.sort(function(a,b){return b.scale-a.scale});const d=this._lodInfos=c.map(a=>F.create(n,a,p));c.forEach((a,b)=>{this._infoByLevel[a.level]=d[b];this._infoByScale[a.scale]=d[b];this.scales[b]=a.scale},this);this._wrap=n.isWrappable}var k=h.prototype;k.getLODInfoAt=function(n){return this._infoByLevel["number"===typeof n?n:n.level]};k.getTileBounds=function(n,p,c=!1){w.set(p);return(p=this._infoByLevel[w.level])?p.getTileBounds(n,
w,c):n};k.getTileCoords=function(n,p,c=!1){w.set(p);return(p=this._infoByLevel[w.level])?p.getTileCoords(n,w,c):n};k.getTileCoverage=function(n,p=192,c="closest"){c="closest"===c?this.getClosestInfoForScale(n.scale):this.getSmallestInfoForScale(n.scale);const d=C.pool.acquire(c),a=this._wrap;var b=Infinity;let f=-Infinity;const m=d.spans;e[0][0]=e[0][1]=e[1][1]=e[3][0]=-p;e[1][0]=e[2][0]=n.size[0]+p;e[2][1]=e[3][1]=n.size[1]+p;for(g of e)n.toMap(g,g),g[0]=c.getColumnForX(g[0]),g[1]=c.getRowForY(g[1]);
n=[];var g=3;for(p=0;4>p;p++)e[p][1]===e[g][1]?g=p:(g=l.create(e[p],e[g]),b=Math.min(g.ymin,b),f=Math.max(g.ymax,f),void 0===n[g.ymin]&&(n[g.ymin]=[]),n[g.ymin].push(g),g=p);if(null==b||null==f||100<f-b)return null;for(p=[];b<f;){null!=n[b]&&(p=p.concat(n[b]));g=Infinity;var x=-Infinity;for(var q=p.length-1;0<=q;q--){var B=p[q];g=Math.min(g,B.getLeftCol());x=Math.max(x,B.getRightCol())}g=Math.floor(g);x=Math.floor(x);if(b>=c.first[1]&&b<=c.last[1])if(a)if(c.size[0]<c.worldSize[0])for(q=Math.floor(x/
c.worldSize[0]),B=Math.floor(g/c.worldSize[0]);B<=q;B++)m.push(new A(b,Math.max(c.getFirstColumnForWorld(B),g),Math.min(c.getLastColumnForWorld(B),x)));else m.push(new A(b,g,x));else g>c.last[0]||x<c.first[0]||(g=Math.max(g,c.first[0]),x=Math.min(x,c.last[0]),m.push(new A(b,g,x)));b+=1;for(g=p.length-1;0<=g;g--)x=p[g],x.ymax>=b?x.incrRow():p.splice(g,1)}return d};k.getTileParentId=function(n){w.set(n);n=this._lodInfos.indexOf(this._infoByLevel[w.level])-1;if(0>n)return null;this._getTileIdAtLOD(w,
this._lodInfos[n],w);return w.id};k.getTileResolution=function(n){return(n=this._infoByLevel["object"===typeof n?n.level:n])?n.resolution:-1};k.getTileScale=function(n){return(n=this._infoByLevel[n.level])?n.scale:-1};k.intersects=function(n,p){w.set(p);p=this._infoByLevel[w.level];const c=n.lodInfo;if(c.resolution>p.resolution){this._getTileIdAtLOD(w,c,w);var d=c.denormalizeCol(w.col,w.world);for(var a of n.spans)if(a.row===w.row&&a.colFrom<=d&&a.colTo>=d)return!0}if(c.resolution<p.resolution){const [f,
m,g,x]=n.spans.reduce((q,B)=>{q[0]=Math.min(q[0],B.row);q[1]=Math.max(q[1],B.row);q[2]=Math.min(q[2],B.colFrom);q[3]=Math.max(q[3],B.colTo);return q},[Infinity,-Infinity,Infinity,-Infinity]);d=p.denormalizeCol(w.col,w.world);n=c.getColumnForX(p.getXForColumn(d));a=c.getRowForY(p.getYForRow(w.row));d=c.getColumnForX(p.getXForColumn(d+1))-1;p=c.getRowForY(p.getYForRow(w.row+1))-1;return!(n>x||d<g||a>m||p<f)}const b=c.denormalizeCol(w.col,w.world);return n.spans.some(f=>f.row===w.row&&f.colFrom<=b&&
f.colTo>=b)};k.normalizeBounds=function(n,p,c){n[0]=p[0];n[1]=p[1];n[2]=p[2];n[3]=p[3];this._wrap&&(p=t.getInfo(this.tileInfo.spatialReference),c=-c*(p.valid[1]-p.valid[0]),n[0]+=c,n[2]+=c);return n};k.getSmallestInfoForScale=function(n){const p=this.scales;if(this._infoByScale[n])return this._infoByScale[n];if(n>p[0])return this._infoByScale[p[0]];for(let c=1;c<p.length-1;c++)if(n>p[c]+1E-6)return this._infoByScale[p[c-1]];return this._infoByScale[p[p.length-1]]};k.getClosestInfoForScale=function(n){const p=
this.scales;if(this._infoByScale[n])return this._infoByScale[n];n=p.reduce((c,d)=>Math.abs(d-n)<Math.abs(c-n)?d:c,p[0]);return this._infoByScale[n]};k.scaleToLevel=function(n){const p=this.scales;if(this._infoByScale[n])return this._infoByScale[n].level;for(let c=p.length-1;0<=c;c--)if(n<p[c])return c===p.length-1?this._infoByScale[p[p.length-1]].level:this._infoByScale[p[c]].level+(p[c]-n)/(p[c]-p[c+1]);return this._infoByScale[p[0]].level};k.scaleToZoom=function(n){return this.tileInfo.scaleToZoom(n)};
k._getTileIdAtLOD=function(n,p,c){const d=this._infoByLevel[c.level];n.set(c);if(p.resolution<d.resolution)return null;if(p.resolution===d.resolution)return n;n.level=p.level;n.col=Math.floor(c.col*d.resolution/p.resolution+.01);n.row=Math.floor(c.row*d.resolution/p.resolution+.01);return n};r._createClass(h,[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return h}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../core/maybe","../../../geometry/support/spatialReferenceUtils",
"./TileKey"],function(r,t,F){function C(A,w,l){A[0]=w;A[1]=l;return A}const v=new F("0/0/0/0");return function(){function A(l,e,h,k,n,p,c,d,a,b,f,m){this.level=l;this.resolution=e;this.scale=h;this.origin=k;this.first=n;this.last=p;this.size=c;this.norm=d;this.worldStart=a;this.worldEnd=b;this.worldSize=f;this.wrap=m}A.create=function(l,e,h=null){var k=t.getInfo(l.spatialReference);const n=e.origin||[l.origin.x,l.origin.y],p=[l.size[0]*e.resolution,l.size[1]*e.resolution],c=[-Infinity,-Infinity],
d=[Infinity,Infinity],a=[Infinity,Infinity];r.isSome(h)&&(C(c,Math.max(0,Math.floor((h.xmin-n[0])/p[0])),Math.max(0,Math.floor((n[1]-h.ymax)/p[1]))),C(d,Math.max(0,Math.floor((h.xmax-n[0])/p[0])),Math.max(0,Math.floor((n[1]-h.ymin)/p[1]))),C(a,d[0]-c[0]+1,d[1]-c[1]+1));const {cols:b,rows:f}=e;!h&&b&&f&&(C(c,b[0],f[0]),C(d,b[1],f[1]),C(a,b[1]-b[0]+1,f[1]-f[0]+1));let m;l.isWrappable?(l=[Math.ceil(Math.round((k.valid[1]-k.valid[0])/e.resolution)/l.size[0]),a[1]],k=[Math.floor((k.origin[0]-n[0])/p[0]),
c[1]],h=[l[0]+k[0]-1,d[1]],m=!0):(k=c,h=d,l=a,m=!1);return new A(e.level,e.resolution,e.scale,n,c,d,a,p,k,h,l,m)};var w=A.prototype;w.normalizeCol=function(l){if(!this.wrap)return l;const e=this.worldSize[0];return 0>l?e-1-Math.abs((l+1)%e):l%e};w.denormalizeCol=function(l,e){return this.wrap?this.worldSize[0]*e+l:l};w.getWorldForColumn=function(l){return this.wrap?Math.floor(l/this.worldSize[0]):0};w.getFirstColumnForWorld=function(l){return l*this.worldSize[0]+this.first[0]};w.getLastColumnForWorld=
function(l){return l*this.worldSize[0]+this.first[0]+this.size[0]-1};w.getColumnForX=function(l){return(l-this.origin[0])/this.norm[0]};w.getXForColumn=function(l){return this.origin[0]+l*this.norm[0]};w.getRowForY=function(l){return(this.origin[1]-l)/this.norm[1]};w.getYForRow=function(l){return this.origin[1]-l*this.norm[1]};w.getTileBounds=function(l,e,h=!1){v.set(e);var k=h?v.col:this.denormalizeCol(v.col,v.world),n=v.row;e=this.getXForColumn(k);h=this.getYForRow(n+1);k=this.getXForColumn(k+1);
n=this.getYForRow(n);l[0]=e;l[1]=h;l[2]=k;l[3]=n;return l};w.getTileCoords=function(l,e,h=!1){v.set(e);e=h?v.col:this.denormalizeCol(v.col,v.world);Array.isArray(l)?C(l,this.getXForColumn(e),this.getYForRow(v.row)):(l.x=this.getXForColumn(e),l.y=this.getYForRow(v.row));return l};return A}()})},"esri/views/2d/tiling/TileSpan":function(){define(function(){return function(r,t,F){this.row=r;this.colFrom=t;this.colTo=F}})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/set ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q){function B(u,y){return(!u.minScale||u.minScale>=y)&&(!u.maxScale||u.maxScale<=y)}function z(u){u=u.message;const y={message:{data:{},tileKey:u.tileKey,tileKeyOrigin:u.tileKeyOrigin},transferList:[]};for(const J in u.data){var E=u.data[J];y.message.data[J]=null;if(w.isSome(E)){var H=E.stride;const P=E.indices.slice(0),O=E.vertices.slice(0),K=E.records.slice(0);E=w.applySome(E.metrics,D=>D.slice(0));H={stride:H,indices:P,vertices:O,records:K,metrics:E};
y.transferList.push(P,O,K);y.message.data[J]=H}}return y}A.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");C=function(u){function y(){var H=u.apply(this,arguments)||this;H.type="symbol";H._matchers={feature:null,aggregate:null};H._bufferData=new Map;H._bufferIds=new Map;return H}r._inheritsLoose(y,u);var E=y.prototype;E.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new q(this.remoteClient)};E.destroy=
function(){this._resourceManagerProxy.destroy()};E.forEachBufferId=function(H){this._bufferIds.forEach(J=>{J.forEach(H)})};E.update=function(){var H=r._asyncToGenerator(function*(J,P){P=P.schema.processors[0];if("symbol"===P.type){var O=p.diff(this._schema,P);p.hasDiff(O,"mesh")&&(v("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",O),J.mesh=!0,J.why.mesh.push("Symbology changed"),this._schema=P,this._factory=this._createFactory(P),this._factory.update(P,this.tileStore.tileScheme.tileInfo))}});
return function(J,P){return H.apply(this,arguments)}}();E.onTileMessage=function(H,J,P,O){l.throwIfAborted(O);return this._onTileData(H,J,P,O)};E.onTileClear=function(H){this._bufferData.delete(H.key.id);this._bufferIds.delete(H.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:H.id,data:{clear:!0}})};E.onTileError=function(H,J,P){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:H.id,error:J},{signal:P.signal})};E.onTileUpdate=function(H){for(const J of H.removed)this._bufferData.has(J.key.id)&&
this._bufferData.delete(J.key.id),this._bufferIds.has(J.key.id)&&this._bufferIds.delete(J.key.id);for(const J of H.added)this._bufferData.forEach(P=>{for(const O of P)O.message.tileKey===J.id&&this._updateTileMesh("append",J,z(O),[],!1,!1,null)})};E._addBufferData=function(H,J){this._bufferData.has(H)||this._bufferData.set(H,[]);this._bufferData.get(H).push(z(J))};E._createFactory=function(H){const {geometryType:J,objectIdField:P,fields:O}=this.service,K=c.fromJSON(this.spatialReference),D={geometryType:J,
fields:O,spatialReference:K},I=new f.WGLTemplateStore((Z,X)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",Z,X),this.tileStore.tileScheme.tileInfo),{matcher:L,aggregateMatcher:R}=H.mesh;this._store=I;this._matchers.feature=m.createMatcher(L,I,D,this._resourceManagerProxy);this._matchers.aggregate=w.applySome(R,Z=>m.createMatcher(Z,I,D,this._resourceManagerProxy));return new b.WGLMeshFactory(J,P,I)};E._onTileData=function(){var H=r._asyncToGenerator(function*(J,P,O,K){l.throwIfAborted(K);
const {type:D,addOrUpdate:I,remove:L}=P;var R=P.end;const Z=!!this._schema.mesh.sortKey;if(!I)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:J.id,data:{type:D,addOrUpdate:null,remove:L,clear:!1,end:R,sort:Z}},K);O=this._processFeatures(J,I,O,K);try{var X=yield O;if(w.isNone(X))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:J.id,data:{type:D,addOrUpdate:null,remove:L,clear:!1,end:R,sort:Z}},K);R=[];for(const Q of X){X=!1;const M=Q.message.bufferIds,V=J.key.id,
fa=Q.message.tileKey;if(V!==fa&&w.isSome(M)){if(!this.tileStore.get(fa)){this._addBufferData(V,Q);R.push(Q);continue}let oa=this._bufferIds.get(fa);oa||(oa=new Set,this._bufferIds.set(fa,oa));const ua=Array.from(M);for(const xa of ua)if(oa.has(xa)){X=!0;break}else oa.add(xa)}X||(this._addBufferData(V,Q),R.push(Q))}yield l.all(R.map(Q=>{const M=J.key.id===Q.message.tileKey;return this._updateTileMesh(D,J,Q,M?P.remove:[],M&&P.end,P.clear,K.signal)}))}catch(Q){this._handleError(J,Q,K)}});return function(J,
P,O,K){return H.apply(this,arguments)}}();E._updateTileMesh=function(){var H=r._asyncToGenerator(function*(J,P,O,K,D,I,L){I=O.message.tileKey;const R=!!this._schema.mesh.sortKey;I!==P.key.id&&(D=!1);P=w.applySome(O,Z=>Z.message);O=w.applySome(O,Z=>Z.transferList)||[];J={type:J,addOrUpdate:P,remove:K,clear:!1,end:D,sort:R};L={transferList:w.unwrap(O)||[],signal:L};l.throwIfAborted(L);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:I,data:J},L)});return function(J,P,O,K,D,I,L){return H.apply(this,
arguments)}}();E._processFeatures=function(){var H=r._asyncToGenerator(function*(J,P,O,K){if(w.isNone(P)||!P.hasFeatures)return null;const D={transform:J.transform,hasZ:!1,hasM:!1},I=this._factory,L={viewingMode:"",scale:J.scale},R=yield this._matchers.feature,Z=yield this._matchers.aggregate;l.throwIfAborted(K);const X=this._getLabelInfos(J,P);yield I.analyze(P.getCursor(),this._resourceManagerProxy,R,Z,D,L);l.throwIfAborted(K);return this._writeFeatureSet(J,P,D,X,I,O)});return function(J,P,O,K){return H.apply(this,
arguments)}}();E._writeFeatureSet=function(H,J,P,O,K,D){var I=J.getSize();D=new a.MeshData(H.key.id,{features:I,records:I,metrics:0},this._schema.mesh.matcher.stride,D,!0);I={viewingMode:"",scale:H.scale};for(J=J.getCursor();J.next();)try{const L=J.getDisplayId(),R=w.isSome(O)?O.get(L):null;K.writeCursor(D,J,P,I,H.level,R,this._resourceManagerProxy)}catch(L){}return D.serialize(H.tileInfoView.tileInfo.isWrappable)};E._handleError=function(H,J,P){if(!l.isAbortError(J))return this.remoteClient.invoke("tileRenderer.onTileError",
{tileKey:H.id,error:J.message},{signal:P.signal})};E._getLabelingSchemaForScale=function(H){var J=this._schema.mesh.labels;if(w.isNone(J))return null;if("subtype"===J.type){const P={type:"subtype",classes:{}};let O=!1;for(const K in J.classes){const D=J.classes[K].filter(I=>B(I,H.scale));O=O||!!D.length;P.classes[K]=D}return O?P:null}J=J.classes.filter(P=>B(P,H.scale));return J.length?{type:"simple",classes:J}:null};E._getLabels=function(H,J){if("subtype"===J.type){var P;const O=w.unwrapOrThrow(this.service.subtypeField,
"Expected to find subtype Field");H=H.readAttribute(O);return null==H?[]:null!=(P=J.classes[H])?P:[]}return J.classes};E._getLabelInfos=function(H,J){H=this._getLabelingSchemaForScale(H);if(w.isNone(H))return null;const P=new Map;for(J=J.getCursor();J.next();){const K=J.getDisplayId(),D=[],I=d.isAggregateId(K),L=I&&1!==J.readAttribute("cluster_count")?"aggregate":"feature";var O=this._getLabels(J,H);for(const R of O){if(R.target!==L)continue;O=J.getStorage();O=I&&"feature"===L?O.getComputedStringAtIndex(J.readAttribute("referenceId"),
R.fieldIndex):O.getComputedStringAtIndex(K,R.fieldIndex);if(!O)continue;O=F.bidiText(O.toString());const Z=O[1];this._store.getMosaicItem(R.symbol,g.codepoints(O[0])).then(X=>{D[R.index]={glyphs:X.glyphMosaicItems,rtl:Z,index:R.index}})}P.set(K,D)}return P};r._createClass(y,[{key:"supportsTileUpdates",get:function(){return!0}}]);return y}(x);return C=t.__decorate([n.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],C)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],
function(r,t){const F=new t;r.bidiText=function(C){if(!F.hasBidiChar(C))return[C,!1];let v;v="rtl"===F.checkContextual(C)?"IDNNN":"ICNNN";return[F.bidiTransform(C,v,"VLYSN"),!0]};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){function c(a){switch(a){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function d(a){switch(a){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}F=function(){function a(f,m,g,x,q){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,
isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=m;this.tileKey=f;this._hasAggregate=x;this._pixelBufferEnabled=q;this._strideOptions=g}var b=a.prototype;b.serialize=function(f){const m=[];m.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((g,x)=>{var q=1<<x;x=c(q);q=d(q);x=p.getPow2NeighborKey(new v(this.tileKey),x,q,f);x=this._serializeTileVertexData(this.tileKey,x.id,g.vertexData);x.message.bufferIds=g.displayIds;m.push(x)});
return m};b._serializeTileVertexData=function(f,m,g){var x,q,B,z,u;const y=[];g={[h.WGLGeometryType.MARKER]:null==(x=g.get(h.WGLGeometryType.MARKER))?void 0:x.serialize(y),[h.WGLGeometryType.FILL]:null==(q=g.get(h.WGLGeometryType.FILL))?void 0:q.serialize(y),[h.WGLGeometryType.LINE]:null==(B=g.get(h.WGLGeometryType.LINE))?void 0:B.serialize(y),[h.WGLGeometryType.TEXT]:null==(z=g.get(h.WGLGeometryType.TEXT))?void 0:z.serialize(y),[h.WGLGeometryType.LABEL]:null==(u=g.get(h.WGLGeometryType.LABEL))?void 0:
u.serialize(y)};return{message:{tileKeyOrigin:f,tileKey:m,data:g},transferList:y}};b.featureStart=function(f,m){this._current.insertAfter=f;this._current.sortKey=m};b.featureEnd=function(){};b.recordStart=function(f,m,g,x){this._current.writer=this._getVertexWriter(g);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=x;this._current.id=f;this._current.materialKey=m;this._current.geometryType=
g;this._current.isDotDensity=!1;this._current.writer.recordStart()};b.recordCount=function(){return this._current.writer.recordCount};b.vertexCount=function(){return this._current.writer.vertexCount};b.indexCount=function(){return this._current.writer.indexCount};b.vertexEnsureSize=function(f){this._current.writer.vertexEnsureSize(f)};b.indexEnsureSize=function(f){this._current.writer.indexEnsureSize(f)};b.vertexBounds=function(f,m,g,x){this._current.bufferingEnabled&&this._addOverlap(f,m,g,x)};b.vertexWrite=
function(f){this._current.writer.writeVertex(f)};b.vertexWriteF32=function(f){this._current.writer.writeVertexF32(f)};b.vertexEnd=function(){};b.vertexWriter=function(){return this._current.writer.vertexWriter};b.indexWrite=function(f){this._current.writer.writeIndex(f)};b.indexWriter=function(){return this._current.writer.indexWriter};b.metricWriter=function(){return this._current.writer.metricWriter};b.metricStart=function(f,m,g,x,q,B,z,u){this._current.writer=this._getVertexWriter(h.WGLGeometryType.LABEL);
const y=this._current.writer.metricWriter;y.push(e.getDisplayIdTexel(f));y.push(m);y.push(g);y.push(x);y.push(q);y.push(B);y.push(z);y.push(u);y.push(255);this._current.metricBoxLenPointer=y.push(0)};b.metricEnd=function(){const f=this._current.writer.metricWriter;0===f.getValue(this._current.metricBoxLenPointer)&&f.seek(f.length-10)};b.metricBoxWrite=function(f,m,g,x){const q=this._current.writer.metricWriter;q.incr(this._current.metricBoxLenPointer);q.push(0);q.push(0);q.push(f);q.push(m);q.push(g);
q.push(x)};b.recordEnd=function(){var f=this._current.vertStart,m=this._current.writer.vertexCount-f;if(!m)return!1;this.hasRecords=!0;var g=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,g,this._current.writer.indexCount-g,f,m,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===h.WGLGeometryType.LABEL)return!0;f=this._current.writer;for(m=0;8>
m;m++){var x=1<<m;if(this._current.overlaps&x){this._data.neighbors[m]||(this._data.neighbors[m]={vertexData:new Map,displayIds:new Set});g=this._data.neighbors[m];var q=this._current.geometryType;if(!g.vertexData.has(q)){var B=k.getStrides(q,this._strideOptions).geometry;B=new n.VertexDataWriter(q,B,l.PATCH_PIXEL_BUFFER_ALLOC_SIZE);g.vertexData.set(q,B)}q=g.vertexData.get(this._current.geometryType);B=4096*-c(x);x=4096*-d(x);q.copyLastFrom(f,B,x);g.displayIds.add(this._current.id)}}return!0};b._addOverlap=
function(f,m,g,x){this._current.overlaps|=255^((f<0+g?148:f>=l.TILE_SIZE-g?41:189)|(m<0+x?224:m>=l.TILE_SIZE-x?7:231))};b._getVertexWriter=function(f){if(!this._data.self.has(f)){const m=this._data.self,g=k.getStrides(f,this._strideOptions).geometry;m.set(f,new n.VertexDataWriter(f,g,this.hint.records))}return this._data.self.get(f)};t._createClass(a,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return a}();
r.MeshData=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),function(r,t,F,C,v,A,w,l,e,h){function k(a,
b){a.length=0;b.forEach(f=>a.push(f));return a}const n=new Set,p=[],c=new Map,d=[0,0];F=function(a){function b(m){m=a.call(this,m)||this;m._keyToItem=new Map;m.concurrency=6;m.strategy="scale-first";m.tileInfoView=null;return m}r._inheritsLoose(b,a);var f=b.prototype;f.initialize=function(){const {concurrency:m,process:g}=this;this._queue=new h.QueueProcessor({concurrency:m,process:(x,q)=>{x=this._keyToItem.get(x);return g(x,{signal:q})},peeker:x=>x.values().next().value})};f.destroy=function(){this.clear();
this._queue.destroy();this._queue=null};f.abort=function(m){this._queue.abort("string"===typeof m?m:m.id)};f.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.has=function(m){return"string"===typeof m?this._keyToItem.has(m):this._keyToItem.has(m.id)};f.isOngoing=function(m){m="string"===typeof m?m:m.id;return this.has(m)&&this._queue.isOngoing(m)};f.pause=function(){this._queue.pause()};f.push=function(m,g){const x=m.key.id+"-"+g;if(this.has(x))return this.get(x);
g=this._queue.push(x);const q=()=>{this._keyToItem.delete(x);this.notifyChange("updating")};this._keyToItem.set(x,m);g.then(q,q);this.notifyChange("updating");return g};f.reset=function(){this._queue.reset();this.notifyChange("updating")};f.resume=function(){this._queue.resume()};f._peekByScaleFirst=function(m){if(!this.state)return m.values().next().value;const g=this.tileInfoView;let x=Number.NEGATIVE_INFINITY,q=Number.POSITIVE_INFINITY;m.forEach(E=>{E=this._keyToItem.get(E);const H=this.tileInfoView.getTileScale(E.key);
c.has(H)||(c.set(H,[]),x=Math.max(H,x),q=Math.min(H,q));c.get(H).push(E.key);n.add(H)});let B=this.state.scale;c.has(B)||(k(p,n),p.sort((E,H)=>E-H),B=p.reduce((E,H)=>Math.abs(H-B)<Math.abs(E-B)?H:E,p[0]));B=Math.min(B,x);B=Math.max(B,q);m=c.get(B);const z=g.getClosestInfoForScale(B),u=z.getColumnForX(this.state.center[0]),y=z.getRowForY(this.state.center[1]);m.sort((E,H)=>{const J=z.denormalizeCol(E.col,E.world),P=z.denormalizeCol(H.col,H.world);return Math.sqrt((u-J)*(u-J)+(y-E.row)*(y-E.row))-Math.sqrt((u-
P)*(u-P)+(y-H.row)*(y-H.row))});n.clear();c.clear();return m[0].id};f._peekByCenterFirst=function(m){if(!this.state)return m.values().next().value;const g=this.tileInfoView,x=this.state.center;let q=Number.POSITIVE_INFINITY,B=null;m.forEach(z=>{z=this._keyToItem.get(z);g.getTileCoords(d,z.key);const u=e.distance(d,x);u<q&&(q=u,B=z.key)});return B.id};r._createClass(b,[{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},
{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(F);t.__decorate([C.property({constructOnly:!0})],F.prototype,"concurrency",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"process",void 0);t.__decorate([C.property()],F.prototype,"state",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"strategy",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"tileInfoView",void 0);t.__decorate([C.property({readOnly:!0})],
F.prototype,"updating",null);return F=t.__decorate([l.subclass("esri.views.2d.tiling.PagedTileQueue")],F)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(r,t){function F(X,Q){X[0]=Q[0];X[1]=Q[1];return X}function C(X,Q,M){X[0]=Q;X[1]=M;return X}function v(X,Q,M){X[0]=Q[0]+M[0];X[1]=Q[1]+M[1];return X}function A(X,Q,M){X[0]=Q[0]-M[0];X[1]=Q[1]-M[1];return X}function w(X,Q,M){X[0]=Q[0]*M[0];X[1]=Q[1]*M[1];return X}function l(X,Q,M){X[0]=Q[0]/M[0];X[1]=Q[1]/M[1];return X}function e(X,
Q){X[0]=Math.ceil(Q[0]);X[1]=Math.ceil(Q[1]);return X}function h(X,Q){X[0]=Math.floor(Q[0]);X[1]=Math.floor(Q[1]);return X}function k(X,Q,M){X[0]=Math.min(Q[0],M[0]);X[1]=Math.min(Q[1],M[1]);return X}function n(X,Q,M){X[0]=Math.max(Q[0],M[0]);X[1]=Math.max(Q[1],M[1]);return X}function p(X,Q){X[0]=Math.round(Q[0]);X[1]=Math.round(Q[1]);return X}function c(X,Q,M){X[0]=Q[0]*M;X[1]=Q[1]*M;return X}function d(X,Q,M,V){X[0]=Q[0]+M[0]*V;X[1]=Q[1]+M[1]*V;return X}function a(X,Q){const M=Q[0]-X[0];X=Q[1]-
X[1];return Math.sqrt(M*M+X*X)}function b(X,Q){const M=Q[0]-X[0];X=Q[1]-X[1];return M*M+X*X}function f(X){const Q=X[0];X=X[1];return Math.sqrt(Q*Q+X*X)}function m(X){const Q=X[0];X=X[1];return Q*Q+X*X}function g(X,Q){X[0]=-Q[0];X[1]=-Q[1];return X}function x(X,Q){X[0]=1/Q[0];X[1]=1/Q[1];return X}function q(X,Q){var M=Q[0];const V=Q[1];M=M*M+V*V;0<M&&(M=1/Math.sqrt(M),X[0]=Q[0]*M,X[1]=Q[1]*M);return X}function B(X,Q){return X[0]*Q[0]+X[1]*Q[1]}function z(X,Q,M){Q=Q[0]*M[1]-Q[1]*M[0];X[0]=X[1]=0;X[2]=
Q;return X}function u(X,Q,M,V){const fa=Q[0];Q=Q[1];X[0]=fa+V*(M[0]-fa);X[1]=Q+V*(M[1]-Q);return X}function y(X,Q){Q=Q||1;const M=2*t.RANDOM()*Math.PI;X[0]=Math.cos(M)*Q;X[1]=Math.sin(M)*Q;return X}function E(X,Q,M){const V=Q[0];Q=Q[1];X[0]=M[0]*V+M[2]*Q;X[1]=M[1]*V+M[3]*Q;return X}function H(X,Q,M){const V=Q[0];Q=Q[1];X[0]=M[0]*V+M[2]*Q+M[4];X[1]=M[1]*V+M[3]*Q+M[5];return X}function J(X,Q,M){const V=Q[0];Q=Q[1];X[0]=M[0]*V+M[3]*Q+M[6];X[1]=M[1]*V+M[4]*Q+M[7];return X}function P(X,Q,M){const V=Q[0];
Q=Q[1];X[0]=M[0]*V+M[4]*Q+M[12];X[1]=M[1]*V+M[5]*Q+M[13];return X}function O(X,Q,M,V){const fa=Q[0]-M[0];Q=Q[1]-M[1];const oa=Math.sin(V);V=Math.cos(V);X[0]=fa*V-Q*oa+M[0];X[1]=fa*oa+Q*V+M[1];return X}function K(X,Q){var M=X[0];X=X[1];const V=Q[0];Q=Q[1];let fa=M*M+X*X;0<fa&&(fa=1/Math.sqrt(fa));let oa=V*V+Q*Q;0<oa&&(oa=1/Math.sqrt(oa));M=(M*V+X*Q)*fa*oa;return 1<M?0:-1>M?Math.PI:Math.acos(M)}function D(X){return"vec2("+X[0]+", "+X[1]+")"}function I(X,Q){return X[0]===Q[0]&&X[1]===Q[1]}function L(X,
Q){const M=X[0];X=X[1];const V=Q[0];Q=Q[1];return Math.abs(M-V)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(V))&&Math.abs(X-Q)<=t.EPSILON*Math.max(1,Math.abs(X),Math.abs(Q))}function R(X,Q,M,V,fa){let oa=Q[0]-M[0];M=Q[1]-M[1];fa=(V[0]*oa+V[1]*M)*(fa-1);oa=V[0]*fa;M=V[1]*fa;X[0]=Q[0]+oa;X[1]=Q[1]+M;return X}const Z=Object.freeze({__proto__:null,copy:F,set:C,add:v,subtract:A,multiply:w,divide:l,ceil:e,floor:h,min:k,max:n,round:p,scale:c,scaleAndAdd:d,distance:a,squaredDistance:b,length:f,squaredLength:m,
negate:g,inverse:x,normalize:q,dot:B,cross:z,lerp:u,random:y,transformMat2:E,transformMat2d:H,transformMat3:J,transformMat4:P,rotate:O,angle:K,str:D,exactEquals:I,equals:L,projectAndScale:R,len:f,sub:A,mul:w,div:l,dist:a,sqrDist:b,sqrLen:m});r.add=v;r.angle=K;r.ceil=e;r.copy=F;r.cross=z;r.dist=a;r.distance=a;r.div=l;r.divide=l;r.dot=B;r.equals=L;r.exactEquals=I;r.floor=h;r.inverse=x;r.len=f;r.length=f;r.lerp=u;r.max=n;r.min=k;r.mul=w;r.multiply=w;r.negate=g;r.normalize=q;r.projectAndScale=R;r.random=
y;r.rotate=O;r.round=p;r.scale=c;r.scaleAndAdd=d;r.set=C;r.sqrDist=b;r.sqrLen=m;r.squaredDistance=b;r.squaredLength=m;r.str=D;r.sub=A;r.subtract=A;r.transformMat2=E;r.transformMat2d=H;r.transformMat3=J;r.transformMat4=P;r.vec2=Z})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(r,t,F,C,v,A,w,l,e,h){function k(a,b){a.length=0;b.forEach(f=>a.push(f));return a}const n=new Set,p=[],c=new Map,d=[0,0];F=function(a){function b(m){m=a.call(this,m)||this;m._keyToItem=new Map;m.concurrency=6;m.strategy="scale-first";m.tileInfoView=null;return m}r._inheritsLoose(b,a);var f=b.prototype;f.initialize=function(){const {concurrency:m,process:g,strategy:x}=this;this._queue=new h.QueueProcessor({concurrency:m,process:(q,B)=>{q=this._keyToItem.get(q);return g(q,{signal:B})},peeker:"scale-first"===
x?q=>this._peekByScaleFirst(q):q=>this._peekByCenterFirst(q)})};f.destroy=function(){this.clear();this._queue.destroy();this._queue=null};f.abort=function(m){this._queue.abort("string"===typeof m?m:m.id)};f.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.has=function(m){return"string"===typeof m?this._keyToItem.has(m):this._keyToItem.has(m.id)};f.isOngoing=function(m){m="string"===typeof m?m:m.id;return this.has(m)&&this._queue.isOngoing(m)};f.pause=function(){this._queue.pause()};
f.push=function(m){const g=m.key.id;if(this._queue.has(g))return this._queue.get(g);const x=this._queue.push(g),q=()=>{this._keyToItem.delete(g);this.notifyChange("updating")};this._keyToItem.set(g,m);x.then(q,q);this.notifyChange("updating");return x};f.reset=function(){this._queue.reset()};f.resume=function(){this._queue.resume()};f._peekByScaleFirst=function(m){if(!this.state)return m.values().next().value;const g=this.tileInfoView;let x=Number.NEGATIVE_INFINITY,q=Number.POSITIVE_INFINITY;m.forEach(E=>
{E=this._keyToItem.get(E);const H=this.tileInfoView.getTileScale(E.key);c.has(H)||(c.set(H,[]),x=Math.max(H,x),q=Math.min(H,q));c.get(H).push(E.key);n.add(H)});let B=this.state.scale;c.has(B)||(k(p,n),p.sort((E,H)=>E-H),B=p.reduce((E,H)=>Math.abs(H-B)<Math.abs(E-B)?H:E,p[0]));B=Math.min(B,x);B=Math.max(B,q);m=c.get(B);const z=g.getClosestInfoForScale(B),u=z.getColumnForX(this.state.center[0]),y=z.getRowForY(this.state.center[1]);m.sort((E,H)=>{const J=z.denormalizeCol(E.col,E.world),P=z.denormalizeCol(H.col,
H.world);return Math.sqrt((u-J)*(u-J)+(y-E.row)*(y-E.row))-Math.sqrt((u-P)*(u-P)+(y-H.row)*(y-H.row))});n.clear();c.clear();return m[0].id};f._peekByCenterFirst=function(m){if(!this.state)return m.values().next().value;const g=this.tileInfoView,x=this.state.center;let q=Number.POSITIVE_INFINITY,B=null;m.forEach(z=>{z=this._keyToItem.get(z);g.getTileCoords(d,z.key);const u=e.distance(d,x);u<q&&(q=u,B=z.key)});return B.id};r._createClass(b,[{key:"length",get:function(){return this._queue?this._queue.length:
0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(F);t.__decorate([C.property({constructOnly:!0})],F.prototype,"concurrency",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"process",void 0);t.__decorate([C.property()],F.prototype,"state",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"strategy",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,
"tileInfoView",void 0);t.__decorate([C.property({readOnly:!0})],F.prototype,"updating",null);return F=t.__decorate([l.subclass("esri.views.2d.tiling.TileQueue")],F)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(r,t,F,C){const v=new C(0,0,0,0),A=new Map,w=[],l=[];return function(){function e(k){this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";
this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=k.acquireTile;this.releaseTile=k.releaseTile;this.tileInfoView=k.tileInfoView;this.resampling=null==k.resampling||!!k.resampling;k.cachePolicy&&(this.cachePolicy=k.cachePolicy);k.coveragePolicy&&(this.coveragePolicy=k.coveragePolicy);null!=k.buffer&&(this.buffer=k.buffer);k.cacheSize&&(this._tileCache=new t(k.cacheSize,this.tileInfoView,n=>{this.releaseTile(n)}))}var h=e.prototype;h.destroy=function(){this.tileIndex.clear()};
h.update=function(k){const {resampling:n,tileIndex:p}=this,c=this.tileInfoView.getTileCoverage(k.state,this.buffer,this.coveragePolicy);l.length=0;w.length=0;A.clear();if(c){var {minScale:d,maxScale:a}=this.tileInfoView.tileInfo,{spans:b,lodInfo:f}=c,{level:m}=f,{scale:g,center:x,resolution:q}=k.state,B=!k.stationary&&g>this._previousScale;this._previousScale=g;this.tiles.length=0;if(!n&&(g>d||g<a))return this.tiles.length=0,A.clear(),p.forEach(H=>{this.releaseTile(H)}),p.clear(),l.length=0,w.length=
0,A.clear(),F.pool.release(c),!0;p.forEach(H=>H.visible=!0);var z=k=0;if(0<b.length)for(const {row:H,colFrom:J,colTo:P}of b)for(let O=J;O<=P;O++){k++;const K=v.set(m,H,f.normalizeCol(O),f.getWorldForColumn(O)).id;if(p.has(K)){var u=p.get(K);u.isReady?(A.set(K,u),z++):B||this._addParentTile(K,A)}else{if(this._tileCache&&this._tileCache.has(K)){if(u=this._tileCache.pop(K),this.tileIndex.set(K,u),u.isReady){A.set(K,u);z++;continue}}else u=this.acquireTile(v),this.tileIndex.set(K,u);B||this._addParentTile(K,
A)}}var y=z===k;p.forEach((H,J)=>{v.set(J);if(!A.has(J)){var P=this.tileInfoView.intersects(c,v),O="purge"===this.cachePolicy?v.level!==m:v.level>m;!P||!B&&y?!O&&P||w.push(J):H.isReady?O&&"purge"===this.cachePolicy&&this._hasReadyAncestor(v,m)?w.push(J):l.push(J):O&&w.push(J)}});for(var E of l)(k=p.get(E))&&k.isReady&&A.set(E,k);for(const H of w)E=p.get(H),this._tileCache?this._tileCache.add(E):this.releaseTile(E),p.delete(H);A.forEach(H=>this.tiles.push(H));p.forEach(H=>{A.has(H.key.id)||(H.visible=
!1)});this._tileCache&&this._tileCache.prune(m,x,q);F.pool.release(c);A.clear();return y}};h.clear=function(k=!0){const {tileIndex:n}=this;k&&n.forEach(p=>{this.releaseTile(p)});n.clear()};h.updateCacheSize=function(k){this._tileCache&&(this._tileCache.maxSize=k)};h._addParentTile=function(k,n){let p=null;for(;;){k=this.tileInfoView.getTileParentId(k);if(!k)break;if(this.tileIndex.has(k)){if((p=this.tileIndex.get(k))&&p.isReady){n.has(p.key.id)||n.set(p.key.id,p);break}}else if(this._tileCache&&this._tileCache.has(k)&&
(p=this._tileCache.pop(k),this.tileIndex.set(k,p),p&&p.isReady)){n.has(p.key.id)||n.set(p.key.id,p);break}}};h._hasReadyAncestor=function(k,n){const p=r.create();this.tileInfoView.getTileBounds(p,k,!0);for(const c of this.tileIndex.values())if(c.isReady&&c.key.level>=n&&c.key.level<k.level){const d=r.create();this.tileInfoView.getTileBounds(d,c.key,!0);if(r.contains(d,p))return!0}return!1};return e}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/vec2"],function(r){return function(){function t(C,
v,A){this.maxSize=C;this.tileInfoView=v;this.removedFunc=A;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var F=t.prototype;F.has=function(C){return this._tilePerId.has(C)};F.get=function(C){return this._tilePerId.get(C)};F.pop=function(C){const v=this._tilePerId.get(C);if(!v)return null;const A=this._tileKeysPerLevel[v.key.level];this._tilePerId["delete"](C);for(let w=0;w<A.length;w++)if(A[w].id===C){A.splice(w,1);break}v.visible=!0;return v};F.add=function(C){C.visible=!1;const v=C.key,A=v.id;
this._tilePerId.has(A)||(this._tilePerId.set(A,C),C=v.level,this._tileKeysPerLevel[C]||(this._tileKeysPerLevel[C]=[]),this._tileKeysPerLevel[C].push(v))};F.prune=function(C,v,A){let w=this._tilePerId.size;if(!(w<=this.maxSize)){for(var l=this._tileKeysPerLevel.length-1;w>this.maxSize&&0<=l;)l!==C&&(w=this._pruneAroundCenterTile(w,v,A,l)),l--;w>this.maxSize&&(w=this._pruneAroundCenterTile(w,v,A,C))}};F._pruneAroundCenterTile=function(C,v,A,w){w=this._tileKeysPerLevel[w];if(!w||0===w.length)return C;
const {size:l,origin:e}=this.tileInfoView.tileInfo,h=A*l[0],k=A*l[1],n=[0,0],p=[0,0];for(w.sort((c,d)=>{n[0]=e.x+h*(c.col+.5);n[1]=e.y-k*(c.row+.5);p[0]=e.x+h*(d.col+.5);p[1]=e.y-k*(d.row+.5);return r.squaredDistance(n,v)-r.squaredDistance(p,v)});0<w.length&&(A=w.pop(),this._removeTile(A.id),C--,C!==this.maxSize););return C};F._removeTile=function(C){const v=this._tilePerId.get(C);this.removedFunc&&this.removedFunc(v);this._tilePerId["delete"](C)};return t}()})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(r,t,F,C,v){let A=function(){function w(e,h,k){this._start={index:0,vertex:0};k=C.getMeshSizeHint(e,h,k);h/=4;this.geometryType=e;this._records=new v(Int32Array,k.recordBytes);this._indices=new v(Uint32Array,k.indexBytes);this._vertices=new v(Uint32Array,k.vertexBytes);this._metrics=new v(Float32Array,0);this._strideInt=h}var l=w.prototype;l.serialize=function(e){const h=this._records.buffer(),
k=this._indices.buffer(),n=this._vertices.buffer(),p=this._metrics.length?this._metrics.buffer():null,c=4*this._strideInt;e.push(h,k,n);return{stride:c,records:h,indices:k,vertices:n,metrics:p}};l.vertexEnsureSize=function(e){this._vertices.ensureSize(e)};l.indexEnsureSize=function(e){this._indices.ensureSize(e)};l.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};l.recordEnd=function(e,h,k,n,p,c,d,a){this._records.push(e);this._records.push(h);
this._records.push(k);this._records.push(n);this._records.push(p);this._records.push(c);this._records.push(d);this._records.writeF32(a)};l.writeIndex=function(e){this._indices.push(e)};l.writeVertex=function(e){this._vertices.push(e)};l.writeVertexF32=function(e){this._vertices.writeF32(e)};l.copyLastFrom=function(e,h,k){var n=e._records.length-F.DISPLAY_RECORD_INT_PER_ELEMENT;const p=e._records.getValue(n),c=e._records.getValue(n+1),d=e._records.getValue(n+2),a=e._records.getValue(n+4),b=e._records.getValue(n+
6);n=e._records.getValue(n+7);const f=this._vertices.length;var m=(e._start.vertex-this._vertices.length)/this._strideInt;const g=this._indices.length,x=this.vertexCount;for(var q=e._start.index;q!==e._indices.length;q++){const B=e._indices.getValue(q);this._indices.push(B-m)}for(m=e._start.vertex;m!==e._vertices.length;m++)q=e._vertices.getValue(m),this._vertices.push(q);for(e=f;e<=this._vertices.length;e+=this._strideInt)this._vertices.i1616Add(e,h,k);this._records.push(p);this._records.push(c);
this._records.push(d);this._records.push(g);this._records.push(a);this._records.push(x);this._records.push(b);this._records.push(n)};t._createClass(w,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/F.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return w}();r.VertexDataWriter=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(r,t,F){const C=new Map;C.set(F.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});C.set(F.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});
C.set(F.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(F.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(F.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});r.getMeshHeuristic=function(v){return C.get(v)};r.getMeshSizeHint=function(v,A,w){const {indicesPerRecord:l,multiplier:e,verticesPerRecord:h}=C.get(v);return{recordBytes:w*t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:e*
l*w*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:e*h*w*A}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(C,v){this._pos=0;v=v?this._roundToNearest(v,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(v);this._buffer=new C(this._array);this._ctor=C;this._i16View=new Int16Array(this._array)}var F=t.prototype;F._roundToNearest=function(C,v){C=Math.round(C);
return C+(v-C%v)};F._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.25*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const v=new this._ctor(C);v.set(this._buffer,0);this._array=C;this._buffer=v;this._i16View=new Int16Array(this._array)}};F.ensureSize=function(C){this._ensureSize(C)};F.writeF32=function(C){this._ensureSize(1);const v=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;
return v};F.push=function(C){this._ensureSize(1);const v=this._pos;this._buffer[this._pos++]=C;return v};F.writeFixed=function(C){this._buffer[this._pos++]=C};F.setValue=function(C,v){this._buffer[C]=v};F.i1616Add=function(C,v,A){this._i16View[2*C]+=v;this._i16View[2*C+1]+=A};F.getValue=function(C){return this._buffer[C]};F.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");this._buffer[C]++};F.decr=function(C){this._buffer[C]--};F.writeRegion=function(C){this._ensureSize(C.length);
const v=this._pos;this._buffer.set(C,this._pos);this._pos+=C.length;return v};F.writeManyFrom=function(C,v,A){for(this._ensureSize(A-v);v!==A;v++)this.writeFixed(C._buffer[v])};F.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};F.toArray=function(){const C=this._array,v=[];for(let A=0;A<C.byteLength/4;A++)v.push(C[A]);return v};F.seek=function(C){this._pos=C};F.destroy=function(){this._buffer=this._array=null};r._createClass(t,[{key:"length",get:function(){return this._pos}}]);
return t}()})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(r,t){function F(C,v,A,w){C=C.clone();const l=1<<C.level;v=C.col+v;A=C.row+A;w&&0>v?(C.col=v+l,--C.world):v>=l?(C.col=v-l,C.world+=1):C.col=v;C.row=A;return C}r.getPow2NeighborKey=F;r.getPow2NeighborTile=function(C,v,A){v=F(C.key,v,A,C.tileInfoView.tileInfo.isWrappable);return new t.Tile(C.tileInfoView,v)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(r,t,F,C,v,A,w,l,e,h){F=function(){function k(p,c,d){this._loadPromise=A.loadLibtess();this._geometryType=p;this._idField=c;this._templateStore=d}var n=k.prototype;n.update=function(p,c){C.isSome(p.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(p.mesh.labels,c));this._schema=p};n._createLabelTemplates=function(p,c){const d=new Map;if("simple"===p.type){for(var a of p.classes)p=l.fromLabelClass(a,c),d.set(a.index,p);return d}for(const b in p.classes){a=p.classes[b];for(const f of a)a=
l.fromLabelClass(f,c),d.set(f.index,a)}return d};n.analyze=function(){var p=t._asyncToGenerator(function*(c,d,a,b,f,m,g){if(!v.isAborted(g)){var x;"dictionary"===a.type&&(x=yield a.analyze(this._idField,c.copy(),d,f,m,g));for(d=0;c.next();){var q=void 0;q=x?x[d++]:C.isSome(b)&&w.isAggregateId(c.getDisplayId())&&1!==c.readAttribute("cluster_count")?b.match(this._idField,c,this._geometryType,f,m):a.match(this._idField,c,this._geometryType,f,m);c.setGroupId(q);if(h.isDynamicId(q)){q=this._templateStore.getDynamicTemplateGroup(q);
for(const B of q)B&&B.analyze&&B.analyze(this._templateStore,c,f,m)}}yield this._loadPromise;return this._templateStore.finalize(g)}});return function(c,d,a,b,f,m,g){return p.apply(this,arguments)}}();n.analyzeGraphics=function(){var p=t._asyncToGenerator(function*(c,d,a,b,f,m){if(!v.isAborted(m)){c=c.getCursor();for(a&&(yield a.analyze(this._idField,c.copy(),d,b,f,m));c.next();){d=c.getGroupId();if(null==d||-1===d)d=a.match(this._idField,c,c.geometryType,b,f),c.setGroupId(d);if(h.isDynamicId(d)){const g=
this._templateStore.getDynamicTemplateGroup(d);for(const x of g)x&&x.analyze&&x.analyze(this._templateStore,c,b,f)}c.setGroupId(d)}yield this._loadPromise;return this._templateStore.finalize(m)}});return function(c,d,a,b,f,m){return p.apply(this,arguments)}}();n.writeGraphic=function(p,c,d,a){const b=c.getGroupId(),f=c.getDisplayId(),m=this._templateStore.getTemplateGroup(b);p.featureStart(c.insertAfter,0);if(null!=f){if(h.isDynamicId(b))for(const g of m)g&&g.bindFeature(c,null,null);if(m){for(const g of m)g&&
g.write(p,c,d,a);p.featureEnd()}}};n.writeCursor=function(p,c,d,a,b,f,m){const g=c.getGroupId(),x=c.getDisplayId(),q=this._templateStore.getTemplateGroup(g),B=this._schema.mesh.sortKey;let z=0;C.isSome(B)&&(z=null!=B.fieldIndex?c.getComputedNumericAtIndex(B.fieldIndex):null!=B.field?c.readAttribute(B.field):c.readAttribute(this._idField),z*="asc"===B.order?1:-1);p.featureStart(0,null==z||isNaN(z)?0:z);if(null!=x&&q){if(h.isDynamicId(g))for(const u of q)u.bindFeature(c,d,a);for(const u of q)u.write(p,
c,b,m);C.isSome(f)&&p.hasRecords&&(d=f&&this._findLabelRef(q),this._writeLabels(p,c,f,d,b,m));p.featureEnd()}};n._findLabelRef=function(p){for(const c of p)if(c instanceof e)return c;return null};n._writeLabels=function(p,c,d,a,b,f){for(const m of d)if(C.isSome(m)&&m){const {glyphs:g,rtl:x,index:q}=m;d=this._labelTemplates.get(q);d.setZoomLevel(b);d.bindReferenceTemplate(a);d.bindTextInfo(g,x);d.write(p,c,null,f)}};t._createClass(k,[{key:"templates",get:function(){return this._templateStore}}]);return k}();
r.WGLMeshFactory=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d){const a=F.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),b=(m,g="mapview-labeling")=>a.error(new t(g,m)),f=function(m){const g=new Map;return x=>{g.has(x)||g.set(x,m(x));return g.get(x)}}(m=>{let g=0;if(0===m)return Infinity;for(;!(m%2);)g++,m/=2;return g});return function(m){function g(q,B,z,u){var y,E,H;var J=m.call(this,q,z.font.size,z.haloSize||0,z.font.size,z.color&&e.premultiplyAlphaRGBAArray(z.color)||0,z.haloColor&&e.premultiplyAlphaRGBAArray(z.haloColor)||
0,z.horizontalAlignment,z.verticalAlignment,l.isMapAligned(B.labelPlacement)?w.Alignment.MAP:w.Alignment.SCREEN,z.font.decoration,!1,z.angle||0,z.xoffset,z.yoffset,z.lineWidth,z.lineHeight,null,null,null,null,null)||this;J._outLineLabelAngle=0;J._refPlacementPadding=0;J._refPlacementDirX=0;J._refPlacementDirY=0;J._refOffsetX=0;J._refOffsetY=0;J._zoomLevel=0;J.geometryType=k.WGLGeometryType.LABEL;J._allowOverrun=null!=(y=B.allowOverrun)?y:!1;J._repeatLabel=null!=(E=B.repeatLabel)?E:!0;J._labelPosition=
null!=(H=B.labelPosition)?H:"curved";y=!!B.minScale&&u.scaleToZoom(B.minScale)||0;y=C.clamp(y,0,25.5);u=!!B.maxScale&&u.scaleToZoom(B.maxScale)||255;u=C.clamp(u,0,25.5);const [P,O]=l.getAlignmentFromPlacement(B.labelPlacement);J._xAlignD=P;J._yAlignD=O;J._minZoom=y;J._maxZoom=u;J._refPlacementPadding=A.pt2px(z.haloSize)+h.TEXT_PLACEMENT_PADDING;J._repeatLabelDistance=B.repeatLabelDistance?A.pt2px(B.repeatLabelDistance):128;q=p.LabelMaterialKey.load(q);q.sdf=!0;J._materialKey=q.data;return J}r._inheritsLoose(g,
m);g.fromLabelClass=function(q,B){if("esriServerLinePlacementCenterAlong"===q.labelPlacement){const z=q.symbol;z.xoffset=0;z.yoffset=0;z.angle=0;z.font.decoration="none"}return new g(q.materialKey,q,q.symbol,B)};var x=g.prototype;x.setZoomLevel=function(q){this._zoomLevel=q};x.bindReferenceTemplate=function(q){let B=l.getXDirection(this._xAlignD),z=l.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(v.isNone(q))this._refSymbolAndPlacementOffset=n.i8888to32(0,0,Math.floor(127*B+127),
Math.floor(127*z+127));else{if("circle"===q.boundsType&&(B||z)){var u=Math.sqrt(B*B+z*z);B/=u;z/=u}u=Math.max(q.height,q.width);this._refSymbolAndPlacementOffset=n.i8888to32(4*this._refPlacementPadding,u,Math.floor(127*B+127),Math.floor(127*z+127));this._referenceSize=u;this._refPlacementDirX=B;this._refPlacementDirY=z;this._refOffsetX=q.xOffset;this._refOffsetY=q.yOffset}};x._write=function(q,B){if(!v.isNone(this._shapingInfo)){var z=this._shapingInfo,u=B.getDisplayId(),y="esriGeometryPolygon"===
B.geometryType?B.readLegacyCentroid():B.readLegacyGeometry();if(y)switch(this.current={out:q,inId:u,inShaping:z,zoomLevel:this._zoomLevel},B.geometryType){case "esriGeometryPolyline":this._placeLineLabels(y);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(y);break;default:b("mapview-labeling",`Geometry of type ${B.geometryType} is not supported`)}}};x._isVisible=function(q,B){const z=Math.floor(10*this.current.zoomLevel);return Math.floor(10*q)<=z&&z<=Math.floor(10*
B)};x._placePointLabels=function(q){const {out:B,inId:z,inShaping:u}=this.current;this._writeGlyphs(B,z,q,u)};x._placeLineLabels=function(q){q=c.smoothPaths(q.paths,this.current.inShaping.bounds.width);const B=this._placeSubdivGlyphs.bind(this),z=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const u of q)c.pathDivide(u,z,B,this._repeatLabel)};x._placeSubdivGlyphs=function(q,B,z,u){var y=f(B);z=Math.log2(Math.min(z,u-z)/(Math.sqrt(this._repeatLabelDistance)/2+this._shapedBox.width/2/2));
y=Math.max(this._minZoom,this.current.zoomLevel+1-(0===B?z:Math.min(y,z)));z=this.current.zoomLevel-y;u=this._shapedBox.width/2*2**z;this.current.inShaping.isMultiline?0===B&&this._placeStraight(q,y):this._allowOverrun&&0>z?this._placeStraightAlong(q,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(q,y):"curved"===this._labelPosition&&this._placeCurved(q,y,u)};x._placeStraight=function(q,B){const {out:z,inId:u,inShaping:y}=this.current;this._writeGlyphs(z,u,q,y,B)};x._placeCurved=
function(q,B,z){const {out:u,inId:y}=this.current;u.metricStart(y,B,q.x,q.y,0,0,0,0);const E=q.clone(),H=(180/Math.PI*q.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*q.angle%360*(254/360));this._placeFirst(E,B,1);this._placeBack(q,E,B,z,1);this._placeForward(q,E,B,z,1);this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(E,B,0);this._placeBack(q,E,B,z,0);this._placeForward(q,E,B,z,0);u.metricEnd()};x._placeStraightAlong=function(q,B){const {out:z,inId:u}=this.current;z.metricStart(u,
B,q.x,q.y,0,0,0,0);const y=q.clone(),E=(180/Math.PI*q.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*q.angle%360*(254/360));this._placeFirst(y,B,1,!0);this._outLineLabelAngle=Math.round(254/360*E);this._placeFirst(y,B,0,!0);z.metricEnd()};x._placeBack=function(q,B,z,u,y){const E=q.clone();for(q=q.backwardLength+0;E.prev()&&!(q>=u);)this._placeOnSegment(E,B,q,z,-1,y),q+=E.length+0};x._placeForward=function(q,B,z,u,y){const E=q.clone();for(q=q.remainingLength+0;E.next()&&!(q>=u);)this._placeOnSegment(E,
B,q,z,1,y),q+=E.length+0};x._placeFirst=function(q,B,z,u=!1){const y=this.current.inShaping;var E=y.glyphs;const H=this.current.zoomLevel,{out:J,inId:P}=this.current;for(const O of E)E=O.x>y.bounds.x?z:1-z,E=Math.max(0,H+Math.log2(Math.abs(O.x+O.width/2-y.bounds.x)/(E*q.remainingLength+(1-E)*q.backwardLength))),E=Math.max(B,u?0:E),O.maxZoom=25,O.angle=q.angle+(1-z)*Math.PI,O.minZoom=E,this._writeGlyph(J,P,q.x,q.y,O),z&&this._isVisible(O.minZoom,O.maxZoom)&&(E=O.bounds,J.metricBoxWrite(E.center[0],
E.center[1],E.width,E.height))};x._placeOnSegment=function(q,B,z,u,y,E){var H=this.current.inShaping.glyphs;const {out:J,inId:P}=this.current,O=this.current.inShaping,K=this.current.zoomLevel;var D=q.x+q.dx/q.length*-y*z,I=q.y+q.dy/q.length*-y*z;for(const R of H)if((H=R.x>O.bounds.x?E:1-E)&&1===y||!H&&-1===y){var L=Math.abs(R.x+R.width/2-O.bounds.x);H=Math.max(0,K+Math.log2(L/z)-.1);L=Math.max(u,K+Math.log2(L/(z+q.length+0)));0!==H&&(R.angle=q.angle+(1-E)*Math.PI,R.minZoom=L,R.maxZoom=H,this._writeGlyph(J,
P,D,I,R),E&&this._isVisible(R.minZoom,R.maxZoom)&&(H=R.bounds,J.metricBoxWrite(H.center[0]+(q.x-B.x),H.center[1]+(q.y-B.y),H.width,H.height)))}};x._writeGlyphs=function(q,B,z,u,y=this._minZoom){if(!(0>z.x||512<=z.x||0>z.y||512<=z.y)){var E=z.x+this._refOffsetX;z=z.y-this._refOffsetY;for(const H of u.glyphs)H.minZoom=y,H.maxZoom=this._maxZoom,this._writeGlyph(q,B,E,z,H);u=u.boundsT;q.metricStart(B,y,E,z,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);q.metricBoxWrite(u.center[0],
u.center[1],u.width,u.height);q.metricEnd()}};x._writeVertexCommon=function(q,B,z,u){const y=this._color,E=this._haloColor,H=n.i8888to32(0,0,this._size,this._haloSize);u=n.i8888to32(Math.floor(10*Math.max(u.minZoom,this._minZoom)),Math.floor(10*Math.min(u.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);q.vertexWrite(z);q.vertexWrite(B);q.vertexWrite(y);q.vertexWrite(E);q.vertexWrite(H);q.vertexWrite(this._refSymbolAndPlacementOffset);q.vertexWrite(u)};r._createClass(g,[{key:"_shapedBox",get:function(){return v.unwrap(this._shapingInfo).bounds}}]);
return g}(d)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(r){r.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(r.HAlign||(r.HAlign={}));r.VAlign=void 0;(function(t){t[t.Top=1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(r.VAlign||(r.VAlign={}));r.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[r.HAlign.Right,
r.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[r.HAlign.Center,r.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[r.HAlign.Left,r.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[r.HAlign.Right,r.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[r.HAlign.Center,
r.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[r.HAlign.Left,r.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[r.HAlign.Right,r.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[r.HAlign.Center,r.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[r.HAlign.Left,r.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[r.HAlign.Center,
r.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),[r.HAlign.Center,r.VAlign.Center]}};r.getJustification=function(t){switch(t){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":case "justify":return r.HAlign.Center}};r.getXAnchorDirection=function(t){switch(t){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":case "justify":return r.HAlign.Center}};r.getXDirection=function(t){switch(t){case r.HAlign.Right:return-1;
case r.HAlign.Center:return 0;case r.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}};r.getYAnchorDirection=function(t){switch(t){case "top":return r.VAlign.Top;case "middle":return r.VAlign.Center;case "baseline":return r.VAlign.Baseline;case "bottom":return r.VAlign.Bottom}};r.getYDirection=function(t){switch(t){case r.VAlign.Top:return 1;case r.VAlign.Center:return 0;case r.VAlign.Bottom:case r.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),
0}};r.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(r,
t,F,C,v){function A(b,f){const m=v.WGLVVFlag.SIZE_FIELD_STOPS|v.WGLVVFlag.SIZE_MINMAX_VALUE|v.WGLVVFlag.SIZE_SCALE_STOPS|v.WGLVVFlag.SIZE_UNIT_VALUE;b=(b&(v.WGLVVTarget.FIELD_TARGETS_OUTLINE|v.WGLVVTarget.MINMAX_TARGETS_OUTLINE|v.WGLVVTarget.SCALE_TARGETS_OUTLINE|v.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return f.isOutline||f.isOutlinedFill?m&b:m&~b}let w=function(){function b(m){this._data=0;this._data=m}b.load=function(m){const g=this.shared;g.data=m;return g};var f=b.prototype;f.setBit=function(m,
g){m=1<<m;this._data=g?this._data|m:this._data&~m};f.bit=function(m){return(this._data&1<<m)>>m};f.setBits=function(m,g,x){for(let q=g,B=0;q<x;q++,B++)this.setBit(q,0!==(m&1<<B))};f.bits=function(m,g){let x=0;for(let q=m,B=0;q<g;q++,B++)x|=this.bit(q)<<B;return x};f.hasVV=function(){return!1};f.setVV=function(m,g){};f.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};f.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(b,
[{key:"data",get:function(){return this._data},set:function(m){this._data=m}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(m){this.setBits(m,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(m){this.setBit(20,m)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(m){this.setBit(11,m)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(m){this.setBit(12,m)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(m){this.setBits(m,
0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case v.WGLGeometryType.FILL:return"fill";case v.WGLGeometryType.MARKER:return"marker";case v.WGLGeometryType.LINE:return"line";case v.WGLGeometryType.TEXT:return"text";case v.WGLGeometryType.LABEL:return"label";default:throw new F(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return b}();w.shared=new w(0);const l=b=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var g=
m.prototype;g.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};g.setVV=function(x,q){f.prototype.setVV.call(this,x,q);x&=A(x,q);this.vvSizeMinMaxValue=!!(x&v.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(x&v.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(x&v.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(x&v.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(m,[{key:"vvSizeMinMaxValue",get:function(){return 0!==
this.bit(16)},set:function(x){this.setBit(16,x)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(x){this.setBit(17,x)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(x){this.setBit(18,x)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(x){this.setBit(19,x)}}]);return m}(b),e=b=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var g=m.prototype;g.hasVV=function(){return f.prototype.hasVV.call(this)||
this.vvRotation};g.setVV=function(x,q){f.prototype.setVV.call(this,x,q);this.vvRotation=!q.isOutline&&!!(x&v.WGLVVFlag.ROTATION)};t._createClass(m,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(x){this.setBit(15,x)}}]);return m}(b),h=b=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var g=m.prototype;g.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvColor};g.setVV=function(x,q){f.prototype.setVV.call(this,x,q);this.vvColor=
!q.isOutline&&!!(x&v.WGLVVFlag.COLOR)};t._createClass(m,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(x){this.setBit(13,x)}}]);return m}(b),k=b=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var g=m.prototype;g.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvOpacity};g.setVV=function(x,q){f.prototype.setVV.call(this,x,q);this.vvOpacity=!q.isOutline&&!!(x&v.WGLVVFlag.OPACITY)};t._createClass(m,[{key:"vvOpacity",get:function(){return 0!==
this.bit(14)},set:function(x){this.setBit(14,x)}}]);return m}(b);let n=function(b){function f(){return b.apply(this,arguments)||this}t._inheritsLoose(f,b);f.load=function(m){const g=this.shared;g.data=m;return g};f.from=function(m){const g=this.load(0);g.geometryType=v.WGLGeometryType.FILL;g.dotDensity="dot-density"===m.stride.fill;g.simple="simple"===m.stride.fill;g.outlinedFill=m.isOutlinedFill;g.dotDensity||g.setVV(m.vvFlags,m);return g.data};f.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),
dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};t._createClass(f,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(m){this.setBit(15,m)}},{key:"simple",get:function(){return!!this.bit(22)},set:function(m){this.setBit(22,m)}},{key:"outlinedFill",get:function(){return!!this.bit(21)},
set:function(m){this.setBit(21,m)}}]);return f}(h(k(l(w))));n.shared=new n(0);let p=function(b){function f(){return b.apply(this,arguments)||this}t._inheritsLoose(f,b);f.load=function(m){const g=this.shared;g.data=m;return g};f.from=function(m){const g=this.load(0);g.geometryType=v.WGLGeometryType.MARKER;g.setVV(m.vvFlags,m);return g.data};f.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,
vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(h(k(e(l(w)))));p.shared=new p(0);let c=function(b){function f(){return b.apply(this,arguments)||this}t._inheritsLoose(f,b);f.load=function(m){const g=this.shared;g.data=m;return g};f.from=function(m){const g=this.load(0);g.geometryType=v.WGLGeometryType.LINE;g.setVV(m.vvFlags,m);return g.data};f.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),
vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(h(k(l(w))));c.shared=new c(0);let d=function(b){function f(){return b.apply(this,arguments)||this}t._inheritsLoose(f,b);f.load=function(m){const g=this.shared;g.data=m;return g};f.from=function(m){const g=this.load(0);g.geometryType=v.WGLGeometryType.TEXT;g.setVV(m.vvFlags,m);return g.data};
f.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(h(k(e(l(w)))));d.shared=new d(0);let a=function(b){function f(){return b.apply(this,arguments)||this}t._inheritsLoose(f,b);f.load=function(m){const g=this.shared;g.data=m;return g};
f.from=function(m){const g=this.load(0);g.geometryType=v.WGLGeometryType.LABEL;g.setVV(m.vvFlags,m);g.mapAligned=C.isMapAligned(m.placement);return g.data};f.prototype.getVariation=function(){return{...b.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(l(w));a.shared=new a(0);r.FillMaterialKey=n;r.LabelMaterialKey=a;r.LineMaterialKey=c;r.MarkerMaterialKey=
p;r.MaterialKeyBase=w;r.TextMaterialKey=d;r.createMaterialKey=function(b,f){switch(b){case v.WGLGeometryType.FILL:return n.from(f);case v.WGLGeometryType.LINE:return c.from(f);case v.WGLGeometryType.MARKER:return p.from(f);case v.WGLGeometryType.TEXT:return d.from(f);case v.WGLGeometryType.LABEL:return a.from(f);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${b}`);}};r.getSizeFlagsMask=A;r.hydrateMaterialKey=function(b){switch(w.load(b).geometryType){case v.WGLGeometryType.MARKER:return new p(b);
case v.WGLGeometryType.FILL:return new n(b);case v.WGLGeometryType.LINE:return new c(b);case v.WGLGeometryType.TEXT:return new d(b);case v.WGLGeometryType.LABEL:return new a(b)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(r,t,F,C){function v(h){return h.length-1}function A(h){let k=0;for(let n=0;n<v(h);n++)k+=
w(h,n);return k}function w(h,k,n=1){const [p,c]=h[k+1];return Math.sqrt(p*p+c*c)*n}function l(h,k,n,p,c){if(!(n<k)){var d=p.clone().seek(n/2);F.isNone(d)||(h(d.clone(),n,c),n=(n-k)/2,d=F.unwrap(d.seek(k/2)),l(h,k,n,p,c+1),l(h,k,n,d,c+1))}}let e=function(){function h(n,p,c,d,a){this._segments=n;this._index=p;this._distance=c;this._xStart=d;this._yStart=a;this._done=!1}h.create=function(n){return new h(n,0,0,n[0][0],n[0][1])};var k=h.prototype;k.clone=function(){return new h(this._segments,this._index,
this._distance,this.xStart,this.yStart)};k.equals=function(n){return this._index===n._index||n._index===this._index-1&&(0===this._distance||1===n._distance)||n._index===this._index+1&&(1===this._distance||0===n._distance)};k.leq=function(n){return this._index<n._index||this._index===n._index&&this._distance<=n._distance};k.geq=function(n){return this._index>n._index||this._index===n._index&&this._distance>=n._distance};k.hasPrev=function(){return 0<=this._index-1};k.hasNext=function(){return this._index+
1<v(this._segments)};k.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};k.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};k._seekBackwards=function(n,p){var c=this.backwardLength;if(n<=c)return this._distance=(c-n)/this.length,this;for(c=this.backwardLength;this.prev();){if(c+this.length>n)return this._seekBackwards(n-
c);c+=this.length}this._distance=0;return p?this:null};k.seek=function(n,p=!1){if(0>n)return this._seekBackwards(Math.abs(n),p);if(n<=this.remainingLength)return this._distance=(this.backwardLength+n)/this.length,this;let c=this.remainingLength;for(;this.next();){if(c+this.length>n)return this.seek(n-c,p);c+=this.length}this._distance=1;return p?this:null};t._createClass(h,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const n=this.dy;let p=Math.acos((0*
n+-1*-this.dx)/(1*this.length));0<n&&(p=2*Math.PI-p);return p}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+
.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:n,dy:p}=this;return Math.sqrt(n*n+p*p)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return h}();r.SegmentCursor=e;r.pathDivide=
function(h,k,n,p=!0){const c=A(h);h=e.create(h);const d=c/2;if(p){p=Math.floor(Math.max((c-k)/2,0)/k);h.seek(d-p*k);for(let a=-p;a<=p;a++)512>h.x&&0<=h.x&&512>h.y&&0<=h.y&&n(h.clone(),a,d+a*k,c),h.seek(k)}else h.seek(d),n(h.clone(),0,d+0*k,c)};r.pathLength=A;r.pathSubdivide=function(h,k,n){l(n,k,A(h),e.create(h),0)};r.segmentAt=function(h,k){return h[k+1]};r.segmentCount=v;r.segmentLength=w;r.smoothPaths=function(h,k){for(let E=0;E<h.length;E++){var n=h[E];const H=[];H.push(n[0]);for(var p=1;p<n.length;p++){let [J,
P]=H[p-1];J+=n[p][0];P+=n[p][1];H.push([J,P])}a:{n=H;p=k;if(0>=p)break a;const J=n.length;if(3>J)break a;const P=[];var c=0;P.push(0);for(var d=1;d<J;d++)c+=C.dist(n[d],n[d-1]),P.push(c);p=Math.min(p,.2*c);c=[];c.push(n[0][0]);c.push(n[0][1]);d=n[J-1][0];const O=n[J-1][1];var a=C.sub([0,0],n[0],n[1]);C.normalize(a);n[0][0]+=p*a[0];n[0][1]+=p*a[1];C.sub(a,n[J-1],n[J-2]);C.normalize(a);n[J-1][0]+=p*a[0];n[J-1][1]+=p*a[1];for(a=1;a<J;a++)P[a]+=p;P[J-1]+=p;a=.5*p;for(let K=1;K<J-1;K++){let D=0,I=0,L=
0;for(var b=K-1;0<=b&&!(P[b+1]<P[K]-a);b--){var f=a+P[b+1]-P[K],m=P[b+1]-P[b],g=P[K]-P[b]<a?1:f/m;if(1E-6>Math.abs(g))break;var x=g*g,q=g*f-.5*x*m,B=g*m/p,z=n[b+1],u=n[b][0]-z[0],y=n[b][1]-z[1];D+=B/q*(z[0]*g*f+.5*x*(f*u-m*z[0])-x*g*m*u/3);I+=B/q*(z[1]*g*f+.5*x*(f*y-m*z[1])-x*g*m*y/3);L+=B}for(b=K+1;b<J&&!(P[b-1]>P[K]+a);b++){f=a-P[b-1]+P[K];m=P[b]-P[b-1];g=P[b]-P[K]<a?1:f/m;if(1E-6>Math.abs(g))break;x=g*g;q=g*f-.5*x*m;B=g*m/p;z=n[b-1];u=n[b][0]-z[0];y=n[b][1]-z[1];D+=B/q*(z[0]*g*f+.5*x*(f*u-m*z[0])-
x*g*m*u/3);I+=B/q*(z[1]*g*f+.5*x*(f*y-m*z[1])-x*g*m*y/3);L+=B}c.push(D/L);c.push(I/L)}c.push(d);c.push(O);for(let K=0,D=0;K<J;K++)n[K][0]=c[D++],n[K][1]=c[D++]}n=[];n.push(H[0]);for(p=1;p<H.length;p++){const [J,P]=H[p-1],[O,K]=H[p];n.push([Math.round(O-J),Math.round(K-P)])}h[E]=n}return h};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(r){function t(F,C){return Math.sqrt(F*F+C*C)}r.DEFAULT_MAX_ZOOM=100;r.DEFAULT_MIN_ZOOM=
0;r.dist=function(F,C){return t(F[0]-C[0],F[1]-C[1])};r.getLimitCosine=function(F=2){return 1/Math.max(F,1)};r.getMinMaxZoom=function(F,C){const v=!!F.minScale&&C.scaleToZoom(F.minScale)||0;F=!!F.maxScale&&C.scaleToZoom(F.maxScale)||100;return[v,F]};r.isExtent=function(F){return void 0!==F.xmin&&void 0!==F.ymin&&void 0!==F.xmax&&void 0!==F.ymax};r.isFunction=function(F){return"function"===typeof F};r.isMultipoint=function(F){return void 0!==F.points};r.isPoint=function(F){return void 0!==F.x&&void 0!==
F.y};r.isPolygon=function(F){return void 0!==F.rings};r.isPolyline=function(F){return void 0!==F.paths};r.len=t;r.normalize=function(F){const C=t(F[0],F[1]);F[0]/=C;F[1]/=C};r.sub=function(F,C,v){F[0]=C[0]-v[0];F[1]=C[1]-v[1];return F};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){return function(p){function c(d,a,b,f,m,g,x,q,B,z,u,y,E,H,J,P,O,K,D=!1,I,L){var R=p.call(this)||this;R._xOffset=F.pt2px(E);R._yOffset=F.pt2px(H);R._decoration=z||"none";R._color=m;R._haloColor=g;R._haloSize=Math.min(Math.floor(5*F.pt2px(F.toPt(b))),127);R._size=Math.min(Math.round(F.pt2px(a)),127);a=Math.min(Math.round(F.pt2px(f||a)),127);R._referenceSize=Math.round(Math.sqrt(256*a));R._scale=R._size/w.GLYPH_SIZE;R._angle=y;R._justify=v.getJustification(x||"center");
R._xAlignD=v.getXAnchorDirection(x||"center");R._yAlignD=v.getYAnchorDirection(q||"baseline");R._baseline="baseline"===(q||"baseline");R._bitset=(B===C.Alignment.MAP?1:0)|(u?1:0)<<1;d=e.MaterialKeyBase.load(d);d.sdf=!0;R._materialKey=d.data;R._lineWidth=F.pt2px(J)||512;R._lineHeight=P||1;R._textPlacement=O;R._effects=K;R._isCIM=D;R._minMaxZoom=l.i1616to32(Math.round(I*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(L*w.MIN_MAX_ZOOM_PRECISION_FACTOR));return R}r._inheritsLoose(c,p);c.fromText=function(d,
a){const b=new c(d.materialKey,d.font.size,d.haloSize||0,d.font.size,d.color&&A.premultiplyAlphaRGBAArray(d.color)||0,d.haloColor&&A.premultiplyAlphaRGBAArray(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,C.Alignment.SCREEN,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.lineWidth,d.lineHeight,null,null,!1,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM),[,f]=t.bidiText(d.text);b.bindTextInfo(a,f);b._vertexBoundsScale=d.maxVVSize?d.maxVVSize/d.font.size:1;return b};c.fromCIMText=function(d,
a,b){var f=d.scaleFactor||1;const m=d.size*d.sizeRatio*f,[g,x]=h.getMinMaxZoom(d.scaleInfo,b);b=new c(d.materialKey,m,d.outlineSize*d.sizeRatio,d.referenceSize,A.premultiplyAlphaRGBA(d.color),A.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.alignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*f,d.offsetY*d.sizeRatio*f,512,1,d.markerPlacement,d.effects,!0,g,x);[,f]=t.bidiText(d.text);b.bindTextInfo(a,f);b._vertexBoundsScale=d.maxVVSize?d.maxVVSize/m:
1;return b};return c}(k(n))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(r,t,F,C,v,A,w,l,e,h){return k=>function(n){function p(...d){d=
n.call(this,...d)||this;d._isCIM=!1;d._vertexBoundsScale=1;d.geometryType=w.WGLGeometryType.TEXT;d._aux=l.i8888to32(0,0,d._referenceSize,d._bitset);return d}r._inheritsLoose(p,n);var c=p.prototype;c.bindTextInfo=function(d,a){this._shapingInfo=d&&d.length?t.applySome(d,b=>h.shapeGlyphs(b,a,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:A.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};c._write=function(d,a,b,f){const m=a.getDisplayId();this._writeGeometry(d,a,m,b,f)};c._writeGeometry=function(d,a,b,f,m){const g=this._shapingInfo;if(!t.isNone(g)){if(t.isSome(this._textPlacement))return a=null!=m?m:a.readLegacyGeometryForDisplay(),this._writePlacedText(d,b,a,g,f);f=m?C.deltaDecodeGeometry(C.convertFromGeometry(m),2):"esriGeometryPolygon"===a.geometryType?a.readCentroid():a.readGeometryForDisplay();
if(!t.isNone(f)){if(f.isPoint){const [x,q]=f.coords;return!d.hasAggregates&&d.hasPixelBufferEnabled&&(0>x||512<=x||0>q||512<=q)?void 0:this._writeGlyphs(d,b,{x,y:q},g)}f.forEachVertex((x,q)=>this._writeGlyphs(d,b,{x,y:q},g))}}};c._writePlacedText=function(d,a,b,f,m){var g=t.unwrap(this._textPlacement);if(b=v.CIMMarkerPlacementHelper.getPlacement(b,g,F.pt2px(1),m.geometryEngine))for(var x=b.next();null!=x;)m=-x.getAngle(),f.setRotation(m),g=x.tx,x=-x.ty,0>g||512<=g||0>x||512<=x||(this._writeGlyphs(d,
a,{x:g,y:x},f),f.setRotation(-m)),x=b.next()};c._writeGlyphs=function(d,a,b,f){const m=e.MaterialKeyBase.load(this._materialKey),g=l.i1616to32(Math.round(8*b.x),Math.round(8*b.y)),x=this._vertexBoundsScale,q=f.bounds,B=2*Math.max(q.width,q.height);for(const z of f.glyphs)m.textureBinding=z.textureBinding,d.recordStart(a,m.data,this.geometryType,!0),d.vertexBounds(b.x+q.x+this._xOffset,b.y+q.y-this._yOffset,B*x,B*x),this._writeVertices(d,a,g,z),d.recordEnd()};c._writeGlyph=function(d,a,b,f,m){var g=
e.MaterialKeyBase.load(this._materialKey);const x=l.i1616to32(Math.round(8*b),Math.round(8*f));g.textureBinding=m.textureBinding;d.recordStart(a,g.data,this.geometryType,!0);g=m.bounds;const q=this._vertexBoundsScale;d.vertexBounds(b+g.x*q,f+g.y*q,g.width*q,g.height*q);this._writeVertices(d,a,x,m);d.recordEnd()};c._writeVertices=function(d,a,b,f){const m=d.vertexCount();this._writeVertexCommon(d,a,b,f);d.vertexWrite(f.offsets.upperLeft);d.vertexWrite(f.texcoords.upperLeft);d.vertexEnd();this._writeVertexCommon(d,
a,b,f);d.vertexWrite(f.offsets.upperRight);d.vertexWrite(f.texcoords.upperRight);d.vertexEnd();this._writeVertexCommon(d,a,b,f);d.vertexWrite(f.offsets.lowerLeft);d.vertexWrite(f.texcoords.lowerLeft);d.vertexEnd();this._writeVertexCommon(d,a,b,f);d.vertexWrite(f.offsets.lowerRight);d.vertexWrite(f.texcoords.lowerRight);d.vertexEnd();d.indexWrite(m+0);d.indexWrite(m+1);d.indexWrite(m+2);d.indexWrite(m+1);d.indexWrite(m+3);d.indexWrite(m+2)};c._writeVertexCommon=function(d,a,b,f){f=this._color;const m=
this._haloColor,g=l.i8888to32(0,0,this._referenceSize,this._bitset),x=l.i8888to32(0,0,this._size,this._haloSize);d.vertexWrite(b);d.vertexWrite(a);d.vertexWrite(f);d.vertexWrite(m);d.vertexWrite(x);d.vertexWrite(g);d.vertexWrite(this._minMaxZoom)};return p}(k)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(r,t,F){let C=function(){function v(){}v.getPlacement=function(A,w,l,e){const h=F.getPlacementOperator(w);if(!h)return null;
A=t.cloneAndDecodeGeometry(A);return h.execute(A,w,l,e)};return v}();r.CIMMarkerPlacementHelper=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(r,t,F,C){function v(b){if(!b)return null;F.isPoint(b)?b.y=-b.y:F.isPolygon(b)?w(b.rings):F.isPolyline(b)?w(b.paths):F.isMultipoint(b)&&A(b.points)}function A(b){if(b){const f=b.length;for(let m=0;m<f;m++)b[m][1]=
-b[m][1]}}function w(b){if(b)for(const f of b)A(f)}function l(b){if(b){var f=b.length;for(--f;0<f;--f)b[f][0]-=b[f-1][0],b[f][1]-=b[f-1][1]}}function e(b){if(b)for(const f of b)l(f)}function h(b){if(b){const f=b.length;for(let m=1;m<f;++m)b[m][0]+=b[m-1][0],b[m][1]+=b[m-1][1]}}function k(b){if(b)for(const f of b)h(f)}function n(b){b&&(F.isPolygon(b)?k(b.rings):F.isPolyline(b)?k(b.paths):F.isMultipoint(b)&&h(b.points),v(b))}function p(b){b&&b.reverse()}function c(b){return{rings:[[[b.xmin,b.ymin],
[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}let d=function(){function b(f,m,g,x){this.acceptPolygon=m;this.acceptPolyline=g;this.geomUnitsPerPoint=x;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;f&&(F.isPolygon(f)?m&&(this.multiPath=f.rings,this.isClosed=!0):F.isPolyline(f)?g&&(this.multiPath=f.paths,this.isClosed=!1):F.isExtent(f)&&m&&(this.multiPath=c(f).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}
b.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const f=this.processPath(this.multiPath[this.pathIndex]);if(f)return f}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return b}(),a=function(){function b(f,m,g,x){this.inputGeometries=f;this.acceptPolygon=m;this.acceptPolyline=g;this.geomUnitsPerPoint=x;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}b.prototype.next=function(){for(;;){if(!this.multiPath){for(var f=
this.inputGeometries.next();f;)if(F.isPolygon(f)?this.acceptPolygon&&(this.multiPath=f.rings,this.isClosed=!0):F.isPolyline(f)?this.acceptPolyline&&(this.multiPath=f.paths,this.isClosed=!1):F.isExtent(f)&&this.acceptPolygon&&(this.multiPath=c(f).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else f=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,
f=this.processPath(this.multiPath[this.pathIndex]))return f;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return b}();r.PathGeometryCursor=a;r.PathTransformationCursor=d;r.cloneAndDecodeGeometry=function(b){b=t.clone(b);n(b);return b};r.deltaDecodeGeometry=n;r.deltaEncodeGeometry=function(b){b&&(v(b),F.isPolygon(b)?e(b.rings):F.isPolyline(b)?e(b.paths):F.isMultipoint(b)&&l(b.points))};r.getCoord2D=function(b,f,m){return[b[0]+(f[0]-b[0])*m,b[1]+(f[1]-b[1])*m]};r.getId=function(b){return b[4]};
r.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};r.reverseMultipath=function(b){if(b)for(const f of b)p(f)};r.reversePath=p;r.setId=function(b,f){b[4]=f};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(r){let t=function(){function C(){this.setIdentity()}var v=C.prototype;v.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,
this.rz_c);return this.rz};v.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};v.setTranslate=function(A,w){this.tx=A;this.ty=w};v.setTranslateZ=function(A){this.tz=A};v.setRotateCS=function(A,w){this.rz=void 0;this.rz_c=A;this.rz_s=w};v.setRotate=function(A){this.rz=A;this.rz_s=this.rz_c=void 0};v.setRotateY=function(A){this.ry=A};v.setScale=function(A){this.s=A};v.setMeasure=function(A){this.m=A};return C}(),F=function(){function C(){}C.prototype.next=
function(){return null};return C}();r.EmptyPlacementCursor=F;r.Placement=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q){r.getEffectOperator=function(B){if(!B)return null;switch(B.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return F.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return v.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return A.EffectCut.local();case "CIMGeometricEffectDashes":return w.EffectDashes.local();
case "CIMGeometricEffectDonut":return l.EffectDonut.local();case "CIMGeometricEffectJog":return e.EffectJog.local();case "CIMGeometricEffectMove":return h.EffectMove.local();case "CIMGeometricEffectOffset":return k.EffectOffset.local();case "CIMGeometricEffectReverse":return n.EffectReverse.local();case "CIMGeometricEffectRotate":return p.EffectRotate.local();case "CIMGeometricEffectScale":return c.EffectScale.local();case "CIMGeometricEffectWave":return d.EffectWave.local()}return null};r.getPlacementOperator=
function(B){if(!B)return null;switch(B.type){case "CIMMarkerPlacementAlongLineSameSize":return a.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return b.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return f.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return m.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return g.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return x.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return q.PlacementPolygonCenter.local()}return null};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=
null;let A=function(){function w(e,h,k){this._inputGeometries=e;this._angleTolerance=void 0!==h.angleTolerance?h.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var l=w.prototype;l.next=function(){for(var e=this._inputGeometries.next();e;){if(F.isPolygon(e))return this._isClosed=!0,e=t.clone(e),this._processMultipath(e.rings),e;if(F.isPolyline(e))return this._isClosed=!1,e=t.clone(e),this._processMultipath(e.paths),e;if(F.isExtent(e)){if(this._maxCosAngle)return e;
this._isClosed=!0;e=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];this._processPath(e);return{rings:[e]}}e=this._inputGeometries.next()}return null};l._processMultipath=function(e){if(e)for(const h of e)this._processPath(h)};l._processPath=function(e){if(e){let h=e.length,k=e[0],n,p,c,d,a,b;this._isClosed&&++h;for(let f=1;f<h;++f){let m;m=this._isClosed&&f===h-1?e[0]:e[f];const g=m[0]-k[0],x=m[1]-k[1],q=Math.sqrt(g*g+x*x);1<f&&0<q&&0<c&&(n*g+p*x)/q/c<=this._maxCosAngle&&
C.setId(k,1);1===f&&(d=g,a=x,b=q);0<q&&(k=m,n=g,p=x,c=q)}this._isClosed&&0<c&&0<b&&(n*d+p*a)/b/c<=this._maxCosAngle&&C.setId(e[0],1)}};return w}();r.EffectAddControlPoints=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(r,t,F,C,v){const A=v.GeometricEffectArrowType.OpenEnded;let w=function(){function e(){}e.local=function(){null===
e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,k,n,p){return new l(h,k,n)};return e}();w.instance=null;let l=function(e){function h(n,p,c){n=e.call(this,n,!1,!0)||this;n._curveHelper=new C.CurveHelper;n._width=(void 0!==p.width?p.width:5)*c;n._arrowType=void 0!==p.geometricEffectArrowType?p.geometricEffectArrowType:void 0!==p.arrowType?p.arrowType:A;n._offsetFlattenError=C.PIXEL_TOLERANCE*c;return n}t._inheritsLoose(h,e);var k=h.prototype;k.processPath=function(n){switch(this._arrowType){default:return this._constructSimpleArrow(n,
!0);case v.GeometricEffectArrowType.Block:return this._constructSimpleArrow(n,!1);case v.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(n)}};k._constructSimpleArrow=function(n,p){var c=this._curveHelper.calculatePathLength(n),d=this._width;c<2*d&&(d=c/2);c=this._curveHelper.getSubCurve(n,0,c-d);if(!c)return null;var a=d/2;if(this._curveHelper.isEmpty(c,!1))return null;d=this._constructOffset(c,-a);if(!d)return null;c=this._constructOffset(c,a);if(!c)return null;const b=this._constructArrowBasePoint(d,
-a/2);if(!b)return null;a=this._constructArrowBasePoint(c,a/2);if(!a)return null;n=n[n.length-1];p||(this._makeControlPoint(c,!0),this._makeControlPoint(d,!0));const f=new C.PathHelper;f.addPath(c,!0);f.lineTo(a);this._makeControlPoint(f.path());f.lineTo(n);this._makeControlPoint(f.path());f.lineTo(b);this._makeControlPoint(f.path());f.addPath(d,!1);return p?{paths:[f.path()]}:(f.close(),{rings:[f.path()]})};k._constructCrossedArrow=function(n){var p=this._curveHelper.calculatePathLength(n),c=this._width;
p<3.732050807568877*c&&(c=p/3.732050807568877);var d=this._curveHelper.getSubCurve(n,0,p-2.732050807568877*c);if(!d)return null;var a=c/2;if(this._curveHelper.isEmpty(d,!1))return null;const b=this._constructOffset(d,a);if(!b)return null;d=this._constructOffset(d,-a);if(!d)return null;p=this._curveHelper.getSubCurve(n,0,p-c);if(!p||this._curveHelper.isEmpty(p,!1))return null;c=this._constructOffset(p,a);if(!c)return null;var f=this._constructOffset(p,-a);if(!f)return null;p=c[c.length-1];c=this._constructArrowBasePoint(c,
a/2);if(!c)return null;const m=f[f.length-1];a=this._constructArrowBasePoint(f,-a/2);if(!a)return null;n=n[n.length-1];this._makeControlPoint(b,!1);this._makeControlPoint(d,!1);f=new C.PathHelper;f.addPath(b,!0);this._makeControlPoint(f.path());f.lineTo(m);f.lineTo(a);this._makeControlPoint(f.path());f.lineTo(n);this._makeControlPoint(f.path());f.lineTo(c);this._makeControlPoint(f.path());f.lineTo(p);this._makeControlPoint(f.path());f.addPath(d,!1);return{paths:[f.path()]}};k._constructOffset=function(n,
p){return this._curveHelper.offset(n,p,v.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};k._constructArrowBasePoint=function(n,p){if(!n||2>n.length)return null;var c=n[n.length-2];n=n[n.length-1];c=[n[0]-c[0],n[1]-c[1]];this._curveHelper.normalize(c);return[n[0]+c[1]*p,n[1]-c[0]*p]};k._makeControlPoint=function(n,p=!1){p?F.setId(n[0],1):F.setId(n[n.length-1],1)};return h}(F.PathGeometryCursor);r.EffectArrow=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports",
"./enums"],function(r,t){let F=function(){function v(){this._path=[]}var A=v.prototype;A.path=function(){return this._path};A.addPath=function(w,l){l||w.reverse();Array.prototype.push.apply(this._path,w);l||w.reverse()};v.mergePath=function(w,l){l&&Array.prototype.push.apply(w,l)};A.startPath=function(w){this._path.push(w)};A.lineTo=function(w){this._path.push(w)};A.close=function(){const w=this._path;1<w.length&&(w[0][0]!==w[w.length-1][0]||w[0][1]!==w[w.length-1][1])&&w.push([w[0][0],w[0][1]])};
return v}(),C=function(){function v(w,l){}var A=v.prototype;A.normalize=function(w){const l=Math.sqrt(w[0]*w[0]+w[1]*w[1]);w[0]/=l;w[1]/=l};A.calculateLength=function(w,l){const e=l[0]-w[0];w=l[1]-w[1];return Math.sqrt(e*e+w*w)};A.calculateSegLength=function(w,l){return this.calculateLength(w[l],w[l+1])};A.calculatePathLength=function(w){let l=0;const e=w?w.length:0;for(let h=0;h<e-1;++h)l+=this.calculateSegLength(w,h);return l};A.calculatePathArea=function(w){let l=0;const e=w?w.length:0;for(let h=
0;h<e-1;++h)l+=(w[h+1][0]-w[h][0])*(w[h+1][1]+w[h][1]);return l/2};A.getCoord2D=function(w,l,e){return[w[0]+(l[0]-w[0])*e,w[1]+(l[1]-w[1])*e]};A.getSegCoord2D=function(w,l,e){return this.getCoord2D(w[l],w[l+1],e)};A.getAngle=function(w,l,e){return Math.atan2(l[1]-w[1],l[0]-w[0])};A.getSegAngle=function(w,l,e){return this.getAngle(w[l],w[l+1],e)};A.getAngleCS=function(w,l,e){e=l[0]-w[0];w=l[1]-w[1];l=Math.sqrt(e*e+w*w);return 0<l?[e/l,w/l]:[1,0]};A.getSegAngleCS=function(w,l,e){return this.getAngleCS(w[l],
w[l+1],e)};A.cut=function(w,l,e,h){e=0>=e?w[l]:this.getSegCoord2D(w,l,e);w=1<=h?w[l+1]:this.getSegCoord2D(w,l,h);return[e,w]};A.addSegment=function(w,l,e){e&&w.push(l[0]);w.push(l[1])};A.getSubCurve=function(w,l,e){const h=[];return this.appendSubCurve(h,w,l,e)?h:null};A.appendSubCurve=function(w,l,e,h){const k=l?l.length-1:0;let n=0,p=!0,c=0;for(;c<k;){const a=this.calculateSegLength(l,c);if(0!==a){if(p){if(n+a>e){var d=(e-n)/a;let b=1,f=!1;n+a>=h&&(b=(h-n)/a,f=!0);(d=this.cut(l,c,d,b))&&this.addSegment(w,
d,p);if(f)break;p=!1}}else{if(n+a>h){(l=this.cut(l,c,0,(h-n)/a))&&this.addSegment(w,l,p);break}this.addSegment(w,[l[c],l[c+1]],p)}n+=a}++c}return!0};A.getCIMPointAlong=function(w,l){const e=w?w.length-1:0;let h=0,k=-1;for(;k<e;){++k;const n=this.calculateSegLength(w,k);if(0!==n){if(h+n>l)return this.getCoord2D(w[k],w[k+1],(l-h)/n);h+=n}}return null};A.isEmpty=function(w,l){if(!w||1>=w.length)return!0;const e=w?w.length-1:0;let h=-1;for(;h<e;)if(++h,w[h+1][0]!==w[h][0]||w[h+1][1]!==w[h][1]||l&&w[h+
1][2]!==w[h][2])return!1;return!0};A.offset=function(w,l,e,h,k){if(!w||2>w.length)return null;var n=0,p=w[n++];for(k=n;n<w.length;){var c=w[n];if(c[0]!==p[0]||c[1]!==p[1])n!==k&&(w[k]=w[n]),p=w[k++];n++}(n=w[0][0]===w[k-1][0]&&w[0][1]===w[k-1][1])&&--k;if(k<(n?3:2))return null;c=[];p=n?w[k-1]:null;let d=w[0];for(let m=0;m<k;m++){const g=m===k-1?n?w[0]:null:w[m+1];if(p)if(g){var a=[g[0]-d[0],g[1]-d[1]];this.normalize(a);p=[d[0]-p[0],d[1]-p[1]];this.normalize(p);var b=p[0]*a[1]-p[1]*a[0],f=p[0]*a[0]+
p[1]*a[1];if(0<=b===0>=l)1>f&&(a=[a[0]-p[0],a[1]-p[1]],this.normalize(a),p=Math.sqrt((1+f)/2),p>1/h&&(p=-Math.abs(l)/p,c.push([d[0]-a[0]*p,d[1]-a[1]*p])));else switch(e){case t.GeometricEffectOffsetMethod.Mitered:if(f=Math.sqrt((1+f)/2),0<f&&1/f<h){a=[a[0]-p[0],a[1]-p[1]];this.normalize(a);p=Math.abs(l)/f;c.push([d[0]-a[0]*p,d[1]-a[1]*p]);break}case t.GeometricEffectOffsetMethod.Bevelled:c.push([d[0]+p[1]*l,d[1]-p[0]*l]);c.push([d[0]+a[1]*l,d[1]-a[0]*l]);break;case t.GeometricEffectOffsetMethod.Rounded:if(1>
f){c.push([d[0]+p[1]*l,d[1]-p[0]*l]);f=Math.floor(2.5*(1-f));if(0<f){let x=b=1/f;for(let q=1;q<f;q++,x+=b){const B=[p[1]*(1-x)+a[1]*x,-p[0]*(1-x)-a[0]*x];this.normalize(B);c.push([d[0]+B[0]*l,d[1]+B[1]*l])}}c.push([d[0]+a[1]*l,d[1]-a[0]*l])}break;default:0>b?(c.push([d[0]+(p[1]+p[0])*l,d[1]+(p[1]-p[0])*l]),c.push([d[0]+(a[1]-a[0])*l,d[1]-(a[0]+a[1])*l])):(f=Math.sqrt((1+Math.abs(f))/2),a=[a[0]-p[0],a[1]-p[1]],this.normalize(a),p=l/f,c.push([d[0]-a[0]*p,d[1]-a[1]*p]))}}else a=[d[0]-p[0],d[1]-p[1]],
this.normalize(a),c.push([d[0]+a[1]*l,d[1]-a[0]*l]);else a=[g[0]-d[0],g[1]-d[1]],this.normalize(a),c.push([d[0]+a[1]*l,d[1]-a[0]*l]);p=d;d=g}if(c.length<(n?3:2))return null;n&&c.push([c[0][0],c[0][1]]);return c};return v}();r.CurveHelper=C;r.PIXEL_TOLERANCE=.03;r.PathHelper=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,t,F,C){let v=function(){function w(){}
w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h,k)};return w}();v.instance=null;let A=function(){function w(l,e,h,k){this._inputGeometries=l;this._curveHelper=new F.CurveHelper;this._size=(void 0!==e.size?e.size:1)*h;this._offsetFlattenError=F.PIXEL_TOLERANCE*h}w.prototype.next=function(){let l=this._inputGeometries.next();for(;l;){if(t.isExtent(l))if(0<this._size){var e=this._curveHelper.offset([[l.xmin,l.ymin],
[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]],this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(e)return{rings:[e]}}else if(0>this._size){if(0<Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._size)return{xmin:l.xmin-this._size,xmax:l.xmax+this._size,ymin:l.ymin-this._size,ymax:l.ymax+this._size}}else return l;if(t.isPolygon(l)){if(0===this._size)return l;e=[];for(const k of l.rings){var h=this._curveHelper.offset(k,this._size,C.GeometricEffectOffsetMethod.Rounded,
4,this._offsetFlattenError);h&&e.push(h)}if(e.length)return{rings:e}}if(t.isPolyline(l)&&0<this._size){e=[];for(const k of l.paths)if(k&&1<k.length){h=this._curveHelper.offset(k,this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);const n=this._curveHelper.offset(k,-this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(h&&n){for(let p=n.length-1;0<=p;p--)h.push(n[p]);h.push([h[0][0],h[0][1]]);e.push(h)}}if(e.length)return{rings:e}}t.isPoint(l);l=this._inputGeometries.next()}return null};
return w}();r.EffectBuffer=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=null;let A=function(){function w(e,h,k){var n;this._default_point_size=
20;this._inputGeometries=e;this._geomUnitsPerPoint=k;this._rule=null!=(n=h.rule)?n:C.GeometricEffectControlMeasureLineRule.FullGeometry;this._default_size=this._default_point_size*k}var l=w.prototype;l.next=function(){let e;for(;e=this._inputGeometries.next();){let h;t.isPoint(e)?h=this._processGeom([[[e.x,e.y]]]):t.isMultipoint(e)?h=this._processGeom([e.points]):t.isPolyline(e)?h=this._processGeom(e.paths):t.isPolygon(e)&&(h=this._processGeom(e.rings));if(h&&h.length)return{paths:h}}return null};
l._clone=function(e){return[e[0],e[1]]};l._mid=function(e,h){return[(e[0]+h[0])/2,(e[1]+h[1])/2]};l._mix=function(e,h,k,n){return[e[0]*h+k[0]*n,e[1]*h+k[1]*n]};l._add=function(e,h){return[e[0]+h[0],e[1]+h[1]]};l._add2=function(e,h,k){return[e[0]+h,e[1]+k]};l._sub=function(e,h){return[e[0]-h[0],e[1]-h[1]]};l._dist=function(e,h){return Math.sqrt((e[0]-h[0])*(e[0]-h[0])+(e[1]-h[1])*(e[1]-h[1]))};l._norm=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])};l._normalize=function(e,h=1){h/=this._norm(e);
e[0]*=h;e[1]*=h};l._leftPerpendicular=function(e){const h=e[0];e[0]=-e[1];e[1]=h};l._leftPerp=function(e){return[-e[1],e[0]]};l._rightPerpendicular=function(e){const h=-e[0];e[0]=e[1];e[1]=h};l._rightPerp=function(e){return[e[1],-e[0]]};l._dotProduct=function(e,h){return e[0]*h[0]+e[1]*h[1]};l._crossProduct=function(e,h){return e[0]*h[1]-e[1]*h[0]};l._rotateDirect=function(e,h,k){const n=e[0]*k+e[1]*h;e[0]=e[0]*h-e[1]*k;e[1]=n};l._makeCtrlPt=function(e){e=[e[0],e[1]];F.setId(e,1);return e};l._addAngledTicks=
function(e,h,k,n){const p=this._sub(k,h);this._normalize(p);var c=this._crossProduct(p,this._sub(n,h));n=0<c?this._rightPerp(p):this._leftPerp(p);c=Math.abs(c)/2;const d=[];d.push([h[0]+(n[0]-p[0])*c,h[1]+(n[1]-p[1])*c]);d.push(h);d.push(k);d.push([k[0]+(n[0]+p[0])*c,k[1]+(n[1]+p[1])*c]);e.push(d)};l._addBezier2=function(e,h,k,n,p){if(0===p--)e.push(n);else{var c=this._mid(h,k);k=this._mid(k,n);var d=this._mid(c,k);this._addBezier2(e,h,c,d,p);this._addBezier2(e,d,k,n,p)}};l._addBezier3=function(e,
h,k,n,p,c){if(0===c--)e.push(p);else{var d=this._mid(h,k),a=this._mid(k,n);n=this._mid(n,p);k=this._mid(d,a);a=this._mid(a,n);var b=this._mid(k,a);this._addBezier3(e,h,d,k,b,c);this._addBezier3(e,b,a,n,p,c)}};l._add90DegArc=function(e,h,k,n,p){n=null!=p?p:0<this._crossProduct(this._sub(k,h),this._sub(n,h));p=this._mid(h,k);const c=this._sub(p,h);n?this._leftPerpendicular(c):this._rightPerpendicular(c);p[0]+=c[0];p[1]+=c[1];this._addBezier3(e,h,this._mix(h,.33333,p,.66667),this._mix(k,.33333,p,.66667),
k,4)};l._addArrow=function(e,h,k){var n=h[0],p=h[1],c=h[h.length-1],d=this._sub(n,p);this._normalize(d);const a=this._crossProduct(d,this._sub(c,p));p=.5*a;var b=this._leftPerp(d);const f=[c[0]-b[0]*a,c[1]-b[1]*a];var m=h.length-1;c=[];c.push(k?[-b[0],-b[1]]:b);var g=[-d[0],-d[1]];for(k=1;k<m-1;k++){d=this._sub(h[k+1],h[k]);this._normalize(d);var x=this._dotProduct(d,g);b=this._crossProduct(d,g);x=Math.sqrt((1+x)/2);g=this._sub(d,g);this._normalize(g);g[0]/=x;g[1]/=x;c.push(0>b?[-g[0],-g[1]]:g);g=
d}c.push(this._rightPerp(g));for(m=c.length-1;0<m;m--)e.push([h[m][0]+c[m][0]*p,h[m][1]+c[m][1]*p]);e.push([f[0]+c[0][0]*p,f[1]+c[0][1]*p]);e.push([f[0]+c[0][0]*a,f[1]+c[0][1]*a]);e.push(n);e.push([f[0]-c[0][0]*a,f[1]-c[0][1]*a]);e.push([f[0]-c[0][0]*p,f[1]-c[0][1]*p]);for(n=1;n<c.length;n++)e.push([h[n][0]-c[n][0]*p,h[n][1]-c[n][1]*p])};l._cp2=function(e,h,k){return 2<=e.length?e[1]:this._add2(e[0],h*this._default_size,k*this._default_size)};l._cp3=function(e,h,k,n){if(3<=e.length)return e[2];k=
this._mix(e[0],1-k,h,k);e=this._sub(h,e[0]);this._normalize(e);this._rightPerpendicular(e);return[k[0]+e[0]*n*this._default_size,k[1]+e[1]*n*this._default_size]};l._arrowPath=function(e){if(2<e.length)return e;const h=e[0];e=this._cp2(e,-4,0);const k=this._sub(h,e);this._normalize(k);const n=this._rightPerp(k);return[h,e,[h[0]+(n[0]-k[0])*this._default_size,h[1]+(n[1]-k[1])*this._default_size]]};l._arrowLastSeg=function(e){var h=e[0];const k=this._cp2(e,-4,0);if(3<=e.length)h=e[e.length-1];else{e=
this._sub(h,k);this._normalize(e);const n=this._rightPerp(e);h=[h[0]+(n[0]-e[0])*this._default_size,h[1]+(n[1]-e[1])*this._default_size]}return[k,h]};l._processGeom=function(e){if(!e)return null;const h=[];for(const k of e){if(!k||0===k.length)continue;const n=k.length;let p=k[0];switch(this._rule){case C.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,4),a=[];a.push(d);a.push(this._mid(p,c));h.push(a);break}case C.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const c=
this._cp2(k,0,-1);h.push([c,p]);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const c=this._cp2(k,-4,1),d=this._cp3(k,c,.882353,-1.94),a=[];a.push(this._mid(c,d));a.push(p);h.push(a);break}case C.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const c=this._cp2(k,-4,1),d=this._cp3(k,c,.882353,-1.94),a=this._sub(d,c);let b;b=0<this._crossProduct(a,this._sub(p,c))?this._rightPerp(b):this._leftPerp(a);const f=[];f.push([c[0]+(b[0]-a[0])/3,c[1]+(b[1]-a[1])/
3]);f.push(c);f.push(d);f.push([d[0]+(b[0]+a[0])/3,d[1]+(b[1]+a[1])/3]);h.push(f);break}case C.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,3),a=this._mid(p,c),b=this._sub(a,d);this._normalize(b);const f=this._crossProduct(b,this._sub(p,d));this._leftPerpendicular(b);const m=[];m.push(p);m.push([d[0]+b[0]*f,d[1]+b[1]*f]);h.push(m);const g=[];g.push([d[0]-b[0]*f,d[1]-b[1]*f]);g.push(c);h.push(g);break}case C.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const c=
this._cp2(k,0,-1),d=this._cp3(k,c,.5,3),a=this._mid(p,c),b=this._sub(a,d);this._normalize(b);const f=this._crossProduct(b,this._sub(p,d));this._leftPerpendicular(b);const m=[];m.push([d[0]+b[0]*f,d[1]+b[1]*f]);m.push([d[0]-b[0]*f,d[1]-b[1]*f]);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,4),a=this._mid(p,c),b=this._sub(a,d);this._normalize(b);const f=this._crossProduct(b,this._sub(p,d));this._leftPerpendicular(b);const m=
[];m.push([d[0]+b[0]*f*.8,d[1]+b[1]*f*.8]);m.push([a[0]+.8*(p[0]-a[0]),a[1]+.8*(p[1]-a[1])]);h.push(m);h.push([d,a]);const g=[];g.push([d[0]-b[0]*f*.8,d[1]-b[1]*f*.8]);g.push([a[0]+.8*(c[0]-a[0]),a[1]+.8*(c[1]-a[1])]);h.push(g);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,4),a=this._mid(p,c);let b=this._sub(c,p);const f=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),g=Math.sqrt((1+f)/2),x=Math.sqrt((1-f)/2),q=[];let B;0<this._crossProduct(b,
this._sub(d,p))?(q.push(p),b=this._sub(p,a),B=c):(q.push(c),b=this._sub(c,a),B=p);this._rotateDirect(b,g,x);b[0]/=g;b[1]/=g;for(let z=1;18>=z;z++)q.push(this._add(a,b)),this._rotateDirect(b,f,m);q.push(B);h.push(q);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,1,-1);let a=this._sub(p,c);this._normalize(a);const b=this._crossProduct(a,this._sub(d,c))/2;this._leftPerpendicular(a);const f=[c[0]+a[0]*b,c[1]+a[1]*b];a=this._sub(c,
f);const m=Math.cos(Math.PI/18);let g=Math.sin(Math.PI/18);0<b&&(g=-g);const x=[c];for(let q=1;18>=q;q++)this._rotateDirect(a,m,g),x.push(this._add(f,a));h.push(x);break}case C.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const c=this._cp2(k,0,-2),d=this._cp3(k,c,1,-1);let a;if(4<=n)a=k[3];else{const x=this._sub(p,c);a=this._add(d,x)}const b=this._dist(c,d)/2/.75,f=this._sub(c,p);this._normalize(f,b);const m=this._sub(d,a);this._normalize(m,b);h.push([a,d]);const g=[this._clone(d)];this._addBezier3(g,
d,this._add(d,m),this._add(c,f),c,4);g.push(p);h.push(g);break}case C.GeometricEffectControlMeasureLineRule.OpenCircle:{const c=this._cp2(k,-2,0),d=this._sub(c,p),a=Math.cos(Math.PI/18),b=-Math.sin(Math.PI/18),f=[c];for(let m=1;33>=m;m++)this._rotateDirect(d,a,b),f.push(this._add(p,d));h.push(f);break}case C.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const c=this._cp2(k,0,-1);let d;if(3<=n)d=k[2];else{const g=this._sub(c,p),x=this._leftPerp(g);d=[p[0]+x[0]-.25*g[0],p[1]+x[1]-.25*
g[1]]}let a;if(4<=n)a=k[3];else{const g=this._mid(p,c),x=this._sub(p,c);this._normalize(x);this._leftPerpendicular(x);const q=this._crossProduct(x,this._sub(d,g));this._rightPerpendicular(x);a=[d[0]+x[0]*q*2,d[1]+x[1]*q*2]}const b=this._sub(c,p);let f,m;f=0<this._crossProduct(b,this._sub(d,p))?this._rightPerp(b):this._leftPerp(b);m=[];m.push(d);m.push(p);m.push([p[0]+(f[0]-b[0])/3,p[1]+(f[1]-b[1])/3]);h.push(m);f=0<this._crossProduct(b,this._sub(a,c))?this._rightPerp(f):this._leftPerp(b);m=[];m.push([c[0]+
(f[0]+b[0])/3,c[1]+(f[1]+b[1])/3]);m.push(c);m.push(a);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const c=this._cp2(k,0,2),d=this._cp3(k,c,0,1);let a;if(4<=n)a=k[3];else{const b=this._sub(c,p);a=this._add(d,b)}this._addAngledTicks(h,p,c,this._mid(d,a));this._addAngledTicks(h,d,a,this._mid(p,c));break}case C.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const c=this._cp2(k,2,0),d=this._cp3(k,c,0,1);let a;if(4<=n)a=k[3];else{const f=this._sub(c,
p);a=this._add(d,f)}const b=[];b.push(this._mid(p,d));b.push(this._mid(c,a));h.push(b);break}case C.GeometricEffectControlMeasureLineRule.Chevron:{const c=this._cp2(k,-1,-1);let d;if(3<=n)d=k[2];else{const a=this._sub(c,p);this._leftPerpendicular(a);d=this._add(p,a)}h.push([c,this._makeCtrlPt(p),d]);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const c=this._cp2(k,0,-2),d=this._cp3(k,c,.5,-1);let a=this._sub(c,p);const b=this._norm(a);a[0]/=b;a[1]/=b;const f=this._crossProduct(a,
this._sub(d,p));let m=this._dotProduct(a,this._sub(d,p));m<.05*b?m=.05*b:m>.95*b&&(m=.95*b);const g=[p[0]+a[0]*m,p[1]+a[1]*m];this._leftPerpendicular(a);let x=[];x.push([g[0]-a[0]*f,g[1]-a[1]*f]);x.push([g[0]+a[0]*f,g[1]+a[1]*f]);h.push(x);const q=[c[0]+a[0]*f,c[1]+a[1]*f];a=this._sub(c,q);const B=Math.cos(Math.PI/18);let z=Math.sin(Math.PI/18);0>f&&(z=-z);x=[p,c];for(let u=1;9>=u;u++)this._rotateDirect(a,B,z),x.push(this._add(q,a));h.push(x);break}case C.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const c=
this._cp2(k,2,0),d=this._mid(p,c),a=this._sub(c,d),b=Math.cos(Math.PI/18),f=Math.sin(Math.PI/18),m=[p,c];for(let g=1;18>=g;g++)this._rotateDirect(a,b,f),m.push(this._add(d,a));h.push(m);break}case C.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const c=this._cp2(k,0,-2),d=this._cp3(k,c,1,-2),a=this._mid(p,c),b=this._sub(d,c);this._normalize(b);const f=Math.abs(this._crossProduct(b,this._sub(a,c)))/2,m=this._dist(c,d),g=[c,p];g.push([p[0]+b[0]*m*.5,p[1]+b[1]*m*.5]);h.push(g);const x=
[];x.push([a[0]-b[0]*f,a[1]-b[1]*f]);x.push([a[0]+b[0]*m*.375,a[1]+b[1]*m*.375]);F.setId(x[x.length-1],1);x.push([a[0]+b[0]*m*.75,a[1]+b[1]*m*.75]);h.push(x);h.push([c,d]);break}case C.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._sub(d,c);this._normalize(a);const b=this._crossProduct(a,this._sub(d,p));this._leftPerpendicular(a);this._addAngledTicks(h,p,c,d);this._addAngledTicks(h,this._mix(p,1,a,b),this._mix(c,1,a,b),this._mid(p,
c));break}case C.GeometricEffectControlMeasureLineRule.Parallel:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._sub(c,p);this._normalize(a);const b=this._leftPerp(a),f=this._crossProduct(a,this._sub(d,p));let m=[p,c];h.push(m);m=[];m.push([p[0]+b[0]*f,p[1]+b[1]*f]);m.push([c[0]+b[0]*f,c[1]+b[1]*f]);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._mid(p,c),b=this._sub(c,p);this._normalize(b);const f=
this._crossProduct(b,this._sub(d,p));this._leftPerpendicular(b);const m=[];m.push([a[0]-b[0]*f*.25,a[1]-b[1]*f*.25]);m.push([a[0]+b[0]*f*1.25,a[1]+b[1]*f*1.25]);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.ParallelOffset:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._sub(c,p);this._normalize(a);const b=this._crossProduct(a,this._sub(d,p));this._leftPerpendicular(a);const f=[];f.push([p[0]-a[0]*b,p[1]-a[1]*b]);f.push([c[0]-a[0]*b,c[1]-a[1]*b]);h.push(f);const m=[];m.push([p[0]+
a[0]*b,p[1]+a[1]*b]);m.push([c[0]+a[0]*b,c[1]+a[1]*b]);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._sub(c,p);this._normalize(a);const b=this._crossProduct(a,this._sub(d,p));this._leftPerpendicular(a);const f=[];f.push([p[0]-a[0]*b,p[1]-a[1]*b]);f.push([c[0]-a[0]*b,c[1]-a[1]*b]);h.push(f);break}case C.GeometricEffectControlMeasureLineRule.OffsetSame:{const c=this._cp2(k,3,0),d=this._cp3(k,c,.5,-1),a=this._sub(c,
p);this._normalize(a);const b=this._crossProduct(a,this._sub(d,p));this._leftPerpendicular(a);const f=[];f.push([p[0]+a[0]*b,p[1]+a[1]*b]);f.push([c[0]+a[0]*b,c[1]+a[1]*b]);h.push(f);break}case C.GeometricEffectControlMeasureLineRule.CircleWithArc:{let c=this._cp2(k,3,0);const d=this._cp3(k,c,.5,-1);let a,b;if(4<=n)a=k[3],b=0<this._crossProduct(this._sub(a,c),this._sub(d,c));else{a=c;b=0<this._crossProduct(this._sub(a,p),this._sub(d,p));const q=24*this._geomUnitsPerPoint,B=this._sub(a,p);this._normalize(B,
q);const z=Math.sqrt(2)/2;this._rotateDirect(B,z,b?z:-z);c=this._add(p,B)}const f=this._sub(c,p),m=Math.cos(Math.PI/18),g=Math.sin(Math.PI/18),x=[c];for(let q=1;36>=q;q++)this._rotateDirect(f,m,g),x.push(this._add(p,f));this._add90DegArc(x,c,a,d,b);F.setId(x[x.length-8],1);h.push(x);break}case C.GeometricEffectControlMeasureLineRule.DoubleJog:{let c=this._cp2(k,-3,1),d;d=3<=n?k[2]:this._add(p,this._sub(p,c));let a;if(4<=n)a=k[3];else{const u=p;p=c;a=d;const y=this._dist(p,u),E=this._dist(a,u);let H=
30*this._geomUnitsPerPoint;.5*y<H&&(H=.5*y);.5*E<H&&(H=.5*E);c=this._mix(p,H/y,u,(y-H)/y);d=this._mix(a,H/E,u,(E-H)/E)}const b=this._mid(p,c),f=this._mid(a,d),m=this._dist(p,c),g=this._dist(d,a);let x=Math.min(m,g)/8;x=Math.min(x,24*this._geomUnitsPerPoint);const q=Math.cos(Math.PI/4);let B=this._sub(p,c);this._normalize(B,x);0<this._crossProduct(B,this._sub(a,c))?this._rotateDirect(B,q,-q):this._rotateDirect(B,q,q);let z=[];z.push(c);z.push(this._add(b,B));z.push(this._sub(b,B));z.push(p);h.push(z);
B=this._sub(a,d);this._normalize(B,x);0>this._crossProduct(B,this._sub(p,d))?this._rotateDirect(B,q,q):this._rotateDirect(B,q,-q);z=[];z.push(d);z.push(this._add(f,B));z.push(this._sub(f,B));z.push(a);h.push(z);break}case C.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const c=this._cp2(k,-4,1),d=this._cp3(k,c,.882353,-1.94),a=this._sub(d,c);0<this._crossProduct(a,this._sub(p,c))?this._rightPerpendicular(a):this._leftPerpendicular(a);const b=[a[0]/8,a[1]/8],f=this._sub(this._mid(c,d),
b);h.push([f,p]);break}case C.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const c=this._arrowPath(k),d=[];let a=c.length-2;for(;a--;)d.push(c[a]);h.push(d);break}case C.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const c=this._arrowPath(k),d=[];this._addArrow(d,c,!1);h.push(d);break}case C.GeometricEffectControlMeasureLineRule.CrossedArrow:{const c=this._arrowPath(k),d=[];this._addArrow(d,c,!0);h.push(d);break}case C.GeometricEffectControlMeasureLineRule.ChevronArrow:{const [c,
d]=this._arrowLastSeg(k),a=10*this._geomUnitsPerPoint,b=this._sub(p,c);this._normalize(b);const f=this._crossProduct(b,this._sub(d,c)),m=this._leftPerp(b),g=[d[0]-m[0]*f*2,d[1]-m[1]*f*2],x=[];x.push([d[0]+b[0]*a,d[1]+b[1]*a]);x.push(p);x.push([g[0]+b[0]*a,g[1]+b[1]*a]);h.push(x);break}case C.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const [c,d]=this._arrowLastSeg(k),a=this._sub(p,c);this._normalize(a);const b=this._crossProduct(a,this._sub(d,c));this._leftPerpendicular(a);const f=
[d[0]-a[0]*b,d[1]-a[1]*b],m=[];m.push([f[0]+a[0]*b*.5,f[1]+a[1]*b*.5]);m.push(this._mid(f,p));m.push([f[0]-a[0]*b*.5,f[1]-a[1]*b*.5]);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const [c,d]=this._arrowLastSeg(k),a=this._sub(p,c);this._normalize(a);const b=this._crossProduct(a,this._sub(d,c));this._leftPerpendicular(a);h.push([c,[d[0]-a[0]*b,d[1]-a[1]*b]]);break}case C.GeometricEffectControlMeasureLineRule.Arch:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,1),
a=this._sub(p,c),b=this._mix(d,1,a,.55),f=this._mix(d,1,a,-.55),m=[p];this._addBezier2(m,p,b,d,4);this._addBezier2(m,d,f,c,4);h.push(m);break}case C.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const c=this._cp2(k,-4,1),d=this._cp3(k,c,.882353,-1.94),a=this._sub(d,c);0<this._crossProduct(a,this._sub(p,c))?this._rightPerpendicular(a):this._leftPerpendicular(a);const b=[a[0]/8,a[1]/8],f=this._sub(this._mid(c,d),b),m=this._sub(this._mix(c,.75,d,.25),b),g=this._sub(this._mix(c,.25,d,.75),
b),x=[c];this._addBezier2(x,c,m,f,3);this._addBezier2(x,f,g,d,3);h.push(x);for(let q=0;8>q;q++){const B=x[2*q+1],z=[this._clone(B)];z.push(this._add(B,[a[0]/4,a[1]/4]));h.push(z)}break}case C.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const c=this._cp2(k,0,-1),d=this._cp3(k,c,.5,1),a=[c];this._add90DegArc(a,c,p,d);h.push(a);break}default:h.push(k)}}return h};return w}();r.EffectControlMeasureLine=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=null;let A=function(w){function l(e,h,k){e=w.call(this,e,!0,!0)||this;e._curveHelper=new C.CurveHelper;e._beginCut=(void 0!==h.beginCut?h.beginCut:1)*k;e._endCut=(void 0!==h.endCut?h.endCut:1)*k;e._middleCut=(void 0!==
h.middleCut?h.middleCut:0)*k;e._invert=void 0!==h.invert?h.invert:!1;0>e._beginCut&&(e._beginCut=0);0>e._endCut&&(e._endCut=0);0>e._middleCut&&(e._middleCut=0);return e}t._inheritsLoose(l,w);l.prototype.processPath=function(e){var h=this._beginCut;const k=this._endCut,n=this._middleCut,p=this._curveHelper.calculatePathLength(e),c=[];if(!this._invert)0===h&&0===k&&0===n?c.push(e):h+k+n>=p||(0===n?(e=this._curveHelper.getSubCurve(e,h,p-k))&&c.push(e):((h=this._curveHelper.getSubCurve(e,h,.5*(p-n)))&&
c.push(h),(h=this._curveHelper.getSubCurve(e,.5*(p+n),p-k))&&c.push(h)));else if(0!==h||0!==k||0!==n)h+k+n>=p?c.push(e):((h=this._curveHelper.getSubCurve(e,0,h))&&c.push(h),(h=this._curveHelper.getSubCurve(e,.5*(p-n),.5*(p+n)))&&c.push(h),(h=this._curveHelper.getSubCurve(e,p-k,k))&&c.push(h));return 0===c.length?null:{paths:c}};return l}(F.PathGeometryCursor);r.EffectCut=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(r,t,F,C,v,A){let w=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,k,n,p){return new l(h,k,n)};return e}();w.instance=null;let l=function(e){function h(k,n,p){var c,d;k=e.call(this,k,!0,!0)||this;k._walker=new A.GeometryWalker;k._walker.updateTolerance(p);k._endings=n.lineDashEnding;k._customDashPos=-(null!=(c=n.offsetAlongLine)?c:0)*p;k._offsetAtEnd=(null!=(d=n.customEndingOffset)?d:0)*p;k._pattern=new A.DashPattern;
k._pattern.init(n.dashTemplate,!0);k._pattern.scale(p);return k}t._inheritsLoose(h,e);h.prototype.processPath=function(k){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[k]};if(!this.iteratePath){var n=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case v.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case v.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case v.LineDashEnding.NoConstraint:this.isClosed||
(n=!1);break;case v.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var p=this._walker.calculatePathLength(k);if(this._pattern.isEmpty()||p<.1*this._pattern.length()||!this._walker.init(k,this._pattern,n))return{paths:[k]}}if(this.iteratePath)k=this._pattern.nextValue();else{switch(this._endings){default:n=.5*this._pattern.firstValue();break;case v.LineDashEnding.HalfGap:n=.5*-this._pattern.lastValue();break;case v.LineDashEnding.FullGap:n=-this._pattern.lastValue();
break;case v.LineDashEnding.FullPattern:n=0;break;case v.LineDashEnding.NoConstraint:case v.LineDashEnding.Custom:n=-this._customDashPos}k=n/this._pattern.length();k-=Math.floor(k);n=k*this._pattern.length();this._pattern.reset();k=this._pattern.nextValue();for(p=!1;n>=k;)n-=k,k=this._pattern.nextValue(),p=!p;k-=n;p?(this._walker.nextPosition(k),k=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(k),k=this._pattern.nextValue(),this._walker.nextPosition(k),k=this._pattern.nextValue())}(n=
this._walker.nextCurve(k))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),C.PathHelper.mergePath(n,this._firstCurve),this._firstCurve=null)):(k=this._pattern.nextValue(),!this._walker.nextPosition(k)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(n=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,n=this._firstCurve,this._firstCurve=null);return{paths:[n]}};return h}(F.PathGeometryCursor);r.EffectDashes=
w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(r,t,F,C){let v=function(){function l(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var e=l.prototype;e.isEmpty=function(){return 0===this._values.length};e.size=function(){return this._values.length};e.init=function(h,k,n=!0){this._setEmpty();if(!h||0===h.length)return!1;
for(let p=0;p<h.length;p++){let c=Math.abs(h[p]);n&&1E-7>c&&(c=1E-7);this._values.push(c);this._length+=c}k&&h.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};e.scale=function(h){const k=this._values?this._values.length:0;for(let n=0;n<k;++n)this._values[n]*=h;this._length*=h;this.extPtGap*=h;this.ctrlPtGap*=h};e.addValue=function(h){this._length+=h;this._values.push(h)};e.firstValue=function(){return this._values[0]};e.lastValue=
function(){return this._values[this._values.length-1]};e.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};e.reset=function(){this._currentValue=-1};e.length=function(){return this._length};e._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return l}();r.EndType=void 0;(function(l){l[l.FAIL=0]="FAIL";l[l.END=1]="END";l[l.CONTINUE=2]="CONTINUE"})(r.EndType||
(r.EndType={}));let A=function(){function l(){this.reset()}var e=l.prototype;e.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};e.isValid=function(){return-1!==this.segment};e.copyTo=function(h){h.segment=this.segment;h.segmentLength=this.segmentLength;h.abscissa=this.abscissa;h.isPathEnd=this.isPathEnd;h.isPartEnd=this.isPartEnd};return l}(),w=function(l){function e(k=0,n=!1){k=l.call(this,k,n)||this;k._tolerance=C.PIXEL_TOLERANCE;k._currentPosition=
new A;return k}t._inheritsLoose(e,l);var h=e.prototype;h.updateTolerance=function(k){this._tolerance=C.PIXEL_TOLERANCE*k};h.init=function(k,n,p=!0){p?(this._patternLength=n.length(),this._partExtPtGap=n.extPtGap,this._partCtrlPtGap=n.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=k;this._seg=-1;return this._setPosAtNextPart()};h.curPositionIsValid=function(){return this._currentPosition.isValid()};h.nextPosition=
function(k,n=r.EndType.FAIL){const p=new A;if(!this._nextPosition(k,p,null,n))return!1;p.copyTo(this._currentPosition);return!0};h.curPointAndAngle=function(k){k.pt=this._getPoint(this._currentPosition);const [n,p]=this._getAngle(this._currentPosition);k.ca=n;k.sa=p};h.nextPointAndAngle=function(k,n,p=r.EndType.FAIL){const c=new A;if(!this._nextPosition(k,c,null,p))return!1;c.copyTo(this._currentPosition);n.pt=this._getPoint(c);const [d,a]=this._getAngle(c);n.ca=d;n.sa=a;return!0};h.nextCurve=function(k){if(0===
k)return null;const n=[],p=new A;if(!this._nextPosition(k,p,n,r.EndType.END))return null;p.copyTo(this._currentPosition);return n};h.isPathEnd=function(){return this._currentPosition.isPathEnd};h.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};h._nextPosition=function(k,n,p,c){if(this._currentPosition.isPathEnd)return!1;var d=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(d/=this._currentPosition.segmentLength);
for(this._currentPosition.copyTo(n);n.abscissa+k*this._partLengthRatio>n.segmentLength+this._tolerance;)if(p&&(0===p.length&&(0===d?(d=this._path[n.segment],p.push([d[0],d[1]])):p.push(this.getSegCoord2D(this._path,n.segment,d))),d=this._path[n.segment+1],p.push([d[0],d[1]])),d=0,k-=(n.segmentLength-n.abscissa)/this._partLengthRatio,this._partSegCount)n.segment=this._nextSegment(),n.segmentLength=this.calculateSegLength(this._path,n.segment),n.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(c===
r.EndType.FAIL)return!1;n.segmentLength=this.calculateSegLength(this._path,n.segment);n.isPartEnd=!0;c===r.EndType.END?(n.abscissa=n.segmentLength,n.isPathEnd=!0):n.abscissa=n.segmentLength+k;return!0}this._currentPosition.copyTo(n)}n.abscissa+=k*this._partLengthRatio;p&&(0===p.length&&(0===d?(k=this._path[n.segment],p.push([k[0],k[1]])):p.push(this.getSegCoord2D(this._path,n.segment,d))),k=n.abscissa/n.segmentLength,1===k?(k=this._path[n.segment+1],p.push([k[0],k[1]])):p.push(this.getSegCoord2D(this._path,
n.segment,k)));!this._partSegCount&&Math.abs(n.abscissa-n.segmentLength)<this._tolerance&&(n.isPathEnd=this._partIsLast,n.isPartEnd=!0);return!0};h._getPoint=function(k){if(-1===k.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,k.segment,0>=k.segmentLength?0:k.abscissa/k.segmentLength)};h._getAngle=function(k){if(-1===k.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,k.segment,0>=k.segmentLength?0:k.abscissa/k.segmentLength)};h._setPosAtNextPart=
function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===F.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var k=this._partSegCount;k;)this._previousSegment(),--k;this._currentPosition.segment=
this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;k=this._getStartPointIndex();this._ctrlPtBegin=1===F.getId(this._path[k]);k=k+this._partSegCount+1;k>=this._path.length&&(k=0);this._ctrlPtEnd=1===F.getId(this._path[k]);if(0<this._patternLength){k=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const n=
this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let p=Math.round((this._partLength-(k+n))/this._patternLength);0>=p&&(p=0<k+n?0:1);this._partLengthRatio=this._partLength/(k+n+p*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};h._hasNextSegment=function(){return this._seg<this._path.length-2};h._previousSegment=function(){return--this._seg};h._nextSegment=function(){return++this._seg};h._getStartPointIndex=function(){return this._seg};
h._getEndPointIndex=function(){return this._seg+1};return e}(C.CurveHelper);r.DashPattern=v;r.GeometryWalker=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=
null;let A=function(){function w(l,e,h){this._inputGeometries=l;this._curveHelper=new F.CurveHelper;this._width=(void 0!==e.width?e.width:2)*h;switch(e.method){default:this._method=C.GeometricEffectOffsetMethod.Mitered;break;case C.GeometricEffectDonutMethod.Bevelled:this._method=C.GeometricEffectOffsetMethod.Bevelled;break;case C.GeometricEffectDonutMethod.Rounded:case C.GeometricEffectDonutMethod.TrueBuffer:this._method=C.GeometricEffectOffsetMethod.Rounded;break;case C.GeometricEffectDonutMethod.Square:this._method=
C.GeometricEffectOffsetMethod.Square}this._option=e.option;this._offsetFlattenError=F.PIXEL_TOLERANCE*h}w.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(t.isExtent(l)&&0<this._width){if(0>Math.min(l.xmax-l.xmin,l.ymax-l.ymin)-2*this._width)return l;var e=[];e.push([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]);e.push([[l.xmin+this._width,l.ymin+this._width],[l.xmax-this._width,l.ymin+this._width],[l.xmax-this._width,l.ymax-this._width],
[l.xmin+this._width,l.ymax-this._width],[l.xmin+this._width,l.ymin+this._width]]);return{rings:e}}if(t.isPolygon(l)&&0<this._width){e=[];for(const h of l.rings){l=this._curveHelper.calculatePathLength(h);const k=this._curveHelper.offset(h,this._width,this._method,4,this._offsetFlattenError);k&&(0>l&&k.reverse(),e.push(k))}if(e.length)return{rings:e}}l=this._inputGeometries.next()}return null};return w}();r.EffectDonut=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=null;let A=function(w){function l(e,h,k){e=w.call(this,e,!1,!0)||this;e._curveHelper=new C.CurveHelper;e._length=(void 0!==h.length?h.length:20)*k;e._angle=void 0!==h.angle?h.angle:225;e._position=void 0!==h.position?
h.position:50;0>e._length&&(e._length=-e._length);20>e._position&&(e._position=20);80<e._position&&(e._position=80);e._mirror=!1;return e}t._inheritsLoose(l,w);l.prototype.processPath=function(e){if(this._curveHelper.isEmpty(e,!1))return null;const h=e[0];e=e[e.length-1];this._curveHelper.normalize([e[0]-h[0],e[1]-h[1]]);const k=[h[0]+(e[0]-h[0])*this._position/100,h[1]+(e[1]-h[1])*this._position/100],n=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&
(p=-p);this._mirror=!this._mirror;return{paths:[[h,[k[0]-this._length/2*n,k[1]-this._length/2*p],[k[0]+this._length/2*n,k[1]+this._length/2*p],e]]}};return l}(F.PathGeometryCursor);r.EffectJog=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(r,t,F){let C=function(){function A(){}A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=
function(w,l,e,h){return new v(w,l,e)};return A}();C.instance=null;let v=function(){function A(l,e,h){this._inputGeometries=l;this._offsetX=void 0!==e.offsetX?e.offsetX*h:0;this._offsetY=void 0!==e.offsetY?-e.offsetY*h:0}var w=A.prototype;w.next=function(){for(var l=this._inputGeometries.next();l;){if(F.isExtent(l))return{xmin:l.xmin+this._offsetX,xmax:l.xmax+this._offsetX,ymin:l.ymin+this._offsetY,ymax:l.ymax+this._offsetY};if(F.isPolygon(l))return l=t.clone(l),this._moveMultipath(l.rings,this._offsetX,
this._offsetY),l;if(F.isPolyline(l))return l=t.clone(l),this._moveMultipath(l.paths,this._offsetX,this._offsetY),l;if(F.isMultipoint(l))return l=t.clone(l),this._movePath(l.points,this._offsetX,this._offsetY),l;if(F.isPoint(l))return{x:l.x+this._offsetX,y:l.y+this._offsetY};l=this._inputGeometries.next()}return null};w._moveMultipath=function(l,e,h){if(l)for(const k of l)this._movePath(k,e,h)};w._movePath=function(l,e,h){if(l)for(const k of l)k[0]+=e,k[1]+=h};return A}();r.EffectMove=C;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=null;let A=function(){function w(l,e,h){var k;this._inputGeometries=l;this._curveHelper=new F.CurveHelper;this._offset=(null!=(k=e.offset)?
k:1)*h;this._method=e.method;this._option=e.option;this._offsetFlattenError=F.PIXEL_TOLERANCE*h}w.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(0===this._offset)return l;if(t.isExtent(l)){if(this._method===C.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var e=this._curveHelper.offset([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return e?{rings:[e]}:null}if(0<Math.min(l.xmax-
l.xmin,l.ymax-l.ymin)+2*this._offset)return{xmin:l.xmin-this._offset,xmax:l.xmax+this._offset,ymin:l.ymin-this._offset,ymax:l.ymax+this._offset}}if(t.isPolygon(l)){var h=[];for(e of l.rings){const k=this._curveHelper.offset(e,-this._offset,this._method,4,this._offsetFlattenError);k&&h.push(k)}if(h.length)return{rings:h}}if(t.isPolyline(l)){h=[];for(const k of l.paths)(l=this._curveHelper.offset(k,-this._offset,this._method,4,this._offsetFlattenError))&&h.push(l);if(h.length)return{paths:h}}l=this._inputGeometries.next()}return null};
return w}();r.EffectOffset=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=null;let A=function(){function w(l,e,h){this._inputGeometries=l;this._reverse=
void 0!==e.reverse?e.reverse:!0}w.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(!this._reverse)return l;if(F.isPolyline(l))return l=t.clone(l),C.reverseMultipath(l.paths),l;l=this._inputGeometries.next()}return null};return w}();r.EffectReverse=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],
function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(){function l(h,k,n){this._inputGeometries=h;this._rotateAngle=void 0!==k.angle?k.angle*Math.PI/180:0}var e=l.prototype;e.next=function(){for(var h=this._inputGeometries.next();h;){if(0===this._rotateAngle)return h;var k=F.create();C.getBoundsXY(k,h);const n=(k[2]+k[0])/2;
k=(k[3]+k[1])/2;if(v.isExtent(h))return h={rings:[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]]},this._rotateMultipath(h.rings,n,k),h;if(v.isPolygon(h))return h=t.clone(h),this._rotateMultipath(h.rings,n,k),h;if(v.isPolyline(h))return h=t.clone(h),this._rotateMultipath(h.paths,n,k),h;if(v.isMultipoint(h))return h=t.clone(h),this._rotatePath(h.points,n,k),h;if(v.isPoint(h))return h;h=this._inputGeometries.next()}return null};e._rotateMultipath=function(h,k,n){if(h)for(const p of h)this._rotatePath(p,
k,n)};e._rotatePath=function(h,k,n){if(h){const p=Math.cos(this._rotateAngle),c=Math.sin(this._rotateAngle);for(const d of h){h=d[0]-k;const a=d[1]-n;d[0]=k+h*p-a*c;d[1]=n+h*c+a*p}}};return l}();r.EffectRotate=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(r,t,F,C,v){let A=
function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(){function l(h,k,n){this._inputGeometries=h;this._xFactor=void 0!==k.xScaleFactor?k.xScaleFactor:1.15;this._yFactor=void 0!==k.yScaleFactor?k.yScaleFactor:1.15}var e=l.prototype;e.next=function(){for(var h=this._inputGeometries.next();h;){if(1===this._xFactor&&1===this._yFactor)return h;var k=F.create();
C.getBoundsXY(k,h);const n=(k[2]+k[0])/2;k=(k[3]+k[1])/2;if(v.isExtent(h))return h={rings:[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]]},this._scaleMultipath(h.rings,n,k),h;if(v.isPolygon(h))return h=t.clone(h),this._scaleMultipath(h.rings,n,k),h;if(v.isPolyline(h))return h=t.clone(h),this._scaleMultipath(h.paths,n,k),h;if(v.isMultipoint(h))return h=t.clone(h),this._scalePath(h.points,n,k),h;if(v.isPoint(h))return h;h=this._inputGeometries.next()}return null};
e._scaleMultipath=function(h,k,n){if(h)for(const p of h)this._scalePath(p,k,n)};e._scalePath=function(h,k,n){if(h)for(const p of h)h=(p[1]-n)*this._yFactor,p[0]=k+(p[0]-k)*this._xFactor,p[1]=n+h};return l}();r.EffectScale=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===
l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(){function l(h,k,n){this._inputGeometries=h;this._height=(void 0!==k.amplitude?k.amplitude:2)*n;this._period=(void 0!==k.period?k.period:3)*n;this._style=k.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new v.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new v.GeometryWalker;this._walker.updateTolerance(n)}var e=l.prototype;e.next=function(){for(var h=this._inputGeometries.next();h;){if(0===this._height||0===this._period)return h;if(t.isPolyline(h)){const k=this._processGeom(h.paths);if(k.length)return{paths:k}}if(t.isPolygon(h)&&(h=this._processGeom(h.rings),h.length))return{rings:h};h=this._inputGeometries.next()}return null};e._processGeom=function(h){const k=[];for(const n of h)if(this._walker.init(n,this._pattern))switch(this._style){default:k.push(this._constructCurve(n,
!1));break;case C.GeometricEffectWaveform.Square:k.push(this._constructSquare(n));break;case C.GeometricEffectWaveform.Triangle:k.push(this._constructTriangle(n));break;case C.GeometricEffectWaveform.Random:k.push(this._constructCurve(n,!0))}else k.push(n);return k};e._constructCurve=function(h,k){const n=new F.PathHelper;var p=this._walker.calculatePathLength(h),c=Math.round(p/this._period);0===c&&(c=1);const d=this._period/16,a=1/(16*c+1);p=2*Math.PI*p/(p/c);c=2*Math.PI*Math.random();const b=2*
Math.PI*Math.random(),f=2*Math.PI*Math.random(),m=.75-Math.random()/2,g=.75-Math.random()/2,x={};this._walker.curPointAndAngle(x);n.startPath(x.pt);let q=0;for(;;)if(this._walker.nextPointAndAngle(d,x)){const B=q;q+=a;let z;if(k){const u=this._height/2*(1+.3*Math.sin(m*p*B+c));z=u*Math.sin(p*B+b);z+=u*Math.sin(g*p*B+f);z/=2}else z=.5*this._height*Math.sin(.5*p*B);n.lineTo([x.pt[0]-z*x.sa,x.pt[1]+z*x.ca])}else{n.lineTo(h[h.length-1]);break}return n.path()};e._constructSquare=function(h){const k=new F.PathHelper;
h=this._walker.calculatePathLength(h);Math.round(h/this._period);for(h=!0;;){let n=!1;if(this._walker.curPositionIsValid()){const p={};this._walker.curPointAndAngle(p);const c={};if(this._walker.nextPointAndAngle(this._period,c)){const d={};this._walker.nextPointAndAngle(this._period,d)&&(h?(k.startPath(p.pt),h=!1):k.lineTo(p.pt),k.lineTo([p.pt[0]-this._height/2*p.sa,p.pt[1]+this._height/2*p.ca]),k.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),k.lineTo([c.pt[0]+this._height/2*
c.sa,c.pt[1]-this._height/2*c.ca]),k.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca]),n=!0)}}if(!n){k.lineTo(this._walker.getPathEnd());break}}return k.path()};e._constructTriangle=function(h){const k=new F.PathHelper;h=this._walker.calculatePathLength(h);Math.round(h/this._period);for(h=!0;;){let n=!1;if(this._walker.curPositionIsValid()){const p={};this._walker.curPointAndAngle(p);const c={};if(this._walker.nextPointAndAngle(this._period/2,c)){const d={};this._walker.nextPointAndAngle(this._period,
d)&&(this._walker.nextPosition(this._period/2)&&(h?(k.startPath(p.pt),h=!1):k.lineTo(p.pt),k.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),k.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca])),n=!0)}}if(!n){k.lineTo(this._walker.getPathEnd());break}}return k.path()};return l}();r.EffectWave=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../enums","../GeometryWalker"],function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(l){function e(k,n,p){var c;k=l.call(this,k,!0,!0)||this;k._geometryWalker=new v.GeometryWalker;k._geometryWalker.updateTolerance(p);k._angleToLine=null!=(c=n.angleToLine)?c:!0;k._offset=(n.offset?n.offset:0)*p;k._originalEndings=
n.endings;k._offsetAtEnd=(n.customEndingOffset?n.customEndingOffset:0)*p;k._position=-(n.offsetAlongLine?n.offsetAlongLine:0)*p;k._pattern=new v.DashPattern;k._pattern.init(n.placementTemplate,!1);k._pattern.scale(p);k._endings=k._originalEndings;return k}t._inheritsLoose(e,l);var h=e.prototype;h.processPath=function(k){if(this._pattern.isEmpty())return null;if(this.iteratePath)var n=this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?
C.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let p=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:n=-this._position;n=this._adjustPosition(n);p=!1;break;default:n=-this._pattern.lastValue()/2;break;case C.PlacementEndings.WithFullGap:n=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:n=0;break;case C.PlacementEndings.Custom:n=-this._position,n=this._adjustPosition(n),this._pattern.extPtGap=
.5*this._offsetAtEnd}if(!this._geometryWalker.init(k,this._pattern,p))return null;this._pattern.reset();for(k=0;n>k;)n-=k,k=this._pattern.nextValue();n=k-=n;this.iteratePath=!0}k={};if(!this._geometryWalker.nextPointAndAngle(n,k)||this._endings===C.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(k.pt[0]-
this._offset*k.sa,k.pt[1]+this._offset*k.ca);this._angleToLine&&this.internalPlacement.setRotateCS(k.ca,k.sa);return this.internalPlacement};h._adjustPosition=function(k){k/=this._pattern.length();k-=Math.floor(k);return k*this._pattern.length()};return e}(F.PathTransformationCursor);r.PlacementAlongLineSameSize=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(l){function e(k,n,p){k=l.call(this,k,!1,!0)||this;k._curveHelper=new C.CurveHelper;k._angleToLine=void 0!==n.angleToLine?n.angleToLine:!0;k._offset=void 0!==n.offset?n.offset*p:0;k._type=n.extremityPlacement;k._position=void 0!==n.offsetAlongLine?
n.offsetAlongLine*p:0;k._beginProcessed=!1;return k}t._inheritsLoose(e,l);var h=e.prototype;h.processPath=function(k){let n;switch(this._type){default:this._beginProcessed?(n=this._atExtremities(k,this._position,!1),this.iteratePath=this._beginProcessed=!1):(n=this._atExtremities(k,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case v.ExtremityPlacement.JustBegin:n=this._atExtremities(k,this._position,!0);break;case v.ExtremityPlacement.JustEnd:n=this._atExtremities(k,this._position,
!1);case v.ExtremityPlacement.None:}return n};h._atExtremities=function(k,n,p){var c=k.length;if(2>c)return null;var d=p?1:c-2;const a=p?c:-1,b=p?1:-1;let f=0;p=p?k[0]:k[c-1];for(c=d;c!==a;c+=b){d=p;p=k[c];const m=this._curveHelper.calculateLength(d,p);if(f+m>n){k=(n-f)/m;const [g,x]=this._curveHelper.getAngleCS(d,p,k);k=F.getCoord2D(d,p,k);this.internalPlacement.setTranslate(k[0]-this._offset*x,k[1]+this._offset*g);this._angleToLine&&this.internalPlacement.setRotateCS(-g,-x);return this.internalPlacement}f+=
m}return null};return e}(F.PathTransformationCursor);r.PlacementAtExtremities=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(r,t,F,C){let v=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(l,e,h,k){return new A(l,e,h)};return w}();v.instance=
null;let A=function(w){function l(e,h,k){e=w.call(this,e,!0,!0)||this;e._walker=new C.GeometryWalker;e._walker.updateTolerance(k);e._angleToLine=void 0!==h.angleToLine?h.angleToLine:!0;e._offset=void 0!==h.offset?h.offset*k:0;e._beginGap=void 0!==h.beginPosition?h.beginPosition*k:0;e._endGap=void 0!==h.endPosition?h.endPosition*k:0;e._flipFirst=void 0!==h.flipFirst?h.flipFirst:!0;e._pattern=new C.DashPattern;e._pattern.init(h.positionArray,!1,!1);e._subPathLen=0;e._posCount=e._pattern.size();e._isFirst=
!0;e._prevPos=0;return e}t._inheritsLoose(l,w);l.prototype.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath){e=this._pattern.nextValue()*this._subPathLen;var h=this._beginGap+e;e=h-this._prevPos;this._prevPos=h}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(e)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;
this._pattern.reset();e=this._pattern.nextValue()*this._subPathLen;h=this._beginGap+e;e=h-this._prevPos;this._prevPos=h;this.iteratePath=!0}h={};if(!this._walker.nextPointAndAngle(e,h,C.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(h.pt[0]-this._offset*h.sa,h.pt[1]+this._offset*h.ca);e=this._isFirst&&this._flipFirst;let k;this._angleToLine?(k=h.ca,h=h.sa):(k=1,h=0);e&&(k=-k,h=-h);this.internalPlacement.setRotateCS(k,h);this._isFirst=!1;this._posCount--;0===this._posCount&&
(this.iteratePath=!1);return this.internalPlacement};return l}(F.PathTransformationCursor);r.PlacementAtRatioPositions=v;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements","../enums"],function(r,t,F){let C=function(){function A(){}A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=function(w,l,e,h){return new v(w,l,e,h)};return A}();C.instance=null;let v=
function(){function A(l,e,h,k){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==e.stepX?Math.abs(e.stepX):16)*h;this._stepY=(void 0!==e.stepY?Math.abs(e.stepY):16)*h;if(0!==this._stepX&&0!==this._stepY&&l&&void 0!==l.rings&&l.rings){this._gridType=void 0!==e.gridType?e.gridType:F.PlacementGridType.Fixed;if(this._gridType===F.PlacementGridType.Random)this._randomness=void 0!==e.randomness?e.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=
1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==e.gridAngle?e.gridAngle:0;this._shiftOddRows=void 0!==e.shiftOddRows?e.shiftOddRows:!1;this._offsetX=void 0!==e.offsetX?e.offsetX*h:0;this._offsetY=void 0!==e.offsetY?e.offsetY*h:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=
.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new t.Placement;this._calculateMinMax(l);this._geometry=l}}var w=A.prototype;w.next=function(){return this._geometry?this._nextInside():null};w._calculateMinMax=function(l){this._yMax=this._yMin=this._xMax=this._xMin=0;let e,
h,k,n,p;h=k=Number.MAX_VALUE;n=p=-Number.MAX_VALUE;for(const d of l.rings){const a=d?d.length:0;for(let b=0;b<a;++b){var c=d[b][0]-this._graphicOriginX-this._offsetX;e=d[b][1]-this._graphicOriginY-this._offsetY;l=this._cosAngle*c-this._sinAngle*e;c=this._sinAngle*c+this._cosAngle*e;h=Math.min(h,l);n=Math.max(n,l);k=Math.min(k,c);p=Math.max(p,c)}}h+=this._graphicOriginX;n+=this._graphicOriginX;k+=this._graphicOriginY;p+=this._graphicOriginY;this._xMin=Math.round(h/this._stepX);this._xMax=Math.round(n/
this._stepX);this._yMin=Math.round(k/this._stepY);this._yMax=Math.round(p/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};w._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var l=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(l+=.5*this._stepX);const e=this._currentY*this._stepY+this._offsetY;this._currentX++;
let h;this._gridType===F.PlacementGridType.Random?(h=this._graphicOriginX+l+this._stepX*this._randomness*(.5-Math.random())*2/3,l=this._graphicOriginY+e+this._stepY*this._randomness*(.5-Math.random())*2/3):(h=this._graphicOriginX+this._cosAngle*l+this._sinAngle*e,l=this._graphicOriginY-this._sinAngle*l+this._cosAngle*e);this._internalPlacement.setTranslate(h,l);return this._internalPlacement}};return A}();r.PlacementInsidePolygon=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(l){function e(k,n,p){k=l.call(this,k,!0,!0)||this;k._curveHelper=new C.CurveHelper;k._angleToLine=void 0!==n.angleToLine?n.angleToLine:!0;k._offset=void 0!==n.offset?n.offset*p:0;k._relativeTo=
n.relativeTo;k._position=void 0!==n.startPointOffset?n.startPointOffset*p:0;k._epsilon=.001*p;return k}t._inheritsLoose(e,l);var h=e.prototype;h.processPath=function(k){var n=this._position;if(this._relativeTo===v.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=k.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var p=this._curSegment;this._curSegment++;n=k[p-1];p=k[p];const c=this._curveHelper.calculateLength(n,p);if(c<this._epsilon)continue;
k=.5+this._position/c;const [d,a]=this._curveHelper.getAngleCS(n,p,k);k=F.getCoord2D(n,p,k);this.internalPlacement.setTranslate(k[0]-this._offset*a,k[1]+this._offset*d);this._angleToLine&&this.internalPlacement.setRotateCS(d,a);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===v.PlacementOnLineRelativeTo.LineEnd&&F.reversePath(k);n=this.onLine(k,n);this._relativeTo===v.PlacementOnLineRelativeTo.LineEnd&&F.reversePath(k);return n};h.onLine=function(k,n){let p,c=!1;switch(this._relativeTo){default:p=
this._curveHelper.calculatePathLength(k)/2+n;break;case v.PlacementOnLineRelativeTo.LineBeginning:p=n;break;case v.PlacementOnLineRelativeTo.LineEnd:p=n,c=!0}const d=k.length;let a=0,b=k[0];for(let f=1;f<d;++f){n=b;b=k[f];const m=this._curveHelper.calculateLength(n,b);if(a+m>p){k=(p-a)/m;const [g,x]=this._curveHelper.getAngleCS(n,b,k);k=F.getCoord2D(n,b,k);n=c?-this._offset:this._offset;this.internalPlacement.setTranslate(k[0]-n*x,k[1]+n*g);this._angleToLine&&(c?this.internalPlacement.setRotateCS(-g,
-x):this.internalPlacement.setRotateCS(g,x));return this.internalPlacement}a+=m}return null};return e}(F.PathTransformationCursor);r.PlacementOnLine=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,F,C){function v(l,e){const h=Math.PI;for(;Math.abs(e-l)>h+2E-15;)e=e-l>h?e-2*h:e+2*h;return(l+e)/2}let A=function(){function l(){}
l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(l){function e(k,n,p){k=l.call(this,k,!0,!0)||this;k._curveHelper=new C.CurveHelper;k._angleToLine=void 0!==n.angleToLine?n.angleToLine:!0;k._offset=void 0!==n.offset?n.offset*p:0;k._endPoints=void 0!==n.placeOnEndPoints?n.placeOnEndPoints:!0;k._controlPoints=void 0!==n.placeOnControlPoints?n.placeOnControlPoints:!0;k._regularVertices=
void 0!==n.placeOnRegularVertices?n.placeOnRegularVertices:!0;k._tags=[];k._tagIterator=0;return k}t._inheritsLoose(e,l);var h=e.prototype;h.processPath=function(k){this.iteratePath||(this._preparePath(k),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;k=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(k[2]);let n=k[0],p=k[1];if(0!==this._offset){const c=Math.cos(k[2]);n-=this._offset*
Math.sin(k[2]);p+=this._offset*c}this.internalPlacement.setTranslate(n,p);this._tagIterator++;return this.internalPlacement};h._preparePath=function(k){this._tagIterator=this._tags.length=0;const n=F.isClosedPath(k),p=k.length-1;let c=0,d=0,a=0,b=0,f=0,m,g;for(;c<p;){c++;m=k[c-1];g=k[c];const x=F.getId(m),q=F.getId(g);if(this._angleToLine||0!==this._offset)b=this._curveHelper.getAngle(m,g,0);1===c?n?(d=b,a=x):(this._endPoints||this._controlPoints&&1===x)&&this._tags.push([m[0],m[1],b]):1===x?this._controlPoints&&
this._tags.push([m[0],m[1],v(f,b)]):this._regularVertices&&this._tags.push([m[0],m[1],v(f,b)]);if(this._angleToLine||0!==this._offset)f=this._curveHelper.getAngle(m,g,1);c===p&&(n?1===q||1===a?this._controlPoints&&this._tags.push([g[0],g[1],v(f,d)]):this._regularVertices&&this._tags.push([g[0],g[1],v(f,d)]):(this._endPoints||this._controlPoints&&1===q)&&this._tags.push([g[0],g[1],f]))}this._tagIterator=0};return e}(F.PathTransformationCursor);r.PlacementOnVertices=A;Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements","../enums"],function(r,t,F,C,v){let A=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,h,k,n){return new w(e,h,k)};return l}();A.instance=null;let w=function(){function l(h,k,n){this._geometry=h;this._offsetX=void 0!==k.offsetX?
k.offsetX*n:0;this._offsetY=void 0!==k.offsetY?k.offsetY*n:0;this._method=void 0!==k.method?k.method:v.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new C.Placement}var e=l.prototype;e.next=function(){const h=this._geometry;this._geometry=null;return h&&void 0!==h.rings?this._polygonCenter(h):null};e._polygonCenter=function(h){switch(this._method){default:case v.PlacementPolygonCenterMethod.CenterOfMass:case v.PlacementPolygonCenterMethod.BoundingBoxCenter:{const k=t.create();F.getBoundsXY(k,
h);this._internalPlacement.setTranslate((k[2]+k[0])/2+this._offsetX,(k[3]+k[1])/2+this._offsetY)}}return this._internalPlacement};return l}();r.PlacementPolygonCenter=A;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(r,t,F,C,v,A,w,l,e,h){const k=Math.PI/180;let n=function(){function a(f,m,g,x){this._rotationT=C.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const q=g.rect,B=new Float32Array(8);f*=x;m*=x;const z=g.code?q.width*x:g.metrics.width,u=g.code?q.height*x:g.metrics.height;B[0]=f;B[1]=m;B[2]=f+z;B[3]=m;B[4]=f;B[5]=m+u;B[6]=f+z;B[7]=m+u;this._data=B;this._setTextureCoords(q);this._scale=x;this._mosaic=g;this.x=f;this.y=m;this.maxOffset=Math.max(f+z,m+u)}var b=
a.prototype;b.setTransform=function(f){this._T=f;this._offsets=null};b._setOffsets=function(f){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const m=this._offsets,g=new Float32Array(8),x=F.multiply(C.create(),this._rotationT,this._T);C.transformMany(g,f,x);m.upperLeft=l.i1616to32(8*g[0],8*g[1]);m.upperRight=l.i1616to32(8*g[2],8*g[3]);m.lowerLeft=l.i1616to32(8*g[4],8*g[5]);m.lowerRight=l.i1616to32(8*g[6],8*g[7])};b._setTextureCoords=function({x:f,y:m,width:g,height:x}){this._texcoords=
{upperLeft:l.i1616to32(f,m),upperRight:l.i1616to32(f+g,m),lowerLeft:l.i1616to32(f,m+x),lowerRight:l.i1616to32(f+g,m+x)}};t._createClass(a,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(f){this._angle=f;F.fromRotation(this._rotationT,-f);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},
{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:q,
width:B}=this._mosaic.metrics;var f=B*this._scale,m=Math.abs(q)*this._scale,g=new Float32Array(8);g[0]=this.x;g[1]=this.y;g[2]=this.x+f;g[3]=this.y;g[4]=this.x;g[5]=this.y+m;g[6]=this.x+f;g[7]=this.y+m;f=F.multiply(C.create(),this._rotationT,this._T);C.transformMany(g,g,f);m=f=Infinity;let z=0;var x=0;for(let u=0;4>u;u++){const y=g[2*u],E=g[2*u+1];f=Math.min(f,y);m=Math.min(m,E);z=Math.max(z,y);x=Math.max(x,E)}g=z-f;x-=m;this._bounds=new h(f+g/2,m+x/2,g,x)}return this._bounds}}]);return a}();const p=
(a,b)=>({code:0,page:0,sdf:!0,rect:new e(0,0,11,8),textureBinding:b,metrics:{advance:0,height:4,width:a,left:0,top:0}});let c=function(){function a(f,m,g){this._rotation=0;this._decorate(f,m,g);this.glyphs=f;this.bounds=this._createBounds(f);this.isMultiline=1<m.length;this._hasRotation=0!==g.angle;this._T=this._createGlyphTransform(this.bounds,g);for(const x of f)x.setTransform(this._T)}var b=a.prototype;b.setRotation=function(f){if(0!==f||0!==this._rotation){this._rotation=f;var m=this._T;f=F.fromRotation(C.create(),
f);F.multiply(m,f,m);for(const g of this.glyphs)g.setTransform(this._T)}};b._decorate=function(f,m,g){if(g.decoration&&"none"!==g.decoration&&f.length){var x=g.scale;g="underline"===g.decoration?30:20;var q=f[0].textureBinding;for(const B of m)f.push(new n(B.startX*x,B.startY*x+g*x,p((B.width+B.glyphWidthEnd)*x,q),1))}};b._createBounds=function(f){let m=Infinity,g=Infinity,x=0;var q=0;for(const B of f)m=Math.min(m,B.xTopLeft),g=Math.min(g,B.yTopLeft),x=Math.max(x,B.xTopLeft+B.width),q=Math.max(q,
B.yBottomRight);f=x-m;q-=g;return new h(m+f/2,g+q/2,f,q)};b._createGlyphTransform=function(f,m){const g=k*m.angle,x=C.create(),q=A.create();F.translate(x,x,v.set(q,m.xOffset,-m.yOffset));m.isCIM?F.rotate(x,x,g):(F.translate(x,x,v.set(q,f.x,f.y)),F.rotate(x,x,g),F.translate(x,x,v.set(q,-f.x,-f.y)));return x};t._createClass(a,[{key:"boundsT",get:function(){var f=this.bounds;const m=v.set(A.create(),f.x,f.y);v.transformMat2d(m,m,this._T);return this._hasRotation?(f=Math.max(f.width,f.height),new h(m[0],
m[1],f,f)):new h(m[0],m[1],f.width,f.height)}}]);return a}(),d=function(a,b,f,m,g,x){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,f));this.end=Math.max(0,Math.max(b,f));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=m;this.yMin=g;this.yMax=x};r.ShapedGlyph=n;r.ShapingInfo=c;r.shapeGlyphs=function(a,b,f){const m=f.scale,g=[];{var x=[];var q=1/f.scale*f.maxLineWidth;var B=b?a.length-1:0;var z=b?-1:a.length;b=b?-1:1;var u=B,y=0,E=0;let O=
u,K=O,D=0,I=Infinity,L=0;for(;u!==z;){const {code:R,metrics:Z}=a[u];var H=Math.abs(Z.top);10!==R&&32!==R&&(I=Math.min(I,H),L=Math.max(L,H+Z.height));10===R?(u!==B&&(x.push(new d(a,O,u-b,y,I,L)),I=Infinity,L=0),y=0,O=u+b,K=u+b,E=0):32===R?(K=u+b,E=0,D=Z.advance,y+=Z.advance):(y>q&&(K!==O?(H=K-2*b,y-=D,x.push(new d(a,O,H,y-E,I,L)),I=Infinity,L=0,O=K,y=E):(x.push(new d(a,O,u-b,y,I,L)),I=Infinity,L=0,K=O=u,y=0)),y+=Z.advance,E+=Z.advance);u+=b}q=new d(a,O,u-b,y,I,L);0<=q.start&&q.end<a.length&&x.push(q)}for(q=
0;q<x.length;q++);q=B=x[0].yMin;B=x[x.length-1].yMax+f.lineHeight*(x.length-1)+("underline"===f.decoration?4:0)-B;const {vAlign:J,hAlign:P}=f;z=J===w.VAlign.Baseline?1:0;q=(1-z)*-q+B/2*(z?0:J-1)+-26*(z?1:0);for(B=0;B<x.length;B++){const {start:O,end:K,width:D}=x[B];z=D/2*(P+1)*-1-3;b=B*f.lineHeight+q-3;x[B].startX=z;x[B].startY=b;for(u=O;u<=K;u++)y=a[u],10!==y.code&&(E=new n(z+y.metrics.left,b-y.metrics.top,y,m),z+=y.metrics.advance,g.push(E))}return new c(g,x,f)};Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(r,t){function F(z,u){z[0]=u[0];z[1]=u[1];z[2]=u[2];z[3]=u[3];z[4]=u[4];z[5]=u[5];return z}function C(z){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=0;z[5]=0;return z}function v(z,u,y,E,H,J,P){z[0]=u;z[1]=y;z[2]=E;z[3]=H;z[4]=J;z[5]=P;return z}function A(z,u){const y=u[0],E=u[1],H=u[2],J=u[3],P=u[4];u=u[5];let O=y*J-E*H;if(!O)return null;O=1/O;z[0]=J*O;z[1]=-E*O;z[2]=-H*O;z[3]=y*O;z[4]=(H*u-J*P)*O;z[5]=(E*P-y*u)*O;return z}function w(z){return z[0]*
z[3]-z[1]*z[2]}function l(z,u,y){const E=u[0],H=u[1],J=u[2],P=u[3],O=u[4];u=u[5];const K=y[0],D=y[1],I=y[2],L=y[3],R=y[4];y=y[5];z[0]=E*K+J*D;z[1]=H*K+P*D;z[2]=E*I+J*L;z[3]=H*I+P*L;z[4]=E*R+J*y+O;z[5]=H*R+P*y+u;return z}function e(z,u,y){const E=u[0],H=u[1],J=u[2],P=u[3],O=u[4];u=u[5];const K=Math.sin(y);y=Math.cos(y);z[0]=E*y+J*K;z[1]=H*y+P*K;z[2]=E*-K+J*y;z[3]=H*-K+P*y;z[4]=O;z[5]=u;return z}function h(z,u,y){const E=u[1],H=u[2],J=u[3],P=u[4],O=u[5],K=y[0];y=y[1];z[0]=u[0]*K;z[1]=E*K;z[2]=H*y;z[3]=
J*y;z[4]=P;z[5]=O;return z}function k(z,u,y){const E=u[0],H=u[1],J=u[2],P=u[3],O=u[4];u=u[5];const K=y[0];y=y[1];z[0]=E;z[1]=H;z[2]=J;z[3]=P;z[4]=E*K+J*y+O;z[5]=H*K+P*y+u;return z}function n(z,u){const y=Math.sin(u);u=Math.cos(u);z[0]=u;z[1]=y;z[2]=-y;z[3]=u;z[4]=0;z[5]=0;return z}function p(z,u){z[0]=u[0];z[1]=0;z[2]=0;z[3]=u[1];z[4]=0;z[5]=0;return z}function c(z,u){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=u[0];z[5]=u[1];return z}function d(z){return"mat2d("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+", "+z[4]+
", "+z[5]+")"}function a(z){return Math.sqrt(z[0]**2+z[1]**2+z[2]**2+z[3]**2+z[4]**2+z[5]**2+1)}function b(z,u,y){z[0]=u[0]+y[0];z[1]=u[1]+y[1];z[2]=u[2]+y[2];z[3]=u[3]+y[3];z[4]=u[4]+y[4];z[5]=u[5]+y[5];return z}function f(z,u,y){z[0]=u[0]-y[0];z[1]=u[1]-y[1];z[2]=u[2]-y[2];z[3]=u[3]-y[3];z[4]=u[4]-y[4];z[5]=u[5]-y[5];return z}function m(z,u,y){z[0]=u[0]*y;z[1]=u[1]*y;z[2]=u[2]*y;z[3]=u[3]*y;z[4]=u[4]*y;z[5]=u[5]*y;return z}function g(z,u,y,E){z[0]=u[0]+y[0]*E;z[1]=u[1]+y[1]*E;z[2]=u[2]+y[2]*E;z[3]=
u[3]+y[3]*E;z[4]=u[4]+y[4]*E;z[5]=u[5]+y[5]*E;return z}function x(z,u){return z[0]===u[0]&&z[1]===u[1]&&z[2]===u[2]&&z[3]===u[3]&&z[4]===u[4]&&z[5]===u[5]}function q(z,u){const y=z[0],E=z[1],H=z[2],J=z[3],P=z[4];z=z[5];const O=u[0],K=u[1],D=u[2],I=u[3],L=u[4];u=u[5];return Math.abs(y-O)<=t.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(E-K)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(K))&&Math.abs(H-D)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(D))&&Math.abs(J-I)<=t.EPSILON*Math.max(1,Math.abs(J),
Math.abs(I))&&Math.abs(P-L)<=t.EPSILON*Math.max(1,Math.abs(P),Math.abs(L))&&Math.abs(z-u)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(u))}const B=Object.freeze({__proto__:null,copy:F,identity:C,set:v,invert:A,determinant:w,multiply:l,rotate:e,scale:h,translate:k,fromRotation:n,fromScaling:p,fromTranslation:c,str:d,frob:a,add:b,subtract:f,multiplyScalar:m,multiplyScalarAndAdd:g,exactEquals:x,equals:q,mul:l,sub:f});r.add=b;r.copy=F;r.determinant=w;r.equals=q;r.exactEquals=x;r.frob=a;r.fromRotation=n;
r.fromScaling=p;r.fromTranslation=c;r.identity=C;r.invert=A;r.mat2d=B;r.mul=l;r.multiply=l;r.multiplyScalar=m;r.multiplyScalarAndAdd=g;r.rotate=e;r.scale=h;r.set=v;r.str=d;r.sub=f;r.subtract=f;r.translate=k})},"esri/chunks/mat2df32":function(){define(["exports"],function(r){function t(){const e=new Float32Array(6);e[0]=1;e[3]=1;return e}function F(e){const h=new Float32Array(6);h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];h[4]=e[4];h[5]=e[5];return h}function C(e,h,k,n,p,c){const d=new Float32Array(6);
d[0]=e;d[1]=h;d[2]=k;d[3]=n;d[4]=p;d[5]=c;return d}function v(e,h){return new Float32Array(e,h,6)}function A(e,h,k,n){const p=h[n];h=h[n+1];e[n]=k[0]*p+k[2]*h+k[4];e[n+1]=k[1]*p+k[3]*h+k[5]}function w(e,h,k,n=0,p=0,c=2){for(p=p||h.length/c;n<p;n++)A(e,h,k,n*c)}const l=Object.freeze({__proto__:null,create:t,clone:F,fromValues:C,createView:v,transform:A,transformMany:w});r.clone=F;r.create=t;r.createView=v;r.fromValues=C;r.mat2df32=l;r.transform=A;r.transformMany=w})},"esri/chunks/vec2f32":function(){define(["exports"],
function(r){function t(){return new Float32Array(2)}function F(d){const a=new Float32Array(2);a[0]=d[0];a[1]=d[1];return a}function C(d,a){const b=new Float32Array(2);b[0]=d;b[1]=a;return b}function v(d,a){return new Float32Array(d,a,2)}function A(){return t()}function w(){return C(1,1)}function l(){return C(1,0)}function e(){return C(0,1)}const h=t(),k=w(),n=l(),p=e(),c=Object.freeze({__proto__:null,create:t,clone:F,fromValues:C,createView:v,zeros:A,ones:w,unitX:l,unitY:e,ZEROS:h,ONES:k,UNIT_X:n,
UNIT_Y:p});r.ONES=k;r.UNIT_X=n;r.UNIT_Y=p;r.ZEROS=h;r.clone=F;r.create=t;r.createView=v;r.fromValues=C;r.ones=w;r.unitX=l;r.unitY=e;r.vec2f32=c;r.zeros=A})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(r,t){return function(){function F(v,A,w,l){this.center=t.fromValues(v,A);this.centerT=t.create();this.halfWidth=w/2;this.halfHeight=l/2;this.width=w;this.height=l}var C=F.prototype;
C.clone=function(){return new F(this.x,this.y,this.width,this.height)};C.serialize=function(v){v.writeF32(this.center[0]);v.writeF32(this.center[1]);v.push(this.width);v.push(this.height);return v};C.findCollisionDelta=function(v,A=4){return Math.log2(Math.min((v.halfWidth+this.halfWidth+A)/Math.abs(v.centerT[0]-this.centerT[0]),(v.halfHeight+this.halfHeight+A)/Math.abs(v.centerT[1]-this.centerT[1])))};C.extend=function(v){const A=Math.min(this.xmin,v.xmin),w=Math.min(this.ymin,v.ymin),l=Math.max(this.xmax,
v.xmax)-A;v=Math.max(this.ymax,v.ymax)-w;this.width=l;this.height=v;this.halfWidth=l/2;this.halfHeight=v/2;this.x=A+l/2;this.y=w+v/2};F.deserialize=function(v){const A=v.readF32(),w=v.readF32(),l=v.readInt32();v=v.readInt32();return new F(A,w,l,v)};r._createClass(F,[{key:"x",get:function(){return this.center[0]},set:function(v){this.center[0]=v}},{key:"y",get:function(){return this.center[1]},set:function(v){this.center[1]=v}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",
get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return F}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe",
"../../../../../../symbols/cim/effects/CIMEffectHelper"],function(r,t){return function(){function F(){}var C=F.prototype;C.bindFeature=function(v,A,w){};C.write=function(v,A,w,l){var e;if(r.isNone(this._effects)||0===(null==(e=this._effects)?void 0:e.length))return this._write(v,A,l);w=t.CIMEffectHelper.executeEffects(this._effects,A.readLegacyGeometryForDisplay(),l.geometryEngine);for(e=t.CIMEffectHelper.next(w);e;)this._write(v,A,l,e),e=t.CIMEffectHelper.next(w)};C._write=function(v,A,w,l){};return F}()})},
"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(r,t,F,C,v){const A=96/72;let w=function(){function l(){}l.executeEffects=function(e,h,k){h=F.cloneAndDecodeGeometry(h);h=new C.SimpleGeometryCursor(h);for(const n of e)(e=v.getEffectOperator(n))&&(h=e.execute(h,n,A,k));return h};l.next=function(e){e=e.next();F.deltaEncodeGeometry(e);return e};l.applyEffects=function(e,h,k){if(!e)return h;
h=new C.SimpleGeometryCursor(h);for(var n of e)(e=v.getEffectOperator(n))&&(h=e.execute(h,n,1,k));for(k=null;n=h.next();)k?t.isPolyline(k)?t.isPolyline(n)&&k.paths.push(...n.paths):t.isPolygon(k)&&t.isPolygon(n)&&k.rings.push(...n.rings):k=n;return k};return l}();r.CIMEffectHelper=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(r,t){let F=function(){function C(v){this._geometry=v}C.prototype.next=function(){const v=
this._geometry;this._geometry=null;return v};return C}();r.SimpleGeometryCursor=F;r.clone=function(C){return t.clone(C)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){return function(c){function d(a,b,f,m,g,x,q,B,z,u,y,E,H,J,P,O,K,D,I,L,R,Z,X){var Q=c.call(this)||this;Q.angle=m;Q.height=q;Q.width=x;Q.xOffset=b*I;Q.yOffset=f*I;Q._markerPlacement=L;Q._effects=R;Q._anchorX=.5-(.5+O)*P.width/P.width;Q._anchorY=.5-(.5+K)*P.height/P.height;Q._minMaxZoom=e.i1616to32(Math.round(Z*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(X*l.MIN_MAX_ZOOM_PRECISION_FACTOR));b=(J===A.Alignment.MAP?l.BITSET_MARKER_ALIGNMENT_MAP:l.BITSET_MARKER_ALIGNMENT_SCREEN)|
(y?l.BITSET_GENERIC_LOCK_COLOR:0)|(H?l.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(E?l.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);f=P&&P.sdf;a=h.MarkerMaterialKey.load(a);a.sdf=f;a.pattern=!0;a.textureBinding=P.textureBinding;Q._materialKey=a.data;Q._fillColor=g;Q._outlineColor=z;Q._sizeOutlineWidth=e.i8888to32(Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*q),255)),Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*B),255)));g=P.rect.x+
l.SPRITE_PADDING;B=P.rect.y+l.SPRITE_PADDING;z=g+P.width;P=B+P.height;Q._offsets.xUpperLeft=g;Q._offsets.yUpperLeft=B;Q._offsets.xUpperRight=z;Q._offsets.yUpperRight=B;Q._offsets.xBottomLeft=g;Q._offsets.yBottomLeft=P;Q._offsets.xBottomRight=z;Q._offsets.yBottomRight=P;Q._texUpperLeft=e.i1616to32(g,B);Q._texUpperRight=e.i1616to32(z,B);Q._texBottomLeft=e.i1616to32(g,P);Q._texBottomRight=e.i1616to32(z,P);x=x*D*I;q=q*D*I;Q._bitestAndDistRatio=e.i1616to32(b,Math.round(64*D));Q._computedWidth=x;Q._computedHeight=
q;x=v.create();q=C.create();Q._applyTransformation(q,x);return Q}r._inheritsLoose(d,c);d.fromCIMMarker=function(a,b,f){const m=a.size,g=(b&&b.width||1)/(b&&b.height||1)*a.scaleX;var x=a.scaleSymbolsProportionally&&a.frameHeight?m/a.frameHeight:1;let q=w.premultiplyAlphaRGBA(a.color);const B=w.premultiplyAlphaRGBA(a.outlineColor),z=F.pt2px(m),u=z*g,y=F.pt2px(a.offsetX||0),E=F.pt2px(a.offsetY||0);x*=F.pt2px(a.outlineWidth||0);const H=a.alignment||A.Alignment.SCREEN,J=F.pt2px(a.referenceSize),[P,O]=
k.getMinMaxZoom(a.scaleInfo,f);b.sdf||0!==q||(q=-1);f=a.rotation||0;a.rotateClockwise||(f=-f);let K=0,D=0;const I=a.anchorPoint;I&&(a.isAbsoluteAnchorPoint?m&&(K=-I.x/(m*g),D=I.y/m):(K=I.x,D=I.y));b=new d(a.materialKey,y,E,f,q,u,z,J,B,x,a.colorLocked,a.scaleSymbolsProportionally,!1,H,b,K,D,a.sizeRatio,t.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects,P,O);b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/u:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/z:1;return b};d.fromPictureMarker=function(a,
b){const f=Math.round(F.pt2px(a.width)),m=Math.round(F.pt2px(a.height)),g=l.PICTURE_FILL_COLOR,x=Math.round(F.pt2px(a.xoffset||0)),q=Math.round(F.pt2px(a.yoffset||0));b=new d(a.materialKey,x,q,a.angle,g,f,m,m,0,0,!1,!1,!1,A.Alignment.SCREEN,b,0,0,1,1,null,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM);b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.height:1;return b};d.fromSimpleMarker=function(a,b){const f=w.premultiplyAlphaRGBAArray(a.color),
m=Math.round(F.pt2px(a.size)),g=Math.round(F.pt2px(a.xoffset||0)),x=Math.round(F.pt2px(a.yoffset||0)),q=a.style;var B=a.outline;const z=(B&&B.color&&w.premultiplyAlphaRGBAArray(B.color))|0;B=(B&&B.width&&Math.round(F.pt2px(B.width)))|0;b=new d(a.materialKey,g,x,a.angle,f,m,m,m,z,B,!1,!1,"esriSMSCross"===q||"esriSMSX"===q,A.Alignment.SCREEN,b,0,0,1.96875,1,null,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM);b.boundsType="esriSMSCircle"===q?"circle":"square";b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/
a.size:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return b};d.fromLineSymbolMarker=function(a,b){const f=w.premultiplyAlphaRGBAArray(a.color),m=Math.round(F.pt2px(6*a.lineWidth)),g="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var x=A.ExtremityPlacement.Both;break;case "begin":x=A.ExtremityPlacement.JustBegin;break;case "end":x=A.ExtremityPlacement.JustEnd;break;default:x=A.ExtremityPlacement.None}x={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,
extremityPlacement:x,offsetAlongLine:0};b=new d(a.materialKey,0,0,0,f,m,m,m/6,f,g?Math.round(F.pt2px(a.lineWidth)):0,!1,!1,g,A.Alignment.MAP,b,0,0,1.96875,1,x,null,k.DEFAULT_MIN_ZOOM,k.DEFAULT_MAX_ZOOM);b.boundsType="circle"===a.style?"circle":"square";return b};return d}(n(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k){const n=3.14159265359/180;return p=>function(c){function d(...b){b=c.call(this,...b)||this;b.angle=0;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.boundsType="square";b._anchorX=0;b._anchorY=0;b._computedWidth=0;b._computedHeight=0;b._vertexBoundsScaleX=1;b._vertexBoundsScaleY=1;b._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};b.geometryType=h.WGLGeometryType.MARKER;return b}r._inheritsLoose(d,
c);var a=d.prototype;a._write=function(b,f,m,g){const x=f.getDisplayId();b.recordStart(x,this._materialKey,this.geometryType,!0);this._writeGeometry(b,f,x,m,g);b.recordEnd()};a._writeGeometry=function(b,f,m,g,x){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(b,f,g,x);if(!x&&"esriGeometryPoint"===f.geometryType)return g=f.getX(),f=f.getY(),!b.hasAggregates&&b.hasPixelBufferEnabled&&(0>g||513<=g||0>f||513<=f)?void 0:this._writeVertices(b,m,this._getPos(g,f),g,f);f=x?l.deltaDecodeGeometry(l.convertFromGeometry(x),
2):"esriGeometryPolygon"===f.geometryType?f.readCentroid():f.readGeometryForDisplay();if(!t.isNone(f)){if(f.isPoint){const [q,B]=f.coords;return!b.hasAggregates&&b.hasPixelBufferEnabled&&(0>q||512<=q||0>B||512<=B)?void 0:this._writeVertices(b,m,this._getPos(q,B),q,B)}f.forEachVertex((q,B)=>this._writeVertices(b,m,this._getPos(q,B),q,B))}};a._writePlacedMarkers=function(b,f,m,g){g=null!=g?g:f.readLegacyGeometryForDisplay();if(m=e.CIMMarkerPlacementHelper.getPlacement(g,t.unwrap(this._markerPlacement),
F.pt2px(1),m.geometryEngine)){f=f.getDisplayId();g=w.create();for(var x=v.create(),q=m.next();null!=q;){const B=q.tx,z=-q.ty;-128<=B&&640>=B&&-128<=z&&640>=z&&(this._applyTransformation(x,g,-q.getAngle()/n),this._writeVertices(b,f,this._getPos(B,z),B,z));q=m.next()}}};a._writeVertices=function(b,f,m,g,x){const q=b.vertexCount();if(this.angle){const B=Math.max(this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);b.vertexBounds(g+this.xOffset,x-this.yOffset,B,
B)}else b.vertexBounds(g+this.xOffset,x-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);b.vertexWrite(m);b.vertexWrite(this._offsetUpperLeft);b.vertexWrite(this._texUpperLeft);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(f);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.vertexWrite(m);b.vertexWrite(this._offsetUpperRight);b.vertexWrite(this._texUpperRight);
b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(f);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.vertexWrite(m);b.vertexWrite(this._offsetBottomLeft);b.vertexWrite(this._texBottomLeft);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(f);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();
b.vertexWrite(m);b.vertexWrite(this._offsetBottomRight);b.vertexWrite(this._texBottomRight);b.vertexWrite(this._bitestAndDistRatio);b.vertexWrite(f);b.vertexWrite(this._fillColor);b.vertexWrite(this._outlineColor);b.vertexWrite(this._sizeOutlineWidth);b.vertexWrite(this._minMaxZoom);b.vertexEnd();b.indexWrite(q+0);b.indexWrite(q+1);b.indexWrite(q+2);b.indexWrite(q+1);b.indexWrite(q+3);b.indexWrite(q+2)};a._applyTransformation=function(b,f,m=0){C.fromTranslation(b,w.fromValues(this.xOffset,-this.yOffset));
0!==this.angle+m&&C.rotate(b,b,n*(this.angle+m));m=this._computedWidth;const g=this._computedHeight,x=(this._anchorX-.5)*m,q=(this._anchorY-.5)*g;A.set(f,x,q);A.transformMat2d(f,f,b);this._offsetUpperLeft=k.i1616to32(16*f[0],16*f[1]);this._offsets.xUpperLeft=f[0];this._offsets.yUpperLeft=f[1];A.set(f,x+m,q);A.transformMat2d(f,f,b);this._offsetUpperRight=k.i1616to32(16*f[0],16*f[1]);this._offsets.xUpperRight=f[0];this._offsets.yUpperRight=f[1];A.set(f,x,q+g);A.transformMat2d(f,f,b);this._offsetBottomLeft=
k.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomLeft=f[0];this._offsets.yBottomLeft=f[1];A.set(f,x+m,q+g);A.transformMat2d(f,f,b);this._offsetBottomRight=k.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomRight=f[0];this._offsets.yBottomRight=f[1]};a._getPos=function(b,f){return k.i1616to32(Math.round(8*b),Math.round(8*f))};return d}(p)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g){function x(J,P){const O=J.length;J.push(null);P.then(K=>J[O]=K);return J}function q(J){return!!(J&1)}const B=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),z=[];C={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0};const u={...A.errorPointSymbolJSON,hash:JSON.stringify(A.errorPointSymbolJSON),materialKey:l.createMaterialKey(w.WGLGeometryType.MARKER,C)},y={...A.errorPolylineSymbolJSON,hash:JSON.stringify(A.errorPolylineSymbolJSON),
materialKey:l.createMaterialKey(w.WGLGeometryType.LINE,C)},E={...A.errorPolygonSymbolJSON,hash:JSON.stringify(A.errorPolygonSymbolJSON),materialKey:l.createMaterialKey(w.WGLGeometryType.FILL,C)};A=function(){function J(O,K){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new b.default;this._fetchResource=O;this._tileInfo=K}var P=J.prototype;
P.createTemplateGroup=function(O,K){this._initErrorTemplates();const D=O.hash;if(this._symbolToTemplate.has(D))return this._symbolToTemplate.get(D);const I=[];K&&this._createMeshTemplates(I,K,!0);this._createMeshTemplates(I,O,!1);O=this._createGroupId("expanded-cim"===O.type&&H(O));this._idToTemplateGroup.set(O,I);this._symbolToTemplate.set(D,O);return O};P.getTemplateGroup=function(O){return this._idToTemplateGroup.has(O)?this._idToTemplateGroup.get(O):z};P.getDynamicTemplateGroup=function(O){if(!this._idToTemplateGroup.has(O))return z;
q(O)||B.error("mapview-template-store",`Id ${O} does not refer to a dynamic template`);return this._idToTemplateGroup.get(O)};P.getMosaicItem=function(O,K){const D=this._createTemplateId(),I=new Promise(L=>this._idToResolver.set(D,L));this._fetchQueue.push({symbol:O,id:D,glyphIds:K});return I};P.finalize=function(O){return this._fetchQueue.length||this._lock.isHeld()?b.withLock(this._lock,this._fetchAllQueuedResources.bind(this),O):Promise.resolve()};P._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],E,!1),marker:this._createMeshTemplates([],u,!1),line:this._createMeshTemplates([],y,!1)})};P._fetchAllQueuedResources=function(O){if(!this._fetchQueue.length)return Promise.resolve();const K=this._fetchQueue,D=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(D).then(()=>this._fetchResource(K,O).then(I=>{for(const {id:L,mosaicItem:R}of I)this._idToResolver.get(L)(R),this._idToResolver.delete(L)})).catch(I=>{v.isAbortError(I)?
this._fetchQueue=this._fetchQueue.concat(K):"worker:port-closed"!==I.name&&B.error(new F("mapview-template-store","Unable to fetch requested texture resources",I))})};P._createGroupId=function(O){return this._idCounter++<<1|(O?1:0)};P._createTemplateId=function(){return this._templateIdCounter++};P._createSMS=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=yield this.getMosaicItem(K);return f.ok(D,B)?d.fromSimpleMarker(K,D):this._markerError});return function(K){return O.apply(this,
arguments)}}();P._createPMS=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=yield this.getMosaicItem(K);return f.ok(D,B)?d.fromPictureMarker(K,D):this._markerError});return function(K){return O.apply(this,arguments)}}();P._createSFS=function(){var O=t._asyncToGenerator(function*(K,D){const {spriteMosaicItem:I}=yield this.getMosaicItem(K);return f.ok(I,B)?p.fromSimpleFill(K,I,D):this._fillError});return function(K,D){return O.apply(this,arguments)}}();P._createPFS=function(){var O=
t._asyncToGenerator(function*(K,D){const {spriteMosaicItem:I}=yield this.getMosaicItem(K);return f.ok(I,B)?p.fromPictureFill(K,I,D):this._fillError});return function(K,D){return O.apply(this,arguments)}}();P._createSLS=function(){var O=t._asyncToGenerator(function*(K,D){({spriteMosaicItem:D}=yield this.getMosaicItem(K));return f.ok(D,B)?c.fromSimpleLine(K,D):this._lineError});return function(K,D){return O.apply(this,arguments)}}();P._createLMS=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=
yield this.getMosaicItem(K);return f.ok(D,B)?d.fromLineSymbolMarker(K,D):this._markerError});return function(K){return O.apply(this,arguments)}}();P._createTS=function(){var O=t._asyncToGenerator(function*(K){const {glyphMosaicItems:D}=yield this.getMosaicItem(K);return a.fromText(K,D)});return function(K){return O.apply(this,arguments)}}();P._createCIMText=function(){var O=t._asyncToGenerator(function*(K){const {glyphMosaicItems:D}=yield this.getMosaicItem(g.cimLayerToRasterizationInfo(K),m.codepoints(K.text));
return f.ok(D,B)?a.fromCIMText(K,D,this._tileInfo):this._textError});return function(K){return O.apply(this,arguments)}}();P._createCIMFill=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=yield this.getMosaicItem(g.cimLayerToRasterizationInfo(K));return f.ok(D,B)?p.fromCIMFill(K,D,this._tileInfo):this._fillError});return function(K){return O.apply(this,arguments)}}();P._createCIMLine=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=yield this.getMosaicItem(g.cimLayerToRasterizationInfo(K));
return f.ok(D,B)?c.fromCIMLine(K,D,this._tileInfo):this._lineError});return function(K){return O.apply(this,arguments)}}();P._createCIMMarker=function(){var O=t._asyncToGenerator(function*(K){const {spriteMosaicItem:D}=yield this.getMosaicItem(g.cimLayerToRasterizationInfo(K));return f.ok(D,B)?d.fromCIMMarker(K,D,this._tileInfo):this._markerError});return function(K){return O.apply(this,arguments)}}();P._createCIM=function(){var O=t._asyncToGenerator(function*(K){const D=K.templateHash;if(this._cimTemplateCache.has(D))return this._cimTemplateCache.get(D);
let I;switch(K.type){case "marker":I=yield this._createCIMMarker(K);break;case "line":I=yield this._createCIMLine(K);break;case "fill":I=yield this._createCIMFill(K);break;case "text":I=yield this._createCIMText(K)}this._cimTemplateCache.set(D,I);return I});return function(K){return O.apply(this,arguments)}}();P._createDynamicCIM=function(){var O=t._asyncToGenerator(function*(K){const D=K.templateHash;if(this._cimTemplateCache.has(D))return this._cimTemplateCache.get(D);let I;switch(K.type){case "marker":I=
k.fromCIMMarker(K,this._tileInfo);break;case "line":I=h.fromCIMLine(K,this._tileInfo);break;case "fill":I=e.fromCIMFill(K,this._tileInfo);break;case "text":I=n.fromCIMText(K,this._tileInfo)}this._cimTemplateCache.set(D,I);return I});return function(K){return O.apply(this,arguments)}}();P._createPrimitiveMeshTemplates=function(O,K,D){switch(K.type){case "esriSMS":return x(O,this._createSMS(K));case "esriPMS":return x(O,this._createPMS(K));case "esriSFS":return x(O,this._createSFS(K,D));case "line-marker":return x(O,
this._createLMS(K));case "esriPFS":return x(O,this._createPFS(K,D));case "esriSLS":return x(O,this._createSLS(K,!1));case "esriTS":return x(O,this._createTS(K));default:return B.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),O}};P._createMeshTemplates=function(O,K,D){if(-1!==K.type.indexOf("3d"))return B.error("3D symbols are not supported with MapView"),O;if("expanded-cim"===K.type){for(const I of K.layers)"function"===typeof I.materialHash?x(O,this._createDynamicCIM(I)):
x(O,this._createCIM(I));return O}if("composite-symbol"===K.type){for(const I of K.layers)this._createPrimitiveMeshTemplates(O,I,D);return O}return"cim"===K.type||"label"===K.type||"web-style"===K.type?O:this._createPrimitiveMeshTemplates(O,K,D)};t._createClass(J,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return J}();const H=J=>{if(!J.layers)return!1;for(const P of J.layers)if("function"===typeof P.materialHash)return!0;return!1};r.WGLTemplateStore=A;r.errorPointSchema2D=u;r.errorPolygonSchema2D=E;r.errorPolylineSchema2D=y;r.isDynamicId=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){return function(p){function c(d,a,b){var f;var m=p.call(this,d)||this;m._minMaxZoom=w.i1616to32(Math.round(a*v.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*v.MIN_MAX_ZOOM_PRECISION_FACTOR));e.isFunction(d.color)?m._dynamicPropertyMap.set("fillColor",(u,y,E)=>(u=d.color(u,y,E))&&C.premultiplyAlphaRGBA(u)||0):(a=d.color,m.fillColor=a&&C.premultiplyAlphaRGBA(a)||0);const g="CIMMarkerPlacementInsidePolygon"===(null==(f=d.cim.placement)?void 0:f.type)&&d.cim.placement.shiftOddRows?
2:1,x=d.height;e.isFunction(x)?m._dynamicPropertyMap.set("_height",(u,y,E)=>x(u,y,E)*g):m._height=(x||0)*g;const q=d.offsetX;e.isFunction(q)?m._dynamicPropertyMap.set("_offsetX",(u,y,E)=>{u=F.pt2px(q(u,y,E))+128;255<u?u=255:0>u&&(u=0);return u}):(f=F.pt2px(q||0)+128,255<f?f=255:0>f&&(f=0),m._offsetX=f);const B=d.offsetY;e.isFunction(B)?m._dynamicPropertyMap.set("_offsetY",(u,y,E)=>{u=F.pt2px(-B(u,y,E))+128;255<u?u=255:0>u&&(u=0);return u}):(f=F.pt2px(-B||0)+128,255<f?f=255:0>f&&(f=0),m._offsetY=f);
f=d.scaleX;e.isFunction(f)?m._dynamicPropertyMap.set("_scaleX",f):m._scaleX=f||1;const z=d.angle;e.isFunction(z)?m._dynamicPropertyMap.set("_angle",(u,y,E)=>A.radToByte(z(u,y,E))):m._angle=A.radToByte(z)||0;t.isSome(d.effects)&&(f=d.effects,e.isFunction(f)?m._dynamicPropertyMap.set("_effects",f):m._effects=f);m._cimFillLayer=d;m._fillMaterialKey=l.FillMaterialKey.load(d.materialKey);return m}r._inheritsLoose(c,p);c.fromCIMFill=function(d,a){const [b,f]=e.getMinMaxZoom(d.scaleInfo,a);return new c(d,
b,f)};c.prototype.bindFeature=function(d,a,b){const f=d.readLegacyFeature();this._dynamicPropertyMap.forEach((x,q)=>{this[q]=x(f,a,b)});d=this._fillMaterialKey;var m=this._materialCache,g=this._cimFillLayer.materialHash;g=g(f,a,b);g=m.get(g);m=null;g&&n.ok(g.spriteMosaicItem)&&(m=g.spriteMosaicItem);if(m){const {rect:x,width:q,height:B}=m;g=x.x+v.SPRITE_PADDING;const z=x.y+v.SPRITE_PADDING,u=g+q,y=z+B;let E=Math.round(F.pt2px(this._height));255<E?E=255:0>=E&&(E=y-z);let H=Math.round(F.pt2px(this._height/
B*q||0));255<H?H=255:0>=H&&(H=u-g);const J=this._scaleX;this.tl=w.i1616to32(g,z);this.br=w.i1616to32(u,y);this.aux2=w.i8888to32(H,E,this._offsetX,this._offsetY);this.aux3=w.i8888to32(J,1,this._angle,0);d.sdf=m.sdf;d.pattern=!0;d.textureBinding=m.textureBinding}else this.aux3=this.aux2=this.br=this.tl=0,d.sdf=!1,d.pattern=!1,d.textureBinding=0;this._materialKey=d.data};return c}(h(k))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(r,t,F,C,v,A,w,l){return e=>function(h){function k(...p){p=h.call(this,...p)||this;p.forceLibtess=!1;p._bitset=0;p._lineTemplate=null;p.geometryType=C.WGLGeometryType.FILL;return p}r._inheritsLoose(k,h);var n=k.prototype;n._maybeAddLineTemplate=function(p){this._lineTemplate=l.fromFillOutline(p)};n._write=function(p,c,d,a){d="esriGeometryPoint"===c.geometryType;const b=A.FillMaterialKey.load(this._materialKey);p.recordStart(c.getDisplayId(),this._materialKey,this.geometryType,d);this._writeGeometry(p,
c,b,a,d);b.outlinedFill&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(p,c,a,d);p.recordEnd()};n._writeGeometry=function(p,c,d,a,b){a=this._getGeometry(c,a,b);t.isNone(a)||(b=[],100<a.maxLength||this.forceLibtess||!w.triangulate(b,a)?(a=w.triangulateLibtess(a),this._writeVertices(p,c,a,[a.length/2],d)):b.length&&this._writeVertices(p,c,a.coords,a.lengths,d,b))};n._writeVertex=function(p,c,d,a,b,f){const m=v.i1616to32(1*a,1*b);p.vertexBounds(a,b,0,0);p.vertexWrite(m);p.vertexWrite(c);
d.dotDensity?p.vertexWriteF32(1/Math.abs(f.readGeometryArea())):(p.vertexWrite(this.fillColor),d.simple||(p.vertexWrite(this.tl),p.vertexWrite(this.br)),p.vertexWrite(this.aux2),p.vertexWrite(this.aux3),d.simple||p.vertexWrite(this._minMaxZoom))};n._writeVertices=function(p,c,d,a,b,f){var m=c.getDisplayId();m|=this._bitset<<24;var g=a.reduce((q,B)=>q+B);const x=b.dotDensity?4:10;a=p.vertexCount();p.vertexEnsureSize(x*g);g=0;if(f)for(const q of f)this._writeVertex(p,m,b,d[2*q],d[2*q+1],c),g++;else for(f=
0;f<d.length;f+=2)this._writeVertex(p,m,b,Math.round(d[f]),Math.round(d[f+1]),c),g++;p.indexEnsureSize(g);for(c=0;c<g;c++)p.indexWrite(c+a)};n._getGeometry=function(p,c,d){return(p=c?F.deltaDecodeGeometry(F.convertFromGeometry(c),2):p.readGeometryForDisplay())?w.clipMarshall(p,d?256:8):null};return k}(e)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(r,t,F,C,v,A,w,l,e){function h(c,d,a){let b=0;for(let f=1;f<a;f++)b+=(c[2*(d+f)]-c[2*(d+f-1)])*(c[2*(d+f)+1]+c[2*(d+f-1)+1]);return b}function k(c,d,a,b,f){let m=0;for(;a<b;a+=3){const g=2*(c[a]-f),x=2*(c[a+1]-f),q=2*(c[a+2]-f);m+=Math.abs((d[g]-d[q])*(d[x+1]-d[g+1])-(d[g]-d[x])*(d[q+1]-d[g+1]))}return m}const n=new l.TileClipper(0,0,0,1,0),p=new l.TileClipper(0,0,0,1,0);n.setExtent(A.TILE_SIZE);p.setExtent(A.TILE_SIZE);r.area=h;r.clipLinesMarshall=function(c,d){p.setPixelMargin(d);const a=
-d;d=A.TILE_SIZE+d;let b=[];var f=!1;let m=0;for(;m<c.length;){const g=[],x=c[m];if(!x)return null;p.reset(w.GeometryType.LineString);let [q,B]=x[0];if(f)p.moveTo(q,B);else{if(q<a||q>d||B<a||B>d){f=!0;continue}g.push({x:q,y:B})}let z=!1;const u=x.length;for(let y=1;y<u;++y)if(q+=x[y][0],B+=x[y][1],f)p.lineTo(q,B);else{if(q<a||q>d||B<a||B>d){z=!0;break}g.push({x:q,y:B})}if(z)f=!0;else{if(f){if(f=p.resultWithStarts())for(const y of f)b.push(y)}else b.push({line:g,start:0});m++;f=!1}}b=b.filter(g=>1<
g.line.length);return 0===b.length?null:b};r.clipMarshall=function(c,d){if(t.isNone(c))return null;a:{var a=A.TILE_SIZE+128;var b=0;for(var f=0;f<c.lengths.length;f++){var m=c.lengths[f];for(var g=0;g<m;g++){const x=c.coords[2*(g+b)],q=c.coords[2*(g+b)+1];if(-128>x||x>a||-128>q||q>a){a=!0;break a}}b+=m}a=!1}if(!a)return c;n.setPixelMargin(d);n.reset(w.GeometryType.Polygon);d=0;for(a=0;a<c.lengths.length;a++){b=c.lengths[a];f=c.coords[2*(0+d)];m=c.coords[2*(0+d)+1];n.moveTo(f,m);for(g=1;g<b;g++)f=
c.coords[2*(g+d)],m=c.coords[2*(g+d)+1],n.lineTo(f,m);n.close();d+=b}a=n.result(!1);if(!a)return null;c=[];d=[];for(const x of a){a=0;for(const q of x)d.push(q.x),d.push(q.y),a++;c.push(a)}return new v(c,d)};r.triangleArea=function(c,d,a,b,f){let m=0;for(;a<b;a+=3){const g=2*(c.getValue(a)-f),x=2*(c.getValue(a+1)-f),q=2*(c.getValue(a+2)-f);m+=Math.abs((d[g]-d[q])*(d[x+1]-d[g+1])-(d[g]-d[x])*(d[q+1]-d[g+1]))}return m};r.triangleAreaArray=k;r.triangulate=function(c,d){const {coords:a,lengths:b,hasIndeterminateRingOrder:f}=
d;if(f)return!1;d=0;for(var m=0;m<b.length;){let q=m,B=b[m];m=h(a,d,B);for(var g=[];++q<b.length;){var x=b[q];const z=h(a,d+B,x);if(!(0<z))break;m+=z;g.push(d+B);B+=x}x=c.length;e.bufcut(c,a,d,d+B,g,2,0);g=k(c,a,x,c.length,0);m=Math.abs(m);if(1E-5<Math.abs((g-m)/Math.max(1E-7,m)))return c.length=0,!1;m=q;d+=B}return!0};r.triangulateEarcut=function(c,d,a){const {coords:b,lengths:f,hasIndeterminateRingOrder:m}=d;if(m)return!1;let g=0;for(var x=0;x<f.length;){let B=x,z=f[x];for(x=[];++B<f.length;){var q=
f[B];if(!(0<h(b,g+z,q)))break;x.push(g+z-g);z+=q}q=d.coords.slice(2*g,2*(g+z));x=F.earcut(q,x,2);for(const u of x)c.push(u+a+g);x=B;g+=z}return!0};r.triangulateLibtess=function(c){const {coords:d,lengths:a}=c;({buffer:c}=C.triangulate(d,a));return c};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(r){function t(q,B,z,u,y,E,H){let J;z=0;for(let P=u,O=y-E;P<y;P+=E)z+=(q[O+B*E]-q[P+B*E])*(q[P+1+B*E]+q[O+1+B*E]),O=P;if(H===
0<z)for(;u<y;u+=E)J=A(u+B*E,q[u+B*E],q[u+1+B*E],J);else for(y-=E;y>=u;y-=E)J=A(y+B*E,q[y+B*E],q[y+1+B*E],J);J&&a(J,J.next)&&(w(J),J=J.next);return J}function F(q,B=q){if(!q)return q;let z;do if(z=!1,q.steiner||!a(q,q.next)&&0!==k(q.prev,q,q.next))q=q.next;else{w(q);q=B=q.prev;if(q===q.next)break;z=!0}while(z||q!==B);return B}function C(q,B,z,u,y,E,H,J){if(q){!J&&E&&(q=h(q,u,y,E));for(var P=q;q.prev!==q.next;){var O=q.prev,K=q.next;if(E)var D=v(q,u,y,E);else a:{D=q;var I=D.prev,L=D;const R=D.next;
if(0<=k(I,L,R)){D=!1;break a}let Z=D.next.next;const X=Z;let Q=0;for(;Z!==D.prev&&(0===Q||Z!==X);){Q++;if(p(I.x,I.y,L.x,L.y,R.x,R.y,Z.x,Z.y)&&0<=k(Z.prev,Z,Z.next)){D=!1;break a}Z=Z.next}D=!0}if(D)B.push(O.index/z+H),B.push(q.index/z+H),B.push(K.index/z+H),w(q),P=q=K.next;else if(q=K,q===P){if(!J)C(F(q),B,z,u,y,E,H,1);else if(1===J){J=B;P=z;O=H;K=q;do D=K.prev,I=K.next.next,!a(D,I)&&n(D,K,K.next,I)&&c(D,I)&&c(I,D)&&(J.push(D.index/P+O),J.push(K.index/P+O),J.push(I.index/P+O),w(K),w(K.next),K=q=I),
K=K.next;while(K!==q);q=K;C(q,B,z,u,y,E,H,2)}else if(2===J)a:{J=q;do{for(P=J.next.next;P!==J.prev;){if(O=J.index!==P.index){D=D=D=void 0;O=J;K=P;if(D=O.next.index!==K.index&&O.prev.index!==K.index){b:{D=O;do{if(D.index!==O.index&&D.next.index!==O.index&&D.index!==K.index&&D.next.index!==K.index&&n(D,D.next,O,K)){D=!0;break b}D=D.next}while(D!==O);D=!1}D=!D}if(D=D&&c(O,K)&&c(K,O)){D=O;I=!1;L=(O.x+K.x)/2;K=(O.y+K.y)/2;do D.y>K!==D.next.y>K&&D.next.y!==D.y&&L<(D.next.x-D.x)*(K-D.y)/(D.next.y-D.y)+D.x&&
(I=!I),D=D.next;while(D!==O);D=I}O=D}if(O){q=f(J,P);J=F(J,J.next);q=F(q,q.next);C(J,B,z,u,y,E,H,0);C(q,B,z,u,y,E,H,0);break a}P=P.next}J=J.next}while(J!==q)}break}}}}function v(q,B,z,u){const y=q.prev,E=q.next;if(0<=k(y,q,E))return!1;const H=y.x>q.x?y.x>E.x?y.x:E.x:q.x>E.x?q.x:E.x,J=y.y>q.y?y.y>E.y?y.y:E.y:q.y>E.y?q.y:E.y,P=d(y.x<q.x?y.x<E.x?y.x:E.x:q.x<E.x?q.x:E.x,y.y<q.y?y.y<E.y?y.y:E.y:q.y<E.y?q.y:E.y,B,z,u);B=d(H,J,B,z,u);z=q.prevZ;for(u=q.nextZ;z&&z.z>=P&&u&&u.z<=B;){if(z!==q.prev&&z!==q.next&&
p(y.x,y.y,q.x,q.y,E.x,E.y,z.x,z.y)&&0<=k(z.prev,z,z.next))return!1;z=z.prevZ;if(u!==q.prev&&u!==q.next&&p(y.x,y.y,q.x,q.y,E.x,E.y,u.x,u.y)&&0<=k(u.prev,u,u.next))return!1;u=u.nextZ}for(;z&&z.z>=P;){if(z!==q.prev&&z!==q.next&&p(y.x,y.y,q.x,q.y,E.x,E.y,z.x,z.y)&&0<=k(z.prev,z,z.next))return!1;z=z.prevZ}for(;u&&u.z<=B;){if(u!==q.prev&&u!==q.next&&p(y.x,y.y,q.x,q.y,E.x,E.y,u.x,u.y)&&0<=k(u.prev,u,u.next))return!1;u=u.nextZ}return!0}function A(q,B,z,u){q=m.create(q,B,z);u?(q.next=u.next,q.prev=u,u.next.prev=
q,u.next=q):(q.prev=q,q.next=q);return q}function w(q){q.next.prev=q.prev;q.prev.next=q.next;q.prevZ&&(q.prevZ.nextZ=q.nextZ);q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function l(q){let B=q,z=q;do{if(B.x<z.x||B.x===z.x&&B.y<z.y)z=B;B=B.next}while(B!==q);return z}function e(q,B){let z=B;const u=q.x,y=q.y;let E=-Infinity,H;do{if(y<=z.y&&y>=z.next.y&&z.next.y!==z.y){var J=z.x+(y-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(J<=u&&J>E){E=J;if(J===u){if(y===z.y)return z;if(y===z.next.y)return z.next}H=z.x<z.next.x?z:z.next}}z=
z.next}while(z!==B);if(!H)return null;if(u===E)return H.prev;B=H;J=H.x;const P=H.y;let O=Infinity,K;for(z=H.next;z!==B;)u>=z.x&&z.x>=J&&u!==z.x&&p(y<P?u:E,y,J,P,y<P?E:u,y,z.x,z.y)&&(K=Math.abs(y-z.y)/(u-z.x),(K<O||K===O&&z.x>H.x)&&c(z,q)&&(H=z,O=K)),z=z.next;return H}function h(q,B,z,u){for(var y;y!==q;y=y.next){y=y||q;null===y.z&&(y.z=d(y.x,y.y,B,z,u));if(y.prev.next!==y||y.next.prev!==y)return y.prev.next=y,y.next.prev=y,h(q,B,z,u);y.prevZ=y.prev;y.nextZ=y.next}q.prevZ.nextZ=null;q.prevZ=null;a:for(z=
1;;){u=q;B=q=null;let E=0;for(;u;){E++;y=u;let H=0;for(;H<z&&y;H++)y=y.nextZ;let J=z;for(;0<H||0<J&&y;){let P;0===H?(P=y,y=y.nextZ,J--):0!==J&&y?u.z<=y.z?(P=u,u=u.nextZ,H--):(P=y,y=y.nextZ,J--):(P=u,u=u.nextZ,H--);B?B.nextZ=P:q=P;P.prevZ=B;B=P}u=y}B.nextZ=null;z*=2;if(2>E)break a}return q}function k(q,B,z){return(B.y-q.y)*(z.x-B.x)-(B.x-q.x)*(z.y-B.y)}function n(q,B,z,u){return a(q,B)&&a(z,u)||a(q,u)&&a(z,B)?!0:0<k(q,B,z)!==0<k(q,B,u)&&0<k(z,u,q)!==0<k(z,u,B)}function p(q,B,z,u,y,E,H,J){return 0<=
(y-H)*(B-J)-(q-H)*(E-J)&&0<=(q-H)*(u-J)-(z-H)*(B-J)&&0<=(z-H)*(E-J)-(y-H)*(u-J)}function c(q,B){return 0>k(q.prev,q,q.next)?0<=k(q,B,q.next)&&0<=k(q,q.prev,B):0>k(q,B,q.prev)||0>k(q,q.next,B)}function d(q,B,z,u,y){q=32767*(q-z)*y;B=32767*(B-u)*y;q=(q|q<<8)&16711935;q=(q|q<<4)&252645135;q=(q|q<<2)&858993459;B=(B|B<<8)&16711935;B=(B|B<<4)&252645135;B=(B|B<<2)&858993459;return(q|q<<1)&1431655765|((B|B<<1)&1431655765)<<1}function a(q,B){return q.x===B.x&&q.y===B.y}function b(q,B){return q.x-B.x}function f(q,
B){const z=m.create(q.index,q.x,q.y),u=m.create(B.index,B.x,B.y),y=q.next,E=B.prev;q.next=B;B.prev=q;z.next=y;y.prev=z;u.next=z;z.prev=u;E.next=u;u.prev=E;return u}let m=function(){function q(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}q.create=function(B,z,u){const y=x<g.length?g[x++]:new q;y.index=B;y.x=z;y.y=u;y.prev=null;y.next=null;y.z=null;y.prevZ=null;y.nextZ=null;y.steiner=!1;return y};return q}();const g=[];let x=0;for(let q=0;8096>q;q++)g.push(new m);
r.bufcut=function(q,B,z,u,y,E,H){x=0;var J=(u-z)*E,P=y&&y.length;const O=P?(y[0]-z)*E:J;var K=t(B,z,u,0,O,E,!0);if(K&&K.next!==K.prev){var D;if(P){P=[];for(let Z=0,X=y.length;Z<X;Z++){const Q=t(B,z,u,y[Z]*E,Z<X-1?y[Z+1]*E:u*E,E,!1);Q===Q.next&&(Q.steiner=!0);P.push(l(Q))}P.sort(b);for(var I of P){u=I;y=K;if(y=e(u,y))u=f(y,u),F(u,u.next);K=F(K,K.next)}}if(J>80*E){var L=J=B[z*E];var R=D=B[1+z*E];for(I=E;I<O;I+=E)u=B[I+z*E],y=B[I+1+z*E],L=Math.min(L,u),R=Math.min(R,y),J=Math.max(J,u),D=Math.max(D,y);
D=Math.max(J-L,D-R);D=0!==D?1/D:0}C(K,q,E,L,R,D,H,0)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(r,t,F,C,v,
A,w,l,e,h,k,n){const p=t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(c){function d(a,b,f,m,g,x,q,B,z,u,y,E,H,J,P,O,K,D,I){var L=c.call(this)||this;a=e.LineMaterialKey.load(a);b&&(a.sdf=b.sdf,a.pattern=!0,a.textureBinding=b.textureBinding);L._capType=m;L._joinType=g;L._miterLimitCosine=h.getLimitCosine(x);L.tessellationProperties._fillColor=q;L.tessellationProperties._tl=B;L.tessellationProperties._br=z;L._hasPattern=u;L._isDashed=y;L._zOrder=O;L._effects=K;L._minMaxZoom=
w.i1616to32(Math.round(D*A.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(I*A.MIN_MAX_ZOOM_PRECISION_FACTOR));L._materialKey=a.data;L.tessellationProperties._bitset=(H?A.BITSET_GENERIC_LOCK_COLOR:0)|(J?A.BITSET_TYPE_FILL_OUTLINE:0)|(E?A.BITSET_LINE_SCALE_DASH:0);L.tessellationProperties._halfWidth=.5*f;L.tessellationProperties._halfReferenceWidth=.5*P;L.tessellationProperties.offset=0;L._initializeTessellator(!1);return L}r._inheritsLoose(d,c);d.fromCIMLine=function(a,b,f){var m=a.color,g=a.scaleFactor||
1;const x=!!a.dashTemplate;let q=a.cap;x&&q===C.CapType.ROUND&&(q=C.CapType.SQUARE);const B=a.join;g*=F.pt2px(a.width);const z=F.pt2px(a.referenceWidth),u=F.pt2px(a.miterLimit);m=m&&v.premultiplyAlphaRGBA(m)||0;const [y,E]=h.getMinMaxZoom(a.scaleInfo,f);if(!b)return new d(a.materialKey,b,g,q,B,u,m,0,0,!1,x,a.scaleDash,a.colorLocked,!1,z,a.zOrder,a.effects,y,E);const {rect:H,width:J,height:P}=b;var O=H.x+A.SPRITE_PADDING;const K=H.y+A.SPRITE_PADDING;f=O+J;const D=K+P;O=w.i1616to32(O,K);f=w.i1616to32(f,
D);return new d(a.materialKey,b,g,q,B,u,m,O,f,!0,x,a.scaleDash,a.colorLocked,!1,z,a.zOrder,a.effects,y,E)};d.fromFillOutline=function(a){var b;return a.isOutlinedFill&&a.outline&&"esriSLSSolid"===(null==(b=a.outline)?void 0:b.style)?d.fromSimpleLine({hash:"",materialKey:a.materialKey,...a.outline},null,!0):null};d.fromSimpleLine=function(a,b,f=!1){var {color:m}=a;const g="esriSLSSolid"!==a.style&&"esriSLSNull"!==a.style,x=l.getCapType(a.cap||"round"),q=l.getJoinType(a.join||"round");m=m&&"esriSLSNull"!==
a.style&&v.premultiplyAlphaRGBAArray(m)||0;"esriSLSNull"===a.style&&(m=0);const B=F.pt2px(a.width),z=a.miterLimit;if(!b)return new d(a.materialKey,b,B,x,q,z,m,0,0,!1,g,!0,!1,f,B,0,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM);const {rect:u,width:y,height:E}=b;var H=u.x+A.SPRITE_PADDING;const J=u.y+A.SPRITE_PADDING;var P=H+y;const O=J+E;H=w.i1616to32(H,J);P=w.i1616to32(P,O);return new d(a.materialKey,b,B,x,q,z,m,H,P,!0,g,!0,!1,f,B,0,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM)};d.fromPictureLineSymbol=
function(a,b,f,m){p.error("PictureLineSymbol support does not exist!");return null};return d}(k(n))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(r,t,F,C,v,A,w,l){const e=(n,p,c)=>(d,a,b,f,m,g,x,q,B,z,u)=>{b=v.i1616to32(u,Math.ceil(16*n._halfWidth));x=v.i8888to32(Math.round(16*
x),Math.round(16*q),Math.round(16*B),Math.round(16*z));m=v.i8888to32(16*m,16*g,0,n._bitset);g=n.out;g.vertexBounds(d,a,p,c);g.vertexWrite(v.i1616to32(8*d,8*a));g.vertexWrite(n.id);g.vertexWrite(n._fillColor);g.vertexWrite(x);g.vertexWrite(b);g.vertexWrite(n._tl);g.vertexWrite(n._br);g.vertexWrite(m);g.vertexWrite(v.i1616to32(Math.ceil(16*n._halfReferenceWidth),0));g.vertexWrite(n.minMaxZoom);g.vertexEnd();return n.offset+n.vertexCount++},h=(n,p,c)=>(d,a,b,f,m,g,x,q,B,z,u)=>{b=v.i8888to32(0,0,16*n._halfWidth,
16*n._halfReferenceWidth);x=v.i8888to32(16*x+128,16*q+128,16*B+128,16*z+128);q=n.out;B=n._bitset<<24|n.id;q.vertexBounds(d,a,p,c);q.vertexWrite(v.i1616to32(8*d,8*a));q.vertexWrite(B);q.vertexWrite(n._fillColor);n.key.simple||(q.vertexWrite(0),q.vertexWrite(0));q.vertexWrite(b);q.vertexWrite(x);n.key.simple||q.vertexWrite(n.minMaxZoom);q.vertexEnd();return n.offset+n.vertexCount++},k=n=>(p,c,d)=>{const a=n.out;a.indexWrite(p);a.indexWrite(c);a.indexWrite(d);n.indexCount+=3};return n=>function(p){function c(...a){a=
p.call(this,...a)||this;a.tessellationProperties={};a._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};a.geometryType=C.WGLGeometryType.LINE;return a}r._inheritsLoose(c,p);var d=c.prototype;d.writeGeometry=function(a,b,f,m){this._writeGeometry(a,b,f,m)};d._initializeTessellator=function(a){var b=w.LineMaterialKey.load(this._materialKey);const f=w.FillMaterialKey.load(this._materialKey);var m=this._tessellationOptions;b=b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue;
a=this.tessellationProperties._halfWidth<F.THIN_LINE_HALF_WIDTH_THRESHOLD&&!a&&!b;this.tessellationProperties.minMaxZoom=this._minMaxZoom;m.wrapDistance=65535;m.textured=this._isDashed||this._hasPattern;m.offset=this.tessellationProperties.offset;m.halfWidth=this.tessellationProperties._halfWidth;m=a?0:1;this._lineTessellator=new A.LineTessellation((f.outlinedFill?h:e)(this.tessellationProperties,m,m),k(this.tessellationProperties),a)};d._write=function(a,b,f,m){f="esriGeometryPoint"===b.geometryType;
a.recordStart(b.getDisplayId(),this._materialKey,this.geometryType,f);this._writeGeometry(a,b,m,f);a.recordEnd()};d._writeGeometry=function(a,b,f,m){f=null!=f?f:b.readLegacyGeometryForDisplay();m=this._getLines(f,m);t.isNone(m)||this._writeVertices(a,b,m)};d._getLines=function(a,b){if(t.isNone(a))return null;a=a.paths||a.rings;return t.isNone(a)?null:l.clipLinesMarshall(a,b?256:16)};d._writeVertices=function(a,b,f){const m=b.getDisplayId(),g=a.vertexCount(),x=this.tessellationProperties;b=this._tessellationOptions;
x.out=a;x.id=m;x.indexCount=0;x.vertexCount=0;x.offset=g;b.capType=this._capType;b.joinType=this._joinType;a=w.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=a.outlinedFill?a:w.LineMaterialKey.load(this._materialKey);for(const {line:q,start:B}of f)b.initialDistance=B%65535,this._lineTessellator.tessellate(q,b)};return c}(n)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger",
"../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(r,t,F,C,v){const A=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(w){function l(e){var h=w.call(this)||this;h._ongoingMaterialRequestMap=new Map;h._materialCache=new Map;h._dynamicPropertyMap=new Map;h._cimLayer=e;return h}r._inheritsLoose(l,w);l.prototype.analyze=function(e,h,k,n,p){if(p&&0===p.length)return null;const c=p&&0<p.length;h=h.readLegacyFeature();
const d=this._materialCache;var a=this._cimLayer.materialHash;if(!a)return A.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const b="function"===typeof a?a(h,k,n):a;if(d.has(b))return e=d.get(b),Promise.resolve(e);if(a=this._ongoingMaterialRequestMap.get(b))return a;a=this._cimLayer;var f=F.analyzeCIMResource(a.cim,this._cimLayer.materialOverrides);f.mosaicHash=b;const {type:m,url:g}=a;f={cim:f,type:m,mosaicHash:b,url:g,size:null,dashTemplate:null,
text:null,fontName:null};switch(m){case "marker":f.size=C.evaluateValueOrFunction(a.size,h,k,n);break;case "line":f.dashTemplate=a.dashTemplate;break;case "text":f.text=C.evaluateValueOrFunction(a.text,h,k,n),f.fontName=C.evaluateValueOrFunction(a.fontName,h,k,n)}e=e.getMosaicItem(f,p).then(x=>{c||(this._ongoingMaterialRequestMap.delete(b),d.set(b,x));return x}).catch(x=>{this._ongoingMaterialRequestMap.delete(b);A.error(".analyze()",x.message);return null});c||this._ongoingMaterialRequestMap.set(b,
e);return e};return l}(v)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/fontUtils".split(" "),function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a){function b(G){switch(G){case "Butt":return k.CapType.BUTT;
case "Square":return k.CapType.SQUARE;default:return k.CapType.ROUND}}function f(G){switch(G){case "Bevel":return k.JoinType.BEVEL;case "Miter":return k.JoinType.MITER;default:return k.JoinType.ROUND}}function m(G){switch(G){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function g(G){switch(G){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function x(G){let S="",ha="";G&&
(G=G.toLowerCase(),-1!==G.indexOf("italic")?S="italic":-1!==G.indexOf("oblique")&&(S="oblique"),-1!==G.indexOf("bold")?ha="bold":-1!==G.indexOf("light")&&(ha="lighter"));return{style:S,weight:ha}}function q(G,S,ha,T){let W;G[S]?W=G[S]:(W={},G[S]=W);W[ha]=T}function B(G){return(G=G.markerPlacement)&&G.angleToLine?k.Alignment.MAP:k.Alignment.SCREEN}function z(){z=t._asyncToGenerator(function*(G,S,ha,T,W){T=null!=T?T:[];if(!G)return T;let ca;const da={};if("CIMSymbolReference"===G.type){if(ca=G.symbol,
G=G.primitiveOverrides){var ia=[];for(const aa of G){var ja=aa.valueExpressionInfo;ja&&S?(ja=e.createRendererExpression(ja.expression,S.spatialReference,S.fields).then(ea=>{ea&&q(da,aa.primitiveName,aa.propertyName,ea)}),ia.push(ja)):null!=aa.value&&q(da,aa.primitiveName,aa.propertyName,aa.value)}0<ia.length&&(yield Promise.all(ia))}}else return Ca.error("Expect cim type to be 'CIMSymbolReference'"),T;ia=[];ua(ca,ha,ia);0<ia.length&&(yield Promise.all(ia));switch(ca.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":u(ca,
G,da,S,T,ha,W)}return T});return z.apply(this,arguments)}function u(G,S,ha,T,W,ca,da){if(G){var ia=G.symbolLayers;if(ia){var ja=G.effects,aa=h.CIMSymbolHelper.getSize(G);if("CIMPointSymbol"===G.type&&"Map"===G.angleAlignment)var ea=k.Alignment.MAP;for(var la=ia.length;la--;){var qa=ia[la];if(!qa||!1===qa.enable)continue;let Qa;ja&&ja.length&&(Qa=[...ja]);var sa=qa.effects;sa&&sa.length&&(ja?Qa.push(...sa):Qa=[...sa]);sa=[];h.OverrideHelper.findEffectOverrides(Qa,S,sa);sa=0<sa.length?M(Qa,sa,ha,T):
Qa;var wa=[];h.OverrideHelper.findApplicableOverrides(qa,S,wa);switch(qa.type){case "CIMSolidFill":y(qa,sa,ha,wa,T,W);break;case "CIMPictureFill":E(qa,sa,ha,wa,T,ca,W);break;case "CIMHatchFill":H(qa,sa,ha,wa,T,W);break;case "CIMGradientFill":{var za=ha,Da=T,Ja=W;const [Na,N]=oa(wa,qa.primitiveName,sa,null);var Ga=l.numericHash(JSON.stringify(qa)+N).toString();Ja.push({type:"fill",templateHash:Ga,materialHash:Na?fa(Ga,za,wa,Da):Ga,cim:qa,materialOverrides:null,colorLocked:qa.colorLocked,effects:sa,
color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":J(qa,sa,ha,wa,T,W,"CIMPolygonSymbol"===G.type,aa);break;case "CIMPictureStroke":P(qa,sa,ha,wa,T,W,"CIMPolygonSymbol"===G.type,aa);break;case "CIMGradientStroke":{za=ha;Da=T;Ja=W;Ga="CIMPolygonSymbol"===G.type;var Ha=aa,Ia=qa.primitiveName,La=void 0!==qa.width?qa.width:4,Oa=b(qa.capStyle),ya=f(qa.joinStyle),Va=qa.miterLimit;const [Na,N]=oa(wa,Ia,sa,null),Wa=l.numericHash(JSON.stringify(qa)+N).toString();
Ja.push({type:"line",templateHash:Wa,materialHash:Na?fa(Wa,za,wa,Da):Wa,cim:qa,materialOverrides:null,isOutline:Ga,colorLocked:qa.colorLocked,effects:sa,color:{r:128,g:128,b:128,a:1},width:Q(Ia,za,"Width",Da,La),cap:Q(Ia,za,"CapStyle",Da,Oa),join:Q(Ia,za,"JoinStyle",Da,ya),miterLimit:Q(Ia,za,"MiterLimit",Da,Va),referenceWidth:Ha,zOrder:Z(qa.name),dashTemplate:null,scaleDash:!1})}break;case "CIMCharacterMarker":O(qa,sa,ha,wa,T,W);break;case "CIMPictureMarker":if(O(qa,sa,ha,wa,T,W))break;"CIMLineSymbol"===
G.type&&(ea=B(qa));K(qa,sa,ha,wa,T,ca,W,ea,aa);break;case "CIMVectorMarker":if(O(qa,sa,ha,wa,T,W))break;"CIMLineSymbol"===G.type&&(ea=B(qa));za=ha;Da=T;Ja=W;Ga=ca;Ha=ea;Ia=aa;La=da;if(ya=qa.markerGraphics){Oa=0;qa.scaleSymbolsProportionally&&(Va=qa.frame)&&(Oa=Va.ymax-Va.ymin);Va=V(qa.markerPlacement,wa,za,Da);for(const Na of ya)if(Na&&(ya=Na.symbol))switch(ya.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":I(qa,sa,Va,Na,wa,za,Da,Ja,Ga,Ha,Ia,Oa,La);break;case "CIMTextSymbol":D(qa,
sa,Va,Na,za,wa,Da,Ja,Ha,Ia,Oa)}}break;default:Ca.error("Cannot analyze CIM layer",qa.type)}}}}}function y(G,S,ha,T,W,ca){const da=G.primitiveName,ia=p.fromCIMColor(G.color),[ja,aa]=oa(T,da,S,null),ea=l.numericHash(JSON.stringify(G)+aa).toString();ca.push({type:"fill",templateHash:ea,materialHash:ja?()=>ea:ea,cim:G,materialOverrides:null,colorLocked:G.colorLocked,color:Q(da,ha,"Color",W,ia,X),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:S})}function E(G,S,ha,T,W,ca,da){const ia=G.primitiveName,
ja=G.tintColor?p.fromCIMColor(G.tintColor):{r:255,g:255,b:255,a:1},[aa,ea]=oa(T,ia,S,null);T=l.numericHash(JSON.stringify(G)+ea).toString();const la=l.numericHash(`${G.url}${JSON.stringify(G.colorSubstitutions)}`).toString();let qa=p.getValue(G.scaleX);if("width"in G){const sa=G.width;let wa=1;ca=ca.getResource(G.url);A.isSome(ca)&&(wa=ca.width/ca.height);qa/=G.height/sa*wa}da.push({type:"fill",templateHash:T,materialHash:aa?()=>la:la,cim:G,materialOverrides:null,colorLocked:G.colorLocked,effects:S,
color:Q(ia,ha,"TintColor",W,ja,X),height:Q(ia,ha,"Height",W,G.height),scaleX:Q(ia,ha,"ScaleX",W,qa),angle:Q(ia,ha,"Rotation",W,p.getValue(G.rotation)),offsetX:Q(ia,ha,"OffsetX",W,p.getValue(G.offsetX)),offsetY:Q(ia,ha,"OffsetY",W,p.getValue(G.offsetY)),url:G.url})}function H(G,S,ha,T,W,ca){const da=["Rotation","OffsetX","OffsetY"],ia=T.filter(qa=>qa.primitiveName!==G.primitiveName&&-1===da.indexOf(qa.propertyName)),ja=G.primitiveName,[aa,ea]=oa(T,ja,S,null);T=l.numericHash(JSON.stringify(G)+ea).toString();
const la=l.numericHash(`${G.separation}${JSON.stringify(G.lineSymbol)}`).toString();ca.push({type:"fill",templateHash:T,materialHash:aa?fa(la,ha,ia,W):la,cim:G,materialOverrides:ia,colorLocked:G.colorLocked,effects:S,color:{r:255,g:255,b:255,a:1},height:Q(ja,ha,"Separation",W,G.separation),scaleX:1,angle:Q(ja,ha,"Rotation",W,p.getValue(G.rotation)),offsetX:Q(ja,ha,"OffsetX",W,p.getValue(G.offsetX)),offsetY:Q(ja,ha,"OffsetY",W,p.getValue(G.offsetY))})}function J(G,S,ha,T,W,ca,da,ia){const ja=G.primitiveName,
aa=p.fromCIMColor(G.color),ea=void 0!==G.width?G.width:4,la=b(G.capStyle),qa=f(G.joinStyle),sa=G.miterLimit,[wa,za]=oa(T,ja,S,null),Da=l.numericHash(JSON.stringify(G)+za).toString();let Ja;if(S&&S instanceof Array&&0<S.length&&(T=S[S.length-1],"CIMGeometricEffectDashes"===T.type&&"NoConstraint"===T.lineDashEnding&&null===T.offsetAlongLine)){S=[...S];var Ga=S.pop();Ja=Ga.dashTemplate;Ga=Ga.scaleDash}ca.push({type:"line",templateHash:Da,materialHash:wa?()=>Da:Da,cim:G,materialOverrides:null,isOutline:da,
colorLocked:G.colorLocked,effects:S,color:Q(ja,ha,"Color",W,aa,X),width:Q(ja,ha,"Width",W,ea),cap:Q(ja,ha,"CapStyle",W,la),join:Q(ja,ha,"JoinStyle",W,qa),miterLimit:Q(ja,ha,"MiterLimit",W,sa),referenceWidth:ia,zOrder:Z(G.name),dashTemplate:Ja,scaleDash:Ga})}function P(G,S,ha,T,W,ca,da,ia){const ja=l.numericHash(`${G.url}${JSON.stringify(G.colorSubstitutions)}`).toString(),aa=G.primitiveName,ea=p.fromCIMColor(G.tintColor),la=void 0!==G.width?G.width:4,qa=b(G.capStyle),sa=f(G.joinStyle),wa=G.miterLimit,
[za,Da]=oa(T,aa,S,null);T=l.numericHash(JSON.stringify(G)+Da).toString();ca.push({type:"line",templateHash:T,materialHash:za?()=>ja:ja,cim:G,materialOverrides:null,isOutline:da,colorLocked:G.colorLocked,effects:S,color:Q(aa,ha,"TintColor",W,ea,X),width:Q(aa,ha,"Width",W,la),cap:Q(aa,ha,"CapStyle",W,qa),join:Q(aa,ha,"JoinStyle",W,sa),miterLimit:Q(aa,ha,"MiterLimit",W,wa),referenceWidth:ia,zOrder:Z(G.name),dashTemplate:null,scaleDash:!1,url:G.url})}function O(G,S,ha,T,W,ca){const da=G.markerPlacement;
if(!da||"CIMMarkerPlacementInsidePolygon"!==da.type)return!1;const ia=["Rotation","OffsetX","OffsetY"],ja=T.filter(za=>za.primitiveName!==G.primitiveName&&-1===ia.indexOf(za.propertyName)),aa="url"in G?G.url:null,[ea,la]=oa(T,da.primitiveName,S,null);T=l.numericHash(JSON.stringify(G)+la).toString();let qa=da.stepY,sa=null,wa=1;da.shiftOddRows&&(qa*=2,sa=function(za){return za?2*za:0},wa=.5);ca.push({type:"fill",templateHash:T,materialHash:ea?fa(T,ha,ja,W):T,cim:G,materialOverrides:ja,colorLocked:G.colorLocked,
effects:S,color:{r:255,g:255,b:255,a:1},height:Q(da.primitiveName,ha,"StepY",W,qa,sa),scaleX:wa,angle:Q(da.primitiveName,ha,"GridAngle",W,da.gridAngle),offsetX:Q(da.primitiveName,ha,"OffsetX",W,p.getValue(da.offsetX)),offsetY:Q(da.primitiveName,ha,"OffsetY",W,p.getValue(da.offsetY)),url:aa});return!0}function K(G,S,ha,T,W,ca,da,ia,ja){var aa;const ea=G.primitiveName,la=p.getValue(G.size);let qa=p.getValue(G.scaleX);const sa=p.getValue(G.rotation),wa=p.getValue(G.offsetX),za=p.getValue(G.offsetY),
Da=G.tintColor?p.fromCIMColor(G.tintColor):{r:255,g:255,b:255,a:1},Ja=l.numericHash(`${G.url}${JSON.stringify(G.colorSubstitutions)}`).toString();var Ga=V(G.markerPlacement,T,ha,W);const [Ha,Ia]=oa(T,ea,S,Ga);T=l.numericHash(JSON.stringify(G)+Ia).toString();Ga=null!=(aa=G.anchorPoint)?aa:{x:0,y:0};if("width"in G){aa=G.width;let La=1;ca=ca.getResource(G.url);A.isSome(ca)&&(La=ca.width/ca.height);qa/=la/aa*La}da.push({type:"marker",templateHash:T,materialHash:Ha?()=>Ja:Ja,cim:G,materialOverrides:null,
colorLocked:G.colorLocked,effects:S,scaleSymbolsProportionally:!1,alignment:ia,size:Q(ea,ha,"Size",W,la),scaleX:Q(ea,ha,"ScaleX",W,qa),rotation:Q(ea,ha,"Rotation",W,sa),offsetX:Q(ea,ha,"OffsetX",W,wa),offsetY:Q(ea,ha,"OffsetY",W,za),color:Q(ea,ha,"TintColor",W,Da,X),anchorPoint:{x:Ga.x,y:-Ga.y},isAbsoluteAnchorPoint:"Relative"!==G.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:G.rotateClockwise,referenceSize:ja,sizeRatio:1,markerPlacement:G.markerPlacement,
url:G.url})}function D(G,S,ha,T,W,ca,da,ia,ja,aa,ea){h.OverrideHelper.findApplicableOverrides(T,ca,[]);var la=T.geometry;if("x"in la&&"y"in la){var qa=T.symbol;var sa=qa.underline?"underline":qa.strikethrough?"line-through":"none";var wa=x(qa.fontStyleName),za=a.getFontFamily(qa.fontFamilyName);qa.font={family:za,decoration:sa,...wa};var Da=G.frame,Ja=la.x-.5*(Da.xmin+Da.xmax),Ga=la.y-.5*(Da.ymin+Da.ymax),Ha=G.size/ea;ea=G.primitiveName;la=p.getValue(qa.height)*Ha;Da=p.getValue(qa.angle);Ja=p.getValue(G.offsetX)+
(p.getValue(qa.offsetX)+Ja)*Ha;Ga=p.getValue(G.offsetY)+(p.getValue(qa.offsetY)+Ga)*Ha;var Ia=p.fromCIMColor(h.CIMSymbolHelper.getFillColor(qa)),La=p.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(qa)),Oa=h.CIMSymbolHelper.getStrokeWidth(qa);Oa||(La=p.fromCIMColor(h.CIMSymbolHelper.getFillColor(qa.haloSymbol)),Oa=qa.haloSize*Ha);var [ya,Va]=oa(ca,ea,S,ha);ca=JSON.stringify(G.effects)+Number(G.colorLocked)+JSON.stringify(G.anchorPoint)+G.anchorPointUnits+JSON.stringify(G.markerPlacement);ca=l.numericHash(JSON.stringify(T)+
ca+Va).toString();var Qa=Q(T.primitiveName,W,"TextString",da,T.textString,p._adjustTextCase,qa.textCase);if(null!=Qa){({fontStyleName:T}=qa);var Na=za+(T?"-"+T.toLowerCase():"-regular");"string"===typeof Qa&&-1<Qa.indexOf("[")&&qa.fieldMap&&(Qa=p.createLabelOverrideFunction(qa.fieldMap,Qa,qa.textCase));ia.push({type:"text",templateHash:ca,materialHash:ya||"function"===typeof Qa||Qa.match(/\[(.*?)\]/)?(N,Wa,Ua)=>Na+"-"+p.evaluateValueOrFunction(Qa,N,Wa,Ua):Na+"-"+l.numericHash(Qa),cim:qa,materialOverrides:null,
colorLocked:G.colorLocked,effects:S,alignment:ja,anchorPoint:{x:G.anchorPoint?G.anchorPoint.x:0,y:G.anchorPoint?G.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==G.anchorPointUnits,fontName:Na,decoration:sa,weight:Q(ea,W,"Weight",da,wa.weight),style:Q(ea,W,"Size",da,wa.style),size:Q(ea,W,"Size",da,la),angle:Q(ea,W,"Rotation",da,Da),offsetX:Q(ea,W,"OffsetX",da,Ja),offsetY:Q(ea,W,"OffsetY",da,Ga),horizontalAlignment:m(qa.horizontalAlignment),verticalAlignment:g(qa.verticalAlignment),text:Qa,color:Ia,
outlineColor:La,outlineSize:Oa,referenceSize:aa,sizeRatio:1,markerPlacement:ha})}}}function I(G,S,ha,T,W,ca,da,ia,ja,aa,ea,la,qa){var sa=T.symbol;const wa=sa.symbolLayers;if(wa)if(qa)R(G,S,ha,T,ca,W,da,ia,ja,aa,ea,la);else if(qa=wa.length,wa&&2===wa.length&&wa[0].enable&&wa[1].enable&&"CIMSolidStroke"===wa[0].type&&"CIMSolidFill"===wa[1].type&&!wa[0].effects&&!wa[1].effects)L(G,S,ha,T,wa,W,ca,da,ia,aa,ea,la);else if(sa=c.CIMEffectHelper.applyEffects(sa.effects,T.geometry,ja.geometryEngine))for(;qa--;){var za=
wa[qa];if(za&&!1!==za.enable)switch(za.type){case "CIMSolidFill":case "CIMSolidStroke":{var Da,Ja=c.CIMEffectHelper.applyEffects(za.effects,sa,ja.geometryEngine),Ga=n.getExtent(Ja);if(!Ga)continue;const [La,Oa,ya]=n.getSDFMetrics(Ga,G.frame,G.size,G.anchorPoint,"Relative"!==G.anchorPointUnits);var Ha="CIMSolidFill"===za.type;Ja={type:"sdf",geom:Ja,asFill:Ha};var Ia=G.primitiveName;Ga=null!=(Da=p.getValue(G.size))?Da:10;const Va=p.getValue(G.rotation),Qa=p.getValue(G.offsetX),Na=p.getValue(G.offsetY),
N=za.path,Wa=za.primitiveName,Ua=Ha?p.fromCIMColor(h.CIMSymbolHelper.getFillColor(za)):p.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(za)),ib=Ha?{r:0,g:0,b:0,a:0}:p.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(za)),ra=h.CIMSymbolHelper.getStrokeWidth(za);if(!Ha&&!ra)break;Ha=!1;let Ab="";for(const cb of W)if(cb.primitiveName===Wa||cb.primitiveName===Ia)void 0!==cb.value?Ab+=`-${cb.primitiveName}-${cb.propertyName}-${JSON.stringify(cb.value)}`:cb.valueExpressionInfo&&(Ha=!0);A.isSome(S)&&"function"===
typeof S&&(Ha=!0);Ia=JSON.stringify({...G,markerGraphics:null});const ob=l.numericHash(JSON.stringify(Ja)+N).toString();za={type:"marker",templateHash:l.numericHash(JSON.stringify(T)+JSON.stringify(za)+Ia+Ab).toString(),materialHash:Ha?()=>ob:ob,cim:Ja,materialOverrides:null,colorLocked:G.colorLocked,effects:S,scaleSymbolsProportionally:G.scaleSymbolsProportionally,alignment:aa,anchorPoint:{x:Oa,y:ya},isAbsoluteAnchorPoint:!1,size:Q(G.primitiveName,ca,"Size",da,Ga),rotation:Q(G.primitiveName,ca,"Rotation",
da,Va),offsetX:Q(G.primitiveName,ca,"OffsetX",da,Qa),offsetY:Q(G.primitiveName,ca,"OffsetY",da,Na),scaleX:1,frameHeight:la,rotateClockwise:G.rotateClockwise,referenceSize:ea,sizeRatio:La,color:Q(Wa,ca,"Color",da,Ua,X),outlineColor:Q(Wa,ca,"Color",da,ib,X),outlineWidth:Q(Wa,ca,"Width",da,ra),markerPlacement:ha,path:N};ia.push(za);break}default:R(G,S,ha,T,ca,W,da,ia,ja,aa,ea,la)}}}function L(G,S,ha,T,W,ca,da,ia,ja,aa,ea,la){var qa=T.geometry;const sa=W[0];W=W[1];var wa=n.getExtent(qa);if(wa){var [za,
Da,Ja]=n.getSDFMetrics(wa,G.frame,G.size,G.anchorPoint,"Relative"!==G.anchorPointUnits);qa={type:"sdf",geom:qa,asFill:!0};var Ga=G.primitiveName;wa=p.getValue(G.size);var Ha=p.getValue(G.rotation),Ia=p.getValue(G.offsetX),La=p.getValue(G.offsetY),Oa=W.path,ya=W.primitiveName,Va=sa.primitiveName,Qa=p.fromCIMColor(h.CIMSymbolHelper.getFillColor(W)),Na=p.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(sa)),N=h.CIMSymbolHelper.getStrokeWidth(sa),Wa=!1,Ua="";for(const ra of ca)if(ra.primitiveName===ya||
ra.primitiveName===Va||ra.primitiveName===Ga)void 0!==ra.value?Ua+=`-${ra.primitiveName}-${ra.propertyName}-${JSON.stringify(ra.value)}`:ra.valueExpressionInfo&&(Wa=!0);ca=JSON.stringify({...G,markerGraphics:null});var ib=l.numericHash(JSON.stringify(qa)+Oa).toString();G={type:"marker",templateHash:l.numericHash(JSON.stringify(T)+JSON.stringify(W)+JSON.stringify(sa)+ca+Ua).toString(),materialHash:Wa?()=>ib:ib,cim:qa,materialOverrides:null,colorLocked:G.colorLocked,effects:S,scaleSymbolsProportionally:G.scaleSymbolsProportionally,
alignment:aa,anchorPoint:{x:Da,y:Ja},isAbsoluteAnchorPoint:!1,size:Q(G.primitiveName,da,"Size",ia,wa),rotation:Q(G.primitiveName,da,"Rotation",ia,Ha),offsetX:Q(G.primitiveName,da,"OffsetX",ia,Ia),offsetY:Q(G.primitiveName,da,"OffsetY",ia,La),scaleX:1,frameHeight:la,rotateClockwise:G.rotateClockwise,referenceSize:ea,sizeRatio:za,color:Q(ya,da,"Color",ia,Qa,X),outlineColor:Q(Va,da,"Color",ia,Na,X),outlineWidth:Q(Va,da,"Width",ia,N),markerPlacement:ha,path:Oa};ja.push(G)}}function R(G,S,ha,T,W,ca,da,
ia,ja,aa,ea,la){T={type:G.type,enable:!0,name:G.name,colorLocked:G.colorLocked,primitiveName:G.primitiveName,anchorPoint:G.anchorPoint,anchorPointUnits:G.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:G.rotateClockwise,rotation:0,size:G.size,billboardMode3D:G.billboardMode3D,depth3D:G.depth3D,frame:G.frame,markerGraphics:[T],scaleSymbolsProportionally:G.scaleSymbolsProportionally,respectFrame:G.respectFrame,clippingPath:G.clippingPath};let qa=[];const sa=["Rotation","OffsetX","OffsetY"];qa=
ca.filter(La=>La.primitiveName!==G.primitiveName||-1===sa.indexOf(La.propertyName));var wa="";for(var za of ca)void 0!==za.value&&(wa+=`-${za.primitiveName}-${za.propertyName}-${JSON.stringify(za.value)}`);const [Da,Ja,Ga]=h.CIMSymbolHelper.getTextureAnchor(T,ja);ca=G.primitiveName;ja=p.getValue(G.rotation);za=p.getValue(G.offsetX);const Ha=p.getValue(G.offsetY);wa=l.numericHash(JSON.stringify(T)+wa).toString();const Ia=0<qa.length||A.isSome(S)&&"function"===typeof S;S={type:"marker",templateHash:wa,
materialHash:Ia?fa(wa,W,qa,da):wa,cim:T,materialOverrides:qa,colorLocked:G.colorLocked,effects:S,scaleSymbolsProportionally:G.scaleSymbolsProportionally,alignment:aa,anchorPoint:{x:Da,y:Ja},isAbsoluteAnchorPoint:!1,size:G.size,rotation:Q(ca,W,"Rotation",da,ja),offsetX:Q(ca,W,"OffsetX",da,za),offsetY:Q(ca,W,"OffsetY",da,Ha),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:la,rotateClockwise:G.rotateClockwise,referenceSize:ea,sizeRatio:Ga/w.pt2px(G.size),
markerPlacement:ha};ia.push(S)}function Z(G){return G&&0===G.indexOf("Level_")&&(G=parseInt(G.substr(6),10),!isNaN(G))?G:0}function X(G){if(!G||0===G.length)return null;G=(new F(G)).toRgba();return{r:G[0],g:G[1],b:G[2],a:G[3]}}function Q(G,S,ha,T,W,ca,da){if(G=S[G]){const ia=G[ha];if("string"===typeof ia||"number"===typeof ia||ia instanceof Array)return ca?ca.call(null,ia,da):ia;if(null!=ia&&ia instanceof e.ArcadeExpression)return(ja,aa,ea)=>{ja=d(ia,ja,{$view:ea},T.geometryType,aa);null!==ja&&ca&&
(ja=ca.call(null,ja,da));return null!==ja?ja:W}}return W}function M(G,S,ha,T){for(const W of S)if(W.valueExpressionInfo){const ca=ha[W.primitiveName]&&ha[W.primitiveName][W.propertyName];ca instanceof e.ArcadeExpression&&(W.fn=(da,ia,ja)=>d(ca,da,{$view:ja},T.geometryType,ia))}return(W,ca,da)=>{for(var ia of S)ia.fn&&(ia.value=ia.fn(W,ca,da));W=[];for(let aa of G){var ja;if(ca=null==(ja=aa)?void 0:ja.primitiveName){da=!1;for(const ea of S)ea.primitiveName===ca&&(ia=(ia=ea.propertyName)?ia.charAt(0).toLowerCase()+
ia.substr(1):ia,null!=ea.value&&ea.value!==aa[ia]&&(da||(aa=C.clone(aa),da=!0),aa[ia]=ea.value))}W.push(aa)}return W}}function V(G,S,ha,T){const W=[];h.OverrideHelper.findApplicableOverrides(G,S,W);if(0===W.length)return G;for(const ca of W)if(ca.valueExpressionInfo){const da=ha[ca.primitiveName]&&ha[ca.primitiveName][ca.propertyName];da instanceof e.ArcadeExpression&&(ca.fn=(ia,ja,aa)=>d(da,ia,{$view:aa},T.geometryType,ja))}return(ca,da,ia)=>{for(const ja of W)ja.fn&&(ja.value=ja.fn(ca,da,ia));ca=
C.clone(G);da=G.primitiveName;for(const ja of W)ja.primitiveName===da&&(ia=(ia=ja.propertyName)?ia.charAt(0).toLowerCase()+ia.substr(1):ia,null!=ja.value&&ja.value!==ca[ia]&&(ca[ia]=ja.value));return ca}}function fa(G,S,ha,T){for(const W of ha)if(W.valueExpressionInfo){const ca=S[W.primitiveName]&&S[W.primitiveName][W.propertyName];ca instanceof e.ArcadeExpression&&(W.fn=(da,ia,ja)=>d(ca,da,{$view:ja},T.geometryType,ia))}return(W,ca,da)=>{for(const ia of ha)ia.fn&&(ia.value=ia.fn(W,ca,da));return l.numericHash(G+
h.OverrideHelper.buildOverrideKey(ha)).toString()}}function oa(G,S,ha,T){let W=!1,ca="";for(const da of G)da.primitiveName===S&&(void 0!==da.value?ca+=`-${da.primitiveName}-${da.propertyName}-${JSON.stringify(da.value)}`:da.valueExpressionInfo&&(W=!0));A.isSome(ha)&&"function"===typeof ha&&(W=!0);A.isSome(T)&&"function"===typeof T&&(W=!0);return[W,ca]}function ua(G,S,ha){if(G&&S)switch(G.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(G=G.symbolLayers)for(const T of G)switch(xa(T,
S,ha),T.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in T&&T.url&&ha.push(S.fetchResource(T.url,null));break;case "CIMVectorMarker":if(G=T.markerGraphics)for(const W of G)W&&(G=W.symbol)&&ua(G,S,ha)}}}function xa(G,S,ha){G.effects&&!A.isSome(S.geometryEngine)&&(va?ha.push(va):p.isGeometryEngineRequired(G.effects)&&(va=p.importGeometryEngine(),ha.push(va),va.then(T=>S.geometryEngine=
T)))}const Ca=v.getLogger("esri.symbols.cim.cimAnalyzer");let va;r.analyzeCIMResource=function(G,S){if(!S||0===S.length)return G;G=JSON.parse(JSON.stringify(G));h.OverrideHelper.applyOverrides(G,S);return G};r.analyzeCIMSymbol=function(G,S,ha,T,W){return z.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f){function m(Q,M){switch(M.type){case "CIMSymbolReference":return m(Q,M.symbol);case "CIMPointSymbol":Q.drawSymbol(M,{x:0,y:0});break;case "CIMLineSymbol":Q.drawSymbol(M,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":Q.drawSymbol(M,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":Q.drawSymbol(M,{x:0,y:0});break;case "CIMVectorMarker":{const V=new n.Placement;Q.drawMarker(M,V)}}return Q.envelope()}function g(Q){if(!Q)return 0;switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(Q.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(Q.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(Q.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(Q.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(Q.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(Q.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(Q.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function x(Q){if(!Q)return 0;switch(Q.type){case "CIMGeometricEffectArrow":return Math.abs(.5*Q.width);case "CIMGeometricEffectBuffer":return Math.abs(Q.size);case "CIMGeometricEffectExtension":return Math.abs(Q.length);case "CIMGeometricEffectJog":return Math.abs(.5*Q.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(d.getValue(Q.offsetX)),Math.abs(d.getValue(Q.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(Q.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(Q.offset);
case "CIMGeometricEffectRadial":return Math.abs(Q.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(Q.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(Q.fromWidth),Math.abs(Q.toWidth));case "CIMGeometricEffectWave":return Math.abs(Q.amplitude);default:return 0}}function q(Q){if(!Q)return 0;let M=0;for(const V of Q)M+=x(V);return M}const B=Math.PI,z=B/2,u=96/72,y=Math.PI/180,E=A.getLogger("esri.symbols.cim.CIMSymbolHelper");
A=function(){function Q(){}var M=Q.prototype;M.getSymbolInflateSize=function(V,fa,oa,ua,xa){V||(V=[0,0,0,0]);return fa?this._getInflateSize(V,fa,oa,ua,xa):V};Q.safeSize=function(V){const fa=Math.max(Math.abs(V[0]),Math.abs(V[2]));V=Math.max(Math.abs(V[1]),Math.abs(V[3]));return Math.sqrt(fa*fa+V*V)};M._vectorMarkerBounds=function(V,fa,oa,ua){let xa=!0;const Ca=h.create();if(fa&&fa.markerGraphics)for(const va of fa.markerGraphics)fa=[0,0,0,0],va.geometry&&(k.getBoundsXY(Ca,va.geometry),fa[0]=0,fa[1]=
0,fa[2]=0,fa[3]=0,this.getSymbolInflateSize(fa,va.symbol,oa,0,ua),Ca[0]+=fa[0],Ca[1]+=fa[1],Ca[2]+=fa[2],Ca[3]+=fa[3],xa?(V[0]=Ca[0],V[1]=Ca[1],V[2]=Ca[2],V[3]=Ca[3],xa=!1):(V[0]=Math.min(V[0],Ca[0]),V[1]=Math.min(V[1],Ca[1]),V[2]=Math.max(V[2],Ca[2]),V[3]=Math.max(V[3],Ca[3])));return V};M._getInflateSize=function(V,fa,oa,ua,xa){return void 0!==fa.symbolLayers?(V=this._getLayersInflateSize(V,fa.symbolLayers,oa,ua,xa),fa=q(fa.effects),0<fa&&(V[0]-=fa,V[1]-=fa,V[2]+=fa,V[3]+=fa),V):this._getTextInflatedSize(V,
fa,xa)};M._getLayersInflateSize=function(V,fa,oa,ua,xa){let Ca=!0;if(!fa)return V;for(const W of fa)if(W){var va=[0,0,0,0];switch(W.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":fa=W;var G=fa.width;G=fa.capStyle===c.LineCapStyle.Square||fa.joinStyle===c.LineJoinStyle.Miter?G/1.4142135623730951:G/2;va[0]=-G;va[1]=-G;va[2]=G;va[3]=G;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":fa=W;if("CIMVectorMarker"===W.type){if(G=W,va=this._vectorMarkerBounds(va,
G,oa,xa),G.frame){var S=(G.frame.xmin+G.frame.xmax)/2,ha=(G.frame.ymin+G.frame.ymax)/2;va[0]-=S;va[1]-=ha;va[2]-=S;va[3]-=ha;G=G.size/(G.frame.ymax-G.frame.ymin);va[0]*=G;va[1]*=G;va[2]*=G;va[3]*=G}}else"CIMPictureMarker"===W.type?(va=W,S=oa.getResource(va.url),G=1,l.isSome(S)&&S.height&&(G=S.width/S.height),S=fa.size/2,va=fa.size*G*va.scaleX/2,va=[-va,-S,va,S]):(va=fa.size/2,va=[-va,-va,va,va]);fa.anchorPoint&&("Absolute"===fa.anchorPointUnits?(G=fa.anchorPoint.x,S=fa.anchorPoint.y):(G=fa.anchorPoint.x*
(va[2]-va[0]),S=fa.anchorPoint.y*(va[3]-va[1])),va[0]-=G,va[1]-=S,va[2]-=G,va[3]-=S);G=d.getValue(fa.rotation);fa.rotateClockwise&&(G=-G);ua&&(G-=ua);G&&(S=y*G,G=Math.cos(S),S=Math.sin(S),ha=h.create([a.C_INFINITY,a.C_INFINITY,-a.C_INFINITY,-a.C_INFINITY]),h.expandPointInPlace(ha,[va[0]*G-va[1]*S,va[0]*S+va[1]*G]),h.expandPointInPlace(ha,[va[0]*G-va[3]*S,va[0]*S+va[3]*G]),h.expandPointInPlace(ha,[va[2]*G-va[1]*S,va[2]*S+va[1]*G]),h.expandPointInPlace(ha,[va[2]*G-va[3]*S,va[2]*S+va[3]*G]),va=ha);G=
d.getValue(fa.offsetX);S=d.getValue(fa.offsetY);if(ua){var T=y*ua;ha=Math.cos(T);T=Math.sin(T);const ca=G*T+S*ha;G=G*ha-S*T;S=ca}va[0]+=G;va[1]+=S;va[2]+=G;va[3]+=S;fa=g(fa.markerPlacement);0<fa&&(va[0]-=fa,va[1]-=fa,va[2]+=fa,va[3]+=fa)}fa=q(W.effects);0<fa&&(va[0]-=fa,va[1]-=fa,va[2]+=fa,va[3]+=fa);Ca?(V[0]=va[0],V[1]=va[1],V[2]=va[2],V[3]=va[3],Ca=!1):(V[0]=Math.min(V[0],va[0]),V[1]=Math.min(V[1],va[1]),V[2]=Math.max(V[2],va[2]),V[3]=Math.max(V[3],va[3]))}return V};M._getTextInflatedSize=function(V,
fa,oa){var ua,xa;const Ca=null!=(ua=fa.height)?ua:10;V[0]=-Ca/2;V[1]=-Ca/2;V[2]=Ca/2;V[3]=Ca/2;if(!oa)return V;oa=oa.get(fa);if(!oa)return V;const {text:va,mosaicItem:G}=oa;if(!G||0===G.glyphMosaicItems.length)return V;oa=p.lineGapType2LineHeight(fa.lineGapType,null!=(xa=fa.lineGap)?xa:0,Ca);xa=F.bidiText(va)[1];fa=f.shapeGlyphs(G.glyphMosaicItems,xa,{scale:Ca/b.GLYPH_SIZE,angle:d.getValue(fa.angle),xOffset:d.getValue(fa.offsetX),yOffset:d.getValue(fa.offsetY),hAlign:p.horizontalAlignment2HAlign(fa.horizontalAlignment),
vAlign:p.verticalAlignment2VAlign(fa.verticalAlignment),maxLineWidth:512,lineHeight:b.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(oa||1,4)),decoration:fa.font.decoration||"none",isCIM:!0}).boundsT;V[0]=fa.x-fa.halfWidth;V[1]=-fa.y-fa.halfHeight;V[2]=fa.x+fa.halfWidth;V[3]=-fa.y+fa.halfHeight;return V};return Q}();let H=function(){function Q(){}Q.getEnvelope=function(M,V){V=new p.EnvDrawHelper(V);if(Array.isArray(M)){let fa;for(const oa of M)fa?fa.union(m(V,oa)):fa=m(V,oa);return fa}return m(V,M)};
Q.getTextureAnchor=function(M,V){M=this.getEnvelope(M,V);if(!M)return[0,0,0];V=M.height*u+2;return[(M.x+.5*M.width)*u/(M.width*u+2),-(M.y+.5*M.height)*u/V,V]};Q.rasterize=function(M,V,fa,oa,ua=!0){var xa=fa||this.getEnvelope(V,oa);if(!xa)return[null,0,0,0,0];const Ca=(xa.x+.5*xa.width)*u,va=(xa.y+.5*xa.height)*u;M.width=xa.width*u;M.height=xa.height*u;fa||(M.width+=2,M.height+=2);fa=M.getContext("2d");xa=p.Transformation.createScale(u,-u);xa.translate(.5*M.width-Ca,.5*M.height+va);oa=new p.CanvasDrawHelper(fa,
oa,xa);switch(V.type){case "CIMPointSymbol":oa.drawSymbol(V,{type:"point",x:0,y:0});break;case "CIMVectorMarker":xa=new n.Placement,oa.drawMarker(V,xa)}V=fa.getImageData(0,0,M.width,M.height);V=new Uint8Array(V.data);if(ua)for(oa=0;oa<V.length;oa+=4)ua=V[oa+3]/255,V[oa]*=ua,V[oa+1]*=ua,V[oa+2]*=ua;return[V,M.width,M.height,-Ca/M.width,-va/M.height]};Q.fromTextSymbol=function(M){const {angle:V,color:fa,font:oa,haloColor:ua,haloSize:xa,horizontalAlignment:Ca,kerning:va,text:G,verticalAlignment:S,xoffset:ha,
yoffset:T}=M;let W,ca;if(oa){var da=oa.family;var ia=oa.style;var ja=oa.weight;W=oa.size;ca=oa.decoration}M=!1;G&&(M=F.bidiText(G)[1]);var aa=c.BlockProgression.BTT,ea=c.FontEffects.Normal,la=c.FontEncoding.Unicode;da=da||"Arial";b:{if(ja)switch(ja.toLowerCase()){case "bold":case "bolder":ja="bold";break b}ja=""}b:{if(ia)switch(ia.toLowerCase()){case "italic":case "oblique":ia="italic";break b}ia=""}ja=ja&&ia?`${ja}-${ia}`:`${ja}${ia}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",
enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:V,blockProgression:aa,depth3D:1,extrapolateBaselines:!0,fontEffects:ea,fontEncoding:la,fontFamilyName:da,fontStyleName:ja,fontType:c.FontType.Unspecified,haloSize:xa,height:W,hinting:c.GlyphHinting.Default,horizontalAlignment:D(null!=Ca?Ca:"center"),kerning:va,letterWidth:100,
ligatures:!0,lineGapType:"Multiple",offsetX:d.getValue(ha),offsetY:d.getValue(T),strikethrough:"line-through"===ca,underline:"underline"===ca,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:L(fa)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:L(ua)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:M?c.TextReadingDirection.RTL:c.TextReadingDirection.LTR,verticalAlignment:I(null!=S?
S:"baseline"),verticalGlyphOrientation:c.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:c.BillBoardMode.FaceNearPlane},textString:G}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};Q.fromPictureFillSymbol=function(M){const {height:V,outline:fa,width:oa,xoffset:ua,xscale:xa,yoffset:Ca,yscale:va}=M,G=[],S={type:"CIMPolygonSymbol",symbolLayers:G};if(fa){const {cap:T,join:W,miterLimit:ca,width:da}=fa;G.push({type:"CIMSolidStroke",color:L(fa.color),
capStyle:O(T),joinStyle:K(W),miterLimit:ca,width:da})}let ha=M.url;"esriPFS"===M.type&&M.imageData&&(ha=M.imageData);M="angle"in M?M.angle:0;G.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,url:ha,height:V*(va||1),width:oa*(xa||1),offsetX:d.getValue(ua),offsetY:d.getValue(Ca),rotation:d.getValue(-M),colorSubstitutions:null});return S};Q.fromSimpleFillSymbol=function(M){const {color:V,style:fa,outline:oa}=M;M=[];const ua={type:"CIMPolygonSymbol",
symbolLayers:M};var xa=null;if(oa){const {cap:va,join:G,style:S}=oa;"solid"!==S&&"none"!==S&&"esriSLSSolid"!==S&&"esriSLSNull"!==S&&(xa=[{type:"CIMGeometricEffectDashes",dashTemplate:R(S,va),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);M.push({type:"CIMSolidStroke",color:L(oa.color),capStyle:O(va),joinStyle:K(G),miterLimit:oa.miterLimit,width:oa.width,effects:xa})}if(fa&&"solid"!==fa&&"none"!==fa&&"esriSFSSolid"!==fa&&"esriSFSNull"!==fa){xa={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",
color:L(V),capStyle:c.LineCapStyle.Butt,joinStyle:c.LineJoinStyle.Miter,width:.75}]};let va=0;var Ca=w.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));Ca=X(fa)?8*Ca:10*Ca;switch(fa){case "vertical":case "esriSFSVertical":va=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":va=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":va=45;break;case "cross":case "esriSFSCross":va=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":va=-45}M.push({type:"CIMHatchFill",lineSymbol:xa,
offsetX:0,offsetY:0,rotation:va,separation:Ca});"cross"===fa||"esriSFSCross"===fa?M.push({type:"CIMHatchFill",lineSymbol:v.clone(xa),offsetX:0,offsetY:0,rotation:90,separation:Ca}):("diagonal-cross"===fa||"esriSFSDiagonalCross"===fa)&&M.push({type:"CIMHatchFill",lineSymbol:v.clone(xa),offsetX:0,offsetY:0,rotation:45,separation:Ca})}else!fa||"solid"!==fa&&"esriSFSSolid"!==fa||M.push({type:"CIMSolidFill",enable:!0,color:L(V)});return ua};Q.fromSimpleLineSymbol=function(M){const {cap:V,color:fa,join:oa,
marker:ua,miterLimit:xa,style:Ca,width:va}=M;M=null;"solid"!==Ca&&"none"!==Ca&&"esriSLSSolid"!==Ca&&"esriSLSNull"!==Ca&&(M=[{type:"CIMGeometricEffectDashes",dashTemplate:R(Ca,V),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const G=[];if(ua){let S;switch(ua.placement){case "begin-end":S=c.ExtremityPlacement.Both;break;case "begin":S=c.ExtremityPlacement.JustBegin;break;case "end":S=c.ExtremityPlacement.JustEnd;break;default:S=c.ExtremityPlacement.None}const ha=Q.fromSimpleMarker(ua,
va,fa).symbolLayers[0];ha.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:S,offsetAlongLine:0};G.push(ha)}"none"!==Ca&&"esriSLSNull"!==Ca&&G.push({type:"CIMSolidStroke",color:L(fa),capStyle:O(V),joinStyle:K(oa),miterLimit:xa,width:va,effects:M});return{type:"CIMLineSymbol",symbolLayers:G}};Q.fromPictureMarker=function(M){const {angle:V,height:fa,width:oa,xoffset:ua,yoffset:xa}=M;let Ca=M.url;"esriPMS"===M.type&&M.imageData&&(Ca=M.imageData);return{type:"CIMPointSymbol",
symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,url:Ca,size:fa,width:oa,offsetX:d.getValue(ua),offsetY:d.getValue(xa),rotation:d.getValue(-V)}]}};Q.fromSimpleMarker=function(M,V,fa){var oa,{style:ua}=M;fa=null!=(oa=M.color)?oa:fa;if("path"===ua){V=[];"outline"in M&&M.outline&&(oa=M.outline,V.push({type:"CIMSolidStroke",enable:!0,width:e.pt2px(Math.round(e.px2pt(oa.width))),color:L(oa.color)}));V.push({type:"CIMSolidFill",
enable:!0,color:L(fa),path:M.path});const [G,S]=Z("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.getValue(-M.angle),size:d.getValue(M.size||6),offsetX:d.getValue(M.xoffset),offsetY:d.getValue(M.yoffset),frame:G,markerGraphics:[{type:"CIMMarkerGraphic",geometry:S,symbol:{type:"CIMPolygonSymbol",symbolLayers:V}}]}]}}const [xa,Ca]=Z(ua);let va;Ca&&xa&&(oa=[],"outline"in M&&M.outline?(ua=M.outline,oa.push({type:"CIMSolidStroke",enable:!0,width:.667<ua.width?
e.pt2px(Math.round(e.px2pt(ua.width))):ua.width,color:L(ua.color)})):!V||"line-marker"!==M.type||"cross"!==M.style&&"x"!==M.style||oa.push({type:"CIMSolidStroke",enable:!0,width:V,color:L(fa)}),oa.push({type:"CIMSolidFill",enable:!0,color:L(fa)}),fa={type:"CIMPolygonSymbol",symbolLayers:oa},va={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.getValue(-M.angle),size:d.getValue(M.size||6*V),offsetX:d.getValue(M.xoffset),offsetY:d.getValue(M.yoffset),frame:xa,markerGraphics:[{type:"CIMMarkerGraphic",
geometry:Ca,symbol:fa}]}]});return va};Q.fromCIMHatchFill=function(M){var V;const fa=null!=(V=M.separation)?V:4;V=fa/2;for(var oa=this._getLineSymbolPeriod(M.lineSymbol)||4;4>oa;)oa*=2;oa/=2;return{type:"CIMVectorMarker",frame:{xmin:-oa,xmax:oa,ymin:-V,ymax:V},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-oa,0],[oa,0]]]},symbol:M.lineSymbol}],size:fa}};Q._getLineSymbolPeriod=function(M){if(M){const V=this._getEffectsRepeat(M.effects);if(V)return V;if(M.symbolLayers)for(const fa of M.symbolLayers)if((M=
this._getEffectsRepeat(fa.effects))||fa&&(M=this._getPlacementRepeat(fa.markerPlacement)))return M}return 0};Q._getEffectsRepeat=function(M){if(M)for(var V of M)if(V)switch(V.type){case "CIMGeometricEffectDashes":if((M=V.dashTemplate)&&M.length){V=0;for(const fa of M)V+=fa;M.length&1&&(V*=2);return V}break;case "CIMGeometricEffectWave":return V.period;default:E.error(`unsupported geometric effect type ${V.type}`)}return 0};Q._getPlacementRepeat=function(M){if(M)switch(M.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((M=
M.placementTemplate)&&M.length){let V=0;for(const fa of M)V+=fa;M.length&1&&(V*=2);return V}}return 0};Q.fromCIMInsidePolygon=function(M){var V=M.markerPlacement;const fa={type:M.type,...M,markerPlacement:null,anchorPoint:null};let oa,ua;!0===V.shiftOddRows?(M=V.stepX/2,oa=V.stepY,ua=2*V.stepY,V=[{x:-M,y:0},{x:M,y:0},{x:0,y:oa},{x:0,y:-oa}].map(xa=>({type:"CIMMarkerGraphic",geometry:xa,symbol:{type:"CIMPointSymbol",symbolLayers:[fa]}}))):(M=V.stepX/2,oa=V.stepY/2,ua=V.stepY,V=[{type:"CIMMarkerGraphic",
geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[fa]}}]);return{type:"CIMVectorMarker",frame:{xmin:-M,xmax:M,ymin:-oa,ymax:oa},markerGraphics:V,size:ua}};Q.getFillColor=function(M){if(!M)return null;switch(M.type){case "CIMPolygonSymbol":if(M.symbolLayers)for(const V of M.symbolLayers)if(M=Q.getFillColor(V),null!=M)return M;break;case "CIMTextSymbol":return Q.getFillColor(M.symbol);case "CIMSolidFill":return M.color}};Q.getStrokeColor=function(M){if(M)switch(M.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(M.symbolLayers)for(const V of M.symbolLayers)if(M=
Q.getStrokeColor(V),void 0!==M)return M;break;case "CIMTextSymbol":return Q.getStrokeColor(M.symbol);case "CIMSolidStroke":return M.color}};Q.getStrokeWidth=function(M){if(M)switch(M.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(M.symbolLayers)for(const V of M.symbolLayers)if(M=Q.getStrokeWidth(V),void 0!==M)return M;break;case "CIMTextSymbol":return Q.getStrokeWidth(M.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return M.width}};Q.getSize=function(M){if(M)switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let V=
0;if(M.symbolLayers)for(const fa of M.symbolLayers)M=Q.getSize(fa),M>V&&(V=M);return V}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return M.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return M.size}};Q.getMarkerScaleRatio=function(M){if(M)switch(M.type){case "CIMVectorMarker":if(!1!==M.scaleSymbolsProportionally&&M.frame)return M.size/(M.frame.ymax-M.frame.ymin)}return 1};return Q}(),J=function(){function Q(){}Q.rasterizeSimpleFill=function(M,
V,fa){"solid"!==V&&"none"!==V&&"esriSFSSolid"!==V&&"esriSFSNull"!==V||console.error("Unexpected: style does not require rasterization");fa=w.nextPowerOfTwo(Math.ceil(fa));var oa=X(V)?8*fa:16*fa;const ua=2*fa;M.width=oa;M.height=oa;const xa=M.getContext("2d");xa.strokeStyle="#FFFFFF";xa.lineWidth=fa;xa.beginPath();if("vertical"===V||"cross"===V||"esriSFSCross"===V||"esriSFSVertical"===V)xa.moveTo(oa/2,-ua),xa.lineTo(oa/2,oa+ua);if("horizontal"===V||"cross"===V||"esriSFSCross"===V||"esriSFSHorizontal"===
V)xa.moveTo(-ua,oa/2),xa.lineTo(oa+ua,oa/2);if("forward-diagonal"===V||"diagonal-cross"===V||"esriSFSDiagonalCross"===V||"esriSFSForwardDiagonal"===V)xa.moveTo(-ua,-ua),xa.lineTo(oa+ua,oa+ua),xa.moveTo(oa-ua,-ua),xa.lineTo(oa+ua,ua),xa.moveTo(-ua,oa-ua),xa.lineTo(ua,oa+ua);if("backward-diagonal"===V||"diagonal-cross"===V||"esriSFSBackwardDiagonal"===V||"esriSFSDiagonalCross"===V)xa.moveTo(oa+ua,-ua),xa.lineTo(-ua,oa+ua),xa.moveTo(ua,-ua),xa.lineTo(-ua,ua),xa.moveTo(oa+ua,oa-ua),xa.lineTo(oa-ua,oa+
ua);xa.stroke();V=xa.getImageData(0,0,M.width,M.height);V=new Uint8Array(V.data);for(oa=0;oa<V.length;oa+=4)fa=V[oa+3]/255,V[oa]*=fa,V[oa+1]*=fa,V[oa+2]*=fa;return[V,M.width,M.height]};Q.rasterizeSimpleLine=function(M,V){return this.rasterizeDash(M,V)};Q.rasterizeDash=function(M,V){var fa="Butt"===V,oa="Square"===V;V=!fa&&!oa;1===M.length%2&&(M=[...M,...M]);var ua=0;for(var xa of M)ua+=xa;xa=Math.round(15.5*ua);ua=new Float32Array(31*xa);let Ca=0,va=0,G=.5,S=!0;for(var ha of M){Ca=va;for(va+=15.5*
ha;G<=va;){for(M=.5;31>M;){const T=V?(M-15.5)*(M-15.5):Math.abs(M-15.5);ua[(M-.5)*xa+G-.5]=S?fa?Math.max(Math.max(Ca+7.75-G,T),Math.max(G-va+7.75,T)):T:V?Math.min((G-Ca)*(G-Ca)+T,(G-va)*(G-va)+T):oa?Math.min(Math.max(G-Ca,T),Math.max(va-G,T)):Math.min(Math.max(G-Ca+7.75,T),Math.max(va+7.75-G,T));M++}G++}S=!S}fa=ua.length;ha=new Uint8Array(4*fa);for(oa=0;oa<fa;++oa)C.packFloatRGBA((V?Math.sqrt(ua[oa]):ua[oa])/15.5,ha,4*oa);return[ha,xa,31]};return Q}(),P=function(){function Q(){}Q.findApplicableOverrides=
function(M,V,fa){if(M&&V){if(M.primitiveName){let oa=!1;for(const ua of fa)if(ua.primitiveName===M.primitiveName){oa=!0;break}if(!oa)for(const ua of V)ua.primitiveName===M.primitiveName&&fa.push(ua)}switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(M.effects)for(const oa of M.effects)Q.findApplicableOverrides(oa,V,fa);if(M.symbolLayers)for(const oa of M.symbolLayers)Q.findApplicableOverrides(oa,V,fa);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(M.effects)for(const oa of M.effects)Q.findApplicableOverrides(oa,
V,fa);M.markerPlacement&&Q.findApplicableOverrides(M.markerPlacement,V,fa);if("CIMVectorMarker"===M.type){if(M.markerGraphics)for(const oa of M.markerGraphics)Q.findApplicableOverrides(oa,V,fa),Q.findApplicableOverrides(oa.symbol,V,fa)}else"CIMCharacterMarker"===M.type?Q.findApplicableOverrides(M.symbol,V,fa):"CIMHatchFill"===M.type&&Q.findApplicableOverrides(M.lineSymbol,V,fa)}}};Q.findEffectOverrides=function(M,V,fa){if(V&&M){var oa=M.length;for(let xa=0;xa<oa;xa++){var ua=M[xa];if(ua=null==ua?
void 0:ua.primitiveName){let Ca=!1;for(const va of fa)if(va.primitiveName===ua){Ca=!0;break}if(!Ca)for(const va of V)va.primitiveName===ua&&fa.push(va)}}}};Q.applyOverrides=function(M,V,fa,oa){if(V){if(M.primitiveName)for(const xa of V)if(xa.primitiveName===M.primitiveName){var ua=(ua=xa.propertyName)?ua.charAt(0).toLowerCase()+ua.substr(1):ua;oa&&oa.push({cim:M,nocapPropertyName:ua,value:M[ua]});xa.expression&&(xa.value=Q.toValue(xa.propertyName,xa.expression));if(fa){let Ca=!1;for(const va of fa)va.primitiveName===
M.primitiveName&&(Ca=!0);Ca||fa.push(xa)}M[ua]=xa.value}switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(M.effects)for(const xa of M.effects)Q.applyOverrides(xa,V,fa,oa);if(M.symbolLayers)for(const xa of M.symbolLayers)Q.applyOverrides(xa,V,fa,oa);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(M.effects)for(const xa of M.effects)Q.applyOverrides(xa,V,fa,oa);if("CIMVectorMarker"===M.type&&M.markerGraphics)for(const xa of M.markerGraphics)Q.applyOverrides(xa,
V,fa,oa),Q.applyOverrides(xa.symbol,V,fa,oa)}}};Q.restoreOverrides=function(M){for(const V of M)V.cim[V.nocapPropertyName]=V.value};Q.buildOverrideKey=function(M){let V="";for(const fa of M)void 0!==fa.value&&(V+=`${fa.primitiveName}${fa.propertyName}${JSON.stringify(fa.value)}`);return V};Q.toValue=function(M,V){return"DashTemplate"===M?V.split(" ").map(fa=>Number(fa)):"Color"===M?(M=(new t(V)).toRgba(),M[3]*=255,M):V};return Q}();const O=Q=>{if(!Q)return c.LineCapStyle.Butt;switch(Q){case "butt":return c.LineCapStyle.Butt;
case "square":return c.LineCapStyle.Square;case "round":return c.LineCapStyle.Round}},K=Q=>{if(!Q)return c.LineJoinStyle.Miter;switch(Q){case "miter":return c.LineJoinStyle.Miter;case "round":return c.LineJoinStyle.Round;case "bevel":return c.LineJoinStyle.Bevel}},D=Q=>{if(!Q)return"Center";switch(Q){case "left":return"Left";case "right":return"Right";case "center":return"Center";case "justify":return"Justify"}},I=Q=>{if(!Q)return"Center";switch(Q){case "baseline":return"Baseline";case "top":return"Top";
case "middle":return"Center";case "bottom":return"Bottom"}},L=Q=>{if(!Q)return[0,0,0,0];const {r:M,g:V,b:fa,a:oa}=Q;return[M,V,fa,255*oa]},R=(Q,M)=>{M="butt"===M;switch(Q){case "dash":case "esriSLSDash":return M?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return M?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return M?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return M?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return M?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return M?
[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return M?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return M?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return M?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return M?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return E.error("Unexpected: style does not require rasterization"),[0,0];default:return E.error(`Tried to rasterize SLS, but found an unexpected style: ${Q}!`),
[0,0]}},Z=Q=>{if("circle"===Q||"esriSMSCircle"===Q){var M=Math.acos(.995);Q=Math.ceil(B/M/4);0===Q&&(Q=1);M=z/Q;Q*=4;var V=[];V.push([50,0]);for(let fa=1;fa<Q;fa++)V.push([50*Math.cos(fa*M),-50*Math.sin(fa*M)]);V.push([50,0]);M={rings:[V]};V={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===Q||"esriSMSCross"===Q?(M={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},V={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===Q||"esriSMSDiamond"===
Q?(M={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},V={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===Q||"esriSMSSquare"===Q?(M={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},V={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===Q||"esriSMSX"===Q?(M={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},V={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===Q||"esriSMSTriangle"===Q?(Q=2/3*100,V=Q-100,M={rings:[[[-57.735026918962575,V],
[0,Q],[57.735026918962575,V],[-57.735026918962575,V]]]},V={xmin:-57.735026918962575,ymin:V,xmax:57.735026918962575,ymax:Q}):"arrow"===Q&&(M={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},V={xmin:-50,ymin:-50,xmax:50,ymax:50});return[V,M]},X=Q=>"vertical"===Q||"horizontal"===Q||"cross"===Q||"esriSFSCross"===Q||"esriSFSVertical"===Q||"esriSFSHorizontal"===Q;r.CIMSimbolInflatedSizeHelper=A;r.CIMSymbolHelper=H;r.OverrideHelper=P;r.SymbolHelper=J;r.slsDashToTemplateArray=R;r.symbolToCIM=
function(Q){if(!Q||!Q.type)return null;let M;switch(Q.type){case "cim":return Q.data;case "web-style":return Q;case "simple-marker":M=H.fromSimpleMarker(Q);break;case "picture-marker":M=H.fromPictureMarker(Q);break;case "simple-line":M=H.fromSimpleLineSymbol(Q);break;case "simple-fill":M=H.fromSimpleFillSymbol(Q);break;case "picture-fill":M=H.fromPictureFillSymbol(Q);break;case "text":M=H.fromTextSymbol(Q)}return{type:"CIMSymbolReference",symbol:M}};Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(r,t){function F(l,e=0){let h=0;for(let k=0;4>k;k++)h+=l[e+k]*A[k];return h}function C(l){return l-Math.floor(l)}const v=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],w=F(new Uint8ClampedArray([255,255,255,255]));r.packFloatRGBA=function(l,e,h=0){l=t.clamp(l,0,w);for(let k=0;4>k;k++)e[h+k]=Math.floor(256*C(l*v[k]))};r.unpackFloatRGBA=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./enums ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x){const q=Math.PI/180,B=C.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let z=function(){function K(I){this._t=I}K.createIdentity=function(){return new K([1,0,0,0,1,0])};var D=K.prototype;D.clone=function(){return new K(this._t.slice())};D.transform=function(I){const L=this._t;return[L[0]*I[0]+L[1]*I[1]+L[2],L[3]*I[0]+L[4]*I[1]+L[5]]};K.createScale=function(I,L){return new K([I,0,0,0,L,0])};D.scale=function(I,L){const R=this._t;R[0]*=I;R[1]*=I;
R[2]*=I;R[3]*=L;R[4]*=L;R[5]*=L;return this};D.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};K.createTranslate=function(I,L){return new K([0,0,I,0,0,L])};D.translate=function(I,L){const R=this._t;R[2]+=I;R[5]+=L;return this};K.createRotate=function(I){const L=Math.cos(I);I=Math.sin(I);return new K([L,-I,0,I,L,0])};D.rotate=function(I){return K.multiply(this,K.createRotate(I),this)};K.multiply=function(I,L,R){I=I._t;L=L._t;const Z=I[1]*L[0]+I[4]*L[1],X=I[2]*L[0]+
I[5]*L[1]+L[2],Q=I[0]*L[3]+I[3]*L[4],M=I[1]*L[3]+I[4]*L[4],V=I[2]*L[3]+I[5]*L[4]+L[5],fa=R._t;fa[0]=I[0]*L[0]+I[3]*L[1];fa[1]=Z;fa[2]=X;fa[3]=Q;fa[4]=M;fa[5]=V;return R};D.invert=function(){const I=this._t;let L=I[0]*I[4]-I[1]*I[3];if(0===L)return new K([0,0,0,0,0,0]);L=1/L;return new K([I[4]*L,-I[1]*L,(I[1]*I[5]-I[2]*I[4])*L,-I[3]*L,I[0]*L,(I[2]*I[3]-I[0]*I[5])*L])};return K}();C=function(){function K(I,L){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new A(c.Placement,
null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=I||new d;this._transfos.push(L||z.createIdentity());this._sizeTransfos.push(L?L.scaleRatio():1)}var D=K.prototype;D.setTransform=function(I,L){this._transfos=[I||z.createIdentity()];this._sizeTransfos=[L?L:I?I.scaleRatio():1]};D.setGeomUnitsPerPoint=function(I){this._geomUnitsPerPoint=I};D.transformPt=function(I){return this._transfos[this._transfos.length-1].transform(I)};D.transformSize=function(I){return I*this._sizeTransfos[this._sizeTransfos.length-
1]};D.reverseTransformPt=function(I){return this._transfos[this._transfos.length-1].invert().transform(I)};D.reverseTransformSize=function(I){return I/this._sizeTransfos[this._sizeTransfos.length-1]};D.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};D.isEmbedded=function(){return 1<this._transfos.length};D.back=function(){return this._transfos[this._transfos.length-1]};D.push=function(I,L){L=L?I.scaleRatio():1;z.multiply(I,this.back(),I);this._transfos.push(I);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*L)};D.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};D.drawSymbol=function(I,L){if(I)switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(I,L);break;case "CIMTextSymbol":this.drawTextSymbol(I,L)}};D.drawMultiLayerSymbol=function(I,L){if(I){var R=I.symbolLayers;if(R)if((I=I.effects)&&0<I.length){if(L=this.executeEffects(I,L))for(I=L.next();I;)this.drawSymbolLayers(R,I),I=L.next()}else this.drawSymbolLayers(R,L)}};
D.executeEffects=function(I,L){const R=this._resourceManager.geometryEngine;L=new n.SimpleGeometryCursor(L);for(const Z of I)(I=p.getEffectOperator(Z))&&(L=I.execute(L,Z,this.geomUnitsPerPoint(),R));return L};D.drawSymbolLayers=function(I,L){let R=I.length;for(;R--;){const X=I[R];if(X&&!1!==X.enable){var Z=X.effects;if(Z&&0<Z.length){if(Z=this.executeEffects(Z,L)){let Q=null;for(;(Q=Z.next())&&(this.drawSymbolLayer(X,Q),!this._earlyReturn););}}else this.drawSymbolLayer(X,L);if(this._earlyReturn)break}}};
D.drawSymbolLayer=function(I,L){switch(I.type){case "CIMSolidFill":this.drawSolidFill(L,I.color);break;case "CIMHatchFill":this.drawHatchFill(L,I);break;case "CIMPictureFill":this.drawPictureFill(L,I);break;case "CIMGradientFill":this.drawGradientFill(L,I);break;case "CIMSolidStroke":this.drawSolidStroke(L,I.color,I.width,I.capStyle,I.joinStyle,I.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(L,I);break;case "CIMGradientStroke":this.drawGradientStroke(L,I);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(I,
L)}};D.drawHatchFill=function(I,L){const R=this._buildHatchPolyline(L,I,this.geomUnitsPerPoint());R&&(this.pushClipPath(I),this.drawMultiLayerSymbol(L.lineSymbol,R),this.popClipPath())};D.drawPictureFill=function(I,L){};D.drawGradientFill=function(I,L){};D.drawPictureStroke=function(I,L){};D.drawGradientStroke=function(I,L){};D.drawMarkerLayer=function(I,L){var R=I.markerPlacement;if(R){const X=p.getPlacementOperator(R);if(X){var Z="CIMMarkerPlacementInsidePolygon"===R.type;Z&&this.pushClipPath(L);
if(L=X.execute(L,R,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(R=null;(R=L.next())&&(this.drawMarker(I,R),!this._earlyReturn););Z&&this.popClipPath()}}else{R=this._placementPool.acquire();if(k.isPoint(L))R.tx=L.x,R.ty=L.y,this.drawMarker(I,R);else if(k.isPolygon(L))[R.tx,R.ty]=h.polygonCentroid(L),this.drawMarker(I,R);else for(Z of L.points)if(R.tx=Z[0],R.ty=Z[1],this.drawMarker(I,R),this._earlyReturn)break;this._placementPool.release(R)}};D.drawMarker=function(I,L){switch(I.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(I,
L);break;case "CIMVectorMarker":this.drawVectorMarker(I,L)}};D.drawPictureMarker=function(I,L){var R,Z,X,Q,M;if(I){var V=this._resourceManager.getResource(I.url),fa=null!=(R=I.size)?R:10;if(!(v.isNone(V)||0>=fa)&&(R=V.width,V=V.height,R&&V)){V=R/V;R=null!=(Z=I.scaleX)?Z:1;Z=z.createIdentity();var oa=I.anchorPoint;if(oa){let ua=oa.x;oa=oa.y;"Absolute"!==I.anchorPointUnits&&(ua*=fa*V*R,oa*=fa);Z.translate(-ua,-oa)}V=null!=(X=I.rotation)?X:0;I.rotateClockwise&&(V=-V);this._mapRotation&&(V+=this._mapRotation);
V&&Z.rotate(V*q);X=null!=(Q=I.offsetX)?Q:0;Q=null!=(M=I.offsetY)?M:0;if(X||Q)this._mapRotation&&(V=q*this._mapRotation,M=Math.cos(V),V=Math.sin(V),R=X*V+Q*M,X=X*M-Q*V,Q=R),Z.translate(X,Q);M=this.geomUnitsPerPoint();1!==M&&Z.scale(M,M);(M=L.getAngle())&&Z.rotate(M);Z.translate(L.tx,L.ty);this.push(Z,!1);this.drawImage(I.url,fa,I.scaleX);this.pop()}}};D.drawVectorMarker=function(I,L){var R,Z,X,Q;if(I){var M=I.markerGraphics;if(M){var V=null!=(R=I.size)?R:10,fa=(R=I.frame)?R.ymax-R.ymin:0;fa=V&&fa?
V/fa:1;V=z.createIdentity();R&&V.translate(.5*-(R.xmax+R.xmin),.5*-(R.ymax+R.ymin));var oa=I.anchorPoint;if(oa){let ua=oa.x;oa=oa.y;"Absolute"!==I.anchorPointUnits?R&&(ua*=R.xmax-R.xmin,oa*=R.ymax-R.ymin):(ua/=fa,oa/=fa);V.translate(-ua,-oa)}1!==fa&&V.scale(fa,fa);R=null!=(Z=I.rotation)?Z:0;I.rotateClockwise&&(R=-R);this._mapRotation&&(R+=this._mapRotation);R&&V.rotate(R*q);Z=null!=(X=I.offsetX)?X:0;X=null!=(Q=I.offsetY)?Q:0;if(Z||X)this._mapRotation&&(R=q*this._mapRotation,Q=Math.cos(R),R=Math.sin(R),
fa=Z*R+X*Q,Z=Z*Q-X*R,X=fa),V.translate(Z,X);Q=this.geomUnitsPerPoint();1!==Q&&V.scale(Q,Q);(Q=L.getAngle())&&V.rotate(Q);V.translate(L.tx,L.ty);this.push(V,I.scaleSymbolsProportionally);for(const ua of M)if(ua&&ua.symbol&&ua.geometry||B.error("Invalid marker graphic",ua),this.drawSymbol(ua.symbol,ua.geometry),this._earlyReturn)break;this.pop()}}};D.drawTextSymbol=function(I,L){var R,Z,X,Q;if(I&&k.isPoint(L)&&!(0>=(null!=(R=I.height)?R:10))){R=z.createIdentity();var M=null!=(Z=I.angle)?Z:0;(M=-M)&&
R.rotate(M*q);Z=null!=(X=I.offsetX)?X:0;X=null!=(Q=I.offsetY)?Q:0;(Z||X)&&R.translate(Z,X);Q=this.geomUnitsPerPoint();1!==Q&&R.scale(Q,Q);R.translate(L.x,L.y);this.push(R,!1);this.drawText(I);this.pop()}};D._buildHatchPolyline=function(I,L,R){var Z=(void 0!==I.separation?I.separation:4)*R,X=void 0!==I.rotation?I.rotation:0;if(0===Z)return null;0>Z&&(Z=-Z);for(var Q=0,M=.5*Z;Q>M;)Q-=Z;for(;Q<-M;)Q+=Z;Q=l.create();e.getBoundsXY(Q,L);Q[0]-=M;Q[1]-=M;Q[2]+=M;Q[3]+=M;for(var V=[[Q[0],Q[1]],[Q[0],Q[3]],
[Q[2],Q[3]],[Q[2],Q[1]]];180<X;)X-=180;for(;0>X;)X+=180;M=Math.cos(X*q);var fa=Math.sin(X*q);X=-Z*fa;L=Z*M;Q=(void 0!==I.offsetX?I.offsetX*R:0)*fa-(void 0!==I.offsetY?I.offsetY*R:0)*M;let oa;var ua=I=Number.MAX_VALUE;oa=R=-Number.MAX_VALUE;for(var xa of V){var Ca=xa[0];const va=xa[1];V=M*Ca+fa*va;Ca=-fa*Ca+M*va;ua=Math.min(ua,V);I=Math.min(I,Ca);oa=Math.max(oa,V);R=Math.max(R,Ca)}I=Math.floor(I/Z)*Z;xa=M*ua-fa*I-X*Q/Z;ua=fa*ua+M*I-L*Q/Z;V=M*oa-fa*I-X*Q/Z;Q=fa*oa+M*I-L*Q/Z;Z=1+Math.round((R-I)/Z);
M=[];for(fa=0;fa<Z;fa++)xa+=X,ua+=L,V+=X,Q+=L,M.push([[xa,ua],[V,Q]]);return{paths:M}};return K}();let u=function(K){function D(L,R){L=K.call(this,L,R)||this;L.reset();return L}t._inheritsLoose(D,K);var I=D.prototype;I.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};I.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};I.bounds=function(){return l.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};
I.drawSolidFill=function(L){!L||0<this._clipCount||(k.isPolygon(L)?this._processPath(L.rings,0):k.isPolyline(L)?this._processPath(L.paths,0):k.isExtent(L)?(L=H(L))&&this._processPath(L.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};I.drawSolidStroke=function(L,R,Z){!L||0<this._clipCount||(R=.5*this.transformSize(Z),k.isPolygon(L)?this._processPath(L.rings,R):k.isPolyline(L)?this._processPath(L.paths,R):k.isExtent(L)?(L=H(L))&&this._processPath(L.rings,R):console.error("drawSolidStroke unexpected geometry type!"))};
I.pushClipPath=function(L){this.drawSolidFill(L);++this._clipCount};I.popClipPath=function(){--this._clipCount};I.drawImage=function(L,R,Z){let X=Z*R,Q=R;L=this._resourceManager.getResource(L);!R&&v.isSome(L)&&(X=Z*L.width,Q=L.height);this._merge(this.transformPt([-X/2,-Q/2]),0);this._merge(this.transformPt([-X/2,Q/2]),0);this._merge(this.transformPt([X/2,-Q/2]),0);this._merge(this.transformPt([X/2,Q/2]),0)};I.drawText=function(L){this._textRasterizer||(this._textRasterizer=new f.TextRasterizer)};
I._processPath=function(L,R){if(L)for(const Z of L)if(L=Z?Z.length:0,1<L){this._merge(this.transformPt(Z[0]),R);for(let X=1;X<L;++X)this._merge(this.transformPt(Z[X]),R)}};I._merge=function(L,R){L[0]-R<this._xmin&&(this._xmin=L[0]-R);L[0]+R>this._xmax&&(this._xmax=L[0]+R);L[1]-R<this._ymin&&(this._ymin=L[1]-R);L[1]+R>this._ymax&&(this._ymax=L[1]+R)};return D}(C),y=function(K){function D(){var L=K.apply(this,arguments)||this;L._searchPoint=[0,0];L._searchDistPoint=0;return L}t._inheritsLoose(D,K);
var I=D.prototype;I.hitTest=function(L,R,Z,X,Q,M){M*=w.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(M);this._searchPoint=[(L[0]+L[2])/2,(L[1]+L[3])/2];this._searchDistPoint=(L[2]-L[0])/2/M;this._textInfo=X;this._mapRotation=R&&("CIMPointSymbol"===R.type&&"Map"!==R.angleAlignment||"CIMTextSymbol"===R.type)?Q:0;this._earlyReturn=!1;this.drawSymbol(R,Z);return this._earlyReturn};I.drawSolidFill=function(L,R){this._hitTestFill(L)};I.drawHatchFill=function(L,R){this._hitTestFill(L)};I.drawPictureFill=
function(L,R){this._hitTestFill(L)};I.drawGradientFill=function(L,R){this._hitTestFill(L)};I.drawSolidStroke=function(L,R,Z,X,Q,M){this._hitTestStroke(L,Z)};I.drawPictureStroke=function(L,R){this._hitTestStroke(L,R.width)};I.drawGradientStroke=function(L,R){this._hitTestStroke(L,R.width)};I.pushClipPath=function(L){};I.popClipPath=function(){};I.drawImage=function(L,R,Z){L=this._resourceManager.getResource(L);if(!v.isNone(L)&&0!==L.height&&0!==R){R*=this.geomUnitsPerPoint();Z=L.width/L.height*Z*R;
L=this.reverseTransformPt(this._searchPoint);var X=this._searchDistPoint;Math.abs(L[0])<Z/2+X&&Math.abs(L[1])<R/2+X&&(this._earlyReturn=!0)}};I.drawText=function(L){var R,Z,X=this._textInfo;if(X&&(X=X.get(L))){var {text:Q,mosaicItem:M}=X;if(M&&0!==M.glyphMosaicItems.length){X=null!=(R=L.height)?R:10;R=O(L.lineGapType,null!=(Z=L.lineGap)?Z:0,X);Z=F.bidiText(Q)[1];L=x.shapeGlyphs(M.glyphMosaicItems,Z,{scale:X/g.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:J(L.horizontalAlignment),vAlign:P(L.verticalAlignment),
maxLineWidth:512,lineHeight:g.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(R||1,4)),decoration:L.font.decoration||"none",isCIM:!0});R=this.reverseTransformPt(this._searchPoint);Z=R[0];R=R[1];for(const V of L.glyphs)if(Z>V.xTopLeft&&Z<V.xBottomRight&&R>-V.yBottomRight&&R<-V.yTopLeft){this._earlyReturn=!0;break}}}};I._hitTestFill=function(L){let R=null;if(k.isExtent(L))R=[[[L.xmin,L.ymin],[L.xmin,L.ymax],[L.xmax,L.ymax],[L.xmax,L.ymin],[L.xmin,L.ymin]]];else if(k.isPolygon(L))R=L.rings;else if(k.isPolyline(L))R=
L.paths;else return;L=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(L,R)&&(this._earlyReturn=!0);const Z=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(L,R,Z)&&(this._earlyReturn=!0)};I._hitTestStroke=function(L,R){let Z=null;if(k.isExtent(L))Z=[[[L.xmin,L.ymin],[L.xmin,L.ymax],[L.xmax,L.ymax],[L.xmax,L.ymin],[L.xmin,L.ymin]]];else if(k.isPolygon(L))Z=L.rings;else if(k.isPolyline(L))Z=L.paths;else return;L=this.reverseTransformPt(this._searchPoint);
R*=this.geomUnitsPerPoint();const X=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(L,Z,R/2+X)&&(this._earlyReturn=!0)};I._pointInPolygon=function(L,R){let Z=0;for(const X of R){R=X.length;for(let Q=1;Q<R;++Q){const M=X[Q-1],V=X[Q];M[1]>L[1]!==V[1]>L[1]&&(0<(V[0]-M[0])*(L[1]-M[1])-(V[1]-M[1])*(L[0]-M[0])?Z++:Z--)}}return 0!==Z};I._nearLine=function(L,R,Z){for(const Q of R){R=Q.length;for(let M=1;M<R;++M){var X=Q[M-1];const V=Q[M];let fa=(V[0]-X[0])*(V[0]-X[0])+
(V[1]-X[1])*(V[1]-X[1]);if(0!==fa&&(fa=Math.sqrt(fa),Math.abs(((V[0]-X[0])*(L[1]-X[1])-(V[1]-X[1])*(L[0]-X[0]))/fa)<Z&&(X=((V[0]-X[0])*(L[0]-X[0])+(V[1]-X[1])*(L[1]-X[1]))/fa,X>-Z&&X<fa+Z)))return!0}}return!1};return D}(C),E=function(K){function D(L,R,Z){R=K.call(this,R,Z)||this;R._ctx=L;return R}t._inheritsLoose(D,K);var I=D.prototype;I.drawSolidFill=function(L,R){if(L){if(k.isPolygon(L))this._buildPath(L.rings,!0);else if(k.isPolyline(L))this._buildPath(L.paths,!0);else if(k.isExtent(L))this._buildPath(H(L).rings,
!0);else if(k.isMultipoint(L))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;L=this._ctx;L.fillStyle="string"===typeof R?R:"rgba("+Math.round(R[0])+","+Math.round(R[1])+","+Math.round(R[2])+","+R[3]/255+")";L.fill("evenodd")}};I.drawSolidStroke=function(L,R,Z,X,Q,M){if(L&&R&&0!==Z){if(k.isPolygon(L))this._buildPath(L.rings,!0);else if(k.isPolyline(L))this._buildPath(L.paths,!1);else if(k.isExtent(L))this._buildPath(H(L).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");
return}L=this._ctx;L.strokeStyle="string"===typeof R?R:"rgba("+Math.round(R[0])+","+Math.round(R[1])+","+Math.round(R[2])+","+R[3]/255+")";L.lineWidth=this.transformSize(Z)+.5;this._setCapStyle(X);this._setJoinStyle(Q);L.miterLimit=M;L.stroke()}};I.pushClipPath=function(L){this._ctx.save();if(k.isPolygon(L))this._buildPath(L.rings,!0);else if(k.isPolyline(L))this._buildPath(L.paths,!0);else if(k.isExtent(L))this._buildPath(H(L).rings,!0);else return;this._ctx.clip("evenodd")};I.popClipPath=function(){this._ctx.restore()};
I.drawImage=function(L,R,Z){L=this._resourceManager.getResource(L);if(!v.isNone(L)){var X=this._ctx,Q=X.canvas.width;X=X.canvas.height;var M=L.width/L.height*Z*R,V=Z*R;R||(M=Z*L.width,V=Z*L.height);this._ctx.drawImage(L,0,0,L.width,L.height,0,0,Math.min(this.transformSize(M),Q),Math.min(this.transformSize(V),X))}};I.drawText=function(L){this._textRasterizer||(this._textRasterizer=new f.TextRasterizer)};I._buildPath=function(L,R){const Z=this._ctx;Z.beginPath();if(L)for(const X of L)if(L=X?X.length:
0,1<L){let Q=this.transformPt(X[0]);Z.moveTo(Q[0],Q[1]);for(let M=1;M<L;++M)Q=this.transformPt(X[M]),Z.lineTo(Q[0],Q[1]);R&&Z.closePath()}};I._setCapStyle=function(L){switch(L){case a.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case a.LineCapStyle.Round:this._ctx.lineCap="round";break;case a.LineCapStyle.Square:this._ctx.lineCap="square"}};I._setJoinStyle=function(L){switch(L){case a.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case a.LineJoinStyle.Round:this._ctx.lineJoin="round";break;
case a.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return D}(C);const H=K=>K?{spatialReference:K.spatialReference,rings:[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]]}:null,J=K=>{switch(K){case "Left":return m.HAlign.Left;case "Right":return m.HAlign.Right;case "Center":case "Justify":return m.HAlign.Center}},P=K=>{switch(K){case "Top":return m.VAlign.Top;case "Center":return m.VAlign.Center;case "Bottom":return m.VAlign.Bottom;case "Baseline":return m.VAlign.Baseline}},
O=(K,D,I)=>{switch(K){case "ExtraLeading":return 1+D/I;case "Multiple":return D;case "Exact":return D/I}};r.CIMSymbolDrawHelper=C;r.C_DEG_TO_RAD=q;r.CanvasDrawHelper=E;r.EnvDrawHelper=u;r.HittestDrawHelper=y;r.Transformation=z;r.horizontalAlignment2HAlign=J;r.lineGapType2LineHeight=O;r.verticalAlignment2VAlign=P;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],
function(r,t,F,C){function v(A,w){if(A.includes(";base64,")){const l=new Image;l.src=A;return l.decode().then(()=>({ok:!0,value:l})).catch(e=>C.isAbortError(e)?{ok:!1,error:e}:{ok:!1,error:new F("invalid-resource",`Could not fetch requested resource at ${A}`)})}return t(A,{responseType:"image",...w}).then(l=>({ok:!0,value:l.data})).catch(l=>C.isAbortError(l)?{ok:!1,error:l}:{ok:!1,error:new F("invalid-resource",`Could not fetch requested resource at ${A}`)})}return function(){function A(){this._resourceMap=
new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var w=A.prototype;w.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};w.getResource=function(l){var e;return null!=(e=this._resourceMap.get(l))?e:null};w.fetchResource=function(){var l=r._asyncToGenerator(function*(e,h){const k={width:0,height:0},n=this._resourceMap;var p=n.get(e);if(p)return k.width=p.width,k.height=p.height,k;if(p=this._inFlightResourceMap.get(e))return p;p=v(e,h);this._inFlightResourceMap.set(e,
p);return p=p.then(c=>{this._inFlightResourceMap.delete(e);c.ok&&(n.set(e,c.value),c=c.value,k.width=c.width,k.height=c.height);return k})});return function(e,h){return l.apply(this,arguments)}}();w.deleteResource=function(l){this._inFlightResourceMap.delete(l);this._resourceMap.delete(l)};return A}()})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(F=0,C=0,v=0,A=0){this.x=F;this.y=C;this.width=v;this.height=A}t.prototype.union=
function(F){this.x=Math.min(this.x,F.x);this.y=Math.min(this.y,F.y);this.width=Math.max(this.width,F.width);this.height=Math.max(this.height,F.height)};r._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/symbols/cim/TextRasterizer":function(){define(["exports","../../core/screenUtils"],function(r,t){let F=function(){function v(){}var A=v.prototype;A.rasterizeText=function(w,l){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));
var e=this._textRasterizationCanvas,h=e.getContext("2d");this._setFontProperties(h,l);this.parameters=l;this.textLines=w.split(/\r?\n/);this.lineHeight=this._computeLineHeight();w=this._computeTextWidth(h,l);const {decoration:k,weight:n}=l.font;this.lineThroughWidthOffset=k&&"line-through"===k?.1*this.lineHeight:0;var p=this.lineHeight*this.textLines.length;e.width=w+2*this.lineThroughWidthOffset;e.height=p;this.renderedLineHeight=Math.round(this.lineHeight*l.pixelRatio);this.renderedHaloSize=l.halo.size*
l.pixelRatio;this.renderedWidth=w*l.pixelRatio;this.renderedHeight=p*l.pixelRatio;this.lineThroughWidthOffset*=l.pixelRatio;e=l.color;this.fillStyle=`rgba(${e.slice(0,3).toString()},${e[3]})`;this.haloStyle=`rgb(${l.halo.color.slice(0,3).toString()})`;e=this.renderedLineHeight;w=this.renderedHaloSize;this._setFontProperties(h,l);p=h.textAlign;var c=this.renderedWidth;p=("center"===p?.5*c:"right"===p?c:0)+w;c=this.lineThroughWidthOffset;let d=0;0<w&&this._renderHalo(h,p,w,c,d,l);d+=w;c+=p;for(var a of this.textLines)h.globalCompositeOperation=
"destination-out",h.fillStyle="rgb(0, 0, 0)",h.fillText(a,c,d),h.globalCompositeOperation="source-over",h.fillStyle=this.fillStyle,h.fillText(a,c,d),k&&"none"!==k&&this._renderDecoration(h,c,d,k,n),d+=e;a=this.renderedWidth+2*this.lineThroughWidthOffset;e=this.renderedHeight;h=h.getImageData(0,0,a,e);h=new Uint8Array(h.data);if(l.premultiplyColors)for(w=0;w<h.length;w+=4)l=h[w+3]/255,h[w]*=l,h[w+1]*=l,h[w+2]*=l;return{size:[a,e],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};
A._renderHalo=function(w,l,e,h,k,n){const p=this.renderedWidth,c=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=p;this._haloRasterizationCanvas.height=c;const d=this._haloRasterizationCanvas,a=d.getContext("2d");a.clearRect(0,0,p,c);this._setFontProperties(a,n);const {decoration:b,weight:f}=n.font;a.fillStyle=this.haloStyle;a.strokeStyle=this.haloStyle;n=3>this.renderedHaloSize;a.lineJoin=n?"miter":
"round";n?this._renderHaloEmulated(a,l,e,b,f):this._renderHaloNative(a,l,e,b,f);w.globalAlpha=this.parameters.halo.color[3];w.drawImage(d,0,0,p,c,h,k,p,c);w.globalAlpha=1};A._renderHaloEmulated=function(w,l,e,h,k){const n=this.renderedLineHeight,p=this.renderedHaloSize;for(const c of this.textLines){for(const [d,a]of C)w.fillText(c,l+p*d,e+p*a);h&&"none"!==h&&this._renderDecoration(w,l,e,h,k);e+=n}};A._renderHaloNative=function(w,l,e,h,k){const n=this.renderedLineHeight,p=this.renderedHaloSize;for(const c of this.textLines){const d=
2*p;for(let a=0;5>a;a++)w.lineWidth=(.6+.1*a)*d,w.strokeText(c,l,e),h&&"none"!==h&&this._renderDecoration(w,l,e,h,k);e+=n}};A._setFontProperties=function(w,l){var e=l.font;e=`${e.style} ${e.weight} ${t.pt2px(l.size*l.pixelRatio)}px ${e.family}, sans-serif`;w.font=e;w.textBaseline="top";switch(l.horizontalAlignment){case "left":l="left";break;case "right":l="right";break;case "center":l="center";break;default:l="left"}w.textAlign=l};A.computeTextSize=function(w,l){this._textRasterizationCanvas||(this._textRasterizationCanvas=
document.createElement("canvas"));const e=this._textRasterizationCanvas;var h=e.getContext("2d");this._setFontProperties(h,l);this.parameters=l;this.textLines=w.split(/\r?\n/);this.lineHeight=this._computeLineHeight();w=this._computeTextWidth(h,l);h=this.lineHeight*this.textLines.length;e.width=w;e.height=h;return[w*l.pixelRatio,h*l.pixelRatio]};A._computeTextWidth=function(w,l){let e=0;for(const h of this.textLines)e=Math.max(e,w.measureText(h).width);l=l.font;if("italic"===l.style||"oblique"===
l.style||"string"===typeof l.weight&&("bold"===l.weight||"bolder"===l.weight)||"number"===typeof l.weight&&600<l.weight)e+=.3*w.measureText("w").width;e+=2*this.parameters.halo.size;return Math.round(e)};A._computeLineHeight=function(){let w=1.275*this.parameters.size;const l=this.parameters.font.decoration;l&&"underline"===l&&(w*=1.3);return Math.round(w+2*this.parameters.halo.size)};A._renderDecoration=function(w,l,e,h,k){const n=.9*this.lineHeight;k="bold"===k?.06:"bolder"===k?.09:.04;switch(w.textAlign){case "center":l-=
this.renderedWidth/2;break;case "right":l-=this.renderedWidth}const p=w.textBaseline;if("underline"===h)switch(p){case "top":e+=n;break;case "middle":e+=n/2}else if("line-through"===h)switch(p){case "top":e+=n/1.5;break;case "middle":e+=n/3}w.save();w.beginPath();w.strokeStyle=w.fillStyle;w.lineWidth=Math.ceil(n*k);w.moveTo(l-this.lineThroughWidthOffset,e);w.lineTo(l+this.renderedWidth+2*this.lineThroughWidthOffset,e);w.stroke();w.restore()};return v}();const C=[];for(let v=0;360>v;v+=22.5)C.push([Math.cos(Math.PI*
v/180),Math.sin(Math.PI*v/180)]);r.TextRasterizer=F;r.default=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(r,t){function F(C,v){"string"!==typeof C&&(C=String(C));switch(v){case "LowerCase":return C.toLowerCase();case "Allcaps":return C.toUpperCase();default:return C}}t._adjustTextCase=F;t.colorToArray=function(C){return[C.r,C.g,C.b,C.a]};t.createLabelOverrideFunction=function(C,v,A){const w=k=>{let n=k.length;for(;n--;)if(-1===
" /-,\n".indexOf(k.charAt(n)))return!1;return!0},l=[];var e=0;let h=-1;do h=v.indexOf("[",e),h>=e&&(h>e&&(e=v.substr(e,h-e),l.push([e,null,w(e)])),e=h+1,h=v.indexOf("]",e),h>=e&&(h>e&&(e=v.substr(e,h-e),(e=C[e])&&l.push([null,e,!1])),e=h+1));while(-1!==h);e<v.length-1&&(C=v.substr(e),l.push([C,null,w(C)]));return k=>{let n="",p=null;for(const c of l){const [d,a,b]=c;if(d)b?p=d:(p&&(n+=p,p=null),n+=d);else{const f=k.attributes[a];f&&(p&&(n+=p,p=null),n+=f)}}return F(n,A)}};t.evaluateValueOrFunction=
function(C,v,A,w){return"function"===typeof C?C(v,A,w):C};t.fromCIMColor=function(C){return C?{r:C[0],g:C[1],b:C[2],a:C[3]/255}:{r:0,g:0,b:0,a:0}};t.getValue=C=>isNaN(C)||!C?0:C;t.importGeometryEngine=function(){return new Promise((C,v)=>r(["../../geometry/geometryEngineJSON"],C,v))};t.isCIMFill=function(C){return"CIMGradientFill"===C.type||"CIMHatchFill"===C.type||"CIMPictureFill"===C.type||"CIMSolidFill"===C.type||"CIMWaterFill"===C.type};t.isCIMMarker=function(C){return"CIMVectorMarker"===C.type||
"CIMPictureMarker"===C.type||"CIMBarChartMarker"===C.type||"CIMCharacterMarker"===C.type||"CIMPieChartMarker"===C.type||"CIMStackedBarChartMarker"===C.type};t.isCIMMarkerStrokePlacement=function(C){return"CIMMarkerPlacementAlongLineRandomSize"===C.type||"CIMMarkerPlacementAlongLineSameSize"===C.type||"CIMMarkerPlacementAlongLineVariableSize"===C.type||"CIMMarkerPlacementAtExtremities"===C.type||"CIMMarkerPlacementAtMeasuredUnits"===C.type||"CIMMarkerPlacementAtRatioPositions"===C.type||"CIMMarkerPlacementOnLine"===
C.type||"CIMMarkerPlacementOnVertices"===C.type};t.isCIMStroke=function(C){return"CIMGradientStroke"===C.type||"CIMPictureStroke"===C.type||"CIMSolidStroke"===C.type};t.isGeometryEngineRequired=C=>{if(!C)return!1;for(const v of C)switch(v.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};t.resampleHermite=function(C,v,A,w,l,e,h=!0){const k=v/l;A/=e;const n=Math.ceil(k/2),p=Math.ceil(A/2);for(let a=0;a<e;a++)for(let b=0;b<l;b++){const f=4*(b+(h?e-a-1:a)*l);var c=
0;let m=0,g=0,x=0,q=0,B=0,z=0;const u=(a+.5)*A;for(let y=Math.floor(a*A);y<(a+1)*A;y++){var d=Math.abs(u-(y+.5))/p;const E=(b+.5)*k;d*=d;for(let H=Math.floor(b*k);H<(b+1)*k;H++){let J=Math.abs(E-(H+.5))/n;c=Math.sqrt(d+J*J);-1<=c&&1>=c&&(c=2*c*c*c-3*c*c+1,0<c&&(J=4*(H+y*v),z+=c*C[J+3],g+=c,255>C[J+3]&&(c=c*C[J+3]/250),x+=c*C[J],q+=c*C[J+1],B+=c*C[J+2],m+=c))}}w[f]=x/m;w[f+1]=q/m;w[f+2]=B/m;w[f+3]=z/g}};t.toCIMSymbolJSON=function(C){var v;return null==(v=C.data)?void 0:v.symbol};Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(r,t,F,C){function v(w){if(!w)return null;switch(w.type){case "CIMPointSymbol":var l=w.symbolLayers;if(!l||1!==l.length)break;return v(l[0]);case "CIMVectorMarker":w=w.markerGraphics;if(!w||1!==w.length)break;var e=w[0];if(!e)break;w=e.geometry;if(!w)break;e=e.symbol;if(!e||"CIMPolygonSymbol"!==e.type&&"CIMLineSymbol"!==e.type||null!=(l=
e.symbolLayers)&&l.some(h=>!!h.effects))break;return{geom:w,asFill:"CIMPolygonSymbol"===e.type};case "sdf":return{geom:w.geom,asFill:w.asFill}}return null}function A(w){let l=Infinity,e=-Infinity,h=Infinity,k=-Infinity;for(const n of w)for(const p of n)p[0]<l&&(l=p[0]),p[0]>e&&(e=p[0]),p[1]<h&&(h=p[1]),p[1]>k&&(k=p[1]);return[l,h,e,k]}r.buildSDF=function(w){var l=w.geom;var e=l?l.rings?l.rings:l.paths?l.paths:void 0!==l.xmin&&void 0!==l.ymin&&void 0!==l.xmax&&void 0!==l.ymax?[[[l.xmin,l.ymin],[l.xmin,
l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]]:null:null;l=Infinity;var h=-Infinity;var k=Infinity,n=-Infinity;for(var p of e)for(var c of p)c[0]<l&&(l=c[0]),c[0]>h&&(h=c[0]),c[1]<k&&(k=c[1]),c[1]>n&&(n=c[1]);h=new C(l,k,h-l,n-k);k=64/Math.max(h.width,h.height);p=Math.round(h.width*k)+62;c=Math.round(h.height*k)+62;l=[];for(var d of e)if(d&&1<d.length){e=[];for(var a of d){let [y,E]=a;y-=h.x;E-=h.y;y*=k;E*=k;y+=30.5;E+=30.5;w.asFill?e.push([y,E]):e.push([Math.round(y),Math.round(E)])}w.asFill&&
(n=e.length-1,e[0][0]===e[n][0]&&e[0][1]===e[n][1]||e.push(e[0]));l.push(e)}var b;d=p*c;a=Array(d);for(e=0;e<d;++e)a[e]=962;for(b of l)for(e=b.length,h=1;h<e;++h){k=b[h-1];n=b[h];var f=void 0,m=void 0;k[0]<n[0]?(f=k[0],m=n[0]):(f=n[0],m=k[0]);var g=void 0,x=void 0;k[1]<n[1]?(g=k[1],x=n[1]):(g=n[1],x=k[1]);var q=Math.floor(f)-31;m=Math.floor(m)+31;g=Math.floor(g)-31;x=Math.floor(x)+31;0>q&&(q=0);m>p&&(m=p);0>g&&(g=0);x>c&&(x=c);f=n[0]-k[0];const y=n[1]-k[1],E=f*f+y*y;for(;q<m;q++)for(let H=g;H<x;H++){var B=
(q-k[0])*f+(H-k[1])*y,z=void 0;0>B?(z=k[0],B=k[1]):B>E?(z=n[0],B=n[1]):(B/=E,z=k[0]+B*f,B=k[1]+B*y);z=(q-z)*(q-z)+(H-B)*(H-B);B=(c-H-1)*p+q;z<a[B]&&(a[B]=z)}}for(b=0;b<d;++b)a[b]=Math.sqrt(a[b]);b=a;if(w.asFill)for(var u of l)for(w=u.length,l=1;l<w;++l)for(d=u[l-1],a=u[l],d[0]<a[0]?(e=d[0],h=a[0]):(e=a[0],h=d[0]),d[1]<a[1]?(n=d[1],k=a[1]):(n=a[1],k=d[1]),e=Math.floor(e),h=Math.floor(h)+1,n=Math.floor(n),k=Math.floor(k)+1,31>e&&(e=31),h>p-31&&(h=p-31),31>n&&(n=31),k>c-31&&(k=c-31);n<k;++n)if(d[1]>
n!==a[1]>n){m=(c-n-1)*p;for(g=e;g<h;++g)g<(a[0]-d[0])*(n-d[1])/(a[1]-d[1])+d[0]&&(b[m+g]=-b[m+g]);for(g=31;g<e;++g)b[m+g]=-b[m+g]}u=b.length;w=new Uint8Array(4*u);for(l=0;l<u;++l)t.packFloatRGBA(.5-b[l]/62,w,4*l);u=w;return[u,p,c]};r.getExtent=function(w){return w?w.rings?A(w.rings):w.paths?A(w.paths):F.isExtent(w)?[w.xmin,w.ymin,w.xmax,w.ymax]:null:null};r.getSDFInfo=v;r.getSDFMetrics=function(w,l,e,h,k){const [n,p,c,d]=w;if(c<n||d<p)return[0,0,0];var a=c-n,b=d-p;w=64/Math.max(a,b);a=Math.round(a*
w);b=Math.round(b*w)+62;let f=1;l&&(f=b/w/(l.ymax-l.ymin));let m=0,g=0;h&&(k?l&&e&&0<l.ymax-l.ymin&&(m=h.x/((l.xmax-l.xmin)/(l.ymax-l.ymin)*e),g=h.y/e):(m=h.x,g=h.y));m=.5*(l.xmax+l.xmin)+m*(l.xmax-l.xmin);g=.5*(l.ymax+l.ymin)+g*(l.ymax-l.ymin);m=(m-n)*w+31;g=(g-p)*w+31;return[f,m/(a+62)-.5,-(g/b-.5)]};r.getSDFSymbol=function(w){w=w.markerGraphics;if(!w||1!==w.length)return null;w=w[0];if(!w)return null;w=w.symbol;return!w||"CIMPolygonSymbol"!==w.type&&"CIMLineSymbol"!==w.type?null:w};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(r,t,F){function C(A){const w={};switch(A){case "esriGeometryPoint":return(l,e,h,k)=>F.unquantizePoint(e,w,l,h,k);case "esriGeometryPolygon":return(l,e,h,k)=>F.unquantizePolygon(e,w,l,h,k);case "esriGeometryPolyline":return(l,e,h,k)=>F.unquantizePolyline(e,w,l,h,k);case "esriGeometryMultipoint":return(l,
e,h,k)=>F.unquantizeMultipoint(e,w,l,h,k);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r("mapview-arcade",`Unable to handle geometryType: ${A}`)),l=>l}}const v=new Map;return function(A,w,l,e,h){if(A.referencesGeometry()&&h){{const {transform:k,hasZ:n,hasM:p}=h;v.has(e)||v.set(e,C(e));e=v.get(e)(w.geometry,k,n,p);w={...w,geometry:e}}}w=A.repurposeFeature(w);try{return A.evaluate({...l,$feature:w})}catch(k){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
k),null}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(r){function t(F){F=F.toLowerCase().split(" ").join("-");switch(F){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return F}}r.getFontDecorationTop=function(F){switch(F){case "underline":return-26;case "line-through":return-18}return NaN};r.getFontFamily=t;r.getFullyQualifiedFontName=
function(F){a:{if(F.weight)switch(F.weight.toLowerCase()){case "bold":case "bolder":var C="-bold";break a}C=""}a:{if(F.style)switch(F.style.toLowerCase()){case "italic":case "oblique":var v="-italic";break a}v=""}C+=v;return t(F.family)+(0<C.length?C:"-regular")};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(r,t){r.ok=function(F,C){return F&&"name"in F?(C&&C.error(new t(F.name,F.message,
F.details)),!1):!0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(r,t,F,C,v,A,w,l,e,h,k){return function(n){function p(c,d,a){var b=
n.call(this,c)||this;b._minMaxZoom=A.i1616to32(Math.round(d*v.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*v.MIN_MAX_ZOOM_PRECISION_FACTOR));b._cimLineLayer=c;let f=0;l.isFunction(c.width)||(f=.5*F.pt2px(c.width));b._dynamicPropertyMap.set("_halfWidth",(x,q,B)=>l.isFunction(c.width)?.5*F.pt2px(c.width(x,q,B)):f);l.isFunction(c.cap)?b._dynamicPropertyMap.set("_capType",c.cap):b._capType=c.cap;l.isFunction(c.join)?b._dynamicPropertyMap.set("_joinType",c.join):b._joinType=c.join;const m=c.color;l.isFunction(m)?
b._dynamicPropertyMap.set("_fillColor",(x,q,B)=>C.premultiplyAlphaRGBA(m(x,q,B))):b._fillColor=m&&C.premultiplyAlphaRGBA(m)||0;const g=c.miterLimit;l.isFunction(g)?b._dynamicPropertyMap.set("_miterLimitCosine",(x,q,B)=>l.getLimitCosine(g(x,q,B))):b._miterLimitCosine=l.getLimitCosine(g);t.isSome(c.effects)&&(d=c.effects,l.isFunction(d)?b._dynamicPropertyMap.set("_effects",d):b._effects=d);b._scaleFactor=c.scaleFactor||1;b._isDashed=null!=c.dashTemplate;b.tessellationProperties._bitset=(c.colorLocked?
1:0)|(c.scaleDash?1:0)<<1;b._materialKey=c.materialKey;b._initializeTessellator(!0);return b}r._inheritsLoose(p,n);p.fromCIMLine=function(c,d){const [a,b]=l.getMinMaxZoom(c.scaleInfo,d);return new p(c,a,b)};p.prototype.bindFeature=function(c,d,a){const b=c.readLegacyFeature();this._dynamicPropertyMap.forEach((m,g)=>{this[g]=m(b,d,a)});this._halfWidth*=this._scaleFactor;c=this._materialCache;var f=this._cimLineLayer.materialHash;f=f(b,d,a);f=c.get(f);c=null;f&&k.ok(f.spriteMosaicItem)&&(c=f.spriteMosaicItem);
if(c){this._hasPattern=!0;const {rect:m,width:g,height:x}=c;f=m.x+v.SPRITE_PADDING;const q=m.y+v.SPRITE_PADDING,B=f+g,z=q+x;this.tessellationProperties._tl=A.i1616to32(f,q);this.tessellationProperties._br=A.i1616to32(B,z)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=
this.tessellationProperties._halfWidth;f=w.LineMaterialKey.load(this._materialKey);c&&(f.sdf=c.sdf,f.pattern=!0,f.textureBinding=c.textureBinding);this._materialKey=f.data};return p}(e(h))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a){const b=w.create(),f=A.create(),m=F.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(g){function x(q,B,z){var u=g.call(this,q)||this;u._cimMarkerLayer=q;u._minMaxZoom=k.i1616to32(Math.round(B*h.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(z*h.MIN_MAX_ZOOM_PRECISION_FACTOR));const y=q.color;p.isFunction(y)?u._dynamicPropertyMap.set("_fillColor",(K,D,I)=>e.premultiplyAlphaRGBA(y(K,D,I))):u._fillColor=e.premultiplyAlphaRGBA(y);const E=
q.outlineColor;p.isFunction(E)?u._dynamicPropertyMap.set("_outlineColor",(K,D,I)=>e.premultiplyAlphaRGBA(E(K,D,I))):u._outlineColor=e.premultiplyAlphaRGBA(E);const H=q.size;p.isFunction(H)?u._dynamicPropertyMap.set("_size",(K,D,I)=>v.pt2px(H(K,D,I))):u._size=v.pt2px(H)||0;B=q.scaleX;p.isFunction(B)?u._dynamicPropertyMap.set("_scaleX",B):u._scaleX=B||1;const J=q.offsetX;p.isFunction(J)?u._dynamicPropertyMap.set("xOffset",(K,D,I)=>v.pt2px(J(K,D,I))):u.xOffset=v.pt2px(J)||0;const P=q.offsetY;p.isFunction(P)?
u._dynamicPropertyMap.set("yOffset",(K,D,I)=>v.pt2px(P(K,D,I))):u.yOffset=v.pt2px(P)||0;const O=q.outlineWidth;p.isFunction(O)?u._dynamicPropertyMap.set("_outlineWidth",(K,D,I)=>v.pt2px(O(K,D,I))):u._outlineWidth=v.pt2px(O)||0;B=q.rotation;p.isFunction(B)?u._dynamicPropertyMap.set("_angle",B):u._angle=B||0;C.isSome(q.effects)&&(B=q.effects,p.isFunction(B)?u._dynamicPropertyMap.set("_effects",B):u._effects=B);C.isSome(q.markerPlacement)&&(B=q.markerPlacement,p.isFunction(B)?u._dynamicPropertyMap.set("_markerPlacement",
B):u._markerPlacement=B);u._scaleFactor=C.unwrapOr(q.scaleFactor,1);u._bitSet=(q.alignment===l.Alignment.MAP?1:0)|(q.colorLocked?1:0)<<1|(q.scaleSymbolsProportionally?1:0)<<3;u._materialKey=q.materialKey;return u}r._inheritsLoose(x,g);x.fromCIMMarker=function(q,B){const [z,u]=p.getMinMaxZoom(q.scaleInfo,B);return new x(q,z,u)};x.prototype.bindFeature=function(q,B,z){const u=q.readLegacyFeature();this._dynamicPropertyMap.forEach((X,Q)=>{this[Q]=X(u,B,z)});q=this._cimMarkerLayer.materialHash;q="function"===
typeof q?q(u,B,z):q;if((q=this._materialCache.get(q))&&a.ok(q.spriteMosaicItem)&&q.spriteMosaicItem){q=q.spriteMosaicItem;var y=this._cimMarkerLayer.sizeRatio,E=q.width/q.height*this._scaleX,H=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,J=this._size,P=J*E,O=this.xOffset,K=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var D=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/v.pt2px(this._cimMarkerLayer.frameHeight):
1,I=this._outlineWidth*D,L=v.pt2px(this._cimMarkerLayer.referenceSize),R=D=0,Z=this._cimMarkerLayer.anchorPoint;Z&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(D=-Z.x/(this._size*E),R=Z.y/this._size):(D=Z.x,R=Z.y));this._sizeOutlineWidth=k.i8888to32(Math.round(Math.min(Math.sqrt(128*P),255)),Math.round(Math.min(Math.sqrt(128*J),255)),Math.round(Math.min(Math.sqrt(128*I),255)),Math.round(Math.min(Math.sqrt(128*L),255)));this.angle=H;this._bitestAndDistRatio=k.i1616to32(this._bitSet,Math.round(64*
y));E=q.rect.x+h.SPRITE_PADDING;H=q.rect.y+h.SPRITE_PADDING;I=E+q.width;L=H+q.height;this._texUpperLeft=k.i1616to32(E,H);this._texUpperRight=k.i1616to32(I,H);this._texBottomLeft=k.i1616to32(E,L);this._texBottomRight=k.i1616to32(I,L);E=n.MarkerMaterialKey.load(this._materialKey);E.sdf=q.sdf;E.pattern=!0;E.textureBinding=q.textureBinding;this._materialKey=E.data;this._anchorX=.5-(.5+D)*q.width/q.width;this._anchorY=.5-(.5+R)*q.height/q.height;P=P*y*this._scaleFactor;J=J*y*this._scaleFactor;P*=q.rect.width/
q.width;J*=q.rect.height/q.height;this._computedWidth=P;this._computedHeight=J;this._applyTransformation(f,b);this.xOffset=O;this.yOffset=K}else m.error(new t("mapview-cim","Encountered an error when binding feature"))};return x}(c(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p){return function(c){function d(b,f,m){var g=c.call(this,b)||this;g._horizontalAlignment="center";g._verticalAlignment="middle";g._textToGlyphs=new Map;g._minMaxZoom=l.i1616to32(Math.round(f*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(m*w.MIN_MAX_ZOOM_PRECISION_FACTOR));f=b.scaleFactor||1;g._cimTextLayer=b;const x=b.color;h.isFunction(x)?g._dynamicPropertyMap.set("_color",(y,E,H)=>A.premultiplyAlphaRGBA(x(y,E,H))):g._color=A.premultiplyAlphaRGBA(x);const q=b.outlineColor;
h.isFunction(q)?g._dynamicPropertyMap.set("_haloColor",(y,E,H)=>A.premultiplyAlphaRGBA(q(y,E,H))):g._haloColor=A.premultiplyAlphaRGBA(q);let B;h.isFunction(b.size)||(B=Math.min(Math.round(F.pt2px(b.size*b.sizeRatio)),127));g._dynamicPropertyMap.set("_size",(y,E,H)=>h.isFunction(b.size)?Math.min(Math.round(F.pt2px(b.size(y,E,H)*b.sizeRatio)),127):B);h.isFunction(b.outlineSize)?g._dynamicPropertyMap.set("_haloSize",(y,E,H)=>Math.min(Math.floor(5*F.pt2px(b.outlineSize(y,E,H)*b.sizeRatio)),127)):g._haloSize=
Math.min(Math.floor(5*F.pt2px(b.outlineSize*b.sizeRatio)),127);let z;h.isFunction(b.offsetX)||(z=Math.round(F.pt2px(b.offsetX*b.sizeRatio)));g._dynamicPropertyMap.set("_xOffset",(y,E,H)=>h.isFunction(b.offsetX)?Math.round(F.pt2px(b.offsetX(y,E,H)*b.sizeRatio)):z);let u;h.isFunction(b.offsetY)||(u=Math.round(F.pt2px(b.offsetY*b.sizeRatio)));g._dynamicPropertyMap.set("_yOffset",(y,E,H)=>h.isFunction(b.offsetY)?Math.round(F.pt2px(b.offsetY(y,E,H)*b.sizeRatio)):u);h.isFunction(b.angle)?g._dynamicPropertyMap.set("_angle",
b.angle):g._angle=b.angle;h.isFunction(b.horizontalAlignment)?g._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):g._horizontalAlignment=b.horizontalAlignment;h.isFunction(b.verticalAlignment)?g._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):g._verticalAlignment=b.verticalAlignment;t.isSome(b.effects)&&(m=b.effects,h.isFunction(m)?g._dynamicPropertyMap.set("_effects",m):g._effects=m);t.isSome(b.markerPlacement)&&(m=b.markerPlacement,h.isFunction(m)?g._dynamicPropertyMap.set("_markerPlacement",
m):g._textPlacement=m);h.isFunction(b.text)?g._dynamicPropertyMap.set("_text",b.text):g._text=b.text;g._scaleFactor=f;f=Math.min(Math.round(F.pt2px(b.referenceSize*b.sizeRatio)),127);g._referenceSize=Math.round(Math.sqrt(256*f));g._materialKey=b.materialKey;f=e.TextMaterialKey.load(g._materialKey);f.sdf=!0;g._bitset=(b.alignment===C.Alignment.MAP?1:0)|(b.colorLocked?1:0)<<1;g._materialKey=f.data;g._decoration="none";g._lineHeight=1;g._lineWidth=512;g._isCIM=!0;return g}r._inheritsLoose(d,c);d.fromCIMText=
function(b,f){const [m,g]=h.getMinMaxZoom(b.scaleInfo,f);return new d(b,m,g)};var a=d.prototype;a.analyze=function(){var b=r._asyncToGenerator(function*(f,m,g,x){var q=m.readLegacyFeature();var B=this._cimTextLayer;q="string"===typeof B.text?B.text:"function"===typeof B.text?B.text(q,g,x):"";(f=yield c.prototype.analyze.call(this,f,m,g,x,p.codepoints(q)))&&f.glyphMosaicItems&&this._textToGlyphs.set(q,f.glyphMosaicItems);return f});return function(f,m,g,x){return b.apply(this,arguments)}}();a.bindFeature=
function(b,f,m){const g=b.readLegacyFeature();this._dynamicPropertyMap.forEach((x,q)=>{this[q]=x(g,f,m)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/w.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=v.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=v.getYAnchorDirection(this._verticalAlignment||"baseline"),b=this._textToGlyphs.get(this._text),this.bindTextInfo(b,!1)):this._shapingInfo=null};
return d}(k(n))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(r){r.codepoints=function(t){const F=Array(t.length);for(let C=0;C<t.length;C++)F[C]=t.charCodeAt(C);return F};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(r,t,F,C,v,A,w,l,e,h){return function(k){function n(p,c,d,a,b,f,m,g,x,q,B,z,u,y,E,H){var J=k.call(this)||this;J._effects=y;p=w.FillMaterialKey.load(p);c&&(p.sdf=c.sdf,p.pattern=!0,p.textureBinding=c.textureBinding);J.fillColor=d;J.tl=a;J.br=b;J.aux2=A.i8888to32(f,m,g,x);J.aux3=A.i8888to32(q,B,z,0);J._bitset=u;J._minMaxZoom=A.i1616to32(Math.round(E*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(H*C.MIN_MAX_ZOOM_PRECISION_FACTOR));J._materialKey=p.data;return J}r._inheritsLoose(n,k);n.fromCIMFill=
function(p,c,d){var a=p.color;a=a&&F.premultiplyAlphaRGBA(a)||0;const b=p.materialKey,[f,m]=l.getMinMaxZoom(p.scaleInfo,d);if(!c)return new n(b,null,a,0,0,0,0,0,0,0,0,0,p.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0,p.effects,f,m);const {rect:g,width:x,height:q}=c;var B=p.scaleX||1,z=g.x+C.SPRITE_PADDING;const u=g.y+C.SPRITE_PADDING;var y=z+x;const E=u+q;var H=p.height;d=Math.round(H);255<d?d=255:0>=d&&(d=E-u);B=Math.round(B*H);255<B?B=255:0>=B&&(B=y-z);H=t.pt2px(p.offsetX||0)+128;255<H&&(H=255);let J=
t.pt2px(-p.offsetY||0)+128;255<J&&(J=255);z=A.i1616to32(z,u);y=A.i1616to32(y,E);return new n(b,c,a,z,y,B,d,H,J,128,128,v.degToByte(p.angle),p.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0,p.effects,f,m)};n.fromSimpleFill=function(p,c,d=!1){var {color:a}=p;a=a&&"esriSFSNull"!==p.style&&F.premultiplyAlphaRGBAArray(a)||0;d=d?C.BITSET_GENERIC_LOCK_COLOR:0;const b=p.materialKey;if(c){const {rect:g,width:x,height:q}=c;var f=g.x+C.SPRITE_PADDING;const B=g.y+C.SPRITE_PADDING;var m=f+x;const z=B+q;f=A.i1616to32(f,
B);m=A.i1616to32(m,z);c=new n(b,c,a,f,m,x,q,0,0,128,128,0,d,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM)}else c=new n(b,null,a,0,0,0,0,0,0,0,0,0,d,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);c._maybeAddLineTemplate(p);return c};n.fromPictureFill=function(p,c,d=!1){const a=C.PICTURE_FILL_COLOR,{rect:b,width:f,height:m}=c;var g=b.x+C.SPRITE_PADDING,x=b.y+C.SPRITE_PADDING,q=g+f,B=x+m;g=A.i1616to32(g,x);q=A.i1616to32(q,B);B=Math.round(t.pt2px(p.width));255<B&&(B=255);x=Math.round(t.pt2px(p.height));255<
x&&(x=255);let z=t.pt2px(p.xoffset)+128;255<z&&(z=255);let u=t.pt2px(-p.yoffset)+128;255<u&&(u=255);c=new n(p.materialKey,c,a,g,q,B,x,z,u,128*p.xscale,128*p.yscale,0,d?C.BITSET_GENERIC_LOCK_COLOR:0,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);c._maybeAddLineTemplate(p);return c};return n}(e(h))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(r,t,F){function C(){C=t._asyncToGenerator(function*(A,
w,l){try{yield A.acquire(),yield w(l),A.release()}catch(e){throw A.release(),e;}});return C.apply(this,arguments)}let v=function(){function A(){this._resolver=null}var w=A.prototype;w.isHeld=function(){return!!this._resolver};w.acquire=function(){var l=t._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=F.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return l.apply(this,arguments)}}();w.release=function(){const l=this._resolver;
this._resolver=null;l.resolve()};return A}();r.default=v;r.withLock=function(A,w,l){return C.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(r,t,F,C,v){const A=function(){var e=t._asyncToGenerator(function*(h,k,n,p){return Promise.all(h.map(c=>l(c,
k,n,p)))});return function(h,k,n,p){return e.apply(this,arguments)}}(),w=function(){var e=t._asyncToGenerator(function*(h,k,n){return new C.ExpandedCIM(yield F.analyzeCIMSymbol(h.data,k,n),h.data,h.rendererKey,h.maxVVSize)});return function(h,k,n){return e.apply(this,arguments)}}(),l=function(){var e=t._asyncToGenerator(function*(h,k,n,p){return h?"cim"===h.type?w(h,k,n):"web-style"===h.type?(h={type:"cim",data:yield v.fetchCIMSymbolReference(h,null,p),rendererKey:h.rendererKey,maxVVSize:h.maxVVSize},
w(h,k,n)):h:null});return function(h,k,n,p){return e.apply(this,arguments)}}();r.cimLayerToRasterizationInfo=function(e){if(!e)return null;const {type:h,cim:k,url:n,materialHash:p}=e,c={cim:k,type:h,mosaicHash:p,url:n,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(h){case "marker":c.size=e.size;c.path=e.path;break;case "line":c.dashTemplate=e.dashTemplate;break;case "text":c.text=e.text,c.fontName=e.fontName}return c};r.expandSymbol=l;r.expandSymbols=A;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(r,t,F,C){const v={marker:F.WGLGeometryType.MARKER,fill:F.WGLGeometryType.FILL,line:F.WGLGeometryType.LINE,text:F.WGLGeometryType.TEXT};F=function(){function A(w,l,e,h){const k={minScale:null==l?void 0:l.minScale,maxScale:null==l?void 0:l.maxScale};var n=k.minScale||k.maxScale?
k.minScale+"-"+k.maxScale:"";this.layers=w;this.data=l;this.hash=this._createHash()+n;this.rendererKey=e;l={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:e};for(const p of w)p.materialKey=C.createMaterialKey(v[p.type],l),p.maxVVSize=h,p.scaleInfo=k,p.templateHash+=n}A.prototype._createHash=function(){let w="";for(const l of this.layers)w+=l.templateHash;return w};t._createClass(A,[{key:"type",get:function(){return"expanded-cim"}}]);return A}();r.ExpandedCIM=F;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),function(r,t,F,C,v,A,w,l,e){function h(){h=t._asyncToGenerator(function*(d,a,b){if(!d.name)return Promise.reject(new C("style-symbol-reference-name-missing",
"Missing name in style symbol reference"));if(d.styleName&&"Esri2DPointSymbolsStyle"===d.styleName)return k(d,b);try{const f=yield e.fetchStyle(d,a,b);return p(f,d.name,a,b)}catch(f){return v.throwIfAborted(f),null}});return h.apply(this,arguments)}function k(d,a){return n.apply(this,arguments)}function n(){n=t._asyncToGenerator(function*(d,a){d=e.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,d.name);try{const b=yield e.requestJSON(d,a);return e.makeCIMSymbolRef(b.data)}catch(b){return v.throwIfAborted(b),
null}});return n.apply(this,arguments)}function p(d,a,b,f){return c.apply(this,arguments)}function c(){c=t._asyncToGenerator(function*(d,a,b,f){var m=d.data;d={portal:b&&b.portal||w.getDefault(),url:A.urlToObject(d.baseUrl),origin:"portal-item"};m=m.items.find(g=>g.name===a);if(!m)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${a}' could not be found`,{symbolName:a});m=l.fromJSON(e.symbolUrlFromStyleItem(m,"cimRef"),d);F.isDevEnvironment()&&(m=F.adjustStaticAGOUrl(m));try{const g=
yield e.requestJSON(m,f);return e.makeCIMSymbolRef(g.data)}catch(g){return v.throwIfAborted(g),null}});return c.apply(this,arguments)}r.fetchCIMSymbolReference=function(d,a,b){return h.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(r){const t=/^devext.arcgis.com$/,F=/^qaext.arcgis.com$/,C=/^[\w-]*\.mapsdevext.arcgis.com$/,v=/^[\w-]*\.mapsqa.arcgis.com$/,A=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,
t,F,/^jsapps.esri.com$/,C,v];r.adjustStaticAGOUrl=function(w,l){return w?(l=l||globalThis.location.hostname)?null!=l.match(t)||null!=l.match(C)?w.replace("static.arcgis.com","staticdev.arcgis.com"):null!=l.match(F)||null!=l.match(v)?w.replace("static.arcgis.com","staticqa.arcgis.com"):w:w:w};r.isDevEnvironment=function(w){w=w||globalThis.location.hostname;return A.some(l=>{var e;return null!=(null==(e=w)?void 0:e.match(l))})};r.isTelemetryDevEnvironment=function(w){w=w||globalThis.location.hostname;
return[/^zrh-.+?\.esri\.com$/].concat(A).some(l=>{var e;return null!=(null==(e=w)?void 0:e.match(l))})};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/deprecate ../core/Error ../core/JSONSupport ../core/Loadable ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n,p,c,d,a,b,f,m,g,x,q,B,z,u){const y=P=>Object.freeze({__proto__:null,default:P});var E;let H;const J={PortalGroup:()=>new Promise((P,O)=>r(["./PortalGroup"],K=>P(y(K)),O)),PortalItem:()=>new Promise((P,O)=>r(["./PortalItem"],K=>P(y(K)),O)),PortalUser:()=>new Promise((P,O)=>r(["./PortalUser"],K=>P(y(K)),O))};e=E=function(P){function O(D){D=P.call(this,D)||this;D.access=null;D.allSSL=!1;D.authMode="auto";D.authorizedCrossOriginDomains=null;D.basemapGalleryGroupQuery=
null;D.bingKey=null;D.canListApps=!1;D.canListData=!1;D.canListPreProvisionedItems=!1;D.canProvisionDirectPurchase=!1;D.canSearchPublic=!0;D.canShareBingPublic=!1;D.canSharePublic=!1;D.canSignInArcGIS=!1;D.canSignInIDP=!1;D.colorSetsGroupQuery=null;D.commentsEnabled=!1;D.created=null;D.culture=null;D.customBaseUrl=null;D.defaultBasemap=null;D.defaultDevBasemap=null;D.defaultExtent=null;D.defaultVectorBasemap=null;D.description=null;D.devBasemapGalleryGroupQuery=null;D.eueiEnabled=null;D.featuredGroups=
null;D.featuredItemsGroupQuery=null;D.galleryTemplatesGroupQuery=null;D.livingAtlasGroupQuery=null;D.hasCategorySchema=!1;D.helperServices=null;D.homePageFeaturedContent=null;D.homePageFeaturedContentCount=null;D.httpPort=null;D.httpsPort=null;D.id=null;D.ipCntryCode=null;D.isPortal=!1;D.isReadOnly=!1;D.layerTemplatesGroupQuery=null;D.maxTokenExpirationMinutes=null;D.modified=null;D.name=null;D.portalHostname=null;D.portalMode=null;D.portalProperties=null;D.region=null;D.rotatorPanels=null;D.showHomePageDescription=
!1;D.sourceJSON=null;D.supportsHostedServices=!1;D.symbolSetsGroupQuery=null;D.templatesGroupQuery=null;D.units=null;D.url=C.portalUrl;D.urlKey=null;D.user=null;D.useStandardizedQuery=!1;D.useVectorBasemaps=!1;D.vectorBasemapGalleryGroupQuery=null;return D}t._inheritsLoose(O,P);var K=O.prototype;K.normalizeCtorArgs=function(D){return"string"===typeof D?{url:D}:D};K.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=
null)};K.readAuthorizedCrossOriginDomains=function(D){if(D)for(const I of D)-1===C.request.trustedServers.indexOf(I)&&C.request.trustedServers.push(I);return D};K.readDefaultBasemap=function(D){return this._readBasemap(D)};K.readDefaultDevBasemap=function(D){return this._readBasemap(D)};K.readDefaultVectorBasemap=function(D){return this._readBasemap(D)};K.readUrlKey=function(D){return D?D.toLowerCase():D};K.readUser=function(D){let I=null;D&&(I=z.fromJSON(D),I.portal=this);return I};K.load=function(D){const I=
(new Promise((L,R)=>r(["../Basemap"],Z=>L(y(Z)),R))).then(({default:L})=>{p.throwIfAborted(D);H=L}).then(()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,D)).then(L=>{if(v.id){const R=v.id;this.credential=R.findCredential(this.restUrl);this.credential||this.authMode!==E.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=R.on("credential-create",()=>{R.findCredential(this.restUrl)&&this._signIn()}))}this.sourceJSON=L;this.read(L)});this.addResolvingPromise(I);return Promise.resolve(this)};
K.createClosestFacilityTask=function(){var D=t._asyncToGenerator(function*(){w.deprecatedFunction(k.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/closestFacility",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("closestFacility");return new (yield new Promise((L,R)=>r(["../tasks/ClosestFacilityTask"],Z=>L(y(Z)),R))).default(I)});return function(){return D.apply(this,arguments)}}();K.createElevationLayers=function(){var D=t._asyncToGenerator(function*(){yield this.load();
const I=this._getHelperService("defaultElevationLayers"),L=(yield new Promise((R,Z)=>r(["../layers/ElevationLayer"],X=>R(y(X)),Z))).default;return I?I.map(R=>new L({id:R.id,url:R.url})):[]});return function(){return D.apply(this,arguments)}}();K.createGeometryService=function(){var D=t._asyncToGenerator(function*(){w.deprecatedFunction(k.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/geometryService",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("geometry");
return new (yield new Promise((L,R)=>r(["../tasks/GeometryService"],Z=>L(y(Z)),R))).default({url:I})});return function(){return D.apply(this,arguments)}}();K.createPrintTask=function(){var D=t._asyncToGenerator(function*(){w.deprecatedFunction(k.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/print",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("printTask");return new (yield new Promise((L,R)=>r(["../tasks/PrintTask"],Z=>L(y(Z)),R))).default(I)});
return function(){return D.apply(this,arguments)}}();K.createRouteTask=function(){var D=t._asyncToGenerator(function*(){w.deprecatedFunction(k.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/route",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("route");return new (yield new Promise((L,R)=>r(["../tasks/RouteTask"],Z=>L(y(Z)),R))).default(I)});return function(){return D.apply(this,arguments)}}();K.createServiceAreaTask=function(){var D=t._asyncToGenerator(function*(){w.deprecatedFunction(k.getLogger(this.declaredClass),
null,{replacement:"Use helperServices url with esri/rest/serviceArea",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("serviceArea");return new (yield new Promise((L,R)=>r(["../tasks/ServiceAreaTask"],Z=>L(y(Z)),R))).default(I)});return function(){return D.apply(this,arguments)}}();K.fetchBasemaps=function(D,I){const L=new q;L.query=D||(C.apiKey&&u.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);
L.disableExtraQuery=!0;return this.queryGroups(L,I).then(R=>{L.num=100;L.query='type:"Web Map" -type:"Web Application"';return R.total?(R=R.results[0],L.sortField=R.sortField||"name",L.sortOrder=R.sortOrder||"desc",R.queryItems(L,I)):null}).then(R=>R&&R.total?R.results.filter(Z=>"Web Map"===Z.type).map(Z=>new H({portalItem:Z})):[])};K.fetchCategorySchema=function(D){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",D).then(I=>I.categorySchema):p.isAborted(D)?
Promise.reject(p.createAbortError()):Promise.resolve([])};K.fetchFeaturedGroups=function(D){const I=this.featuredGroups,L=new q;L.num=100;L.sortField="title";if(I&&I.length){const R=[];for(const Z of I)R.push(`(title:"${Z.title}" AND owner:${Z.owner})`);L.query=R.join(" OR ");return this.queryGroups(L,D).then(Z=>Z.results)}return p.isAborted(D)?Promise.reject(p.createAbortError()):Promise.resolve([])};K.fetchRegions=function(D){var I;const L=(null==(I=this.user)?void 0:I.culture)||this.culture||x.getLocale();
return this._request(this.restUrl+"/portals/regions",{...D,query:{culture:L}})};K.fetchSettings=function(D){var I;const L=(null==(I=this.user)?void 0:I.culture)||this.culture||x.getLocale();return this._request(this.restUrl+"/portals/self/settings",{...D,query:{culture:L}})};O.getDefault=function(){if(!E._default||E._default.destroyed)E._default=new E;return E._default};K.queryGroups=function(D,I){return this._queryPortal("/community/groups",D,"PortalGroup",I)};K.queryItems=function(D,I){return this._queryPortal("/search",
D,"PortalItem",I)};K.queryUsers=function(D,I){D.sortField||(D.sortField="username");return this._queryPortal("/community/users",D,"PortalUser",I)};K.toJSON=function(){throw new l("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};O.fromJSON=function(D){if(!D)return null;if(D.declaredClass)throw Error("JSON object is already hydrated");return new E({sourceJSON:D})};K._getHelperService=function(D){const I=this.helperServices&&this.helperServices[D];if(!I)throw new l("portal:service-not-found",
`The \`helperServices\` do not include an entry named "${D}"`);return I};K._getHelperServiceUrl=function(D){const I=this._getHelperService(D);if(!I.url)throw new l("portal:service-url-not-found",`The \`helperServices\` entry "${D}" does not include a \`url\` value`);return I.url};K._fetchSelf=function(D=this.authMode,I=!1,L){const R=this.restUrl+"/portals/self";D={authMode:D,query:{culture:x.getLocale().toLowerCase()},...L};"auto"===D.authMode&&(D.authMode="no-prompt");I&&(D.query.default=!0);return this._request(R,
D)};K._queryPortal=function(D,I,L,R){const Z=b.ensureType(q,I),X=Q=>this._request(this.restUrl+D,{...Z.toRequestOptions(this),...R}).then(M=>{const V=Z.clone();V.start=M.nextStart;return new B({nextQueryParams:V,queryParams:Z,total:M.total,results:E._resultsToTypedArray(Q,{portal:this},M,R)})}).then(M=>Promise.all(M.results.map(V=>"function"===typeof V.when?V.when():M)).then(()=>M,V=>{p.throwIfAbortError(V);return M}));return L&&J[L]?J[L]().then(({default:Q})=>{p.throwIfAborted(R);return X(Q)}):X()};
K._signIn=function(){if(this.authMode===E.AUTH_MODE_ANONYMOUS)return Promise.reject(new l("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const D=I=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return I||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=I;return this._fetchSelf("immediate")});
if(this.user&&this.credential===I)return null;this.credential=I;return this._fetchSelf("immediate")}).then(L=>{L&&(this.sourceJSON=L,this.read(L))});return v.id?v.id.getCredential(this.restUrl).then(I=>D(I)):D(this.credential)};K._normalizeSSL=function(D){return D.replace(/^http:/i,"https:").replace(":7080",":7443")};K._normalizeUrl=function(D){const I=this.credential&&this.credential.token;return this._normalizeSSL(I?D+(-1<D.indexOf("?")?"\x26":"?")+"token\x3d"+I:D)};K._requestToTypedArray=function(D,
I,L){return this._request(D,I).then(R=>{const Z=E._resultsToTypedArray(L,{portal:this},R);return Promise.all(Z.map(X=>"function"===typeof X.when?X.when():R)).then(()=>Z,()=>Z)})};K._readBasemap=function(D){return D?(D=H.fromJSON(D),D.portalItem={portal:this},D):null};K._request=function(D,I={}){const L={f:"json",...I.query},{authMode:R=this.authMode===E.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Z=null,cacheBust:X=!1,method:Q="auto",responseType:M="json",signal:V}=I;I={authMode:R,body:Z,cacheBust:X,
method:Q,query:L,responseType:M,timeout:0,signal:V};return A(this._normalizeSSL(D),I).then(fa=>fa.data)};O._resultsToTypedArray=function(D,I,L,R){if(L){const Z=n.isSome(R)?R.signal:null;L=L.listings||L.notifications||L.userInvitations||L.tags||L.items||L.groups||L.comments||L.provisions||L.results||L.relatedItems||L;if(D||I)L=L.map(X=>{X=Object.assign(D?D.fromJSON(X):X,I);"function"===typeof X.load&&X.load(Z);return X})}else L=[];return L};t._createClass(O,[{key:"extraQuery",get:function(){const D=
!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!D?` AND orgid:${this.id}`:null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"restUrl",get:function(){let D=this.url;if(D){const I=D.indexOf("/sharing");D=0<I?D.substring(0,I):this.url.replace(/\/+$/,"");D+="/sharing/rest"}return D}},{key:"stylesGroupQuery",get:function(){w.deprecatedProperty(k.getLogger(this.declaredClass),"stylesGroupQuery",{replacement:"stylesGroupQuery3d",version:"4.21"});return this.stylesGroupQuery3d}},
{key:"thumbnailUrl",get:function(){const D=this.restUrl,I=this.thumbnail;return D&&I?this._normalizeSSL(D+"/portals/self/resources/"+I):null}}]);return O}(e.JSONSupportMixin(h));e.AUTH_MODE_ANONYMOUS="anonymous";e.AUTH_MODE_AUTO="auto";e.AUTH_MODE_IMMEDIATE="immediate";F.__decorate([c.property()],e.prototype,"access",void 0);F.__decorate([c.property()],e.prototype,"allSSL",void 0);F.__decorate([c.property()],e.prototype,"authMode",void 0);F.__decorate([c.property()],e.prototype,"authorizedCrossOriginDomains",
void 0);F.__decorate([f.reader("authorizedCrossOriginDomains")],e.prototype,"readAuthorizedCrossOriginDomains",null);F.__decorate([c.property()],e.prototype,"basemapGalleryGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"bingKey",void 0);F.__decorate([c.property()],e.prototype,"canListApps",void 0);F.__decorate([c.property()],e.prototype,"canListData",void 0);F.__decorate([c.property()],e.prototype,"canListPreProvisionedItems",void 0);F.__decorate([c.property()],e.prototype,"canProvisionDirectPurchase",
void 0);F.__decorate([c.property()],e.prototype,"canSearchPublic",void 0);F.__decorate([c.property()],e.prototype,"canShareBingPublic",void 0);F.__decorate([c.property()],e.prototype,"canSharePublic",void 0);F.__decorate([c.property()],e.prototype,"canSignInArcGIS",void 0);F.__decorate([c.property()],e.prototype,"canSignInIDP",void 0);F.__decorate([c.property()],e.prototype,"colorSetsGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"commentsEnabled",void 0);F.__decorate([c.property({type:Date})],
e.prototype,"created",void 0);F.__decorate([c.property()],e.prototype,"credential",void 0);F.__decorate([c.property()],e.prototype,"culture",void 0);F.__decorate([c.property()],e.prototype,"currentVersion",void 0);F.__decorate([c.property()],e.prototype,"customBaseUrl",void 0);F.__decorate([c.property()],e.prototype,"defaultBasemap",void 0);F.__decorate([f.reader("defaultBasemap")],e.prototype,"readDefaultBasemap",null);F.__decorate([c.property()],e.prototype,"defaultDevBasemap",void 0);F.__decorate([f.reader("defaultDevBasemap")],
e.prototype,"readDefaultDevBasemap",null);F.__decorate([c.property({type:g})],e.prototype,"defaultExtent",void 0);F.__decorate([c.property()],e.prototype,"defaultVectorBasemap",void 0);F.__decorate([f.reader("defaultVectorBasemap")],e.prototype,"readDefaultVectorBasemap",null);F.__decorate([c.property()],e.prototype,"description",void 0);F.__decorate([c.property()],e.prototype,"devBasemapGalleryGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"eueiEnabled",void 0);F.__decorate([c.property({readOnly:!0})],
e.prototype,"extraQuery",null);F.__decorate([c.property()],e.prototype,"featuredGroups",void 0);F.__decorate([c.property()],e.prototype,"featuredItemsGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"galleryTemplatesGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"livingAtlasGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"hasCategorySchema",void 0);F.__decorate([c.property()],e.prototype,"helpBase",void 0);F.__decorate([c.property()],e.prototype,"helperServices",
void 0);F.__decorate([c.property()],e.prototype,"helpMap",void 0);F.__decorate([c.property()],e.prototype,"homePageFeaturedContent",void 0);F.__decorate([c.property()],e.prototype,"homePageFeaturedContentCount",void 0);F.__decorate([c.property()],e.prototype,"httpPort",void 0);F.__decorate([c.property()],e.prototype,"httpsPort",void 0);F.__decorate([c.property()],e.prototype,"id",void 0);F.__decorate([c.property()],e.prototype,"ipCntryCode",void 0);F.__decorate([c.property({readOnly:!0})],e.prototype,
"isOrganization",null);F.__decorate([c.property()],e.prototype,"isPortal",void 0);F.__decorate([c.property()],e.prototype,"isReadOnly",void 0);F.__decorate([c.property()],e.prototype,"layerTemplatesGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"maxTokenExpirationMinutes",void 0);F.__decorate([c.property({type:Date})],e.prototype,"modified",void 0);F.__decorate([c.property()],e.prototype,"name",void 0);F.__decorate([c.property()],e.prototype,"portalHostname",void 0);F.__decorate([c.property()],
e.prototype,"portalMode",void 0);F.__decorate([c.property()],e.prototype,"portalProperties",void 0);F.__decorate([c.property()],e.prototype,"region",void 0);F.__decorate([c.property({readOnly:!0})],e.prototype,"restUrl",null);F.__decorate([c.property()],e.prototype,"rotatorPanels",void 0);F.__decorate([c.property()],e.prototype,"showHomePageDescription",void 0);F.__decorate([c.property()],e.prototype,"sourceJSON",void 0);F.__decorate([c.property()],e.prototype,"staticImagesUrl",void 0);F.__decorate([c.property({readOnly:!0,
json:{read:!1}})],e.prototype,"stylesGroupQuery",null);F.__decorate([c.property({json:{name:"2DStylesGroupQuery"}})],e.prototype,"stylesGroupQuery2d",void 0);F.__decorate([c.property({json:{name:"stylesGroupQuery"}})],e.prototype,"stylesGroupQuery3d",void 0);F.__decorate([c.property()],e.prototype,"supportsHostedServices",void 0);F.__decorate([c.property()],e.prototype,"symbolSetsGroupQuery",void 0);F.__decorate([c.property()],e.prototype,"templatesGroupQuery",void 0);F.__decorate([c.property()],
e.prototype,"thumbnail",void 0);F.__decorate([c.property({readOnly:!0})],e.prototype,"thumbnailUrl",null);F.__decorate([c.property()],e.prototype,"units",void 0);F.__decorate([c.property()],e.prototype,"url",void 0);F.__decorate([c.property()],e.prototype,"urlKey",void 0);F.__decorate([f.reader("urlKey")],e.prototype,"readUrlKey",null);F.__decorate([c.property()],e.prototype,"user",void 0);F.__decorate([f.reader("user")],e.prototype,"readUser",null);F.__decorate([c.property()],e.prototype,"useStandardizedQuery",
void 0);F.__decorate([c.property()],e.prototype,"useVectorBasemaps",void 0);F.__decorate([c.property()],e.prototype,"vectorBasemapGalleryGroupQuery",void 0);return e=E=F.__decorate([m.subclass("esri.portal.Portal")],e)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w,l){const e=h=>{h=function(k){function n(...c){var d=
k.call(this,...c)||this;d._loadController=null;d.loadError=null;d.loadStatus="not-loaded";d._set("loadWarnings",[]);d.addResolvingPromise(new Promise(a=>{const b=d.load.bind(r._assertThisInitialized(d));d.load=f=>{const m=new Promise((g,x)=>{const q=v.onAbortOrThrow(f,x);d.destroyed&&x(new F("load:instance-destroyed",`Instance of '${d.declaredClass||d.constructor.name}' is already destroyed`,{instance:r._assertThisInitialized(d)}));d._promiseProps.when(g,x).finally(()=>{q&&q.remove()})});if("not-loaded"===
d.loadStatus){d._set("loadStatus","loading");const g=d._loadController=new AbortController;b({signal:g.signal});v.onAbort(g.signal,()=>{d._promiseProps.abort()})}a();return m}}));d.when(()=>{d._set("loadStatus","loaded");d._loadController=null},a=>{d._set("loadStatus","failed");d._set("loadError",a);d._loadController=null});return d}r._inheritsLoose(n,k);var p=n.prototype;p.load=function(){return null};p.cancelLoad=function(){var c;if(this.isFulfilled())return this;this._set("loadError",new F("load:cancelled",
"Cancelled"));null==(c=this._loadController)?void 0:c.abort();return this};r._createClass(n,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]);return n}(h);t.__decorate([w.property({readOnly:!0})],h.prototype,"loaded",null);t.__decorate([w.property({readOnly:!0})],h.prototype,"loadError",void 0);t.__decorate([w.property({clonable:!1})],h.prototype,"loadStatus",void 0);t.__decorate([w.property({type:[A],readOnly:!0})],
h.prototype,"loadWarnings",null);return h=t.__decorate([l.subclass("esri.core.Loadable")],h)};C=function(h){function k(){return h.apply(this,arguments)||this}r._inheritsLoose(k,h);return k}(e(C.EsriPromise));C=t.__decorate([l.subclass("esri.core.Loadable")],C);(function(h){h.LoadableMixin=e;h.isLoadable=function(k){return!(!k||!k.load)}})(C||(C={}));return C})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w){var l;(function(k){k[k.PENDING=0]="PENDING";k[k.RESOLVED=1]="RESOLVED";k[k.REJECTED=2]="REJECTED"})(l||(l={}));let e=function(){function k(p){this.instance=p;this._resolver=A.createDeferred();this._status=l.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=l.RESOLVED;this._cleanUp()},()=>{this._status=l.REJECTED;this._cleanUp()})}var n=k.prototype;n.addResolvingPromise=function(p){this._resolvingPromises.push(p);this._tryResolve()};n.isResolved=
function(){return this._status===l.RESOLVED};n.isRejected=function(){return this._status===l.REJECTED};n.isFulfilled=function(){return this._status!==l.PENDING};n.abort=function(){this._resolver.reject(A.createAbortError())};n.when=function(p,c){return this._resolver.promise.then(p,c)};n._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};n._tryResolve=function(){if(!this.isFulfilled()){var p=A.createDeferred(),c=[...this._resolvingPromises,v.assumeNonNull(p.promise)],
d=this._allPromise=Promise.all(c);d.then(()=>{this.isFulfilled()||this._allPromise!==d||this._resolver.resolve(this.instance)},a=>{this.isFulfilled()||this._allPromise!==d||A.isAbortError(a)||this._resolver.reject(a)});p.resolve()}};return k}();const h=k=>{k=function(n){function p(...d){d=n.call(this,...d)||this;d._promiseProps=new e(t._assertThisInitialized(d));d.addResolvingPromise(Promise.resolve());return d}t._inheritsLoose(p,n);var c=p.prototype;c.isResolved=function(){return this._promiseProps.isResolved()};
c.isRejected=function(){return this._promiseProps.isRejected()};c.isFulfilled=function(){return this._promiseProps.isFulfilled()};c.when=function(d,a){return(new Promise((b,f)=>{this._promiseProps.when(b,f)})).then(d,a)};c.catch=function(d){return this.when(null,d)};c.addResolvingPromise=function(d){d&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in d?d.when():d)};return p}(k);return k=F.__decorate([w.subclass("esri.core.Promise")],k)};r.EsriPromise=function(k){function n(){return k.apply(this,
arguments)||this}t._inheritsLoose(n,k);return n}(h(C));r.EsriPromise=F.__decorate([w.subclass("esri.core.Promise")],r.EsriPromise);r.EsriPromiseMixin=h;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/intl/locale":function(){define(["exports"],function(r){function t(){var d,a;return null!=(d=null!=k?k:null==(a=globalThis.navigator)?void 0:a.language)?d:"en"}function F(){void 0===h&&(h=t());return h}function C(d=F()){d=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(d);return null==d?void 0:d[1].toLowerCase()}
function v(){var d;const a=null!=(d=e)?d:t();h!==a&&(h=a,[...c].forEach(b=>{b.call(null,a)}),[...p].forEach(b=>{b.call(null,a)}))}var A,w,l;let e=void 0,h=void 0;const k=null!=(A=null==(w=globalThis.esriConfig)?void 0:w.locale)?A:null==(l=globalThis.dojoConfig)?void 0:l.locale,n={he:!0,ar:!0},p=[],c=[];null==globalThis.addEventListener?void 0:globalThis.addEventListener("languagechange",v);r.beforeLocaleChange=function(d){c.push(d);return{remove(){p.splice(c.indexOf(d),1)}}};r.getDefaultLocale=t;
r.getLanguage=C;r.getLocale=F;r.onLocaleChange=function(d){p.push(d);return{remove(){p.splice(p.indexOf(d),1)}}};r.prefersRTL=function(d=F()){d=C(d);return void 0!==d&&(n[d]||!1)};r.setLocale=function(d){e=d?d:void 0;v()};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(r,t,F,C,v,A,w,l,e,h,k,n){var p;const c=new C.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});F=p=function(d){function a(f){f=d.call(this,f)||this;f.categories=null;f.disableExtraQuery=!1;f.extent=null;f.filter=null;f.num=10;f.query=null;f.sortField=null;f.start=1;return f}r._inheritsLoose(a,d);var b=a.prototype;b.clone=function(){return new p({categories:this.categories?v.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};b.toRequestOptions=function(f,m){let g;this.categories&&(g=this.categories.map(B=>Array.isArray(B)?JSON.stringify(B):B));let x;if(this.extent){var q=n.project(this.extent,k.WGS84);A.isSome(q)&&(x=`${q.xmin},${q.ymin},${q.xmax},${q.ymax}`)}q=this.query;!this.disableExtraQuery&&f.extraQuery&&(q="("+q+")"+f.extraQuery);f={categories:g,bbox:x,
q,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(f.sortField=this.sortField.split(",").map(B=>c.toJSON(B.trim())).join(","),f.sortOrder=this.sortOrder);return{query:{...m,...f}}};r._createClass(a,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(f){"asc"!==f&&"desc"!==f||this._set("sortOrder",f)}}]);return a}(F);t.__decorate([w.property()],F.prototype,"categories",void 0);t.__decorate([w.property()],F.prototype,"disableExtraQuery",
void 0);t.__decorate([w.property({type:h})],F.prototype,"extent",void 0);t.__decorate([w.property()],F.prototype,"filter",void 0);t.__decorate([w.property()],F.prototype,"num",void 0);t.__decorate([w.property()],F.prototype,"query",void 0);t.__decorate([w.property()],F.prototype,"sortField",void 0);t.__decorate([w.property()],F.prototype,"sortOrder",null);t.__decorate([w.property()],F.prototype,"start",void 0);return F=p=t.__decorate([e.subclass("esri.portal.PortalQueryParams")],F)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l){F=function(e){function h(k){k=e.call(this,k)||this;k.nextQueryParams=null;k.queryParams=null;k.results=null;k.total=null;return k}r._inheritsLoose(h,e);return h}(F);t.__decorate([C.property()],F.prototype,"nextQueryParams",void 0);t.__decorate([C.property()],F.prototype,"queryParams",void 0);t.__decorate([C.property()],F.prototype,"results",void 0);t.__decorate([C.property()],F.prototype,"total",void 0);return F=t.__decorate([l.subclass("esri.portal.PortalQueryResult")],
F)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),function(r,t,F,C,v,A,w,l,e,h,k,n){var p;v=p=function(c){function d(...b){b=c.call(this,...b)||this;b.access=null;b.created=null;b.culture=null;b.description=null;
b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.sourceJSON=null;b.units=null;b.username=null;b.userType=null;return b}t._inheritsLoose(d,c);var a=d.prototype;a.addItem=function(b){const f=b&&b.item;var m=b&&b.data;b=b&&b.folder;const g={method:"post"};f&&(g.query=f.createPostQuery(),null!=m&&("string"===typeof m?g.query.text=m:"object"===typeof m&&(g.query.text=JSON.stringify(m))));m=this.userContentUrl;
b&&(m+="/"+("string"===typeof b?b:b.id));return this.portal._request(m+"/addItem",g).then(x=>{f.id=x.id;f.portal=this.portal;return f.loaded?f.reload():f.load()})};a.deleteItem=function(b){let f=this.userContentUrl;b.ownerFolder&&(f+="/"+b.ownerFolder);return this.portal._request(f+`/items/${b.id}/delete`,{method:"post"}).then(()=>{b.id=null;b.portal=null})};a.deleteItems=function(b){const f=this.userContentUrl+"/deleteItems";var m=b.map(g=>g.id);return m.length?(m={method:"post",query:{items:m.join(",")}},
this.portal._request(f,m).then(()=>{b.forEach(g=>{g.id=null;g.portal=null})})):Promise.resolve(void 0)};a.fetchFolders=function(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then(b=>b&&b.folders?b.folders.map(f=>{f=k.fromJSON(f);f.portal=this.portal;return f}):[])};a.fetchGroups=function(){return this.portal._request(this.url).then(b=>b&&b.groups?b.groups.map(f=>{f=n.fromJSON(f);f.portal=this.portal;return f}):[])};a.fetchItems=function(b){b||(b={});let f=this.userContentUrl;
b.folder&&(f+="/"+b.folder.id);let m;return(new Promise((g,x)=>r(["./PortalItem"],q=>g(Object.freeze({__proto__:null,default:q})),x))).then(({default:g})=>{m=g;return this.portal._request(f,{query:{folders:!1,num:b.num||10,start:b.start||1,sortField:b.sortField||"created",sortOrder:b.sortOrder||"asc"}})}).then(g=>{let x;return g&&g.items?(x=g.items.map(q=>{q=m.fromJSON(q);q.portal=this.portal;return q}),Promise.all(x.map(q=>q.load())).catch(q=>q).then(()=>({items:x,nextStart:g.nextStart,total:g.total}))):
{items:[],nextStart:-1,total:0}})};a.fetchTags=function(){return this.portal._request(this.url+"/tags").then(b=>b.tags)};a.getThumbnailUrl=function(b){let f=this.thumbnailUrl;f&&b&&(f+=`&w=${b}`);return f};a.queryFavorites=function(b){return this.favGroupId?(this._favGroup||(this._favGroup=new n({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(b)):Promise.reject(new C("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};a.toJSON=function(){throw new C("internal:not-yet-implemented",
"PortalGroup.toJSON is not yet implemented");};d.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");const f=new p;f.sourceJSON=b;f.read(b);return f};t._createClass(d,[{key:"thumbnailUrl",get:function(){const b=this.url,f=this.thumbnail;return b&&f?this.portal._normalizeUrl(`${b}/info/${f}?f=json`):null}},{key:"userContentUrl",get:function(){const b=this.get("portal.restUrl");return b?`${b}/content/users/${this.username}`:null}},{key:"url",get:function(){const b=
this.get("portal.restUrl");return b?`${b}/community/users/${this.username}`:null}}]);return d}(v.JSONSupport);F.__decorate([A.property()],v.prototype,"access",void 0);F.__decorate([A.property({type:Date})],v.prototype,"created",void 0);F.__decorate([A.property()],v.prototype,"culture",void 0);F.__decorate([A.property()],v.prototype,"description",void 0);F.__decorate([A.property()],v.prototype,"email",void 0);F.__decorate([A.property()],v.prototype,"favGroupId",void 0);F.__decorate([A.property()],
v.prototype,"fullName",void 0);F.__decorate([A.property({type:Date})],v.prototype,"modified",void 0);F.__decorate([A.property()],v.prototype,"orgId",void 0);F.__decorate([A.property()],v.prototype,"portal",void 0);F.__decorate([A.property()],v.prototype,"preferredView",void 0);F.__decorate([A.property()],v.prototype,"privileges",void 0);F.__decorate([A.property()],v.prototype,"region",void 0);F.__decorate([A.property()],v.prototype,"role",void 0);F.__decorate([A.property()],v.prototype,"roleId",void 0);
F.__decorate([A.property()],v.prototype,"sourceJSON",void 0);F.__decorate([A.property()],v.prototype,"thumbnail",void 0);F.__decorate([A.property({readOnly:!0})],v.prototype,"thumbnailUrl",null);F.__decorate([A.property()],v.prototype,"units",void 0);F.__decorate([A.property({readOnly:!0})],v.prototype,"userContentUrl",null);F.__decorate([A.property({readOnly:!0})],v.prototype,"url",null);F.__decorate([A.property()],v.prototype,"username",void 0);F.__decorate([A.property()],v.prototype,"userType",
void 0);return v=p=F.__decorate([h.subclass("esri.portal.PortalUser")],v)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(r,t,F,C,v,A,w,l,e){C=function(h){function k(n){n=h.call(this,n)||this;n.created=null;n.id=null;n.portal=null;n.title=
null;n.username=null;return n}r._inheritsLoose(k,h);k.prototype.toJSON=function(){throw new F("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};r._createClass(k,[{key:"url",get:function(){const n=this.get("portal.restUrl");return n?`${n}/content/users/${this.username}/${this.id}`:null}}]);return k}(C.JSONSupport);t.__decorate([v.property({type:Date})],C.prototype,"created",void 0);t.__decorate([v.property()],C.prototype,"id",void 0);t.__decorate([v.property()],C.prototype,
"portal",void 0);t.__decorate([v.property()],C.prototype,"title",void 0);t.__decorate([v.property({readOnly:!0})],C.prototype,"url",null);t.__decorate([v.property()],C.prototype,"username",void 0);return C=t.__decorate([e.subclass("esri.portal.PortalFolder")],C)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(r,t,F,C,v,A,w,l,e,h){C=function(k){function n(c){c=k.call(this,c)||this;c.access=null;c.created=null;c.description=null;c.id=null;c.isInvitationOnly=!1;c.modified=null;c.owner=null;c.portal=null;c.snippet=null;c.sortField=null;c.sortOrder=null;c.tags=null;c.title=null;return c}r._inheritsLoose(n,k);var p=n.prototype;p.fetchCategorySchema=function(c){return this.portal._request(this.url+"/categorySchema",c).then(d=>{d=d.categorySchema||[];return d.some(a=>"contentCategorySetsGroupQuery.LivingAtlas"===
a.source)?this._fetchCategorySchemaSet("LivingAtlas",c):d})};p.fetchMembers=function(c){return this.portal._request(this.url+"/users",c)};p.getThumbnailUrl=function(c){let d=this.thumbnailUrl;d&&c&&(d+=`&w=${c}`);return d};p.toJSON=function(){throw new F("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};p.queryItems=function(c,d){c=l.ensureType(h,c);if(5<parseFloat(this.portal.currentVersion))return c=c||new h,this.portal._queryPortal(`/content/groups/${this.id}/search`,
c,"PortalItem",d);c=c?c.clone():new h;c.query="group:"+this.id+(c.query?" "+c.query:"");return this.portal.queryItems(c,d)};p._fetchCategorySchemaSet=function(c,d){return this.portal._fetchSelf(this.portal.authMode,!0,d).then(a=>{if(a=a.contentCategorySetsGroupQuery){const b=new h;b.disableExtraQuery=!0;b.num=1;b.query=a;return this.portal.queryGroups(b,d)}throw new F("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(a=>{if(a.total){a=a.results[0];const b=
new h;b.num=1;b.query=`typekeywords:"${c}"`;return a.queryItems(b,d)}throw new F("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(a=>a.total?a.results[0].fetchData("json",d).then(b=>(b=b&&b.categorySchema)&&b.length?b:[]):[])};r._createClass(n,[{key:"thumbnailUrl",get:function(){const c=this.url,d=this.thumbnail;return c&&d?this.portal._normalizeUrl(`${c}/info/${d}?f=json`):null}},{key:"url",get:function(){const c=this.get("portal.restUrl");return c?c+"/community/groups/"+
this.id:null}}]);return n}(C.JSONSupport);t.__decorate([v.property()],C.prototype,"access",void 0);t.__decorate([v.property({type:Date})],C.prototype,"created",void 0);t.__decorate([v.property()],C.prototype,"description",void 0);t.__decorate([v.property()],C.prototype,"id",void 0);t.__decorate([v.property()],C.prototype,"isInvitationOnly",void 0);t.__decorate([v.property({type:Date})],C.prototype,"modified",void 0);t.__decorate([v.property()],C.prototype,"owner",void 0);t.__decorate([v.property()],
C.prototype,"portal",void 0);t.__decorate([v.property()],C.prototype,"snippet",void 0);t.__decorate([v.property()],C.prototype,"sortField",void 0);t.__decorate([v.property()],C.prototype,"sortOrder",void 0);t.__decorate([v.property()],C.prototype,"tags",void 0);t.__decorate([v.property()],C.prototype,"thumbnail",void 0);t.__decorate([v.property({readOnly:!0})],C.prototype,"thumbnailUrl",null);t.__decorate([v.property()],C.prototype,"title",void 0);t.__decorate([v.property({readOnly:!0})],C.prototype,
"url",null);return C=t.__decorate([e.subclass("esri.portal.PortalGroup")],C)})},"esri/symbols/support/styleUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(r,t,F,C,v,A,w,l,e){function h(a,b){return k.apply(this,arguments)}function k(){k=t._asyncToGenerator(function*(a,b){try{return{data:(yield c(a,b)).data,
baseUrl:A.removeFile(a),styleUrl:a}}catch(f){return v.throwIfAbortError(f),null}});return k.apply(this,arguments)}function n(a,b,f){b=b&&b.portal||w.getDefault();let m;const g=`${b.url} - ${b.user&&b.user.username} - ${a}`;d[g]||(d[g]=p(a,b,f).then(x=>{m=x;return x.fetchData()}).then(x=>({data:x,baseUrl:m.itemUrl,styleName:a})));return d[g]}function p(a,b,f){return b.load(f).then(()=>{const m=new l({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${a}"`});return b.queryItems(m,
f)}).then(({results:m})=>{let g=null;const x=a.toLowerCase();if(m&&Array.isArray(m))for(const q of m)if(q.typeKeywords.some(B=>B.toLowerCase()===x)&&"Style"===q.type&&"esri_en"===q.owner){g=q;break}if(!g)throw new C("symbolstyleutils:style-not-found",`The style '${a}' could not be found`,{styleName:a});return g.load(f)})}function c(a,b){b={responseType:"json",query:{f:"json"},...b};return F(A.normalize(a),b)}const d={};r.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
r.fetchStyle=function(a,b,f){return a.styleUrl?h(a.styleUrl,f):a.styleName?n(a.styleName,b,f):Promise.reject(new C("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};r.makeCIMSymbolRef=function(a){return null===a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}};r.requestJSON=c;r.styleNameFromItem=function(a){for(const b of a.typeKeywords)if(/^Esri.*Style$/.test(b)&&"Esri Style"!==b)return b};r.symbolUrlFromStyleItem=
function(a,b){if("cimRef"===b)return a.cimRef;if(a.formatInfos&&!e.enableWebStyleForceWOSR())for(const f of a.formatInfos)if("gltf"===f.type)return f.href;return a.webRef};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(r,t){r.enableDirect3DObjectFeatureLayerDisplay=()=>!!t("enable-feature:direct-3d-object-feature-layer-display");r.enablePrecipitation=()=>!!t("enable-feature:precipitation");r.enableWebStyleForceWOSR=
()=>!!t("enable-feature:force-wosr");Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),function(r,t,F,C,v,A,w,l,e){function h(B,z,u,y){return k.apply(this,arguments)}
function k(){k=F._asyncToGenerator(function*(B,z,u,y){switch(B.type){case "simple":return b.fromBasicRenderer(B,z,u,y);case "map":return g.fromUVRenderer(B,z,u,y);case "interval":return m.fromCBRenderer(B,z,u,y);case "dictionary":return q.fromDictionaryRenderer(B,z,u,y);case "subtype":return f.fromSubtypes(B,z,u,y)}});return k.apply(this,arguments)}function n(B,z){return p.apply(this,arguments)}function p(){p=F._asyncToGenerator(function*(B,z){const u=B||1;if("number"===typeof u)return(E,H,J)=>u;
const y=yield w.createRendererExpression(u,z.spatialReference,z.fields);return(E,H,J)=>l(y,E,{$view:J},z.geometryType,H)||1});return p.apply(this,arguments)}function c(){return d.apply(this,arguments)}function d(){d=F._asyncToGenerator(function*(){x||(x=new Promise((B,z)=>r(["../../../layers/features/createSymbolSchema"],B,z)));return x});return d.apply(this,arguments)}const a=v.getLogger("esri/views/2d/engine/webgl/util/Matcher");let b=function(){function B(){this.type="feature";this._defaultResult=
null}B.fromBasicRenderer=function(){var u=F._asyncToGenerator(function*(y,E,H,J){const P=new B;y.symbol&&(y=yield e.expandSymbol(y.symbol,H,J),E=E.createTemplateGroup(y,null),P.setDefault(E));return P});return function(y,E,H,J){return u.apply(this,arguments)}}();var z=B.prototype;z.size=function(){return 1};z.getDefault=function(){return this._defaultResult};z.setDefault=function(u){this._defaultResult=u};z.match=function(u,y,E,H,J){return this.getDefault()};z.analyze=function(){var u=F._asyncToGenerator(function*(y,
E,H,J,P,O){return null});return function(y,E,H,J,P,O){return u.apply(this,arguments)}}();return B}(),f=function(B){function z(u,y){var E=B.call(this)||this;E._subMatchers=u;E._subtypeField=y;return E}F._inheritsLoose(z,B);z.fromSubtypes=function(){var u=F._asyncToGenerator(function*(y,E,H,J){const P=new Map,O=[];for(const K in y.renderers){const D=parseInt(K,10),I=h(y.renderers[K],E,H,J).then(L=>P.set(D,L));O.push(I)}yield Promise.all(O);return new z(P,y.subtypeField)});return function(y,E,H,J){return u.apply(this,
arguments)}}();z.prototype.match=function(u,y,E,H,J){var P=y.readAttribute(this._subtypeField);return(P=this._subMatchers.get(P))?P.match(u,y,E,H,J):null};return z}(b),m=function(B){function z(y,E,H,J){var P=B.call(this)||this;P.type="interval";P._intervals=[];P._isMaxInclusive=E;P._fieldIndex=J;P._field=y;P._normalizationInfo=H;return P}F._inheritsLoose(z,B);z.fromCBRenderer=function(){var y=F._asyncToGenerator(function*(E,H,J,P){const {isMaxInclusive:O,normalizationField:K,normalizationTotal:D,
normalizationType:I}=E,L=new z(E.field,O,{normalizationField:K,normalizationTotal:D,normalizationType:I},E.fieldIndex),R=yield e.expandSymbol(E.backgroundFillSymbol,J,P);yield Promise.all(E.intervals.map(function(){var Z=F._asyncToGenerator(function*(X){var Q=yield e.expandSymbol(X.symbol,J,P);Q=yield H.createTemplateGroup(Q,R);L.add({min:X.min,max:X.max},Q)});return function(X){return Z.apply(this,arguments)}}()));if(E=yield e.expandSymbol(E.defaultSymbol,J,P))E=yield H.createTemplateGroup(E,R),
L.setDefault(E);return L});return function(E,H,J,P){return y.apply(this,arguments)}}();var u=z.prototype;u.add=function(y,E){this._intervals.push({interval:y,result:E});this._intervals.sort((H,J)=>H.interval.min-J.interval.min)};u.size=function(){return B.prototype.size.call(this)+this._intervals.length};u.match=function(y,E,H,J,P){if(null==this._fieldIndex&&!this._field)return this.getDefault();y=null!=this._fieldIndex?E.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(E);if(!y&&
(null===y||void 0===y||isNaN(y)))return this.getDefault();for(E=0;E<this._intervals.length;E++){const {interval:O,result:K}=this._intervals[E];H=this._isMaxInclusive?y<=O.max:y<O.max;if(y>=O.min&&H)return K}return this.getDefault()};u._needsNormalization=function(){const y=this._normalizationInfo;return y&&(y.normalizationField||y.normalizationTotal||y.normalizationType)};u._getValueFromField=function(y){const E=y.readAttribute(this._field);if(!this._needsNormalization()||null==E)return E;const {normalizationField:H,
normalizationTotal:J,normalizationType:P}=this._normalizationInfo;y=!!H&&y.readAttribute(H);if(P)switch(P){case "esriNormalizeByField":return(y||void 0)&&E/y;case "esriNormalizeByLog":return Math.log(E)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return E/J*100;default:a.error(`Found unknown normalization type: ${P}`)}else a.error("Normalization is required, but no type was set!")};return z}(b),g=function(B){function z(y,E,H){var J=B.call(this)||this;J.type="map";J._nullResult=null;J._resultsMap=
new Map;J._fieldsIndex=H;J._fields=y;J._seperator=E||"";return J}F._inheritsLoose(z,B);z.fromUVRenderer=function(){var y=F._asyncToGenerator(function*(E,H,J,P){const O=E.fieldDelimiter,K=[E.field];E.field2&&K.push(E.field2);E.field3&&K.push(E.field3);const D=yield e.expandSymbol(E.backgroundFillSymbol,J,P),I=new z(K,O,E.fieldIndex);yield Promise.all(E.map.map(function(){var L=F._asyncToGenerator(function*(R){var Z=yield e.expandSymbol(R.symbol,J,P);Z=yield H.createTemplateGroup(Z,D);"\x3cNull\x3e"===
R.value?I.setNullResult(Z):I.add(R.value,Z)});return function(R){return L.apply(this,arguments)}}()));if(E=yield e.expandSymbol(E.defaultSymbol,J,P))E=yield H.createTemplateGroup(E,D),I.setDefault(E);return I});return function(E,H,J,P){return y.apply(this,arguments)}}();var u=z.prototype;u.setNullResult=function(y){this._nullResult=y};u.add=function(y,E){this._resultsMap.set(y.toString(),E)};u.size=function(){return B.prototype.size.call(this)+this._resultsMap.size};u.match=function(y,E,H,J,P){if(null==
this._fieldsIndex&&!this._fields)return this.getDefault();y=null!=this._fieldsIndex?E.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(E);if(null!==this._nullResult&&(null==y||""===y||"\x3cNull\x3e"===y))return this._nullResult;if(!y&&null==y)return this.getDefault();y=y.toString();return this._resultsMap.has(y)?this._resultsMap.get(y):this.getDefault()};u._getValueFromFields=function(y){const E=[];for(const H of this._fields){const J=y.readAttribute(H);null==J||""===J?E.push("\x3cNull\x3e"):
E.push(J)}return E.join(this._seperator)};return z}(b),x,q=function(B){function z(y,E,H,J,P,O){var K=B.call(this)||this;K.type="dictionary";K._groupIdCache=new A(100);K._loader=y;K._fieldMap=y.fieldMap;K._symbolFields=y.getSymbolFields();K._templates=E;K._info=H;K._scaleFn=J;K._schemaUtilsModule=P;K._symbolOptions=O;return K}F._inheritsLoose(z,B);z.fromDictionaryRenderer=function(){var y=F._asyncToGenerator(function*(E,H,J,P){const [{DictionaryLoader:O},K]=yield Promise.all([new Promise((I,L)=>r(["../../../../../renderers/support/DictionaryLoader"],
I,L)),c()]);P=new O(E.url,E.config,E.fieldMap);yield P.fetchResources({spatialReference:J.spatialReference,fields:J.fields});const D=yield n(E.scaleExpression,J);return new z(P,H,J,D,K,E.symbolOptions)});return function(E,H,J,P){return y.apply(this,arguments)}}();var u=z.prototype;u._analyzeFeature=function(){var y=F._asyncToGenerator(function*(E,H,J,P,O){E=E.readLegacyFeature();const K=this._scaleFn(E,J,P);J=this._attributeHash(E)+"-"+K;const D=this._groupIdCache.get(J);if(D)return D;P=yield this._loader.getSymbolAsync(E,
{...P,spatialReference:this._info.spatialReference,abortOptions:O,fields:this._info.fields});P=this._schemaUtilsModule.createSymbolSchema(P,this._symbolOptions);H=e.expandSymbol(P,this._info,H,O).then(I=>{if("expanded-cim"!==I.type)return a.error(new C("mapview-bad-type",`Found unexpected type ${I.type} in dictionary response`)),null;I.hash+="-"+K;for(const L of I.layers)L.scaleFactor=K,L.templateHash+="-"+K;return this._templates.createTemplateGroup(I,null)});this._groupIdCache.put(J,H,1);return H});
return function(E,H,J,P,O){return y.apply(this,arguments)}}();u.analyze=function(){var y=F._asyncToGenerator(function*(E,H,J,P,O,K){E=H.getCursor();for(H=[];E.next();)H.push(this._analyzeFeature(E,J,P,O,K));return Promise.all(H)});return function(E,H,J,P,O,K){return y.apply(this,arguments)}}();u.match=function(y,E,H,J,P){return null};u._attributeHash=function(y){let E="";for(const H of this._symbolFields){const J=this._fieldMap[H];J&&(E+=y.attributes[J]+"-")}return E};return z}(b);t.DictionaryMatcher=
q;t.FeatureMatcher=b;t.IntervalMatcher=m;t.MapMatcher=g;t.SubtypeMatcher=f;t.createMatcher=h;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(r,t){return function(){function F(v,A){this._storage=new t.MemCacheStorage;this._storage.maxSize=v;A&&this._storage.registerRemoveFunc("",A)}var C=F.prototype;C.put=function(v,A,w){this._storage.put(v,A,w,1)};C.pop=function(v){return this._storage.pop(v)};
C.get=function(v){return this._storage.get(v)};C.clear=function(){this._storage.clearAll()};C.destroy=function(){this._storage.destroy()};r._createClass(F,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(v){this._storage.maxSize=v}}]);return F}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,F,C,v,A,w,l){F=function(e){function h(){return e.apply(this,arguments)||this}r._inheritsLoose(h,e);var k=h.prototype;k.initialize=function(){};k.destroy=function(){};r._createClass(h,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const n=this.get("tileStore.tileScheme.spatialReference");return n&&n.toJSON()||null}}]);return h}(F.HandleOwner);t.__decorate([C.property({readOnly:!0})],F.prototype,"supportsTileUpdates",null);t.__decorate([C.property({constructOnly:!0})],
F.prototype,"remoteClient",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"service",void 0);t.__decorate([C.property()],F.prototype,"spatialReference",null);t.__decorate([C.property({constructOnly:!0})],F.prototype,"tileInfo",void 0);t.__decorate([C.property({constructOnly:!0})],F.prototype,"tileStore",void 0);return F=t.__decorate([l.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],F)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(r,t){return function(){function F(v){this._remoteClient=v;this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var C=F.prototype;C.destroy=function(){};C.fetchResource=function(){var v=r._asyncToGenerator(function*(A,w){const l=this._resourceMap;var e=l.get(A);if(e||(e=this._inFlightResourceMap.get(A)))return e;try{e=this._remoteClient.invoke("tileRenderer.fetchResource",{url:A},{...w}),this._inFlightResourceMap.set(A,e),
e.then(h=>{this._inFlightResourceMap.delete(A);l.set(A,h);return h})}catch(h){return t.isAbortError(h)?null:{width:0,height:0}}return e});return function(A,w){return v.apply(this,arguments)}}();C.getResource=function(v){var A;return null!=(A=this._resourceMap.get(v))?A:null};return F}()})},"*noref":1}});
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(r,
t,F,C,v,A,w,l,e,h,k,n,p,c,d,a){const b=new Set;C=function(f){function m(){var x=f.apply(this,arguments)||this;x.controller=null;x.processor=null;x.remoteClient=null;x.tileStore=null;x.service=null;x.viewState=null;x._paused=!1;x._pendingTileUpdates=[];return x}t._inheritsLoose(m,f);var g=m.prototype;g.initialize=function(){this.handles.add(this.watch("updating",x=>{this.remoteClient.invoke("setUpdating",x).catch(q=>{})}))};g.destroy=function(){var x,q;this.stop();null==(x=this.controller)?void 0:
x.destroy();null==(q=this.processor)?void 0:q.destroy();this.controller=this.processor=this.tileStore=this.remoteClient=null};g.stop=function(){var x,q,B;this._paused=!0;Array.isArray(null==(x=this.service)?void 0:x.source)&&(this.service.source.forEach(z=>z.close()),this.service.source.length=0);null==(q=this.tileStore)?void 0:q.updateTiles({added:[],removed:this.tileStore.tiles.map(z=>z.id)});null==(B=this.tileStore)?void 0:B.destroy();this.tileStore=null;this._pendingTileUpdates.length=0};g.startup=
function(){var x=t._asyncToGenerator(function*({service:q,config:B,tileInfo:z,tiles:u}){var y;this._paused=!0;Array.isArray(null==(y=this.service)?void 0:y.source)&&(this.service.source.forEach(J=>J.close()),this.service.source.length=0);this.service=q;if(!this.tileStore||!h.equals(this.tileStore.tileScheme.spatialReference,z.spatialReference)){var E,H;q=new a(k.fromJSON(z));u.added.length=u.removed.length=0;null==(E=this.tileStore)?void 0:E.updateTiles({added:[],removed:this.tileStore.tiles.map(J=>
J.id)});null==(H=this.tileStore)?void 0:H.destroy();this.tileStore=new c(q);this._pendingTileUpdates.length=0}yield this._createProcessorAndController(B);yield this.update({config:B},!0);this.tileStore.clear();this.tileStore.updateTiles(u);for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())});return function(q){return x.apply(this,arguments)}}();g.updateTiles=function(){var x=t._asyncToGenerator(function*(q){this._paused?this._pendingTileUpdates.push(q):
this.tileStore.updateTiles(q)});return function(q){return x.apply(this,arguments)}}();g.update=function(){var x=t._asyncToGenerator(function*({config:q},B=!1){const z=d.UpdateToken.empty();B||this.controller.pause();yield Promise.all([this.processor.update(z,q),this.controller.update(z,q)]);return z.toJSON()});return function(q){return x.apply(this,arguments)}}();g.applyUpdate=function(){var x=t._asyncToGenerator(function*(q){return this.controller.applyUpdate(d.UpdateToken.create(q))});return function(q){return x.apply(this,
arguments)}}();g._createProcessorAndController=function(){var x=t._asyncToGenerator(function*(q){yield Promise.all([this._handleControllerConfig(q),this._handleProcessorConfig(q)]);this.controller.processor=this.processor});return function(q){return x.apply(this,arguments)}}();g._handleControllerConfig=function(){var x=t._asyncToGenerator(function*(q){q=yield this._createController(this.service,q);yield q.startup();return q});return function(q){return x.apply(this,arguments)}}();g._handleProcessorConfig=
function(){var x=t._asyncToGenerator(function*(q){return this._createProcessor(this.service,q)});return function(q){return x.apply(this,arguments)}}();g._createController=function(){var x=t._asyncToGenerator(function*(q,B){this.controller&&this.controller.destroy();const {tileStore:z,remoteClient:u}=this;return this.controller=q=new p({service:q,config:B,tileStore:z,remoteClient:u})});return function(q,B){return x.apply(this,arguments)}}();g._createProcessor=function(){var x=t._asyncToGenerator(function*(q,
B){const z=(yield n.loadProcessorModule(B.schema.processors[0].type)).default,{remoteClient:u,tileStore:y}=this;q=new z({service:q,config:B,tileStore:y,remoteClient:u});this.processor&&this.processor.destroy();return this.processor=q});return function(q,B){return x.apply(this,arguments)}}();t._createClass(m,[{key:"updating",get:function(){return!this.controller||this.controller.updating}}]);return m}(C.HandleOwner);F.__decorate([A.property()],C.prototype,"controller",void 0);F.__decorate([A.property()],
C.prototype,"processor",void 0);F.__decorate([A.property()],C.prototype,"updating",null);F.__decorate([A.property()],C.prototype,"viewState",void 0);C=F.__decorate([e.subclass("esri.views.2d.layers.features.Pipeline")],C);r.default=C;r.getInstances=function(){return b};Object.defineProperty(r,"__esModule",{value:!0})});