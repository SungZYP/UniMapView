// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(n,r,g,k,l,p){l=function(q){function m(){var a=q.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["hittest"];return a}r._inheritsLoose(m,q);var f=m.prototype;f.dispose=function(){g.isSome(this._fbo)&&this._fbo.dispose()};f.createOptions=function({pixelRatio:a},b,d=k.HITTEST_RADIUS){if(!b.length)return null;b=b.shift();const e=
b.point.x,c=b.point.y;this._outstanding=b;return{type:"hittest",distance:d*a,position:[e,c]}};f.bind=function(a){const {context:b,attributeView:d}=a;d.size&&(a=d.getBlock(k.ATTRIBUTE_DATA_GPGPU),g.isNone(a)||(a=a.getFBO(b),b.setViewport(0,0,d.size,d.size),b.bindFramebuffer(a),b.setColorMask(!0,!0,!0,!0),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT)))};f.unbind=function(a){};f.draw=function(a){const {context:b,attributeView:d}=a;var e=d.getBlock(k.ATTRIBUTE_DATA_GPGPU);
if(!g.isNone(this._outstanding))if(a=this._outstanding.resolver,g.isNone(e))a.resolve([]),this._outstanding=null;else{var c=e.getFBO(b);e=new Uint8Array(c.width*c.height*4);c.readPixels(0,0,c.width,c.height,p.PixelFormat.RGBA,p.PixelType.UNSIGNED_BYTE,e);c=[];for(let h=0;h<e.length;h+=4)e[h]&&c.push(h/4);this._outstanding=null;a.resolve(c)}};return m}(l.Effect);n.HittestEffect=l;Object.defineProperty(n,"__esModule",{value:!0})});