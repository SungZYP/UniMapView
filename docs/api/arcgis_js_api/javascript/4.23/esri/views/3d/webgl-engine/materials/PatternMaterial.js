// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutputOptions ../lib/basicInterfaces ../lib/GLMaterial ../lib/GLMaterials ../lib/Material ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./PatternStyle ./internal/bufferWriterUtils ./internal/DefaultBufferWriter ./internal/MaterialUtil ../shaders/PatternTechnique".split(" "),function(B,
v,q,D,p,E,F,G,C,H,r,t,m,I,w,J,K,x){let O=function(n){function l(a){a=n.call(this,a,L)||this;a.supportsEdges=!0;a._vertexAttributeLocations=x.patternVertexAttributeLocations;a.techniqueConfig=new x.PatternTechniqueConfiguration;return a}v._inheritsLoose(l,n);var f=l.prototype;f.getTechniqueConfig=function(a,b){this.techniqueConfig.output=a;this.techniqueConfig.cullFace=this.parameters.cullFace;this.techniqueConfig.vertexColors=this.parameters.vertexColors;this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled;
this.techniqueConfig.polygonOffset=this.parameters.polygonOffset;this.techniqueConfig.writeDepth=this.parameters.writeDepth;this.techniqueConfig.style=this.parameters.style;this.techniqueConfig.patternSpacing=this.parameters.patternSpacing;this.techniqueConfig.lineWidth=this.parameters.lineWidth;this.techniqueConfig.draped=this.parameters.draped;this.techniqueConfig.transparencyPassType=b.transparencyPassType;this.techniqueConfig.enableOffset=b.camera.relativeElevation<H.OITPolygonOffsetLimit;this.techniqueConfig.multipassTerrainEnabled=
b.multipassTerrainEnabled;this.techniqueConfig.cullAboveGround=b.cullAboveGround;return this.techniqueConfig};f.getPassParameters=function(){return this.parameters};f.intersect=function(a,b,c,k,d,g,e){K.intersectTriangleGeometry(a,b,k,d,g,void 0,e)};f.requiresSlot=function(a,b){return a===r.RenderSlot.DRAPED_MATERIAL?!0:G.outputFromPass(b)===p.ShaderOutput.Highlight?a===r.RenderSlot.OPAQUE_MATERIAL:a===(this.parameters.writeDepth?r.RenderSlot.TRANSPARENT_MATERIAL:r.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL)};
f.createGLMaterial=function(a){return a.output===p.ShaderOutput.Color||a.output===p.ShaderOutput.Alpha||a.output===p.ShaderOutput.Highlight||a.output===p.ShaderOutput.Depth&&this.parameters.writeLinearDepth?new M(a):null};f.createBufferWriter=function(){const a=D.newLayout().vec3f(m.VertexAttribute.POSITION).vec4u8(m.VertexAttribute.COLOR).vec4f(m.VertexAttribute.UVMAPSPACE);this.parameters.draped||a.mat3f(m.VertexAttribute.BOUNDINGRECT);return new N(a)};return l}(C.Material),M=function(n){function l(){return n.apply(this,
arguments)||this}v._inheritsLoose(l,n);var f=l.prototype;f.updateParameters=function(a){return this.ensureTechnique(x.PatternTechnique,a)};f._updateOccludeeState=function(a){a.hasOccludees!==this._material.parameters.sceneHasOcludees&&this._material.setParameters({sceneHasOcludees:a.hasOccludees})};f.beginSlot=function(a){this._output!==p.ShaderOutput.Color&&this._output!==p.ShaderOutput.Alpha||this._updateOccludeeState(a);return this.updateParameters(a)};f.bind=function(a,b){b.bindPass(this._material.getPassParameters(),
a)};return l}(F),N=function(n){function l(){return n.apply(this,arguments)||this}v._inheritsLoose(l,n);var f=l.prototype;f.write=function(a,b,c,k){for(const g of this.vertexBufferLayout.fieldNames){const e=b.vertexAttributes.get(g),h=b.indices.get(g);if(e&&h)switch(g){case m.VertexAttribute.POSITION:t.assert(3===e.size);var d=c.getField(g,q.BufferViewVec3f);d&&w.writePosition(h,e.data,a.transformation,d,k);break;case m.VertexAttribute.COLOR:t.assert(3===e.size||4===e.size);(d=c.getField(g,q.BufferViewVec4u8))&&
w.writeColor(h,e.data,e.size,d,k);break;case m.VertexAttribute.UVMAPSPACE:t.assert(4===e.size);(d=c.getField(g,q.BufferViewVec4f))&&w.writeBufferVec4(h,e.data,d,k);break;case m.VertexAttribute.BOUNDINGRECT:t.assert(9===e.size),(d=c.getField(g,q.BufferViewMat3f))&&this.writeBoundingRect(h,e.data,a.transformation,d,k)}}};f.writeBoundingRect=function(a,b,c,k,d){const g=k.typedBuffer;k=k.typedBufferStride;const e=a.length;d*=k;for(let y=0;y<e;++y){const u=9*a[y];var h=b[u];const z=b[u+1],A=b[u+2];g[d]=
c[0]*h+c[4]*z+c[8]*A+c[12];g[d+1]=c[1]*h+c[5]*z+c[9]*A+c[13];g[d+2]=c[2]*h+c[6]*z+c[10]*A+c[14];for(h=3;9>h;++h)g[d+h]=b[u+h];d+=k}};return l}(J.DefaultBufferWriter);const L={color:[1,1,1,1],writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:E.CullFaceOptions.None,sceneHasOcludees:!1,style:I.Style.Cross,patternSpacing:10,lineWidth:1,draped:!0,...C.DefaultMaterialParameters};B.PatternMaterial=O;Object.defineProperty(B,"__esModule",{value:!0})});