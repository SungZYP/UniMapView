// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/promiseUtils ./depthRange ./RenderSlot ./Util".split(" "),function(g,k,l,m,h,n){let r=function(){function f(a){this.context=a;this.renderPlugins=[];this.slots=[];for(a=0;a<h.RenderSlot.MAX_SLOTS;++a)this.slots[a]=[]}var d=f.prototype;d.add=function(a,b,c){const e=()=>{this.renderPlugins.push(b);for(const p of a)this.slots[p].push(b);this.context.requestRender()};c=b.initializeRenderContext(this.context,c);if(l.isPromiseLike(c))return c.then(e);
e()};d.remove=function(a){var b=this.renderPlugins.length;this.renderPlugins=this.renderPlugins.filter(c=>c!==a);n.assert(this.renderPlugins.length<b,"Removing non-added render plugin");for(b=0;b<this.slots.length;++b)this.slots[b]=this.slots[b].filter(c=>c!==a);a.uninitializeRenderContext();this.context.requestRender()};d.prepareRender=function(a,b){for(const c of this.renderPlugins)c.prepareRender&&c.prepareRender(a,b)};d.updateAnimation=function(a){let b=!1;this.renderPlugins.forEach(c=>{c.updateAnimation&&
(b=c.updateAnimation(a)||b)});return b};d.render=function(){const a=[];this.slots[this.context.renderContext.slot].filter(b=>{if(!b.canRender)return!1;if("prepareTechnique"in b)return(b=b.prepareTechnique(this.context.renderContext))?(a.push(b),!0):!1;a.push(null);return!0}).forEach((b,c)=>b.render(this.context.renderContext,a[c]))};d.queryDepthRange=function(a){const b=q;b.near=Infinity;b.far=-Infinity;for(const c of this.renderPlugins)if(c.queryDepthRange){const e=c.queryDepthRange(a);e&&m.union(b,
e,b)}return b};k._createClass(f,[{key:"needsTransparentPass",get:function(){return this.renderPlugins.some(a=>a.needsTransparentPass)}},{key:"needsHighlight",get:function(){return this.renderPlugins.some(a=>a.needsHighlight)}},{key:"needsLinearDepth",get:function(){return this.renderPlugins.some(a=>a.needsLinearDepth)}},{key:"needsLaserlineWithContrastControl",get:function(){const a=this.slots[h.RenderSlot.LASERLINES_CONTRAST_CONTROL];return!!a&&0<a.length}},{key:"renderOccludedFlags",get:function(){let a=
0;this.renderPlugins.forEach(b=>{b.renderOccludedFlags&&(a|=b.renderOccludedFlags)});return a}}]);return f}();const q={near:0,far:0};g.RenderPluginManager=r;Object.defineProperty(g,"__esModule",{value:!0})});