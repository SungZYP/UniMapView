// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../core/shaderLibrary/ShaderOutputOptions ../lib/AnimationTimer ../lib/GLMaterials ../lib/Material ../lib/OrderIndependentTransparency ../lib/RenderSlot ./WaterGLMaterial ./WaterTechnique ./internal/DefaultBufferWriter ./internal/MaterialUtil ./internal/waterMaterialUtils".split(" "),function(h,n,c,p,q,f,r,d,k,t,l,u,v){f=function(m){function g(a){a=m.call(this,a,v.defaultWaterMaterialParameters)||this;a._techniqueConfig=new t.WaterTechniqueConfiguration;
a.animation=new p.AnimationTimer;return a}n._inheritsLoose(g,m);var e=g.prototype;e.getTechniqueConfig=function(a,b){this._techniqueConfig.output=a;this._techniqueConfig.writeDepth=this.parameters.writeDepth;this._techniqueConfig.receiveShadows=this.parameters.receiveShadows;this._techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled;this._techniqueConfig.transparent=this.parameters.transparent;this._techniqueConfig.useSSR=this.parameters.ssrEnabled;this._techniqueConfig.isDraped=this.parameters.isDraped;
this._techniqueConfig.transparencyPassType=b.transparencyPassType;this._techniqueConfig.enableOffset=b.camera.relativeElevation<r.OITPolygonOffsetLimit;this._techniqueConfig.multipassTerrainEnabled=b.multipassTerrainEnabled;this._techniqueConfig.cullAboveGround=b.cullAboveGround;return this._techniqueConfig};e.update=function(a){this.animation.enabled=35E3>Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*Math.min(a.camera.relativeElevation,a.camera.distance);a=this.animation.advance(a);
return this.animation.enabled&&a};e.intersect=function(a,b,A,w,x,y,z){u.intersectTriangleGeometry(a,b,w,x,y,void 0,z)};e.requiresSlot=function(a,b){switch(q.outputFromPass(b)){case c.ShaderOutput.Normal:return a===d.RenderSlot.DRAPED_WATER;case c.ShaderOutput.Color:if(this.parameters.isDraped)return a===d.RenderSlot.DRAPED_MATERIAL;break;case c.ShaderOutput.Highlight:return a===d.RenderSlot.OPAQUE_MATERIAL||a===d.RenderSlot.DRAPED_MATERIAL}b=d.RenderSlot.OPAQUE_MATERIAL;this.parameters.transparent&&
(b=this.parameters.writeDepth?d.RenderSlot.TRANSPARENT_MATERIAL:d.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL);return a===b};e.createGLMaterial=function(a){if(a.output===c.ShaderOutput.Color&&this.parameters.isDraped)return a.output=c.ShaderOutput.Draped,new k.WaterGLMaterial(a);switch(a.output){case c.ShaderOutput.Color:case c.ShaderOutput.Normal:case c.ShaderOutput.Highlight:case c.ShaderOutput.Alpha:return new k.WaterGLMaterial(a)}return null};e.createBufferWriter=function(){return new l.DefaultBufferWriter(l.PositionUVLayout)};
return g}(f.Material);h.WaterMaterial=f;Object.defineProperty(h,"__esModule",{value:!0})});