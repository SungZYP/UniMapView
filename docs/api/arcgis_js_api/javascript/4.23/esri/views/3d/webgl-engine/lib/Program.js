// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../core/PooledArray","../../../webgl/checkWebGLError"],function(g,k,h,l,m){let p=function(){function e(a,b,d){this._context=a;this._locations=d;this._textures=new Map;this._freeTextureUnits=new l({deallocator:null});this._glProgram=a.programCache.acquire(b.generateSource("vertex"),b.generateSource("fragment"),d);this._glProgram.stop=()=>{throw Error("Wrapped _glProgram used directly");};this._fragmentUniforms=
m.webglDebugEnabled()?b.fragmentUniforms.entries:null}var c=e.prototype;c.dispose=function(){this._glProgram.dispose()};c.setUniform1b=function(a,b){this._glProgram.setUniform1i(a,b?1:0)};c.setUniform1i=function(a,b){this._glProgram.setUniform1i(a,b)};c.setUniform1f=function(a,b){this._glProgram.setUniform1f(a,b)};c.setUniform1fv=function(a,b){this._glProgram.setUniform1fv(a,b)};c.setUniform1iv=function(a,b){this._glProgram.setUniform1iv(a,b)};c.setUniform2f=function(a,b,d){this._glProgram.setUniform2f(a,
b,d)};c.setUniform2fv=function(a,b){this._glProgram.setUniform2fv(a,b)};c.setUniform2iv=function(a,b){this._glProgram.setUniform2iv(a,b)};c.setUniform3f=function(a,b,d,f){this._glProgram.setUniform3f(a,b,d,f)};c.setUniform3fv=function(a,b){this._glProgram.setUniform3fv(a,b)};c.setUniform3iv=function(a,b){this._glProgram.setUniform3iv(a,b)};c.setUniform4f=function(a,b,d,f,n){this._glProgram.setUniform4f(a,b,d,f,n)};c.setUniform4fv=function(a,b){this._glProgram.setUniform4fv(a,b)};c.setUniform4iv=function(a,
b){this._glProgram.setUniform4iv(a,b)};c.setUniformMatrix3fv=function(a,b){this._glProgram.setUniformMatrix3fv(a,b)};c.setUniformMatrix4fv=function(a,b){this._glProgram.setUniformMatrix4fv(a,b)};c.assertCompatibleVertexAttributeLocations=function(a){a.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")};c.stop=function(){this._textures.clear();this._freeTextureUnits.clear()};c.bindTexture=function(a,b){if(h.isNone(a)||null==a.glName){if(a=this._textures.get(b))this._context.bindTexture(null,
a.unit),this._freeTextureUnit(a),this._textures.delete(b);return null}let d=this._textures.get(b);null==d?(d=this._allocTextureUnit(a),this._textures.set(b,d)):d.texture=a;this._context.useProgram(this);this.setUniform1i(b,d.unit);this._context.bindTexture(a,d.unit);return d.unit};c.rebindTextures=function(){this._context.useProgram(this);this._textures.forEach((a,b)=>{this._context.bindTexture(a.texture,a.unit);this.setUniform1i(b,a.unit)});h.isSome(this._fragmentUniforms)&&this._fragmentUniforms.forEach(a=>
{if(("sampler2D"===a.type||"samplerCube"===a.type)&&!this._textures.has(a.name))throw Error(`Texture sampler ${a.name} has no bound texture`);})};c._allocTextureUnit=function(a){return{texture:a,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}};c._freeTextureUnit=function(a){this._freeTextureUnits.push(a.unit)};k._createClass(e,[{key:"glName",get:function(){return this._glProgram.glName}},{key:"isCompiled",get:function(){return this._glProgram.isCompiled}}]);
return e}();g.Program=p;Object.defineProperty(g,"__esModule",{value:!0})});