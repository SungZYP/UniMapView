// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutputOptions ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/MultipassGeometryTest.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/DefaultVertexAttributeLocations ../lib/OrderIndependentTransparency ../lib/Program ../../../../chunks/HUDMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(y,t,u,f,h,z,A,v,B,C,D,E,F,p,c,q,d,m,G,H,I,x,n,r){q=function(l){function k(){return l.apply(this,arguments)||this}u._inheritsLoose(k,l);var b=k.prototype;b.initializeProgram=function(g){var a=k.shader.get();const e=this.configuration;a=a.build({output:e.output,frontFacePass:e.transparencyPassType===m.TransparencyPassType.FrontFace,viewingMode:g.viewingMode,occlusionTestEnabled:e.occlusionTestEnabled,signedDistanceFieldEnabled:e.sdf,slicePlaneEnabled:e.slicePlaneEnabled,sliceHighlightDisabled:!1,
sliceEnabledForVertexPrograms:!0,debugDrawLabelBorder:e.debugDrawLabelBorder,binaryHighlightOcclusionEnabled:e.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:e.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:e.screenSizePerspective,verticalOffsetEnabled:e.verticalOffset,pixelSnappingEnabled:e.pixelSnappingEnabled,vvSize:e.vvSize,vvColor:e.vvColor,vvInstancingEnabled:!1,isDraped:e.isDraped,multipassGeometryEnabled:e.multipassGeometryEnabled,multipassTerrainEnabled:e.multipassTerrainEnabled,
cullAboveGround:e.cullAboveGround});return new I.Program(g.rctx,a,G.Default3D)};b.bindPass=function(g,a){p.bindProjectionMatrix(this.program,a.camera.projectionMatrix);this.program.setUniform1f("cameraGroundRelative",a.camera.aboveGround?1:-1);this.program.setUniform1f("perDistancePixelRatio",Math.tan(a.camera.fovY/2)/(a.camera.fullViewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",a.camera.viewInverseTransposeMatrix);this.program.setUniform1f("polygonOffset",g.shaderPolygonOffset);A.bindVerticalOffsetUniforms(this.program,
g,a);F.bindScreenSizePerspectiveUniforms(this.program,g);this.program.setUniform1f("pixelRatio",a.camera.pixelRatio||1);p.bindViewport(this.program,a);this.configuration.output===h.ShaderOutput.Occlusion?(this.program.setUniform2fv("nearFar",a.camera.nearFar),this.program.setUniform2fv("inverseViewport",a.inverseViewport),C.bindMultipassGeometryTexture(this.program,a),D.bindMultipassTerrainTexture(this.program,a)):(v.bindHUDUniforms(this.program,a),x.bindHUDMaterialUniforms(this.program,g,a.camera.pixelRatio||
1),E.bindVisualVariablesUniforms(this.program,g),this.configuration.occlusionTestEnabled&&this.program.bindTexture(a.hudVisibilityTexture,"hudVisibilityTexture"));this.configuration.output===h.ShaderOutput.Highlight&&B.bindOutputHighlight(this.program,a)};b.bindDraw=function(g){p.bindView(this.program,g);p.bindCameraPosition(this.program,g.origin,g.camera.viewInverseTransposeMatrix);z.bindSliceUniformsWithOrigin(this.program,this.configuration,g);this.program.rebindTextures()};b._setPipelineState=
function(g){const a=this.configuration,e=g===m.TransparencyPassType.NONE;var w=g===m.TransparencyPassType.FrontFace;const J=n.CompareFunction.LEQUAL,L=this.configuration.polygonOffsetEnabled&&K;w=(e||w)&&a.output!==h.ShaderOutput.Highlight?(a.depthEnabled||a.output===h.ShaderOutput.Occlusion)&&r.defaultDepthWriteParams:null;return r.makePipelineState({blending:a.output===h.ShaderOutput.Color||a.output===h.ShaderOutput.Alpha||a.output===h.ShaderOutput.Highlight?e?M:H.oitBlending(g):null,depthTest:{func:J},
depthWrite:w,colorWrite:r.defaultColorWriteParams,polygonOffset:L})};b.initializePipeline=function(){return this._setPipelineState(this.configuration.transparencyPassType)};u._createClass(k,[{key:"primitiveType",get:function(){return this.configuration.output===h.ShaderOutput.Occlusion?n.PrimitiveType.POINTS:n.PrimitiveType.TRIANGLES}}]);return k}(q.ShaderTechnique);q.shader=new c.ReloadableShaderModule(x.HUDMaterialShader,()=>new Promise((l,k)=>y(["./HUDMaterial.glsl"],l,k)));const K={factor:0,units:-4},
M=r.simpleBlendingParams(n.BlendFactor.ONE,n.BlendFactor.ONE_MINUS_SRC_ALPHA);c=function(l){function k(){var b=l.apply(this,arguments)||this;b.output=h.ShaderOutput.Color;b.occlusionTestEnabled=!0;b.sdf=!1;b.vvSize=!1;b.vvColor=!1;b.verticalOffset=!1;b.screenSizePerspective=!1;b.screenCenterOffsetUnitsEnabled=v.HUDSpace.World;b.debugDrawLabelBorder=!1;b.binaryHighlightOcclusion=!0;b.slicePlaneEnabled=!1;b.polygonOffsetEnabled=!1;b.depthEnabled=!0;b.transparencyPassType=m.TransparencyPassType.NONE;
b.pixelSnappingEnabled=!0;b.isDraped=!1;b.multipassGeometryEnabled=!1;b.multipassTerrainEnabled=!1;b.cullAboveGround=!1;return b}u._inheritsLoose(k,l);return k}(d.ShaderTechniqueConfiguration);f.__decorate([d.parameter({count:h.ShaderOutput.COUNT})],c.prototype,"output",void 0);f.__decorate([d.parameter()],c.prototype,"occlusionTestEnabled",void 0);f.__decorate([d.parameter()],c.prototype,"sdf",void 0);f.__decorate([d.parameter()],c.prototype,"vvSize",void 0);f.__decorate([d.parameter()],c.prototype,
"vvColor",void 0);f.__decorate([d.parameter()],c.prototype,"verticalOffset",void 0);f.__decorate([d.parameter()],c.prototype,"screenSizePerspective",void 0);f.__decorate([d.parameter({count:v.HUDSpace.COUNT})],c.prototype,"screenCenterOffsetUnitsEnabled",void 0);f.__decorate([d.parameter()],c.prototype,"debugDrawLabelBorder",void 0);f.__decorate([d.parameter()],c.prototype,"binaryHighlightOcclusion",void 0);f.__decorate([d.parameter()],c.prototype,"slicePlaneEnabled",void 0);f.__decorate([d.parameter()],
c.prototype,"polygonOffsetEnabled",void 0);f.__decorate([d.parameter()],c.prototype,"depthEnabled",void 0);f.__decorate([d.parameter({count:m.TransparencyPassType.COUNT})],c.prototype,"transparencyPassType",void 0);f.__decorate([d.parameter()],c.prototype,"pixelSnappingEnabled",void 0);f.__decorate([d.parameter()],c.prototype,"isDraped",void 0);f.__decorate([d.parameter()],c.prototype,"multipassGeometryEnabled",void 0);f.__decorate([d.parameter()],c.prototype,"multipassTerrainEnabled",void 0);f.__decorate([d.parameter()],
c.prototype,"cullAboveGround",void 0);t.HUDMaterialTechnique=q;t.HUDMaterialTechniqueConfiguration=c;Object.defineProperty(t,"__esModule",{value:!0})});