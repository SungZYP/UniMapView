// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutputOptions ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/DefaultVertexAttributeLocations ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../../../../chunks/ImageMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(y,r,v,g,n,z,A,w,e,p,f,l,B,q,C,t,D,x,m){p=function(k){function h(){return k.apply(this,arguments)||this}v._inheritsLoose(h,k);var a=h.prototype;a.initializeProgram=function(b){var c=h.shader.get();const d=this.configuration;c=c.build({output:d.output,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,oitEnabled:d.transparencyPassType===l.TransparencyPassType.Color,multipassTerrainEnabled:d.multipassTerrainEnabled,cullAboveGround:d.cullAboveGround});
return new C.Program(b.rctx,c,B.Default3D)};a.bindPass=function(b,c){w.bindProjectionMatrix(this.program,c.camera.projectionMatrix);this.program.setUniform1f("opacity",b.opacity);c.multipassTerrainEnabled&&(this.program.setUniform2fv("nearFar",c.camera.nearFar),this.program.setUniform2fv("inverseViewport",c.inverseViewport),A.bindMultipassTerrainTexture(this.program,c))};a.bindDraw=function(b){w.bindView(this.program,b);z.bindSliceUniformsWithOrigin(this.program,this.configuration,b);this.program.rebindTextures()};
a._setPipelineState=function(b,c){const d=this.configuration,u=b===l.TransparencyPassType.NONE,E=b===l.TransparencyPassType.FrontFace;return m.makePipelineState({blending:d.output!==n.ShaderOutput.Color&&d.output!==n.ShaderOutput.Alpha||!d.transparent?null:u?F:q.oitBlending(b),culling:m.cullingParams(d.cullFace),depthTest:{func:q.oitDepthTest(b)},depthWrite:u?d.writeDepth&&m.defaultDepthWriteParams:q.oitDepthWrite(b),colorWrite:m.defaultColorWriteParams,stencilWrite:d.sceneHasOcludees?t.stencilWriteMaskOn:
null,stencilTest:d.sceneHasOcludees?c?t.stencilToolMaskBaseParams:t.stencilBaseAllZerosParams:null,polygonOffset:u||E?null:q.getOITPolygonOffset(d.enableOffset)})};a.initializePipeline=function(){this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0);return this._setPipelineState(this.configuration.transparencyPassType,!1)};a.getPipelineState=function(b,c){return c?this._occludeePipelineState:k.prototype.getPipelineState.call(this,b,c)};return h}(p.ShaderTechnique);
p.shader=new e.ReloadableShaderModule(D.ImageMaterialShader,()=>new Promise((k,h)=>y(["./ImageMaterial.glsl"],k,h)));const F=m.simpleBlendingParams(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);e=function(k){function h(){var a=k.apply(this,arguments)||this;a.output=n.ShaderOutput.Color;a.cullFace=l.CullFaceOptions.None;a.slicePlaneEnabled=!1;a.transparent=!1;a.enableOffset=!0;a.writeDepth=!0;a.sceneHasOcludees=!1;a.transparencyPassType=l.TransparencyPassType.NONE;a.multipassTerrainEnabled=
!1;a.cullAboveGround=!1;return a}v._inheritsLoose(h,k);return h}(f.ShaderTechniqueConfiguration);g.__decorate([f.parameter({count:n.ShaderOutput.COUNT})],e.prototype,"output",void 0);g.__decorate([f.parameter({count:l.CullFaceOptions.COUNT})],e.prototype,"cullFace",void 0);g.__decorate([f.parameter()],e.prototype,"slicePlaneEnabled",void 0);g.__decorate([f.parameter()],e.prototype,"transparent",void 0);g.__decorate([f.parameter()],e.prototype,"enableOffset",void 0);g.__decorate([f.parameter()],e.prototype,
"writeDepth",void 0);g.__decorate([f.parameter()],e.prototype,"sceneHasOcludees",void 0);g.__decorate([f.parameter({count:l.TransparencyPassType.COUNT})],e.prototype,"transparencyPassType",void 0);g.__decorate([f.parameter()],e.prototype,"multipassTerrainEnabled",void 0);g.__decorate([f.parameter()],e.prototype,"cullAboveGround",void 0);r.ImageMaterialTechnique=p;r.ImageMaterialTechniqueConfiguration=e;Object.defineProperty(r,"__esModule",{value:!0})});