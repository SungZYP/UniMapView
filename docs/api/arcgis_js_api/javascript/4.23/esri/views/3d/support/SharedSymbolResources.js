// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../../../core/arrayUtils ../../../core/Handles ../../../geometry/projectionEllipsoid ./index ./StreamTextureCollection ../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl/enums".split(" "),function(e,l,m,n,p,q,f,g){let k=function(){function h(a){this.streamDataRequester=this.textures=null;this.graphicsOwners=[];this.cimSymbolRasterizer=this.screenSizePerspectiveHandles=null;this.viewState=a.viewState;this.view=a.view;this.pointsOfInterest=a.pointsOfInterest;this.objectResourceCache=
a.objectResourceCache;this.streamDataRequester=a.resourceController.createStreamDataRequester(p.ClientType.SYMBOLOGY);this.textures=new q.StreamTextureCollection(this.streamDataRequester,a.view._stage,{preMultiplyAlpha:!0,wrap:{s:g.TextureWrapMode.CLAMP_TO_EDGE,t:g.TextureWrapMode.CLAMP_TO_EDGE}},a.resourceController.scheduler);const b=n.getReferenceEllipsoid(this.view.spatialReference).radius;this.screenSizePerspectiveSettings=f.getSettings(a.viewingMode,b);this.screenSizePerspectiveSettingsLabels=
f.getLabelSettings(a.viewingMode,b)}var c=h.prototype;c.destroy=function(){this.textures.destroy();this.streamDataRequester=this.textures=null};c.addGraphicsOwner=function(a){if(!a)return{remove(){}};this.graphicsOwners.push(a);const b="layer"in a?a.watch("layer.screenSizePerspectiveEnabled",()=>this._updateScreenSizePerspectiveEnabled()):null;this._updateScreenSizePerspectiveEnabled();return{remove:()=>{b&&(b.remove(),l.removeUnordered(this.graphicsOwners,a),this._updateScreenSizePerspectiveEnabled())}}};
c._updateScreenSizePerspectiveEnabled=function(){var a=this.graphicsOwners.some(b=>!0===b.get("layer.screenSizePerspectiveEnabled"));a&&!this.screenSizePerspectiveHandles?(this.screenSizePerspectiveHandles=new m,a=()=>this._updateScreenSizePerspectiveSettings(),this.screenSizePerspectiveHandles.add([this.pointsOfInterest.centerOnSurfaceInfrequent.watch("distance",a,!0),this.viewState.events.on("camera-projection-changed",a)]),this._updateScreenSizePerspectiveSettings()):!a&&this.screenSizePerspectiveHandles&&
(this.screenSizePerspectiveHandles.destroy(),this.screenSizePerspectiveHandles=null)};c._updateScreenSizePerspectiveSettings=function(){d.distance=this.pointsOfInterest.centerOnSurfaceInfrequent.distance;d.fovY=this.viewState.camera.fovY;this.screenSizePerspectiveSettings.update(d);this.screenSizePerspectiveSettingsLabels.update(d);this.view._stage.renderView.requestRender()};return h}();const d={distance:0,fovY:0};e.SharedSymbolResources=k;e.default=k;Object.defineProperty(e,"__esModule",{value:!0})});