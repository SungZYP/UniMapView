// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/shading/MultipassGeometryTest.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/Program ../materials/internal/MaterialUtil ../../../../chunks/LineCallout.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(v,q,t,g,w,x,r,y,n,d,p,e,z,A,B,u,l,m){p=function(k){function f(){return k.apply(this,arguments)||this}t._inheritsLoose(f,k);var c=f.prototype;c.initializeProgram=function(b){var a=f.shader.get();const h=this.configuration;a=a.build({occlusionTestEnabled:h.occlusionTestEnabled,verticalOffsetEnabled:h.verticalOffset,screenSizePerspectiveEnabled:h.screenSizePerspective,depthHudEnabled:h.depthHudEnabled,depthHudAlignStartEnabled:h.depthHudAlignStartEnabled,screenCenterOffsetUnitsEnabled:h.screenCenterOffsetUnitsEnabled,
slicePlaneEnabled:h.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,viewingMode:b.viewingMode,isDraped:!1,multipassGeometryEnabled:h.multipassGeometryEnabled});return new A.Program(b.rctx,a,z.Default3D)};c.bindPass=function(b,a){n.bindProjectionMatrix(this.program,a.camera.projectionMatrix);u.bindLineCalloutUniforms(this.program,b,a.camera.pixelRatio||1);x.bindVerticalOffsetUniforms(this.program,b,a);r.bindHUDUniforms(this.program,a);this.program.setUniform2fv("nearFar",
a.camera.nearFar);this.program.setUniform2fv("inverseViewport",a.inverseViewport);y.bindMultipassGeometryTexture(this.program,a);this.program.bindTexture(a.hudVisibilityTexture,"hudVisibilityTexture");this.program.setUniform1f("cameraGroundRelative",a.camera.aboveGround?1:-1);this.program.setUniform1f("polygonOffset",b.shaderPolygonOffset);n.bindViewport(this.program,a);this.program.setUniform1f("perDistancePixelRatio",Math.tan(a.camera.fovY/2)/(a.camera.fullViewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",
a.camera.viewInverseTransposeMatrix);this.program.setUniform2f("pixelToNDC",2/a.camera.fullViewport[2],2/a.camera.fullViewport[3]);this.program.setUniform1f("lineSize",Math.ceil(b.size)*(a.camera.pixelRatio||1));B.bindScreenSizePerspective(b.screenSizePerspective,this.program,"screenSizePerspectiveAlignment")};c.bindDraw=function(b){n.bindView(this.program,b);n.bindCameraPosition(this.program,b.origin,b.camera.viewInverseTransposeMatrix);w.bindSliceUniformsWithOrigin(this.program,this.configuration,
b);this.program.rebindTextures()};c.setPipelineState=function(b){b=b?l.CompareFunction.ALWAYS:l.CompareFunction.LESS;return this.configuration.depthHudEnabled?m.makePipelineState({depthTest:{func:b},depthWrite:m.defaultDepthWriteParams}):m.makePipelineState({blending:m.separateBlendingParams(l.BlendFactor.ONE,l.BlendFactor.SRC_ALPHA,l.BlendFactor.ONE_MINUS_SRC_ALPHA,l.BlendFactor.ONE_MINUS_SRC_ALPHA),depthTest:{func:b},colorWrite:m.defaultColorWriteParams})};c.initializePipeline=function(){return this.setPipelineState(this.configuration.multipassGeometryEnabled)};
return f}(p.ShaderTechnique);p.shader=new d.ReloadableShaderModule(u.LineCalloutShader,()=>new Promise((k,f)=>v(["./LineCallout.glsl"],k,f)));d=function(k){function f(){var c=k.apply(this,arguments)||this;c.occlusionTestEnabled=!0;c.verticalOffset=!1;c.screenSizePerspective=!1;c.depthHudEnabled=!1;c.depthHudAlignStartEnabled=!1;c.screenCenterOffsetUnitsEnabled=r.HUDSpace.World;c.slicePlaneEnabled=!1;c.multipassGeometryEnabled=!1;return c}t._inheritsLoose(f,k);return f}(e.ShaderTechniqueConfiguration);
g.__decorate([e.parameter()],d.prototype,"occlusionTestEnabled",void 0);g.__decorate([e.parameter()],d.prototype,"verticalOffset",void 0);g.__decorate([e.parameter()],d.prototype,"screenSizePerspective",void 0);g.__decorate([e.parameter()],d.prototype,"depthHudEnabled",void 0);g.__decorate([e.parameter()],d.prototype,"depthHudAlignStartEnabled",void 0);g.__decorate([e.parameter({count:r.HUDSpace.COUNT})],d.prototype,"screenCenterOffsetUnitsEnabled",void 0);g.__decorate([e.parameter()],d.prototype,
"slicePlaneEnabled",void 0);g.__decorate([e.parameter()],d.prototype,"multipassGeometryEnabled",void 0);q.LineCalloutTechnique=p;q.LineCalloutTechniqueConfiguration=d;Object.defineProperty(q,"__esModule",{value:!0})});