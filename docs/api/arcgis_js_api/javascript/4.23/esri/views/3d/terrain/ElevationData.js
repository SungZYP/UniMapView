// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/mathUtils","../../../core/maybe","../support/mathUtils","./TerrainConst"],function(u,x,z,r,y){let A=function(){function p(a,c,d){this.type="elevation";this.samplerData=null;this.level=a[0];this.i=a[1];this.j=a[2];this.extent=c;a=d.noDataValue;const f=d.values;let b=Infinity,e=-Infinity,l=!0,k=!1;for(let g=0;g<f.length;g++){const h=f[g];h!==a?(b=h<b?h:b,e=h>e?h:e,l=!1):k=!0}l&&(e=b=0);this.samplerData={pixelData:d.values,width:d.width,height:d.height,noDataValue:a,
safeWidth:.99999999*(d.width-1),dx:(d.width-1)/(c[2]-c[0]),dy:(d.width-1)/(c[3]-c[1]),x0:c[0],y1:c[3]};this.bounds=[b,-3E38<e?e:0];this.hasNoDataValues=k}var t=p.prototype;t.release=function(){this.bounds=this.samplerData=null};t.computeMinMaxValue=function(a,c,d,f){f.min=Infinity;f.max=-Infinity;f.hasNoDataValues=!1;a-=this.level;if(0>=a)return f;var b=2**a;if(Math.floor(c/b)!==this.i||Math.floor(d/b)!==this.j)return f;var e=Infinity,l=-Infinity,k=this.samplerData.width,g=this.samplerData.pixelData,
h=.5*y.ELEVATION_NODATA_VALUE;a=(k-1)/b;d=(d-this.j*b)*a;let q=(c-this.i*b)*a;if(1>a){const v=Math.floor(d),w=Math.floor(q);var m=v+w*k;c=g[m];b=g[m+1];var n=g[m+k];m=g[m+k+1];if(c+b+n+m<h)return e=d-v,h=q-w,l=r.bilerp(c,b,n,m,e,h),k=r.bilerp(c,b,n,m,e+a,h),g=r.bilerp(c,b,n,m,e,h+a),a=r.bilerp(c,b,n,m,e+a,h+a),f.min=Math.min(l,k,g,a),f.max=Math.max(l,k,g,a),f;d=v;q=w;a=1}else d=Math.floor(d),q=Math.floor(q),a=Math.ceil(a);for(c=d;c<=d+a;c++)for(b=q;b<=q+a;b++)n=g[c+b*k],n<h?(e=Math.min(e,n),l=Math.max(l,
n)):f.hasNoDataValues=!0;f.min=e;f.max=l;return f};return p}();u.ElevationData=A;u.sampleElevation=function(p,t,a){if(z.isNone(a))return null;for(const e of a){if(!e)continue;var c=e.safeWidth;a=x.clamp(e.dy*(e.y1-t),0,c);c=x.clamp(e.dx*(p-e.x0),0,c);const l=Math.floor(a),k=Math.floor(c);var d=e.width,f=l*d+k,b=e.pixelData;const g=b[f],h=b[f+1];f+=d;d=b[f];b=b[f+1];if(g+d+h+b<.5*y.ELEVATION_NODATA_VALUE)return a-=l,c-=k,p=g+(h-g)*c,p+(d+(b-d)*c-p)*a}return null};Object.defineProperty(u,"__esModule",
{value:!0})});