// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Graphic ../intl ../core/Collection ../core/events ../core/Handles ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../rest/support/Stop ./Search ./Widget ./Directions/DirectionsViewModel ./Directions/support/directionsUtils ./Directions/support/resources ./Search/support/locatorUtils ./support/DatePicker ./support/Heading ./support/TimePicker ./support/decorators/accessibleHandler ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory ./support/widgetUtils ../chunks/sortable.esm ../intl/substitute ../intl/date ../intl/number".split(" "),
function(U,q,K,n,V,B,W,l,t,w,fa,ha,ia,y,X,Y,Z,aa,M,D,d,N,ba,z,ca,A,L,ja,e,ka,da,O,P,Q){function R(E){return!(null==E.composedPath||!E.composedPath().find(F=>{var f;return null==(f=F.classList)?void 0:f.contains("esri-search__suggestions-list")}))}n=function(E){function F(a,c){var b=E.call(this,a,c)||this;b._autoStopRemovalDelay=100;b._departureTime=d.DepartureTime.NOW;b._datePicker=new ba;b._handles=new W;b._newPlaceholderStop=null;b._pointerPressedSearchSuggestionStop=null;b._sections=null;b._stops=
new V([{},{}]);b._stopsToSearches=new Map;b._timePicker=new ca;b.apiKey=null;b.goToOverride=null;b.headingLevel=2;b.iconClass=d.CSS.widgetIcon;b.label=void 0;b.lastRoute=null;b.maxStops=null;b.messages=null;b.messagesCommon=null;b.messagesUnits=null;b.routeServiceUrl=void 0;b.routeSymbol=null;b.searchProperties=null;b.stopSymbols=null;b.view=null;b.viewModel=new M;b._setUpDragAndDropStops=g=>{b._sortable=da.Sortable.create(g,{draggable:`.${d.CSS.validStopRow}`,ghostClass:d.CSS.stopRowGhost,handle:`.${d.CSS.stopHandle}`,
onEnd:b._handleStopInputDragEnd})};b._handleDragHandlePointerDown=()=>b._stops.forEach(g=>b._acquireSearch(g).activeMenu="none");b._handleStopInputDragEnd=({oldIndex:g,newIndex:h,target:r})=>{if(g!==h){var {children:k}=r,m=k[g];r.insertBefore(k[h],0>h-g?m.nextElementSibling:m);r=b._stops;r.reorder(r.getItemAt(g),h);b._processStops()}};return b}U._inheritsLoose(F,E);var f=F.prototype;f.initialize=function(){this.own([t.watch(()=>this.viewModel.lastRoute,()=>{this._focusedManeuver=this._activeManeuver=
null;this._sections=this._getSections();this.scheduleRender()},t.initial),t.watch(()=>[this.viewModel.selectedTravelMode,this.viewModel.departureTime],()=>{1<this.viewModel.stops.length&&this.getDirections()},t.initial),t.when(()=>this.view,(a,c)=>{c&&(this._viewClickHandle=null,this._handles.remove(c));if(a){c=this._prepPointerDownUpClick();const b=this._prepViewClick();c.pause();b.pause();this._handles.add([B.on(a.surface,"mousedown",()=>this._autoStopRemovalDelay=500),B.on(a.surface,"mouseup",
()=>this._autoStopRemovalDelay=100),c,b],this.view.surface);this._pointerDownUpHandle=c;this._viewClickHandle=b}},t.initial),t.when(()=>0===this.viewModel.stops.length,()=>{this._stops.drain(a=>{this._disposeSearch(a)});this._stops.addMany([{},{}]);this.scheduleRender()}),t.when(()=>l.isNone(this.viewModel.serviceDescription),()=>{this.viewModel.load()},t.initial)])};f.destroy=function(){this._datePicker.destroy();this._timePicker.destroy();this._stopsToSearches.forEach(a=>a.destroy());this._sortable&&
this._sortable.destroy()};f.getDirections=function(){return null};f.zoomToRoute=function(){};f.render=function(){return e.tsx("div",{class:this.classes(d.CSS.base,d.CSS.scroller)},this._renderPanelContent())};f._renderPanelContent=function(){var {viewModel:{state:a}}=this,c="initializing"===a;const b="error"===a&&!this.viewModel.serviceDescription,g="unauthenticated"===a;a={[d.CSS.panelContentLoading]:c,[d.CSS.panelContentError]:b,[d.CSS.panelContentSignIn]:g};const h=c?"presentation":"group";c=g?
this._renderSignIn():b?this._renderMessage(this._getErrorMessage()):c?this._renderLoader():this._renderReadyContent();return e.tsx("div",{class:this.classes(d.CSS.panelContent,a),role:h},c)};f._renderReadyContent=function(){return[this._renderStopsContainer(),this._renderTravelModeOptions(),this._renderDepartureTimeControls(),this._renderSectionSplitter(),this._renderDirectionsContainer()]};f._renderSignIn=function(){return e.tsx("div",{key:"sign-in",class:d.CSS.signInContent},e.tsx(z.Heading,{class:d.CSS.contentTitle,
level:this.headingLevel},this.messages.widgetLabel),this._renderPlaceholder(),e.tsx(z.Heading,{level:z.incrementHeadingLevel(this.headingLevel)},this.messages.signInRequired),e.tsx("button",{class:this.classes(d.CSS.button,d.CSS.buttonSecondary,d.CSS.signInButton),tabIndex:0,onclick:this._handleSignInClick,bind:this,type:"button"},this.messagesCommon.auth.signIn))};f._handleSignInClick=function(){this.viewModel.load().catch(()=>{})};f._renderTravelModeOptions=function(){const {selectedTravelMode:a,
travelModes:c}=this.viewModel;if(0===c.length)return null;const b=l.isSome(a)?a.name:this.messages.travelMode;return e.tsx("select",{"aria-label":b,bind:this,class:this.classes(d.CSS.travelModeSelect,d.CSS.select),key:"esri-directions__travel-mode-options",onchange:this._handleTravelModeChange,title:b},c.map(g=>{const h=l.isSome(a)&&g.id===a.id;return e.tsx("option",{key:g,"data-mode":g,selected:h,value:g.id},g.name)}))};f._handleTravelModeChange=function(a){a=a.currentTarget;a=a.item(a.selectedIndex);
this.viewModel.selectedTravelMode=a["data-mode"]};f._renderStopsContainer=function(){return e.tsx("div",{class:d.CSS.section,key:"esri-directions__stops-container",role:"group"},this._renderStops())};f._renderDepartureTimeControls=function(){const a=this._departureTime,{messages:c}=this,b=c.departureTime;return e.tsx("div",{class:d.CSS.departureTime,key:"esri-directions__departure-time-controls",role:"group"},e.tsx("select",{"aria-label":b,bind:this,class:this.classes(d.CSS.departureTimeSelect,d.CSS.select),
onchange:this._handleDepartureOptionChange,title:b},e.tsx("option",{value:d.DepartureTime.NOW,selected:a===d.DepartureTime.NOW},c.leaveNow),e.tsx("option",{value:d.DepartureTime.DEPART_BY,selected:a===d.DepartureTime.DEPART_BY},c.departBy),e.tsx("option",{value:d.DepartureTime.UNSPECIFIED,selected:a===d.DepartureTime.UNSPECIFIED},c.timeUnspecified)),a===d.DepartureTime.DEPART_BY?this._renderTimeControls():null)};f._renderStops=function(){const a=this._stops;let c=0;a.forEach(k=>{"none"!==this._acquireSearch(k).activeMenu&&
(c+=1)});const b=a.toArray().map((k,m)=>{var p=a.length,u=1<m&&!k.result;const x={[d.CSS.stopsIcon]:0<=m&&m<p-1,[d.CSS.lastStopIcon]:m===p-1},H={[d.CSS.lastStopIconContainer]:m===p-1},I={[d.CSS.validStopRow]:!u};var v=a.getItemAt(p-1),C=v&&v.result;v=(v=a.getItemAt(m+1))&&v.result;var G=m===p-1,J=m===p-2;v=2===p&&0===m||2<p&&!G&&!J||2<p&&J&&v||2<p&&G&&!k.result;p=2===p||3===p&&!C||u;u=this._acquireSearch(k);({messages:C}=this);const {removeStop:S,reverseStops:T,unlocated:ea}=C;C=O.substitute(C.stopLabelTemplate,
{number:m+1,label:k.result?k.result.name:ea});G=`${this.id}__stop--${m}`;k=!!u.searchTerm&&!!u.selectedResult&&!!k.result&&u.selectedResult===k.result;J={zIndex:"none"!==u.activeMenu?`${c--}`:""};return e.tsx("li",{"aria-label":C,afterCreate:this._handleStopFieldCreation,bind:this,class:this.classes(d.CSS.stopRow,I),id:G,key:m,"data-stop-index":m,styles:J},e.tsx("div",{class:d.CSS.stopHandle},e.tsx("span",{"aria-hidden":"true",class:this.classes(d.CSS.stopIcon,d.CSS.handleIcon,d.CSS.stopHandleIcon,
d.CSS.interactiveStopIcon),onpointerdown:this._handleDragHandlePointerDown}),e.tsx("div",{bind:this,"aria-labelledby":G,class:this.classes(d.CSS.stopIconContainer,H),"data-stop-index":m,onclick:this._handleStopIconClick,onkeydown:this._handleStopIconClick,role:"button"},e.tsx("span",{class:this.classes(d.CSS.stopIcon,x),tabindex:k?"0":null}))),e.tsx("div",{class:d.CSS.stopInput},u.render()),e.tsx("div",{class:d.CSS.stopOptions,role:"group"},e.tsx("div",{"aria-label":S,class:d.CSS.removeStopButton,
bind:this,"data-stop-index":m,hidden:p,onkeydown:this._handleRemoveStop,onclick:this._handleRemoveStop,role:"button",tabIndex:0,title:S},e.tsx("span",{"aria-hidden":"true",class:this.classes(d.CSS.stopIcon,d.CSS.removeStop,d.CSS.removeStopIcon,d.CSS.interactiveStopIcon)}),e.tsx("span",{class:d.CSS.screenReaderText},"removeStopTitle")),e.tsx("div",{"aria-label":T,class:d.CSS.reverseStops,bind:this,hidden:v,onkeydown:this._handleReverseStops,onclick:this._handleReverseStops,role:"button",tabIndex:0,
title:T},e.tsx("span",{"aria-hidden":"true",class:this.classes(d.CSS.stopIcon,d.CSS.reverseStopIcon,d.CSS.interactiveStopIcon)}),e.tsx("span",{class:d.CSS.screenReaderText},"removeStopTitle"))))});var g=a.every(k=>{const m=this._stopsToSearches.get(k);return k.result&&m.selectedResult===k.result});const h=this._stops.length>=this.maxStops,r=this.messages.addStop;g=2<=a.length&&g&&!h?e.tsx("div",{"aria-label":r,bind:this,class:d.CSS.addStop,key:"esri-directions__add-stop",onfocus:this._handleAddStopFocus,
tabIndex:0},e.tsx("span",{"aria-hidden":"true",class:this.classes(d.CSS.addStopIcon,d.CSS.stopIcon,d.CSS.interactiveStopIcon)}),e.tsx("div",{"aria-hidden":"true",class:d.CSS.addStopText},r)):null;return e.tsx("div",null,e.tsx("ol",{class:d.CSS.stops,role:"group",afterCreate:this._setUpDragAndDropStops},b),g)};f._handleStopIconClick=function(a){(a=this._stops.getItemAt(a.currentTarget["data-stop-index"]))&&a.result&&this._centerAtStop(a)};f._handleClearRouteClick=function(){this.viewModel.reset()};
f._centerAtStop=function(a){this.viewModel.centerAt(a.result.feature)};f._handleStopFieldCreation=function(a){const c=this._newPlaceholderStop;if(c){a=this._stops.getItemAt(a["data-stop-index"]);if(c===a){const b=this._acquireSearch(a);b.when(()=>{this.renderNow();b.focus()})}this._newPlaceholderStop=null}};f._handleStopInputBlur=function(a,c){this._handles.remove("awaiting-view-click-stop");this.view.cursor=this._previousCursor;a.selectedResult&&c.result&&a.selectedResult===c.result?this._pointerDownUpHandle.pause():
"none"!==a.activeMenu||!a.searchTerm||a.selectedResult===c.result&&(a.selectedResult||c.result)?a.searchTerm||(this._viewClickHandle.resume(),clearTimeout(this._autoStopRemovalTimeoutId),this._autoStopRemovalTimeoutId=setTimeout(()=>{this.destroyed||(this._viewClickHandle.pause(),"searching"===a.viewModel.state?this._pointerDownUpHandle.pause():this._pointerPressedSearchSuggestionStop||(c.result&&(c.result=null,this._processStops()),this.scheduleRender()))},this._autoStopRemovalDelay)):(a.search(),
this._pointerDownUpHandle.pause())};f._handleStopInputFocus=function(a,c){this._pointerDownUpHandle.resume();if(!this._handles.has("awaiting-view-click-stop")){var {view:b,view:{cursor:g}}=this;this._previousCursor=g;this._handles.add(t.watch(()=>a.searchTerm,h=>{b.cursor=0===h.length?"copy":g},t.initial),"awaiting-view-click-stop");this._activeStop=c}};f._prepViewClick=function(){const {view:a}=this.viewModel,c=B.pausable(a,"click",this._handleViewClick.bind(this)),b=B.pausable(a.surface,"click",
()=>{clearTimeout(this._autoStopRemovalTimeoutId);b.pause()});return{remove(){b.remove();c.remove()},pause(){b.pause();c.pause()},resume(){b.resume();c.resume()}}};f._prepPointerDownUpClick=function(){const a=B.pausable(document,"pointerdown",b=>{this._pointerPressedSearchSuggestionStop=R(b)?this._activeStop:null}),c=B.pausable(document,"pointerup",b=>{this._pointerDownUpHandle.pause();b=R(b);const g=this._activeStop;b||g!==this._pointerPressedSearchSuggestionStop||this._removeStop(g);this.scheduleRender();
this._pointerPressedSearchSuggestionStop=b?this._activeStop:null});return{remove(){c.remove();a.remove()},pause(){c.pause();a.pause()},resume(){a.resume()}}};f._handleViewClick=function(a){const c=this._stopsToSearches.get(this._activeStop);c&&!c.searchTerm&&(c.search(a.mapPoint).then(b=>{b=b.results[0].results[0];const g=this._activeStop;g.result=b;g.result.feature.attributes.Name=b.name;c.searchTerm=b.name}),this.scheduleRender());this._viewClickHandle.pause();clearTimeout(this._autoStopRemovalTimeoutId)};
f._handleAddStopFocus=function(){this._addNewPlaceholder()};f._addNewPlaceholder=function(){this._pointerDownUpHandle.pause();if(!this._newPlaceholderStop){var a={};this._stops.add(a);this._newPlaceholderStop=a}};f._handleReverseStops=function(){this._reverseStops()};f._reverseStops=function(){this._stops.reverse();this._processStops()};f._handleRemoveStop=function(a){this._removeStop(this._stops.getItemAt(a.currentTarget["data-stop-index"]));this._processStops()};f._removeStop=function(a){2>=this._stops.length||
(this._disposeSearch(a),this._stops.remove(a))};f._handleDepartureOptionChange=function(a){a=a.currentTarget;a=a.item(a.selectedIndex);a.value===d.DepartureTime.NOW?(this._departureTime=d.DepartureTime.NOW,this.viewModel.departureTime=d.DepartureTime.NOW,this._handles.remove("departure-time-controls")):a.value===d.DepartureTime.DEPART_BY?(this._departureTime=d.DepartureTime.DEPART_BY,this._handles.add([t.watch(()=>this._datePicker.value,()=>this._updateDepartureTime(),t.initial),t.watch(()=>this._timePicker.value,
()=>this._updateDepartureTime(),t.initial)],"departure-time-controls")):(this._departureTime=d.DepartureTime.UNSPECIFIED,this.viewModel.departureTime=null)};f._updateDepartureTime=function(){const a=this._datePicker.value,c=this._timePicker.value;a&&c&&(this.viewModel.departureTime=new Date(a.getFullYear(),a.getMonth(),a.getDate(),c.getHours(),c.getMinutes()))};f._renderTimeControls=function(){return e.tsx("div",{class:d.CSS.departureTimeControls,key:"esri-directions__time-controls",role:"group"},
this._datePicker.render(),this._timePicker.render())};f._renderSectionSplitter=function(){return e.tsx("div",{class:d.CSS.sectionSplitter})};f._renderDirectionsContainer=function(){return e.tsx("div",{class:this.classes(d.CSS.directionsSection,d.CSS.section),key:"esri-directions__container"},this._renderDirectionsContainerContent())};f._renderLoader=function(){return e.tsx("div",{class:d.CSS.loader,key:"loader"})};f._renderWarningCard=function(){return e.tsx("div",{class:d.CSS.warningCard,role:"alert"},
e.tsx("div",{class:d.CSS.warningHeader},e.tsx("span",{class:d.CSS.warningIcon,"aria-hidden":"true"}),e.tsx(z.Heading,{class:d.CSS.warningHeading,level:this.headingLevel},this.messagesCommon.warning)),e.tsx("div",{class:d.CSS.warningMessage},this._getErrorMessage()))};f._renderDirectionsContainerContent=function(){const {lastRoute:a,viewModel:{state:c}}=this,b="routing"===c;return"error"===c?this._renderWarningCard():b?this._renderLoader():l.isSome(a)&&l.isSome(a.directionLines)?e.tsx("div",{class:d.CSS.summary,
key:"esri-directions__summary",role:"group"},this._renderCosts(),this._renderRouteActions(),this._renderManeuverSections()):e.tsx("div",{key:"esri-directions__placeholder",class:d.CSS.emptyContent},this._renderPlaceholder(),e.tsx(z.Heading,{class:d.CSS.message,level:this.headingLevel},this.messages.directionsPlaceholder))};f._renderPlaceholder=function(){return e.tsx("svg",{class:d.CSS.emptyIllustration,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256"},e.tsx("path",{fill:"currentcolor",d:"M192 36c-15.477 0-24 6.034-24 16.99v45.822l24 24 24-24v-45.82C216 42.033 207.477 36 192 36zm20 61.155l-20 20-20-20V52.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM192 52a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zM92 140.99C92 130.035 83.477 124 68 124s-24 6.034-24 16.99v45.822l24 24 24-24zm-4 44.165l-20 20-20-20V140.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM68 140a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zm84-44h16v4h-16zm-24 80h4v12h-12v-4h8zm0-28h4v16h-4zm0-52h12v4h-8v8h-4zm0 24h4v16h-4zm-36 64h16v4H92z"}))};
f._renderMessage=function(a){return e.tsx(z.Heading,{level:this.headingLevel},a)};f._renderRouteActions=function(){return e.tsx("div",{class:d.CSS.routeActions},e.tsx("button",{"aria-label":this.messages.clearRoute,class:this.classes(d.CSS.clearRouteButton,d.CSS.button,d.CSS.buttonTertiary),tabIndex:0,onclick:this._handleClearRouteClick,bind:this,type:"button"},this.messages.clearRoute))};f._getSections=function(){if(l.isNone(this.lastRoute))return null;const {directionPoints:a,directionLines:c,stops:b}=
this.lastRoute;if(l.isNone(a)||l.isNone(c))return null;const g=[];let h=null;for(const k of a){const {objectId:m,stopId:p}=k;if(l.isSome(p)){var r=b.find(x=>x.objectId===p);const u=0===g.length;if(l.isNone(h)||h.stop!==r)h={stop:r,directions:[],open:u},g.push(h)}else l.isNone(h)||(r=c.find(u=>u.directionPointId===m),l.isNone(r)||h.directions.push({directionPoint:k,directionLine:r}))}return g};f._renderManeuverSections=function(){return l.isNone(this._sections)?null:e.tsx("div",{class:d.CSS.maneuvers,
role:"group"},this._sections.map((a,c)=>{const {open:b}=a;let g;0<a.directions.length&&b&&(g=e.tsx("ol",{class:d.CSS.maneuverList},a.directions.map(p=>this._renderManeuver(p))));var h=2<l.unwrap(this._sections).length;const r=c===l.unwrap(this._sections).length-1,k={[d.CSS.collapsibleSection]:h},m={[d.CSS.openIcon]:!b,[d.CSS.closeIcon]:b};h&&!r?(h=b?this.messagesCommon.open:this.messagesCommon.close,a=e.tsx("header",{class:this.classes(d.CSS.maneuverSectionHeader,d.CSS.maneuverSectionToggle),key:"esri-directions__maneuver-section-header"},
e.tsx("div",{"aria-expanded":b.toString(),"aria-label":h,bind:this,class:d.CSS.maneuverSectionHeaderButton,"data-maneuver-section":a,onkeydown:this._handleSectionToggle,onclick:this._handleSectionToggle,role:"button",tabIndex:0,title:h},e.tsx(z.Heading,{class:d.CSS.maneuverSectionTitle,level:this.headingLevel},a.stop.name),e.tsx("span",{"aria-hidden":"true",class:this.classes(m)})))):a=e.tsx("header",{class:d.CSS.maneuverSectionHeader,key:"esri-directions__maneuver-section-header"},e.tsx(z.Heading,
{class:d.CSS.maneuverSectionTitle,level:this.headingLevel},a.stop.name));return e.tsx("section",{class:this.classes(d.CSS.maneuverSection,k),key:c},a,g)}))};f._handleSectionToggle=function(a){a=a.currentTarget["data-maneuver-section"];a.open=!a.open};f._renderCosts=function(){var {lastRoute:a}=this;if(l.isNone(a))return null;var c=this._getCostSummary();({directionPoints:a}=a);if(l.isNone(a)||l.isNone(c))return null;a=a.getItemAt(a.length-1).arrivalTime;const {primary:b,secondary:g}=c,{eta:h,etaTemplate:r,
primaryCosts:k,secondaryCosts:m,zoomToRoute:p}=this.messages;c=P.convertDateFormatToIntlOptions("short-time");c=l.isSome(a)?`<strong>${P.formatDate(a,c)}</strong>`:null;if(l.isSome(a)){{a=a.getTimezoneOffset();const u=Math.abs(Math.floor(a)%60),x={minimumIntegerDigits:2};a=`GMT${0<a?"-":"+"}${Q.formatNumber(Math.abs(Math.floor(a/60)),x)}${Q.formatNumber(u,x)}`}a=`${a}`}else a=null;c=O.substitute(r,{time:c,gmt:a});return e.tsx("div",{"aria-label":p,bind:this,class:d.CSS.directionCosts,onkeydown:this._handleSummaryInteraction,
onclick:this._handleSummaryInteraction,role:"button",tabIndex:0,title:p},e.tsx("div",{class:d.CSS.costsDetails,role:"group"},e.tsx("div",{"aria-label":k,class:d.CSS.primaryCosts,title:k},b),e.tsx("div",{class:d.CSS.verticalSplitter}),e.tsx("div",{"aria-label":m,class:d.CSS.secondaryCosts,title:m},g)),e.tsx("div",{"aria-label":h,innerHTML:c,title:h}))};f._handleSummaryInteraction=function(){this._focusedManeuver=this._activeManeuver=null;this.viewModel.clearHighlights();this.zoomToRoute()};f._getErrorMessage=
function(){const {messages:a,viewModel:{error:c}}=this;if(l.isSome(c))switch(c.name){case "directions-view-model:unable-to-route":return a.errors.unableToRoute;case "directions-view-model:service-metadata-unavailable":return a.errors.unableToLoadServiceMetadata}return a.errors.unknownError};f._normalizeSearchSources=function(a){this._overrideDefaultSources(a);this._applyLocatorSourceOverrides(a)};f._overrideDefaultSources=function(a){a.viewModel.defaultSources.forEach(c=>{c.autoNavigate=!1})};f._applyLocatorSourceOverrides=
function({allSources:a}){0!==a.length&&a.forEach(c=>{"url"in c&&c.url&&(null===c.locationType&&(c.locationType="street"),N.isArcGISWorldGeocoder(c.url)&&this.apiKey&&null==c.apiKey&&(c.apiKey=this.apiKey,c.url=N.meteredArcGISLocatorUrl))})};f._acquireSearch=function(a){const c=this.get("viewModel.view");if(this._stopsToSearches.has(a)){const g=this._stopsToSearches.get(a);g.view=c;this._overrideDefaultSources(g);return g}const b=new Z({view:c,resultGraphicEnabled:!1,popupEnabled:!1,...this.searchProperties});
this._normalizeSearchSources(b);this._handles.add([t.on(()=>b.allSources,"change",()=>this._normalizeSearchSources(b)),b.on("select-result",()=>{a.result=b.selectedResult;a.result.feature.attributes.Name=b.selectedResult.name;this._processStops();this.scheduleRender()}),b.on("search-focus",()=>this._handleStopInputFocus(b,a)),b.on("search-blur",()=>this._handleStopInputBlur(b,a))],b);this._stopsToSearches.set(a,b);return b};f._disposeSearch=function(a){this._stopsToSearches.get(a).destroy();this._stopsToSearches.delete(a)};
f._processStops=function(){const a=this._stops.filter(c=>!!c.result).map(c=>Y.fromJSON(c.result.feature.toJSON()));this.viewModel.stops=a;1<a.length&&this.getDirections()};f._renderManeuver=function(a){var {directionsLengthUnits:c}=this.viewModel.routeParameters;const {directionPoint:b,directionLine:g}=a,{distance:h,duration:r}=g,{messages:k,messagesUnits:m}=this;a=D.formatDistance(k,m,l.unwrapOrValue(h,0),{fromUnits:"meters",toUnits:c});c=D.formatTime(l.unwrapOrValue(r,0),"minutes");a=a&&c?`${a}&nbsp;&middot;&nbsp;${c}`:
`${a}${c}`;c=this._getFormattedManeuverText(b);const {objectId:p,directionPointType:u}=b,x=d.getIconPath(u),H=`esri-directions__maneuver-${p}`,I=`esri-directions__cumulative-costs-${p}`,v=`esri-directions__intermediate-costs-${p}`;return e.tsx("li",{"aria-labelledby":`${H} ${I} ${v}`,bind:this,class:this.classes(d.CSS.maneuver,{[d.CSS.maneuverActive]:this._activeManeuver===g}),"data-maneuver":g,key:g,onclick:this._handleManeuverClick,onkeydown:this._handleManeuverClick,onfocus:this._handleManeuverFocus,
onmouseover:this._handleManeuverMouseOver,onmouseout:this._handleManeuverMouseOut,onblur:this._handleManeuverBlur,tabIndex:0},l.isSome(x)&&e.tsx("img",{alt:"",class:d.CSS.maneuverIcon,src:x}),e.tsx("div",{class:d.CSS.maneuverCostsContainer},e.tsx("span",{id:H,innerHTML:l.unwrapOrValue(c,"")}),e.tsx("div",{class:d.CSS.maneuverCosts},e.tsx("div",{class:d.CSS.horizontalSplitter}),e.tsx("div",{id:I,"aria-label":k.cumulativeCosts,class:d.CSS.cumulativeCost,innerHTML:"",title:k.cumulativeCosts}),e.tsx("div",
{id:v,"aria-label":k.intermediateCosts,class:d.CSS.intermediateCost,innerHTML:a,title:k.intermediateCosts}))))};f._handleManeuverClick=function(a){a=a.currentTarget["data-maneuver"];if(this._activeManeuver===a)this._activeManeuver=null,this.zoomToRoute();else{this._activeManeuver=a;var {geometry:c,symbol:b}=a;a=new K({geometry:c,symbol:b});this.viewModel.centerAt(a);this.viewModel.highlightSegment(a)}};f._handleManeuverMouseOver=function(a){if(!this._activeManeuver&&!this._focusedManeuver){var {geometry:c,
symbol:b}=a.currentTarget["data-maneuver"];a=new K({geometry:c,symbol:b});this.viewModel.highlightSegment(a)}};f._handleManeuverMouseOut=function(){this._activeManeuver||this._focusedManeuver||this.viewModel.clearHighlights()};f._handleManeuverBlur=function(){this._activeManeuver||(this._focusedManeuver=null,this.viewModel.clearHighlights())};f._handleManeuverFocus=function(a){if(!this._activeManeuver){this._focusedManeuver=a=a.currentTarget["data-maneuver"];var {geometry:c,symbol:b}=a;a=new K({geometry:c,
symbol:b});this.viewModel.highlightSegment(a)}};f._getFormattedManeuverText=function(a){const {displayText:c,name:b,intersectingName:g}=a;if(l.isNone(c))return"";a=c;l.isSome(b)&&a.includes(b)&&(a=a.replace(b,`<strong>${b}</strong>`));l.isSome(g)&&a.includes(g)&&(a=a.replace(g,`<strong>${g}</strong>`));return a};f._getCostSummary=function(){const {viewModel:{impedanceAttribute:a,routeParameters:c},lastRoute:b}=this;if(l.isNone(a)||l.isNone(b))return null;var {routeInfo:g}=b;let {totalDuration:h,totalDistance:r}=
g;({directionsLengthUnits:g}=c);r=l.isSome(r)?r:0;h=l.isSome(h)?h:0;g=D.formatDistance(this.messages,this.messagesUnits,r,{fromUnits:"meters",toUnits:g});const k=D.formatTime(h,"minutes"),[m,p]=D.isTimeUnits(a.units)?[k,g]:[g,k];return{primary:m,secondary:p}};return F}(aa);q.__decorate([w.aliasOf("viewModel.apiKey")],n.prototype,"apiKey",void 0);q.__decorate([w.aliasOf("viewModel.goToOverride")],n.prototype,"goToOverride",void 0);q.__decorate([y.property()],n.prototype,"headingLevel",void 0);q.__decorate([y.property()],
n.prototype,"iconClass",void 0);q.__decorate([y.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],n.prototype,"label",void 0);q.__decorate([w.aliasOf("viewModel.lastRoute")],n.prototype,"lastRoute",void 0);q.__decorate([w.aliasOf("viewModel.maxStops")],n.prototype,"maxStops",void 0);q.__decorate([y.property(),L.messageBundle("esri/widgets/Directions/t9n/Directions")],n.prototype,"messages",void 0);q.__decorate([y.property(),L.messageBundle("esri/t9n/common")],n.prototype,"messagesCommon",
void 0);q.__decorate([y.property(),L.messageBundle("esri/core/t9n/Units")],n.prototype,"messagesUnits",void 0);q.__decorate([w.aliasOf("viewModel.routeServiceUrl")],n.prototype,"routeServiceUrl",void 0);q.__decorate([w.aliasOf("viewModel.routeSymbol")],n.prototype,"routeSymbol",void 0);q.__decorate([y.property()],n.prototype,"searchProperties",void 0);q.__decorate([w.aliasOf("viewModel.stopSymbols")],n.prototype,"stopSymbols",void 0);q.__decorate([w.aliasOf("viewModel.view")],n.prototype,"view",void 0);
q.__decorate([y.property({type:M})],n.prototype,"viewModel",void 0);q.__decorate([w.aliasOf("viewModel.getDirections")],n.prototype,"getDirections",null);q.__decorate([w.aliasOf("viewModel.zoomToRoute")],n.prototype,"zoomToRoute",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleStopIconClick",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleClearRouteClick",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleReverseStops",null);q.__decorate([A.accessibleHandler()],
n.prototype,"_handleRemoveStop",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleSectionToggle",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleSummaryInteraction",null);q.__decorate([A.accessibleHandler()],n.prototype,"_handleManeuverClick",null);return n=q.__decorate([X.subclass("esri.widgets.Directions")],n)});