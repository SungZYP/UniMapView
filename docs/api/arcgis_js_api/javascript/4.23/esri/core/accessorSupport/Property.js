// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define(["exports","./PropertyOrigin","./tracking","./tracking/Flags","./tracking/ObservationHandle"],function(h,m,f,d,n){let p=function(){function k(a,b,c){this.properties=a;this.propertyName=b;this.metadata=c;this._handles=this._accessed=this._observers=null;this.flags=d.Flags.Dirty|(c.nonNullable?d.Flags.NonNullable:0)|(c.hasOwnProperty("value")?d.Flags.HasDefaultValue:0)|(void 0===c.get?d.Flags.DepTrackingInitialized:0)|(void 0===c.dependsOn?d.Flags.AutoTracked:0)}var e=k.prototype;e.destroy=function(){this._observers=
this._accessed=null;this._clearObservationHandles()};e.getComputed=function(){f.trackAccess(this);var a=this.properties.store;const b=this.propertyName;var c=this.flags;const l=a.get(b);if(c&d.Flags.Computing||~c&d.Flags.Dirty&&a.has(b))return l;this.flags|=d.Flags.Computing;const g=this.properties.host;c&d.Flags.AutoTracked?c=f.runTracked(this,this.metadata.get,g):(f.trackExplicitDependencies(g,this),c=this.metadata.get.call(g));a.set(b,c,m.OriginId.COMPUTED);a=a.get(b);a===l?this.flags&=~d.Flags.Dirty:
f.runUntracked(this.commit,this);this.flags&=~d.Flags.Computing;return a};e.onObservableAccessed=function(a){a!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(a)||this._accessed.push(a))};e.onTrackingEnd=function(){this._clearObservationHandles();this.flags|=d.Flags.DepTrackingInitialized;const a=this._accessed;if(null!==a){var b=this._handles;null===b&&(b=this._handles=[]);for(let c=0;c<a.length;++c)b.push(a[c].observe(this));a.length=0}};e.observe=function(a){null===
this._observers&&(this._observers=[]);this._observers.includes(a)||this._observers.push(a);return new n.ObservationHandle(this._observers,a)};e.notifyChange=function(){this.onInvalidated();this.onCommitted()};e.invalidate=function(){this.onInvalidated()};e.onInvalidated=function(){~this.flags&d.Flags.Overriden&&(this.flags|=d.Flags.Dirty);const a=this._observers;if(null!==a)for(let b=0;b<a.length;++b)a[b].onInvalidated()};e.commit=function(){this.flags&=~d.Flags.Dirty;this.onCommitted()};e.onCommitted=
function(){if(null!==this._observers){var a=this._observers.slice();for(let b=0;b<a.length;++b)a[b].onCommitted()}};e._clearObservationHandles=function(){const a=this._handles;if(null!==a){for(let b=0;b<a.length;++b)a[b].remove();a.length=0}};return k}();h.Property=p;Object.defineProperty(h,"__esModule",{value:!0})});