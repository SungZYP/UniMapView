// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ./componentsUtils ./dom ./array2 ./guid ./observers ./conditionalSlot ./action ./icon ./loader ./popover ./tooltip-manager".split(" "),function(h,f,l,n,u,v,p,w,x,y,z,A){function q(){"undefined"!==typeof customElements&&"calcite-action-menu calcite-action calcite-icon calcite-loader calcite-popover calcite-tooltip-manager".split(" ").forEach(a=>{switch(a){case "calcite-action-menu":customElements.get(a)||customElements.define(a,h.ActionMenu);break;case "calcite-action":customElements.get(a)||
w.defineCustomElement();break;case "calcite-icon":customElements.get(a)||x.defineCustomElement();break;case "calcite-loader":customElements.get(a)||y.defineCustomElement();break;case "calcite-popover":customElements.get(a)||z.defineCustomElement();break;case "calcite-tooltip-manager":customElements.get(a)||A.defineCustomElement()}})}const k={tooltip:"tooltip",trigger:"trigger"},r=["ArrowUp","ArrowDown"],t=["ArrowUp","ArrowDown","End","Home"];h.ActionMenu=class extends f.H{constructor(){super();this.__registerHost();
this.__attachShadow();this.calciteActionMenuOpenChange=f.createEvent(this,"calciteActionMenuOpenChange",7);this.open=this.expanded=!1;this.overlayPositioning="absolute";this.placement="auto";this.actionElements=[];this.mutationObserver=v.createObserver("mutation",()=>this.getActions());this.guid=`calcite-action-menu-${u.guid()}`;this.menuId=`${this.guid}-menu`;this.menuButtonId=`${this.guid}-menu-button`;this.activeMenuItemIndex=-1;this.connectMenuButtonEl=()=>{const {el:a,menuButtonId:b,menuId:c,
open:d,label:g}=this,e=l.getSlotted(a,k.trigger)||this.defaultMenuButtonEl;this.menuButtonEl!==e&&(this.disconnectMenuButtonEl(),this.menuButtonEl=e,this.setTooltipReferenceElement(),e&&(e.active=d,e.setAttribute("aria-controls",c),e.setAttribute("aria-expanded",d.toString()),e.setAttribute("aria-haspopup","true"),e.id||(e.id=b),e.label||(e.label=g),e.text||(e.text=g),e.addEventListener("click",this.menuButtonClick),e.addEventListener("keydown",this.menuButtonKeyDown),e.addEventListener("keyup",this.menuButtonKeyUp)))};
this.disconnectMenuButtonEl=()=>{const {menuButtonEl:a}=this;a&&(a.removeEventListener("click",this.menuButtonClick),a.removeEventListener("keydown",this.menuButtonKeyDown),a.removeEventListener("keyup",this.menuButtonKeyUp))};this.setDefaultMenuButtonEl=a=>{this.defaultMenuButtonEl=a;this.connectMenuButtonEl()};this.handleCalciteActionClick=()=>{this.open=!1;this.setFocus()};this.menuButtonClick=()=>{this.toggleOpen()};this.setTooltipReferenceElement=()=>{const {el:a,expanded:b,menuButtonEl:c}=this;
var d=l.getSlotted(a,k.tooltip);d="SLOT"===(null===d||void 0===d?void 0:d.tagName)?d.assignedElements()[0]:d;"CALCITE-TOOLTIP"===(null===d||void 0===d?void 0:d.tagName)&&(d.referenceElement=b?null:c)};this.updateAction=(a,b)=>{const {guid:c,activeMenuItemIndex:d}=this,g=`${c}-action-${b}`;a.tabIndex=-1;a.setAttribute("role","menuitem");a.id||(a.id=g);a.active=b===d};this.updateActions=a=>{null===a||void 0===a?void 0:a.forEach(this.updateAction)};this.getActions=()=>{var {el:a}=this;a=l.getSlotted(a,
{all:!0,matches:"calcite-action"});this.updateActions(a);this.actionElements=a;this.connectMenuButtonEl()};this.menuButtonKeyUp=a=>{const {key:b}=a,{actionElements:c}=this;this.isValidKey(b,r)&&(a.preventDefault(),c.length&&(this.toggleOpen(!0),this.handleActionNavigation(b,c)))};this.menuButtonKeyDown=a=>{const {key:b}=a;this.isValidKey(b,r)&&a.preventDefault()};this.menuActionsContainerKeyDown=a=>{const {key:b}=a,{actionElements:c,activeMenuItemIndex:d}=this;"Tab"===b?this.open=!1:" "===b||"Enter"===
b?(a.preventDefault(),(a=c[d])?a.click():this.toggleOpen(!1)):this.isValidKey(b,t)&&a.preventDefault()};this.menuActionsContainerKeyUp=a=>{const {key:b}=a,{actionElements:c}=this;"Escape"===b?this.toggleOpen(!1):this.isValidKey(b,t)&&(a.preventDefault(),c.length&&this.handleActionNavigation(b,c))};this.handleActionNavigation=(a,b)=>{const c=this.activeMenuItemIndex;"Home"===a&&(this.activeMenuItemIndex=0);"End"===a&&(this.activeMenuItemIndex=b.length-1);"ArrowUp"===a&&(this.activeMenuItemIndex=n.getRoundRobinIndex(Math.max(c-
1,-1),b.length));"ArrowDown"===a&&(this.activeMenuItemIndex=n.getRoundRobinIndex(c+1,b.length))};this.toggleOpenEnd=()=>{this.setFocus();this.el.removeEventListener("calcitePopoverOpen",this.toggleOpenEnd)};this.toggleOpen=(a=!this.open)=>{this.el.addEventListener("calcitePopoverOpen",this.toggleOpenEnd);this.open=a}}connectedCallback(){var a;null===(a=this.mutationObserver)||void 0===a?void 0:a.observe(this.el,{childList:!0,subtree:!0});this.getActions();p.connectConditionalSlotComponent(this)}disconnectedCallback(){var a;
null===(a=this.mutationObserver)||void 0===a?void 0:a.disconnect();this.disconnectMenuButtonEl();p.disconnectConditionalSlotComponent(this)}expandedHandler(){this.open=!1;this.setTooltipReferenceElement()}openHandler(a){this.activeMenuItemIndex=this.open?0:-1;this.menuButtonEl&&(this.menuButtonEl.active=a);this.calciteActionMenuOpenChange.emit(a)}closeCalciteActionMenuOnClick(a){a.composedPath().includes(this.el)||(this.open=!1)}activeMenuItemIndexHandler(){this.updateActions(this.actionElements)}async setFocus(){l.focusElement(this.open?
this.menuEl:this.menuButtonEl)}renderMenuButton(){const {el:a,label:b,scale:c}=this,d=f.h("slot",{name:k.trigger},f.h("calcite-action",{class:"default-trigger",icon:"ellipsis",ref:this.setDefaultMenuButtonEl,scale:c,text:b}));return l.getSlotted(a,k.tooltip)?f.h("calcite-tooltip-manager",null,d):d}renderMenuItems(){const {actionElements:a,activeMenuItemIndex:b,open:c,menuId:d,menuButtonEl:g,label:e,placement:B,overlayPositioning:C}=this,m=a[b];return f.h("calcite-popover",{disablePointer:!0,label:e,
offsetDistance:0,open:c,overlayPositioning:C,placement:B,referenceElement:g},f.h("div",{"aria-activedescendant":(null===m||void 0===m?void 0:m.id)||null,"aria-labelledby":null===g||void 0===g?void 0:g.id,class:"menu",id:d,onClick:this.handleCalciteActionClick,onKeyDown:this.menuActionsContainerKeyDown,onKeyUp:this.menuActionsContainerKeyUp,ref:D=>this.menuEl=D,role:"menu",tabIndex:-1},f.h("slot",null)))}render(){return f.h(f.Fragment,null,this.renderMenuButton(),this.renderMenuItems(),f.h("slot",
{name:k.tooltip}))}getAssignedElements(){return Array.from(this.el.querySelectorAll("slot")).map(a=>a.assignedElements({flatten:!0})).reduce((a,b)=>a.concat(b),[])}isValidKey(a,b){return!!b.find(c=>c===a)}get el(){return this}static get watchers(){return{expanded:["expandedHandler"],open:["openHandler"],activeMenuItemIndex:["activeMenuItemIndexHandler"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--calcite-ui-foreground-1);font-size:var(--calcite-font-size-1);color:var(--calcite-ui-text-2)}.menu ::slotted(calcite-action){margin:0.125rem;display:-ms-flexbox;display:flex;outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out}::slotted(calcite-action[active]){outline:2px solid var(--calcite-ui-brand);outline-offset:0px}.default-trigger{position:relative;height:100%;-ms-flex:0 1 auto;flex:0 1 auto;-ms-flex-item-align:stretch;align-self:stretch}slot[name\x3dtrigger]::slotted(calcite-action),calcite-action::slotted([slot\x3dtrigger]){position:relative;height:100%;-ms-flex:0 1 auto;flex:0 1 auto;-ms-flex-item-align:stretch;align-self:stretch}.menu{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap;outline:2px solid transparent;outline-offset:2px}"}};
h.ActionMenu=f.proxyCustomElement(h.ActionMenu,[1,"calcite-action-menu",{expanded:[516],flipPlacements:[16],label:[1],open:[1540],overlayPositioning:[1,"overlay-positioning"],placement:[513],scale:[513],activeMenuItemIndex:[32],setFocus:[64]},[[8,"click","closeCalciteActionMenuOnClick"]]]);q();h.SLOTS=k;h.defineCustomElement=q});