// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
define("exports ../core/has ../core/Logger ../core/mathUtils ../core/maybe ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ../geometry/support/Axis ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),function(e,E,R,t,S,T,d,n,U,u,p,V,W,l){function v(){return u.create()}function w(a,b=v()){return U.copy(b,a)}function F(a,b){return u.fromValues(a[0],a[1],a[2],b)}function G(a){return a}function H(a){a[0]=a[1]=a[2]=a[3]=0}function I(a){return a}function q(a){return Array.isArray(a)?
a[3]:a}function k(a){return Array.isArray(a)?a:X}function J(a,b,c,f){return u.fromValues(a,b,c,f)}function K(a,b,c){a!==c&&d.copy(c,a);c[3]=a[3]+b;return c}function L(a,b,c){Y.error("sphere.setExtent is not yet supported");return a===c?c:w(a,c)}function m(a,b,c){if(S.isNone(b))return!1;const {origin:f,direction:g}=b;var h=Z;h[0]=f[0]-a[0];h[1]=f[1]-a[1];h[2]=f[2]-a[2];b=g[0]*g[0]+g[1]*g[1]+g[2]*g[2];const r=2*(g[0]*h[0]+g[1]*h[1]+g[2]*h[2]);a=r*r-4*b*(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]-a[3]*a[3]);if(0>
a)return!1;h=Math.sqrt(a);a=(-r-h)/(2*b);b=(-r+h)/(2*b);if(0>a||b<a&&0<b)a=b;if(0>a)return!1;c&&(c[0]=f[0]+g[0]*a,c[1]=f[1]+g[1]*a,c[2]=f[2]+g[2]*a);return!0}function M(a,b){return m(a,b,null)}function N(a,b,c){if(m(a,b,c))return c;a=x(a,b,l.sv3d.get());d.add(c,b.origin,d.scale(l.sv3d.get(),b.direction,d.distance(b.origin,a)/d.length(b.direction)));return c}function x(a,b,c){const f=l.sv3d.get(),g=l.sm4d.get();d.cross(f,b.origin,b.direction);const h=q(a);d.cross(c,f,b.origin);d.scale(c,c,1/d.length(c)*
h);a=y(a,b.origin);b=W.angle(b.origin,c);T.fromRotation(g,b+a,f);d.transformMat4(c,c,g);return c}function O(a,b,c){if(m(a,b,c))return c;V.closestPoint(b,k(a),c);return z(a,c,c)}function z(a,b,c){b=d.subtract(l.sv3d.get(),b,k(a));b=d.scale(l.sv3d.get(),b,a[3]/d.length(b));return d.add(c,b,k(a))}function P(a,b){b=d.subtract(l.sv3d.get(),b,k(a));b=d.squaredLength(b);return Math.sqrt(Math.abs(b-a[3]*a[3]))}function y(a,b){b=d.subtract(l.sv3d.get(),b,k(a));b=d.length(b);a=q(a);return t.acosClamped(a/(a+
Math.abs(a-b)))}function A(a,b,c,f){a=d.subtract(B,b,k(a));switch(c){case p.Axis.X:return c=t.cartesianToSpherical(a,B)[2],d.set(f,-Math.sin(c),Math.cos(c),0);case p.Axis.Y:return a=t.cartesianToSpherical(a,B),c=a[1],a=a[2],b=Math.sin(c),d.set(f,-b*Math.cos(a),-b*Math.sin(a),Math.cos(c));case p.Axis.Z:return d.normalize(f,a)}}function C(a,b){b=d.subtract(D,b,k(a));return d.length(b)-a[3]}function Q(a,b,c,f){const g=C(a,b);a=A(a,b,p.Axis.Z,D);c=d.scale(D,a,c-g);return d.add(f,b,c)}const Y=R.getLogger("esri.geometry.support.sphere"),
Z=n.create(),B=n.create(),X=n.create(),D=n.create();E=Object.freeze({__proto__:null,create:v,copy:w,fromCenterAndRadius:F,wrap:G,clear:H,fromRadius:I,getRadius:q,getCenter:k,fromValues:J,elevate:K,setExtent:L,intersectRay:m,intersectsRay:M,intersectRayClosestSilhouette:N,closestPointOnSilhouette:x,closestPoint:O,projectPoint:z,distanceToSilhouette:P,angleToSilhouette:y,axisAt:A,altitudeAt:C,setAltitudeAt:Q});e.altitudeAt=C;e.angleToSilhouette=y;e.axisAt=A;e.clear=H;e.closestPoint=O;e.closestPointOnSilhouette=
x;e.copy=w;e.create=v;e.distanceToSilhouette=P;e.elevate=K;e.fromCenterAndRadius=F;e.fromRadius=I;e.fromValues=J;e.getCenter=k;e.getRadius=q;e.intersectRay=m;e.intersectRayClosestSilhouette=N;e.intersectsRay=M;e.projectPoint=z;e.setAltitudeAt=Q;e.setExtent=L;e.sphere=E;e.wrap=G});