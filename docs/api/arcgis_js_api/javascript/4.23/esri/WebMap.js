// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.23/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/accessorSupport/originUtils":function(){define(["exports","../multiOriginJSONSupportUtils"],function(l,b){l.updateOrigins=function(a){a&&a.writtenProperties&&a.writtenProperties.forEach(d=>{const g=d.target;d.newOrigin&&d.oldOrigin!==d.newOrigin&&b.isMultiOriginJSONMixin(g)&&g.updateOrigin(d.propName,d.newOrigin)})};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/core/multiOriginJSONSupportUtils":function(){define(["exports"],function(l){l.isMultiOriginJSONMixin=
function(b){return b&&"getAtOrigin"in b&&"originOf"in b};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/networks/UtilityNetwork":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Network ./support/NamedTraceConfiguration ./support/TerminalConfiguration".split(" "),function(l,b,a,d,g,t,u,v,k,m,f){g=
function(n){function y(q){q=n.call(this,q)||this;q.sharedNamedTraceConfigurations=[];q.type="utility";return q}l._inheritsLoose(y,n);var w=y.prototype;w.load=function(){var q=l._asyncToGenerator(function*(B){this.addResolvingPromise(n.prototype.load.call(this,B));this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(B));return this});return function(B){return q.apply(this,arguments)}}();w.getTerminalConfiguration=function(q){let B=null,C=null;var r=q.layer;let A=null;if("feature"===
(null==r?void 0:r.type)){if(A=r.layerId,null===A)return null}else return null;r=q.attributes;if(null==r)return null;for(const G of Object.keys(r))"ASSETGROUP"===G.toUpperCase()&&(B=q.getAttribute(G)),"ASSETTYPE"===G.toUpperCase()&&(C=q.getAttribute(G));if(!this.dataElement)return null;let E=null;q=this.dataElement.domainNetworks;for(const G of q){var J;if(q=null==(J=G.junctionSources)?void 0:J.find(D=>D.layerId===A)){var z;if(q=null==(z=q.assetGroups)?void 0:z.find(D=>D.assetGroupCode===B)){var H;
if(q=null==(H=q.assetTypes)?void 0:H.find(D=>D.assetTypeCode===C)){E=q.terminalConfigurationId;break}}}}return null!=E?(J=this.dataElement.terminalConfigurations,(J=null==J?void 0:J.find(G=>G.terminalConfigurationId===E))?f.fromJSON(J):null):null};w.getTierNames=function(q){var B;const C=null==(B=this.dataElement)?void 0:B.domainNetworks.find(r=>r.domainNetworkName===q);return(null==C?void 0:C.tiers.map(r=>r.name))||[]};w._loadNamedTraceConfigurationsFromNetwork=function(){var q=l._asyncToGenerator(function*(B){var C;
if(0!==(null==(C=this.sharedNamedTraceConfigurations)?void 0:C.length)){C=this.sharedNamedTraceConfigurations.map(r=>r.globalId);B=yield this._fetchTraceConfigData(this.networkServiceUrl,C,B);for(const r of this.sharedNamedTraceConfigurations)(C=null==B?void 0:B.find(A=>A.globalId===r.globalId))&&r.read(C,{origin:"service"})}});return function(B){return q.apply(this,arguments)}}();w._fetchTraceConfigData=function(q,B,C){return a(`${q}/traceConfigurations/query`,{responseType:"json",query:{globalIds:JSON.stringify(B),
f:"json"},...C}).then(r=>r.data.traceConfigurations)};l._createClass(y,[{key:"serviceTerritoryFeatureLayerId",get:function(){var q;return null==(q=this.dataElement)?void 0:q.serviceTerritoryFeatureLayerId}},{key:"rulesTableId",get:function(){var q;return null==(q=this.sourceJSON)?void 0:q.systemLayers.rulesTableId}},{key:"rulesTableUrl",get:function(){return this.sourceJSON?`${this.featureServiceUrl}/${this.rulesTableId}`:null}},{key:"subnetworksTableId",get:function(){var q;return null==(q=this.sourceJSON)?
void 0:q.systemLayers.subnetworksTableId}},{key:"subnetworksTableUrl",get:function(){return this.sourceJSON?`${this.featureServiceUrl}/${this.subnetworksTableId}`:null}},{key:"terminalConfigurations",get:function(){var q;return(null==(q=this.dataElement)?void 0:q.terminalConfigurations.map(B=>f.fromJSON(B)))||[]}},{key:"domainNetworkNames",get:function(){var q;return(null==(q=this.dataElement)?void 0:q.domainNetworks.map(B=>B.domainNetworkName))||[]}}]);return y}(k);b.__decorate([d.property({type:[m],
json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],g.prototype,"sharedNamedTraceConfigurations",void 0);b.__decorate([d.property({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],g.prototype,"type",void 0);b.__decorate([d.property({readOnly:!0})],g.prototype,"serviceTerritoryFeatureLayerId",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"rulesTableId",null);b.__decorate([d.property({readOnly:!0})],
g.prototype,"rulesTableUrl",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"subnetworksTableId",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"subnetworksTableUrl",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"terminalConfigurations",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"domainNetworkNames",null);return g=b.__decorate([v.subclass("esri.networks.UtilityNetwork")],g)})},"esri/networks/Network":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../core/Loadable ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../layers/support/arcgisLayerUrl".split(" "),
function(l,b,a,d,g,t,u,v,k,m,f,n,y,w,q,B,C){const r=g.getLogger("esri.networks.Network");d=function(A){function E(z){z=A.call(this,z)||this;z.id=null;z.title=null;z.layerUrl=null;z.dataElement=null;z.fullExtent=null;z.spatialReference=null;z.type=null;z.sourceJSON=null;return z}l._inheritsLoose(E,A);var J=E.prototype;J.initialize=function(){this.when().catch(z=>{if(!v.isAbortError(z)){var H,G;r.error("#load()",`Failed to load layer (title: '${null!=(H=this.title)?H:"no title"}', id: '${null!=(G=this.id)?
G:"no id"}')`,{error:z})}})};J.load=function(){var z=l._asyncToGenerator(function*(H){this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),H));this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,H));return this});return function(H){return z.apply(this,arguments)}}();J.getLayerIdBySourceId=function(z){if(this.dataElement){const H=this.dataElement.domainNetworks;for(const G of H){for(const D of G.edgeSources?G.edgeSources:[])if(D.sourceId===z)return D.layerId;
for(const D of G.junctionSources?G.junctionSources:[])if(D.sourceId===z)return D.layerId}}return null};J._fetchLayerMetaData=function(){var z=l._asyncToGenerator(function*(H,G){H=yield a(H,{responseType:"json",query:{f:"json"},...G});this.sourceJSON=H.data;this.read(H.data,{origin:"service"})});return function(H,G){return z.apply(this,arguments)}}();J._fetchDataElement=function(){var z=l._asyncToGenerator(function*(H,G,D){this.dataElement||(H=yield a(`${H}/queryDataElements`,{responseType:"json",
query:{layers:JSON.stringify([G]),f:"json"},...D}).then(M=>{var N;return null==(N=M.data.layerDataElements)?void 0:N[0]}))&&this.read(H,{origin:"service"})});return function(H,G,D){return z.apply(this,arguments)}}();l._createClass(E,[{key:"datasetName",get:function(){var z;return null==(z=this.dataElement)?void 0:z.name}},{key:"owner",get:function(){var z;return null==(z=this.dataElement)?void 0:z.userIdentity}},{key:"schemaGeneration",get:function(){var z;return null==(z=this.dataElement)?void 0:
z.schemaGeneration}},{key:"parsedUrl",get:function(){const z=this.layerUrl;return z?k.urlToObject(z):null}},{key:"featureServiceUrl",get:function(){const z=this.parsedUrl&&C.parse(this.parsedUrl.path);return t.isSome(z)?z.url.path:null}},{key:"networkServiceUrl",get:function(){return this.featureServiceUrl?this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer"):null}},{key:"layerId",get:function(){const z=this.parsedUrl&&C.parse(this.parsedUrl.path);return t.isSome(z)?z.sublayer:
null}}]);return E}(u.MultiOriginJSONMixin(d));b.__decorate([m.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}}},read:!1}})],d.prototype,"id",void 0);b.__decorate([m.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}}},read:!1}})],d.prototype,"title",void 0);b.__decorate([m.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],d.prototype,
"layerUrl",void 0);b.__decorate([m.property({type:Object,json:{origins:{service:{read:!0}},read:!1}})],d.prototype,"dataElement",void 0);b.__decorate([m.property({type:q,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],d.prototype,"fullExtent",void 0);b.__decorate([m.property({type:B,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],d.prototype,"spatialReference",void 0);b.__decorate([m.property({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],
d.prototype,"type",void 0);b.__decorate([m.property({readOnly:!0})],d.prototype,"datasetName",null);b.__decorate([m.property({readOnly:!0})],d.prototype,"owner",null);b.__decorate([m.property({readOnly:!0})],d.prototype,"schemaGeneration",null);b.__decorate([m.property({readOnly:!0})],d.prototype,"parsedUrl",null);b.__decorate([m.property({readOnly:!0})],d.prototype,"featureServiceUrl",null);b.__decorate([m.property({readOnly:!0})],d.prototype,"networkServiceUrl",null);b.__decorate([m.property({readOnly:!0})],
d.prototype,"layerId",null);b.__decorate([m.property()],d.prototype,"sourceJSON",void 0);return d=b.__decorate([w.subclass("esri.networks.Network")],d)})},"esri/networks/support/NamedTraceConfiguration":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/MultiOriginJSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./TraceConfiguration ./typeUtils ./UNTraceConfiguration".split(" "),
function(l,b,a,d,g,t,u,v,k,m,f,n){a=function(y){function w(q){q=y.call(this,q)||this;q.globalId=null;q.title=null;q.traceConfiguration=null;q.creationDate=null;q.creator=null;q.description=null;q.minStartingPoints=null;q.resultTypes=[];q.tags=[];q.traceType=null;return q}l._inheritsLoose(w,y);w.prototype.readTraceConfiguration=function(q,B){return void 0!==q.tierName?n.fromJSON(q):m.fromJSON(q)};return w}(a.MultiOriginJSONSupport);b.__decorate([d.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},
write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"}}},read:!1}})],a.prototype,"globalId",void 0);b.__decorate([d.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],a.prototype,"title",void 0);b.__decorate([d.property({type:m,json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"traceConfiguration",void 0);b.__decorate([v.reader("service","traceConfiguration")],
a.prototype,"readTraceConfiguration",null);b.__decorate([d.property({type:Date,json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"creationDate",void 0);b.__decorate([d.property({type:String,json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"creator",void 0);b.__decorate([d.property({type:String,json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"description",void 0);b.__decorate([d.property({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"}}},
read:!1}})],a.prototype,"minStartingPoints",void 0);b.__decorate([d.property({type:[Object],json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"resultTypes",void 0);b.__decorate([d.property({type:[String],json:{origins:{service:{read:!0}},read:!1}})],a.prototype,"tags",void 0);b.__decorate([d.property({type:f.traceTypeKebabDict.apiValues,json:{type:f.traceTypeKebabDict.jsonValues,origins:{service:{read:f.traceTypeKebabDict.read}},read:!1}})],a.prototype,"traceType",void 0);return a=b.__decorate([k.subclass("esri.networks.support.NamedTraceConfiguration")],
a)})},"esri/networks/support/TraceConfiguration":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(l,b,a,d,g,t,u,v){a=function(k){function m(f){f=k.call(this,f)||this;f.conditionBarriers=[];f.outputConditions=[];f.functions=[];f.functionBarriers=[];f.traversabilityScope=
null;f.shortestPathNetworkAttributeName=null;f.includeBarriers=null;f.validateConsistency=null;f.ignoreBarriersAtStartingPoints=null;return f}l._inheritsLoose(m,k);return m}(a.JSONSupport);b.__decorate([d.property({type:[Object],json:{write:!0}})],a.prototype,"conditionBarriers",void 0);b.__decorate([d.property({type:[Object],json:{write:!0}})],a.prototype,"outputConditions",void 0);b.__decorate([d.property({type:[Object],json:{write:!0}})],a.prototype,"functions",void 0);b.__decorate([d.property({type:[Object],
json:{write:!0}})],a.prototype,"functionBarriers",void 0);b.__decorate([d.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"traversabilityScope",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"shortestPathNetworkAttributeName",void 0);b.__decorate([d.property({type:Boolean,json:{write:!0}})],a.prototype,"includeBarriers",void 0);b.__decorate([d.property({type:Boolean,json:{write:!0}})],a.prototype,"validateConsistency",void 0);b.__decorate([d.property({type:Boolean,
json:{write:!0}})],a.prototype,"ignoreBarriersAtStartingPoints",void 0);return a=b.__decorate([v.subclass("esri.networks.support.TraceConfiguration")],a)})},"esri/networks/support/typeUtils":function(){define(["exports","../../core/jsonMap"],function(l,b){b=new b.JSONMap({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork","subnetwork controllers":"subnetwork-controllers",loops:"loops",isolation:"isolation"});l.traceTypeKebabDict=
b;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/networks/support/UNTraceConfiguration":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./TraceConfiguration".split(" "),function(l,b,a,d,g,t,u,v){d=function(k){function m(f){f=k.call(this,f)||this;f.filterBarriers=[];f.domainNetworkName=null;
f.filterBitsetNetworkAttributeName=null;f.filterFunctionBarriers=[];f.filterScope=null;f.includeContainers=null;f.includeContent=null;f.includeIsolated=null;f.includeStructures=null;f.includeUpToFirstSpatialContainer=null;f.nearestNeighbor=null;f.outputFilterCategories=[];f.outputFilters=[];f.propagators=[];f.subnetworkName=null;f.targetTierName=null;f.tierName=null;f.validateLocatability=null;return f}l._inheritsLoose(m,k);return m}(v);b.__decorate([a.property({type:[Object],json:{write:!0}})],d.prototype,
"filterBarriers",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],d.prototype,"domainNetworkName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],d.prototype,"filterBitsetNetworkAttributeName",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],d.prototype,"filterFunctionBarriers",void 0);b.__decorate([a.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],d.prototype,"filterScope",void 0);b.__decorate([a.property({type:Boolean,
json:{write:!0}})],d.prototype,"includeContainers",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],d.prototype,"includeContent",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],d.prototype,"includeIsolated",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],d.prototype,"includeStructures",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],d.prototype,"includeUpToFirstSpatialContainer",void 0);b.__decorate([a.property({type:Object,json:{write:!0}})],
d.prototype,"nearestNeighbor",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],d.prototype,"outputFilterCategories",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],d.prototype,"outputFilters",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],d.prototype,"propagators",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],d.prototype,"subnetworkName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],d.prototype,"targetTierName",
void 0);b.__decorate([a.property({type:String,json:{write:!0}})],d.prototype,"tierName",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],d.prototype,"validateLocatability",void 0);return d=b.__decorate([u.subclass("esri.networks.support.UNTraceConfiguration")],d)})},"esri/networks/support/TerminalConfiguration":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./Terminal".split(" "),
function(l,b,a,d,g,t,u,v,k,m){a=new a.JSONMap({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});d=function(f){function n(y){y=f.call(this,y)||this;y.defaultConfiguration=null;y.id=null;y.name=null;y.terminals=[];y.traversabilityModel=null;return y}l._inheritsLoose(n,f);return n}(d.JSONSupport);b.__decorate([g.property({type:String,json:{write:!0}})],d.prototype,"defaultConfiguration",void 0);b.__decorate([g.property({type:Number,json:{read:{source:"terminalConfigurationId"},
write:{target:"terminalConfigurationId"}}})],d.prototype,"id",void 0);b.__decorate([g.property({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],d.prototype,"name",void 0);b.__decorate([g.property({type:[m],json:{write:!0}})],d.prototype,"terminals",void 0);b.__decorate([g.property({type:a.apiValues,json:{type:a.jsonValues,read:a.read,write:a.write}})],d.prototype,"traversabilityModel",void 0);return d=b.__decorate([k.subclass("esri.networks.support.TerminalConfiguration")],
d)})},"esri/networks/support/Terminal":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(l,b,a,d,g,t,u,v){a=function(k){function m(f){f=k.call(this,f)||this;f.id=null;f.name=null;return f}l._inheritsLoose(m,k);return m}(a.JSONSupport);b.__decorate([d.property({type:Number,
json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],a.prototype,"id",void 0);b.__decorate([d.property({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],a.prototype,"name",void 0);b.__decorate([d.property({type:Boolean,json:{write:!0}})],a.prototype,"isUpstreamTerminal",void 0);return a=b.__decorate([v.subclass("esri.networks.support.Terminal")],a)})},"esri/rest/geometryService/project":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),
function(l,b,a,d,g,t,u,v){function k(){k=b._asyncToGenerator(function*(f,n,y){n=m(n);f=t.parseUrl(f);const w={...f.query,f:"json",...n.toJSON()},q=n.outSpatialReference,B=g.getJsonType(n.geometries[0]);n=t.asValidOptions(w,y);return a(f.path+"/project",n).then(({data:{geometries:C}})=>u.decodeGeometries(C,B,q))});return k.apply(this,arguments)}const m=d.ensureType(v);l.project=function(f,n,y){return k.apply(this,arguments)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/rest/geometryService/utils":function(){define(["exports",
"../../geometry/support/jsonUtils"],function(l,b){l.decodeGeometries=function(a,d,g){const t=b.getGeometryType(d);return a.map(u=>{u=t.fromJSON(u);u.spatialReference=g;return u})};l.encodeGeometries=function(a){return{geometryType:b.getJsonType(a[0]),geometries:a.map(d=>d.toJSON())}};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils".split(" "),
function(l,b,a,d,g,t,u,v,k){a=function(m){function f(n){n=m.call(this,n)||this;n.geometries=null;n.outSpatialReference=null;n.transformation=null;n.transformForward=null;return n}l._inheritsLoose(f,m);f.prototype.toJSON=function(){const n=this.geometries.map(function(q){return q.toJSON()}),y=this.geometries[0],w={};w.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON());w.inSR=y.spatialReference.wkid||JSON.stringify(y.spatialReference.toJSON());w.geometries=JSON.stringify({geometryType:k.getJsonType(y),
geometries:n});this.transformation&&(w.transformation=this.transformation.wkid||JSON.stringify(this.transformation));null!=this.transformForward&&(w.transformForward=this.transformForward);return w};return f}(a.JSONSupport);b.__decorate([d.property()],a.prototype,"geometries",void 0);b.__decorate([d.property({json:{read:{source:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([d.property()],a.prototype,"transformation",void 0);b.__decorate([d.property()],a.prototype,"transformForward",
void 0);return a=b.__decorate([v.subclass("esri.rest.support.ProjectParameters")],a)})},"esri/support/MapFloorInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../layers/support/FacilityLayerInfo ../layers/support/LevelLayerInfo ../layers/support/SiteLayerInfo".split(" "),function(l,b,a,d,g,t,u,
v,k,m,f){a=function(n){function y(w){w=n.call(this,w)||this;w.levelLayer=null;w.facilityLayer=null;w.siteLayer=null;return w}l._inheritsLoose(y,n);return y}(a.JSONSupport);b.__decorate([d.property({type:m,json:{write:!0}})],a.prototype,"levelLayer",void 0);b.__decorate([d.property({type:k,json:{write:!0}})],a.prototype,"facilityLayer",void 0);b.__decorate([d.property({type:f,json:{write:!0}})],a.prototype,"siteLayer",void 0);return a=b.__decorate([v.subclass("esri.support.MapFloorInfo")],a)})},"esri/layers/support/FacilityLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,b,a,d,g,t,u,v){a=function(k){function m(f){f=k.call(this,f)||this;f.facilityIdField=null;f.layerId=null;f.nameField=null;f.siteIdField=null;f.sublayerId=null;return f}l._inheritsLoose(m,k);return m}(a.JSONSupport);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"facilityIdField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"nameField",void 0);b.__decorate([d.property({type:String,
json:{write:!0}})],a.prototype,"siteIdField",void 0);b.__decorate([d.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0);return a=b.__decorate([v.subclass("esri.layers.support.FacilityLayerInfo")],a)})},"esri/layers/support/LevelLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,b,a,d,g,t,u,v){a=function(k){function m(f){f=k.call(this,f)||this;f.facilityIdField=null;f.layerId=null;f.levelIdField=null;f.levelNumberField=null;f.longNameField=null;f.shortNameField=null;f.sublayerId=null;f.verticalOrderField=null;return f}l._inheritsLoose(m,k);return m}(a.JSONSupport);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"facilityIdField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([d.property({type:String,
json:{write:!0}})],a.prototype,"levelIdField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"levelNumberField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"longNameField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"shortNameField",void 0);b.__decorate([d.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",
void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"verticalOrderField",void 0);return a=b.__decorate([v.subclass("esri.layers.support.LevelLayerInfo")],a)})},"esri/layers/support/SiteLayerInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,b,a,d,g,t,u,v){a=function(k){function m(f){f=k.call(this,f)||this;f.layerId=null;f.nameField=null;f.siteIdField=null;f.sublayerId=null;return f}l._inheritsLoose(m,k);return m}(a.JSONSupport);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"nameField",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"siteIdField",void 0);b.__decorate([d.property({type:Number,
json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0);return a=b.__decorate([v.subclass("esri.layers.support.SiteLayerInfo")],a)})},"esri/webdoc/RangeInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(l,b,a,d,
g,t,u){var v;a=v=function(k){function m(f){f=k.call(this,f)||this;f.activeRange=null;f.currentRangeExtent=null;f.fullRangeExtent=null;return f}l._inheritsLoose(m,k);m.prototype.clone=function(){return new v(d.clone({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))};return m}(a.JSONSupport);b.__decorate([g.property({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],a.prototype,
"activeRange",void 0);b.__decorate([g.property({type:[Number],json:{write:!0}})],a.prototype,"currentRangeExtent",void 0);b.__decorate([g.property({type:[Number],json:{write:!0}})],a.prototype,"fullRangeExtent",void 0);return a=v=b.__decorate([u.subclass("esri.webdoc.RangeInfo")],a)})},"esri/webdoc/Widgets":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./widgets/FloorFilter ./widgets/Range ./widgets/TimeSlider".split(" "),
function(l,b,a,d,g,t,u,v,k,m){var f;a=f=function(n){function y(w){w=n.call(this,w)||this;w.range=null;w.timeSlider=null;w.floorFilter=null;return w}l._inheritsLoose(y,n);y.prototype.clone=function(){return new f(d.clone({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))};return y}(a.JSONSupport);b.__decorate([g.property({type:k,json:{write:!0}})],a.prototype,"range",void 0);b.__decorate([g.property({type:m,json:{write:!0}})],a.prototype,"timeSlider",void 0);b.__decorate([g.property({type:v,
json:{write:!0}})],a.prototype,"floorFilter",void 0);return a=f=b.__decorate([u.subclass("esri.webdoc.Widgets")],a)})},"esri/webdoc/widgets/FloorFilter":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(l,b,a,d,g,t,u){var v;a=v=function(k){function m(f){f=k.call(this,f)||this;f.enabled=
!1;f.longNames=!1;f.minimized=!1;f.pinnedLevels=!1;f.site=null;f.facility=null;f.level=null;return f}l._inheritsLoose(m,k);m.prototype.clone=function(){return new v(d.clone({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))};return m}(a.JSONSupport);b.__decorate([g.property({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],a.prototype,"enabled",void 0);b.__decorate([g.property({type:Boolean,
json:{read:{source:"longNames"},write:{target:"longNames"}}})],a.prototype,"longNames",void 0);b.__decorate([g.property({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],a.prototype,"minimized",void 0);b.__decorate([g.property({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],a.prototype,"pinnedLevels",void 0);b.__decorate([g.property({type:String,json:{read:{source:"site"},write:{target:"site"}}})],a.prototype,"site",void 0);b.__decorate([g.property({type:String,
json:{read:{source:"facility"},write:{target:"facility"}}})],a.prototype,"facility",void 0);b.__decorate([g.property({type:String,json:{read:{source:"level"},write:{target:"level"}}})],a.prototype,"level",void 0);return a=v=b.__decorate([u.subclass("esri.webdoc.widgets.FloorFilter")],a)})},"esri/webdoc/widgets/Range":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,b,a,d,g,t,u,v,k){var m;a=new a.JSONMap({slider:"slider",picker:"picker"});d=m=function(f){function n(y){y=f.call(this,y)||this;y.interactionMode=null;y.numStops=null;y.stopInterval=null;return y}l._inheritsLoose(n,f);n.prototype.clone=function(){return new m({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})};return n}(d.JSONSupport);b.__decorate([g.property({type:a.apiValues,nonNullable:!0,json:{type:a.jsonValues,default:null,read:{reader:a.read},
write:{isRequired:!0,writer:a.write}}})],d.prototype,"interactionMode",void 0);b.__decorate([g.property({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const f=null!=this.stopInterval;return{enabled:!f,isRequired:!f}}}}})],d.prototype,"numStops",void 0);b.__decorate([g.property({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],d.prototype,"stopInterval",void 0);return d=m=b.__decorate([k.subclass("esri.webdoc.widgets.Range")],
d)})},"esri/webdoc/widgets/TimeSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../TimeExtent ../../TimeInterval ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/object ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(l,b,a,d,g,t,u,v,k,m,f,n,y){var w;
g=w=function(q){function B(r){r=q.call(this,r)||this;r.currentTimeExtent=null;r.fullTimeExtent=null;r.loop=!1;r.numStops=null;r.numThumbs=null;r.stopDelay=null;r.stopInterval=null;r.stops=null;return r}l._inheritsLoose(B,q);var C=B.prototype;C.readCurrentTimeExtent=function(r){if(r)return new a({start:null!=r[0]?new Date(r[0]):null,end:null!=r[1]?new Date(r[1]):null})};C.writeCurrentTimeExtent=function(r,A,E){r&&v.setDeepValue(E,[u.isSome(r.start)?r.start.getTime():null,u.isSome(r.end)?r.end.getTime():
null],A)};C.readFullTimeExtent=function(r,A){if(r=A.properties)return new a({start:null!=r.startTime?new Date(r.startTime):null,end:null!=r.endTime?new Date(r.endTime):null})};C.writeFullTimeExtent=function(r,A){if(r){A=A.properties=A.properties||{};var E=r.end;r=r.start;E&&(A.endTime=u.isSome(E)?E.getTime():null);r&&(A.startTime=u.isSome(r)?r.getTime():null)}};C.readStopInterval=function(r,A,E){return r?d.fromJSON({value:r.interval,unit:r.units},E):null};C.writeStopInterval=function(r,A,E,J){r&&
(r=r.toJSON(J),v.setDeepValue(E,{interval:r.value,units:r.unit},A))};C.readStops=function(r){return r&&r.length?r.map(A=>new Date(A)):null};C.writeStops=function(r,A,E){r&&r.length&&v.setDeepValue(E,r.map(J=>J.getTime()),A)};C.clone=function(){return new w(t.clone({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))};return B}(g.JSONSupport);
b.__decorate([k.property({type:a,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],g.prototype,"currentTimeExtent",void 0);b.__decorate([f.reader("currentTimeExtent")],g.prototype,"readCurrentTimeExtent",null);b.__decorate([y.writer("currentTimeExtent")],g.prototype,"writeCurrentTimeExtent",null);b.__decorate([k.property({type:a,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],
g.prototype,"fullTimeExtent",void 0);b.__decorate([f.reader("fullTimeExtent")],g.prototype,"readFullTimeExtent",null);b.__decorate([y.writer("fullTimeExtent")],g.prototype,"writeFullTimeExtent",null);b.__decorate([k.property({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],g.prototype,"loop",void 0);b.__decorate([k.property({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var q;
const B=!!this.stopInterval,C=!(null==(q=this.stops)||!q.length);q=!(B||C);return{enabled:q,isRequired:q}}}}})],g.prototype,"numStops",void 0);b.__decorate([k.property({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],g.prototype,"numThumbs",void 0);b.__decorate([k.property({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],g.prototype,
"stopDelay",void 0);b.__decorate([k.property({type:d,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){var q;const B=null!=this.numStops,C=!(null==(q=this.stops)||!q.length);return{enabled:!C,isRequired:!(B||C)}}}}})],g.prototype,"stopInterval",void 0);b.__decorate([f.reader("stopInterval")],g.prototype,"readStopInterval",null);b.__decorate([y.writer("stopInterval")],g.prototype,"writeStopInterval",null);b.__decorate([k.property({type:[Date],
json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],g.prototype,"stops",void 0);b.__decorate([f.reader("stops")],g.prototype,"readStops",null);b.__decorate([y.writer("stops")],g.prototype,"writeStops",null);return g=w=b.__decorate([n.subclass("esri.webdoc.widgets.TimeSlider")],g)})},"esri/webdoc/support/thumbnailUtils":function(){define(["exports"],function(l){const b={width:600,height:400};l.getOptimalThumbnailSize=
function(a,d){d=d||b;let {width:g,height:t}=d;d=g/t;1.5>d?t=g/1.5:1.5<d&&(g=1.5*t);g>a.width&&(t*=a.width/g,g=a.width);t>a.height&&(g*=a.height/t,t=a.height);return{width:Math.round(g),height:Math.round(t)}};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/webmap/ApplicationProperties":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../webdoc/applicationProperties/Viewing".split(" "),
function(l,b,a,d,g,t,u,v){var k;a=k=function(m){function f(n){n=m.call(this,n)||this;n.editing=null;n.offline=null;n.viewing=null;return n}l._inheritsLoose(f,m);f.prototype.clone=function(){return new k(d.clone({editing:this.editing,offline:this.offline,viewing:this.viewing}))};return f}(a.JSONSupport);b.__decorate([g.property({json:{write:!0}})],a.prototype,"editing",void 0);b.__decorate([g.property({json:{write:!0}})],a.prototype,"offline",void 0);b.__decorate([g.property({type:v,json:{write:!0}})],
a.prototype,"viewing",void 0);return a=k=b.__decorate([u.subclass("esri.webmap.ApplicationProperties")],a)})},"esri/webdoc/applicationProperties/Viewing":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./Search".split(" "),function(l,b,a,d,g,t,u,v){var k;a=k=function(m){function f(n){n=m.call(this,
n)||this;n.search=null;return n}l._inheritsLoose(f,m);f.prototype.clone=function(){return new k(d.clone({search:this.search}))};return f}(a.JSONSupport);b.__decorate([g.property({type:v,json:{write:!0}})],a.prototype,"search",void 0);return a=k=b.__decorate([u.subclass("esri.webdoc.applicationProperties.Viewing")],a)})},"esri/webdoc/applicationProperties/Search":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/extensions/serializableProperty/writePolicyUtils ./SearchLayer ./SearchTable".split(" "),
function(l,b,a,d,g,t,u,v,k,m,f,n,y){var w;const q=a.ofType(n),B=a.ofType(y);a=w=function(C){function r(E){E=C.call(this,E)||this;E.addressSearchEnabled=!0;E.enabled=!0;E.hintText=null;E.layers=new q;E.tables=new B;return E}l._inheritsLoose(r,C);var A=r.prototype;A.readAddressSearchEnabled=function(E){return!E};A.writeAddressSearchEnabled=function(E,J,z){J[z]=!E};A.clone=function(){return new w(g.clone({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,
tables:this.tables}))};return r}(d.JSONSupport);b.__decorate([t.property({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"addressSearchEnabled",void 0);b.__decorate([v.reader("addressSearchEnabled")],a.prototype,"readAddressSearchEnabled",null);b.__decorate([m.writer("addressSearchEnabled")],a.prototype,"writeAddressSearchEnabled",null);b.__decorate([t.property({type:Boolean,
nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],a.prototype,"enabled",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"hintText",void 0);b.__decorate([t.property({type:q,json:{write:{overridePolicy:f.writeNonEmptyCollectionPolicy},origins:{"web-scene":{write:{isRequired:!0}}}}})],a.prototype,"layers",void 0);b.__decorate([t.property({type:B,json:{read:!0,write:{overridePolicy:f.writeNonEmptyCollectionPolicy}}})],
a.prototype,"tables",void 0);return a=w=b.__decorate([k.subclass("esri.webdoc.applicationProperties.Search")],a)})},"esri/core/accessorSupport/extensions/serializableProperty/writePolicyUtils":function(){define(["exports"],function(l){l.writeNonEmptyCollectionPolicy=function(b){return{enabled:!(null==b||!b.length)}};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/webdoc/applicationProperties/SearchLayer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchLayerField".split(" "),
function(l,b,a,d,g,t,u,v){var k;a=k=function(m){function f(n){n=m.call(this,n)||this;n.field=null;n.id=null;n.subLayer=null;return n}l._inheritsLoose(f,m);f.prototype.clone=function(){return new k(d.clone({field:this.field,id:this.id,subLayer:this.subLayer}))};return f}(a.JSONSupport);b.__decorate([g.property({type:v,json:{write:{isRequired:!0}}})],a.prototype,"field",void 0);b.__decorate([g.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"id",void 0);b.__decorate([g.property({type:t.Integer,
json:{write:!0}})],a.prototype,"subLayer",void 0);return a=k=b.__decorate([u.subclass("esri.webdoc.applicationProperties.SearchLayer")],a)})},"esri/webdoc/applicationProperties/SearchLayerField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),
function(l,b,a,d,g,t,u,v,k,m){var f;a=f=function(n){function y(w){w=n.call(this,w)||this;w.exactMatch=!1;w.name=null;w.type=null;return w}l._inheritsLoose(y,n);y.prototype.clone=function(){return new f({exactMatch:this.exactMatch,type:this.type,name:this.name})};return y}(a.JSONSupport);b.__decorate([d.property({type:Boolean,json:{write:!0}})],a.prototype,"exactMatch",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"name",void 0);b.__decorate([v.enumeration(m.kebabDict)],
a.prototype,"type",void 0);return a=f=b.__decorate([k.subclass("esri.webdoc.applicationProperties.SearchLayerField")],a)})},"esri/webdoc/applicationProperties/SearchTable":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchTableField".split(" "),function(l,b,a,d,g,t,u,v){var k;a=k=function(m){function f(n){n=
m.call(this,n)||this;n.field=null;n.id=null;return n}l._inheritsLoose(f,m);f.prototype.clone=function(){return new k(d.clone({field:this.field,id:this.id}))};return f}(a.JSONSupport);b.__decorate([g.property({type:v,json:{write:{isRequired:!0}}})],a.prototype,"field",void 0);b.__decorate([g.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"id",void 0);return a=k=b.__decorate([u.subclass("esri.webdoc.applicationProperties.SearchTable")],a)})},"esri/webdoc/applicationProperties/SearchTableField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),
function(l,b,a,d,g,t,u,v,k,m){var f;a=f=function(n){function y(w){w=n.call(this,w)||this;w.exactMatch=!1;w.name=null;w.type=null;return w}l._inheritsLoose(y,n);y.prototype.clone=function(){return new f({exactMatch:this.exactMatch,type:this.type,name:this.name})};return y}(a.JSONSupport);b.__decorate([d.property({type:Boolean,json:{write:!0}})],a.prototype,"exactMatch",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"name",void 0);b.__decorate([v.enumeration(m.kebabDict)],
a.prototype,"type",void 0);return a=f=b.__decorate([k.subclass("esri.webdoc.applicationProperties.SearchTableField")],a)})},"esri/webmap/Bookmark":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../TimeExtent ../Viewpoint ../core/deprecate ../core/Error ../core/Identifiable ../core/JSONSupport ../core/lang ../core/Logger ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/accessorSupport/ensureType ../geometry/Extent ../webdoc/support/SlideThumbnail".split(" "),
function(l,b,a,d,g,t,u,v,k,m,f,n,y,w,q,B,C,r,A){var E;const J=m.getLogger("esri.webmap.Bookmark");u=E=function(z){function H(D){D=z.call(this,D)||this;D.name=null;D.thumbnail=new A.SlideThumbnail;D.timeExtent=null;return D}l._inheritsLoose(H,z);var G=H.prototype;G.castThumbnail=function(D){return"string"===typeof D?new A.SlideThumbnail({url:D}):C.ensureType(A.SlideThumbnail,D)};G.readViewpoint=function(D,M){const {extent:N,viewpoint:P}=M;return d.fromJSON(P||{targetGeometry:N})};G.writeViewpoint=
function(D,M,N,P){if(D){var {targetGeometry:Q}=D;f.isSome(Q)&&"extent"!==Q.type?null!=P&&P.messages?P.messages.push(new t("property:unsupported","Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.")):J.error("Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent."):M[N]=D.toJSON()}};G.clone=function(){return new E(k.clone({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))};
l._createClass(H,[{key:"extent",set:function(D){g.deprecatedProperty(J,"extent",{replacement:"viewpoint",version:"4.17"});this._set("viewpoint",new d({targetGeometry:D.clone()}));this._set("extent",D)}},{key:"viewpoint",set:function(D){const {targetGeometry:M,scale:N}=D;f.isSome(M)&&("extent"===M.type?this._set("extent",M.clone()):"point"===M.type&&f.isNone(N)&&J.warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",D));this._set("viewpoint",D)}}]);return H}(u.IdentifiableMixin(v.JSONSupport));
b.__decorate([n.property({type:r,nonNullable:!0,json:{read:!1,write:{isRequired:!0}}})],u.prototype,"extent",null);b.__decorate([n.property({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],u.prototype,"name",void 0);b.__decorate([n.property({type:A.SlideThumbnail,json:{write:{overridePolicy(z){return{enabled:!(!z||!z.url)}}}}})],u.prototype,"thumbnail",void 0);b.__decorate([y.cast("thumbnail")],u.prototype,"castThumbnail",null);b.__decorate([n.property({type:a,json:{write:!0}})],u.prototype,
"timeExtent",void 0);b.__decorate([n.property({type:d,nonNullable:!0,json:{write:!0}})],u.prototype,"viewpoint",null);b.__decorate([w.reader("viewpoint",["extent","viewpoint"])],u.prototype,"readViewpoint",null);b.__decorate([B.writer("viewpoint")],u.prototype,"writeViewpoint",null);return u=E=b.__decorate([q.subclass("esri.webmap.Bookmark")],u)})},"esri/webdoc/support/SlideThumbnail":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,b,a,d,g,t,u,v,k){var m;l.SlideThumbnail=m=function(f){function n(){var w=f.apply(this,arguments)||this;w.url="";return w}b._inheritsLoose(n,f);var y=n.prototype;y.destroy=function(){this.url=""};y.clone=function(){return new m({url:this.url})};return n}(d.JSONSupport);a.__decorate([g.property({type:String,json:{write:{isRequired:!0}}})],l.SlideThumbnail.prototype,"url",void 0);l.SlideThumbnail=m=a.__decorate([k.subclass("esri.webdoc.support.SlideThumbnail")],l.SlideThumbnail);Object.defineProperty(l,
"__esModule",{value:!0})})},"esri/webmap/InitialViewProperties":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Viewpoint ../core/Accessor ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/SpatialReference ../webdoc/RangeInfo ./background/ColorBackground".split(" "),function(l,b,a,d,g,t,u,v,k,m,f){var n;d=n=function(y){function w(q){q=y.call(this,q)||this;q.background=null;
q.rangeInfo=null;q.spatialReference=null;q.viewpoint=null;return q}l._inheritsLoose(w,y);w.prototype.clone=function(){return new n(g.clone({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))};return w}(d);b.__decorate([t.property({type:f})],d.prototype,"background",void 0);b.__decorate([t.property({type:m})],d.prototype,"rangeInfo",void 0);b.__decorate([t.property({type:k})],d.prototype,"spatialReference",void 0);b.__decorate([t.property({type:a})],
d.prototype,"viewpoint",void 0);return d=n=b.__decorate([v.subclass("esri.webmap.InitialViewProperties")],d)})},"esri/webmap/background/ColorBackground":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(l,b,a,d,g,t,u,v){var k;d=k=function(m){function f(n){n=m.call(this,
n)||this;n.color=new a([0,0,0,1]);return n}l._inheritsLoose(f,m);f.prototype.clone=function(){return new k(g.clone({color:this.color}))};return f}(d.JSONSupport);b.__decorate([t.property({type:a,json:{write:!0}})],d.prototype,"color",void 0);return d=k=b.__decorate([v.subclass("esri.webmap.background.ColorBackground")],d)})},"esri/webmap/Version":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../core/Version"],function(l,b,a){a=function(d){function g(t,u){return d.call(this,t,
u,"webmap")||this}b._inheritsLoose(g,d);return g}(a.Version);l.Version=a;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/core/Version":function(){define(["exports","./Error"],function(l,b){let a=function(){function d(t,u,v=""){this.major=t;this.minor=u;this._context=v}var g=d.prototype;g.lessThan=function(t,u){return this.major<t||t===this.major&&this.minor<u};g.since=function(t,u){return!this.lessThan(t,u)};g.validate=function(t){if(this.major!==t.major)throw new b((this._context&&this._context+
":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t});};g.clone=function(){return new d(this.major,this.minor,this._context)};d.parse=function(t,u=""){const [v,k]=t.split(".");var m=/^\s*\d+\s*$/;if(!v||!v.match||!v.match(m))throw new b((u&&u+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!k||!k.match||!k.match(m))throw new b((u&&u+":")+
"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});t=parseInt(v,10);m=parseInt(k,10);return new d(t,m,u)};return d}();l.Version=a;Object.defineProperty(l,"__esModule",{value:!0})})},"*noref":1}});
define("require ./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./kernel ./Map ./Viewpoint ./core/arrayUtils ./core/Collection ./core/Error ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/MultiOriginJSONSupport ./core/Promise ./core/promiseUtils ./core/reactiveUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./core/accessorSupport/originUtils ./core/accessorSupport/read ./geometry/SpatialReference ./geometry/support/spatialReferenceUtils ./geometry/support/webMercatorUtils ./layers/support/arcgisLayerUrl ./networks/UtilityNetwork ./portal/Portal ./portal/PortalItem ./portal/support/portalItemUtils ./rest/geometryService/project ./rest/support/ProjectParameters ./support/basemapUtils ./support/MapFloorInfo ./webdoc/RangeInfo ./webdoc/Widgets ./webdoc/support/thumbnailUtils ./webdoc/support/writeUtils ./webmap/ApplicationProperties ./webmap/Bookmark ./webmap/InitialViewProperties ./webmap/Version ./webmap/background/ColorBackground".split(" "),function(l,
b,a,d,g,t,u,v,k,m,f,n,y,w,q,B,C,r,A,E,J,z,H,G,D,M,N,P,Q,ha,ia,U,aa,K,ba,ca,Y,ja,da,ka,la,ma,na,oa,V,R,ea){const W=new R.Version(2,24),fa=v.ofType(oa);v=v.ofType(ia);const X=n.getLogger("esri.WebMap"),S=new Map;S.set("image/jpeg","jpeg");S.set("image/jpg","jpg");S.set("image/png","png");S.set("image/gif","gif");const pa="NatGeo_World_Map Ocean_Basemap USA_Topo_Maps World_Imagery World_Street_Map World_Terrain_Base World_Topo_Map World_Hillshade Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Reference_Overlay Reference/World_Transportation".split(" ").map(O=>
O.toLowerCase());g=function(O){function T(c){c=O.call(this,c)||this;c.applicationProperties=null;c.bookmarks=new fa;c.floorInfo=null;c.initialViewProperties=new V;c.portalItem=null;c.presentation=null;c.sourceVersion=null;c.widgets=null;c.utilityNetworks=null;c.authoringApp=c.authoringAppVersion=null;c._isAuthoringAppSetByUser=c._isAuthoringAppVersionSetByUser=!1;return c}b._inheritsLoose(T,O);var x=T.prototype;x.destroy=function(){const c=this.portalItem;this.portalItem=null;null==c?void 0:c.destroy()};
x.initialize=function(){this.when().catch(c=>{X.error("#load()","Failed to load web map",c)});if(this.resourceInfo){let c;try{c=this._validateJSON(this.resourceInfo)}catch(e){this.addResolvingPromise(Promise.reject(e));return}this.read(c)}};x.writeAuthoringApp=function(c,e){e.authoringApp=c&&this._isAuthoringAppSetByUser?c:"ArcGIS API for JavaScript"};x.writeAuthoringAppVersion=function(c,e){e.authoringAppVersion=c&&this._isAuthoringAppVersionSetByUser?c:d.version};x.readInitialViewProperties=function(c,
e){var h;c=new V;e.background&&(c.background=ea.fromJSON(e.background));const p=null==(h=e.initialState)?void 0:h.viewpoint;p&&(p.rotation&&R.Version.parse(e.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===e.authoringApp&&(p.rotation*=-1),c.viewpoint=t.fromJSON(p));e.mapRangeInfo&&(c.rangeInfo=da.fromJSON(e.mapRangeInfo));e.spatialReference&&(c.spatialReference=N.fromJSON(e.spatialReference));return c};x.writeInitialViewProperties=function(c,e,h,p){c&&((h=c.background)&&h.color&&(e.background=
h.write({},p)),c.viewpoint&&(e.initialState={viewpoint:c.viewpoint.write({},p)}),c.rangeInfo&&(e.mapRangeInfo=c.rangeInfo.toJSON(p)),c.spatialReference&&(e.spatialReference=c.spatialReference.write({},p)))};x.writeLayers=function(c,e,h,p){e[h]=this._writeLayers(c,p,"operational-layers")};x.readSourceVersion=function(c,e){const [h,p]=e.version.split(".");return new R.Version(parseInt(h,10),parseInt(p,10))};x.writeSourceVersion=function(c,e,h){e[h]=`${W.major}.${W.minor}`};x.writeTables=function(c,
e,h,p){c=this._writeLayers(c,p,"tables");c.length&&(e[h]=c)};x.load=function(c){this.addResolvingPromise(this._loadFromSource());return Promise.resolve(this)};x.loadAll=function(){return f.loadAll(this,c=>{c(this.ground,this.basemap,this.layers,this.tables)})};x.read=function(c,e){e={...e,origin:"web-map"};const h=this._getAuthoringPropsState();M.readLoadable(this,c,p=>O.prototype.read.call(this,c,p),e);this._restoreAuthoringPropsFromState(h)};x.write=function(c,e){if("loaded"!==this.loadStatus)throw c=
new k("webmap:not-loaded","Web map must be loaded before it can be serialized"),X.error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),c;this._removeDanglingLayerRefs();e={...e,origin:"web-map",restrictedWebMapWriting:!0,webmap:this};return O.prototype.write.call(this,c,e)};x.save=function(){var c=b._asyncToGenerator(function*(e){e=e||{};this._validateItem();yield this._updateFromPromise;yield this.load();yield this._loadLayerContainers();yield this._beforeSave();
yield this._validateMap();const h=this.portalItem,p={origin:"web-map",messages:[],writtenProperties:[],url:h.itemUrl&&r.urlToObject(h.itemUrl),portal:h.portal||U.getDefault()},F=this.write({},p);this._validateJSONForWriting(p,e);yield this._updateItemProperties(h);yield this._updateItem(h,F,p);yield this._updateItemThumbnail();return h});return function(e){return c.apply(this,arguments)}}();x.saveAs=function(){var c=b._asyncToGenerator(function*(e,h){h=h||{};e=this._getPortalItem(e);yield this._updateFromPromise;
yield this.load();yield this._loadLayerContainers();yield this._beforeSave();yield this._validateMap();const p={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:e.portal},F=this.write({},p);this._validateJSONForWriting(p,h);yield this._updateItemPropertiesForSaveAs(e);const I=this._getThumbnailState();yield this._createItem(e,F,p,h);this._restoreThumbnailFromState(I);yield this._updateItemThumbnail();return e});return function(e,h){return c.apply(this,arguments)}}();x.updateFrom=
function(){var c=b._asyncToGenerator(function*(e,h){this._updateFromPromise=e=this._updateFromInternal(e,h);yield e;e===this._updateFromPromise&&(this._updateFromPromise=null)});return function(e,h){return c.apply(this,arguments)}}();x.getLayerJSONFromResourceInfo=function(c){var e,h,p,F;const I=this.resourceInfo;return this._collectAllLayersJSON(u.flatten([null==I?void 0:null==(e=I.baseMap)?void 0:e.baseMapLayers,null==I?void 0:I.operationalLayers,null==(h=this.basemap)?void 0:null==(p=h.resourceInfo)?
void 0:null==(F=p.data)?void 0:F.baseMapLayers])).find(L=>L.id===c.id)};x._collectAllLayersJSON=function(c){return c.reduce((e,h)=>{e.push(h);"GroupLayer"===h.layerType&&(e=e.concat(this._collectAllLayersJSON(h.layers||[])));return e},[])};x._writeLayers=function(c,e,h){e={...e,layerContainerType:h};return c.map(p=>y.unwrap(ma.getLayerJSON(p,"tables"===h?null:this.getLayerJSONFromResourceInfo(p),e))).filter(Boolean).toArray()};x._loadFromSource=function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,
{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)};x._loadFromItem=function(c){return c.load().catch(e=>{throw new k("webmap:load-portal-item","Failed to load portal item",{error:e});}).then(()=>{if("Web Map"!==c.type)throw new k("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:c.type});}).then(()=>c.fetchData()).then(e=>{this.resourceInfo=e;return this._readAndLoadFromJSON(e,{origin:"web-map",
portal:c.portal||U.getDefault()})}).then(()=>this._computeInitialViewpoint())};x._readAndLoadFromJSON=function(c,e){c=this._validateJSON(c);this.read(c,e);return this._loadFromJSON(c,e)};x._validateJSON=function(c){const e=R.Version.parse(c.version||"","webmap");W.validate(e);c.version=`${e.major}.${e.minor}`;return c};x._loadFromJSON=function(c,e){const h={context:{...e,layerContainerType:"operational-layers"}};this.portalItem&&(h.context.portal=this.portalItem.portal||U.getDefault());return(new Promise((p,
F)=>l(["./layers/support/layersCreator"],p,F))).then(({populateOperationalLayers:p})=>{const F=[];var I=c.operationalLayers;I&&I.length&&F.push(p(this.layers,I,h));I={...h,context:{...h.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"};const L=c.tables;L&&L.length&&F.push(p(this.tables,L,I));return B.eachAlways(F).then(()=>{})})};x._computeInitialViewpoint=function(){var c=b._asyncToGenerator(function*(){var e,h;let p=this.initialViewProperties;!(null==(e=p)?0:null==(h=e.viewpoint)?
0:h.targetGeometry)&&(e=yield this._getExtentFromItem())&&(p=p?p.clone():new V,p.viewpoint=new t,p.viewpoint.targetGeometry=e,this.initialViewProperties=p)});return function(){return c.apply(this,arguments)}}();x._getExtentFromItem=function(){var c=b._asyncToGenerator(function*(){var e,h;const p=null==(e=this.initialViewProperties)?void 0:e.spatialReference,F=null==(h=this.portalItem)?void 0:h.extent;return p&&F?p.isWGS84?F.clone():p.isWebMercator?Q.geographicToWebMercator(F):(yield new Promise((I,
L)=>l(["./portal/support/geometryServiceUtils"],I,L))).getGeometryServiceURL(this.portalItem).then(I=>{const L=new ca;L.geometries=[F];L.outSpatialReference=p;return ba.project(I,L)}).then(I=>I[0]).catch(I=>{X.error("Error projecting item's extent:",I);return null}):null});return function(){return c.apply(this,arguments)}}();x._removeDanglingLayerRefs=function(){var c=this.applicationProperties,e=c&&c.viewing&&c.viewing.search;const h=p=>!!this.allLayers.find(F=>F.id===p);e&&e.layers&&(e.layers=e.layers.filter(p=>
h(p.id)));e&&e.tables&&(e.tables=e.tables.filter(p=>!!this.tables.find(F=>F.id===p.id)));(e=c&&c.editing&&c.editing.locationTracking)&&e.info&&!h(e.info.layerId)&&(c.editing=null);(c=this.presentation&&this.presentation.slides)&&c.forEach(p=>{p.visibleLayers&&(p.visibleLayers=p.visibleLayers.filter(F=>h(F.id)))})};x._validateMap=function(){var c=b._asyncToGenerator(function*(){var e;if(null==(e=this.basemap)||!e.baseLayers.length)throw new k("webmap:save","Map does not have a valid basemap with a base layer.");
let h=null;yield C.whenOnce(()=>{const p=Y.findSpatialReference(this.initialViewProperties,this.basemap);h=p.spatialReference;return!p.updating});if(!P.equals(h,this.initialViewProperties.spatialReference))throw new k("webmap:save","The spatial reference of the basemap is not compatible with the one from the map.",{expected:this.initialViewProperties.spatialReference,actual:h});});return function(){return c.apply(this,arguments)}}();x._validateItem=function(){if(!this.portalItem)throw X.error("save: requires the portalItem property to be set"),
new k("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)};x._validateItemType=function(c){if("Web Map"!==c.type)throw new k("webmap:portal-item-wrong-type",'Portal item needs to have type "Web Map"');};x._loadLayerContainers=function(){const c=[];this.basemap&&c.push(this.basemap.load());this.ground&&c.push(this.ground.load());return B.eachAlways(c).then(()=>{})};x._beforeSave=function(){var c=b._asyncToGenerator(function*(){const e=
[];for(const h of this.allLayers)if("beforeSave"in h&&"function"===typeof h.beforeSave){const p=h.beforeSave();p&&e.push(p)}yield B.eachAlways(e)});return function(){return c.apply(this,arguments)}}();x._loadAllLayers=function(){const c=this._getAllLayersAndTables().map(e=>e.load());return B.eachAlways(c).then(()=>{})};x._getAllLayersAndTables=function(){return this.allLayers.concat(this.allTables)};x._validateJSONForWriting=function(c,e){c=c.messages.filter(h=>"error"===h.type).map(h=>new k(h.name,
h.message,h.details));e.ignoreUnsupported&&(c=c.filter(h=>"layer:unsupported"!==h.name&&"symbol:unsupported"!==h.name&&"symbol-layer:unsupported"!==h.name&&"property:unsupported"!==h.name&&"url:unsupported"!==h.name));if(0<c.length)throw new k("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:c});};x._updateItemProperties=function(){var c=b._asyncToGenerator(function*(e){e.extent=yield this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry);
yield this._updateTypeKeywords(e)});return function(e){return c.apply(this,arguments)}}();x._updateItemPropertiesForSaveAs=function(){var c=b._asyncToGenerator(function*(e){K.removeTypeKeyword(e,"CollectorDisabled");K.removeTypeKeyword(e,"OfflineDisabled");K.removeTypeKeyword(e,"Workforce Project");K.removeTypeKeyword(e,"Workforce Worker");K.removeTypeKeyword(e,"Workforce Dispatcher");K.removeTypeKeyword(e,"Offline Map Areas");K.removeTypeKeyword(e,"FieldMapsDisabled");yield this._updateItemProperties(e)});
return function(e){return c.apply(this,arguments)}}();x._getWGS84Extent=function(){var c=b._asyncToGenerator(function*(e){e=e.clone().normalize();let h;if(1<e.length)for(const p of e)h?p.width>h.width&&(h=p):h=p;else h=e[0];return this._projectToWGS84(h)});return function(e){return c.apply(this,arguments)}}();x._projectToWGS84=function(){var c=b._asyncToGenerator(function*(e){var h=e.spatialReference;if(h.isWGS84)return e.clone();if(h.isWebMercator)return Q.webMercatorToGeographic(e);h=yield(yield new Promise((F,
I)=>l(["./portal/support/geometryServiceUtils"],F,I))).getGeometryServiceURL(this.portalItem);const p=new ca;p.geometries=[e];p.outSpatialReference=N.WGS84;return(yield ba.project(h,p))[0]});return function(e){return c.apply(this,arguments)}}();x._updateTypeKeywords=function(){var c=b._asyncToGenerator(function*(e){K.addTypeKeyword(e,"ArcGIS API for JavaScript");yield this._loadAllLayers();this._evalCollectorKeyword(e);this._evalDataEditingKeyword(e);this._evalOfflineKeyword(e);this._evalDeveloperBasemapKeyword(e);
e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((h,p,F)=>F.indexOf(h)===p))});return function(e){return c.apply(this,arguments)}}();x._evalCollectorKeyword=function(c){K.hasTypeKeyword(c,"CollectorDisabled")||K.hasTypeKeyword(c,"Workforce Project")||K.hasTypeKeyword(c,"Workforce Worker")||K.hasTypeKeyword(c,"Workforce Dispatcher")||!this._hasEditableFeatureLayer()?K.removeTypeKeyword(c,"Collector"):K.addTypeKeyword(c,"Collector")};x._evalDataEditingKeyword=function(c){this._hasEditableFeatureLayer()?
K.addTypeKeyword(c,"Data Editing"):K.removeTypeKeyword(c,"Data Editing")};x._evalOfflineKeyword=function(c){!K.hasTypeKeyword(c,"OfflineDisabled")&&this._isOfflineCapableMap()?K.addTypeKeyword(c,"Offline"):K.removeTypeKeyword(c,"Offline")};x._evalDeveloperBasemapKeyword=function(c){Y.hasDeveloperBasemapLayer(this.basemap)?K.addTypeKeyword(c,"DeveloperBasemap"):K.removeTypeKeyword(c,"DeveloperBasemap")};x._hasEditableFeatureLayer=function(){return this._getAllLayersAndTables().some(c=>c.loaded&&this._isFeatureServiceLayer(c)&&
c.capabilities.operations.supportsEditing&&c.editingEnabled)};x._isFeatureServiceLayer=function(c){return!("feature"!==c.type||!c.source||"feature-layer"!==c.source.type)};x._isOfflineCapableMap=function(){return this._getAllLayersAndTables().filter(c=>"group"!==c.type).every(c=>c.loaded&&this._isOfflineCapableLayer(c))};x._isOfflineCapableLayer=function(c){return this._isFeatureServiceLayer(c)&&c.capabilities.operations.supportsSync||("tile"===c.type||"vector-tile"===c.type)&&(c.capabilities.operations.supportsExportTiles||
this._isExportableAGOLTileLayer(c)||Y.isDeveloperBasemapLayer(c))&&c.spatialReference.equals(this.initialViewProperties.spatialReference)};x._isExportableAGOLTileLayer=function(c){return"tile"===c.type?ha.isServerOrServicesAGOLUrl(c.url)&&pa.some(e=>-1<c.url.toLowerCase().indexOf("/"+e+"/")):!1};x._updateItem=function(){var c=b._asyncToGenerator(function*(e,h,p){yield e.update({data:h});this._syncUpInstanceWithItem(e,h,p)});return function(e,h,p){return c.apply(this,arguments)}}();x._createItem=function(){var c=
b._asyncToGenerator(function*(e,h,p,F){const I=this.portalItem,L=!!(I&&I.id&&I.portal.user),Z=e.portal;yield Z._signIn();if(!(yield this._canCopyItem(I,L,Z)))throw new k("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");yield Z.user.addItem({item:e,folder:F.folder,data:h});this.portalItem=e;this._syncUpInstanceWithItem(e,h,p)});return function(e,h,p,F){return c.apply(this,arguments)}}();x._canCopyItem=function(){var c=b._asyncToGenerator(function*(e,h,p){if(y.isSome(e)&&
e.id&&e.typeKeywords&&-1<e.typeKeywords.indexOf("useOnly")){if(e.portal.portalHostname!==p.portalHostname)return!1;h||(yield e.reload());return"admin"===e.itemControl||"update"===e.itemControl}return!0});return function(e,h,p){return c.apply(this,arguments)}}();x._syncUpInstanceWithItem=function(c,e,h){w.MultiOriginJSONSupport.prototype.read.call(this,{version:e.version,authoringApp:e.authoringApp,authoringAppVersion:e.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:c.itemUrl&&r.urlToObject(c.itemUrl)});
D.updateOrigins(h);this.resourceInfo=e};x._updateItemThumbnail=function(){var c=b._asyncToGenerator(function*(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(yield this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())});return function(){return c.apply(this,arguments)}}();x._getPortalItem=function(c){c=aa.from(c);c.id&&(c=c.clone(),c.id=null);c.type||(c.type="Web Map");c.portal||(c.portal=U.getDefault());this._validateItemType(c);
return c};x._updateFromInternal=function(){var c=b._asyncToGenerator(function*(e,h){h=h||{};yield C.whenOnce(()=>e.ready);this._updateInitialViewProperties(e,h);if(e.map===this)for(const p of e.allLayerViews)for(const F of["visible","featureEffect"])F in p&&F in p.layer&&p._isOverridden(F)&&(p.layer[F]=p[F]);yield this._updateThumbnailUrl(e,h)});return function(e,h){return c.apply(this,arguments)}}();x._updateInitialViewProperties=function(c,e){if(!e.backgroundExcluded){var h;this.initialViewProperties.background=
null==(h=c.background)?void 0:h.clone()}this.initialViewProperties.spatialReference=c.spatialReference.clone();e.viewpointExcluded||(this.initialViewProperties.viewpoint=new t({rotation:c.rotation,scale:e.scalePreserved?c.scale:null,targetGeometry:this._getViewExtent(c)}));if(!e.widgetsExcluded)for(const p of c.persistableViewModels)p.updateWebDocument(this)};x._getViewExtent=function(c){const e=c.center.clone().normalize();c=c.extent.clone();const h=c.width/2;c.xmin=e.x-h;c.xmax=e.x+h;return c};
x._updateThumbnailUrl=function(){var c=b._asyncToGenerator(function*(e,h){h.thumbnailExcluded||(h=la.getOptimalThumbnailSize(e,h.thumbnailSize),e=yield e.takeScreenshot({format:"png",width:h.width,height:h.height}),this._setAutoGeneratedThumbnail(e.dataUrl))});return function(e,h){return c.apply(this,arguments)}}();x._setAutoGeneratedThumbnail=function(c){this.thumbnailUrl=c;this._thumbnailFilename=null};x._clearThumbnailOverride=function(){this._clearOverride("thumbnailUrl");this.clear("thumbnailUrl",
"user");this._thumbnailFilename=null};x._generateCustomThumbnailFilename=function(c){if(r.isDataProtocol(c)){c=(c=(c=r.dataComponents(c))&&c.mediaType)&&S.get(c.toLowerCase())||null;const e=`thumbnail${Date.now()}`;return c?`${e}.${c}`:e}return null};x._getThumbnailState=function(){let c=this.thumbnailUrl;c&&(c=this._isOverridden("thumbnailUrl")?c:r.addQueryParameter(c,"w","8192"));return{thumbnailUrl:c,filename:this._thumbnailFilename}};x._restoreThumbnailFromState=function(c){this.thumbnailUrl=
c.thumbnailUrl;this._thumbnailFilename=c.filename};x._getAuthoringPropsState=function(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}};x._restoreAuthoringPropsFromState=function(c){c.isAuthoringAppSetByUser?this.authoringApp=c.authoringApp:this._isAuthoringAppSetByUser=!1;c.isAuthoringAppVersionSetByUser?this.authoringAppVersion=c.authoringAppVersion:
this._isAuthoringAppVersionSetByUser=!1};T.fromJSON=function(c){if(!c)throw new k("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:c})};b._createClass(T,[{key:"authoringApp",set:function(c){this._isAuthoringAppSetByUser=!0;this._set("authoringApp",c)}},{key:"authoringAppVersion",set:function(c){this._isAuthoringAppVersionSetByUser=!0;this._set("authoringAppVersion",c)}},{key:"thumbnailUrl",get:function(){return this.portalItem&&this.portalItem.thumbnailUrl||
null},set:function(c){c?(this._override("thumbnailUrl",c),this._thumbnailFilename=this._generateCustomThumbnailFilename(c)):this._clearThumbnailOverride()}}]);return T}(w.MultiOriginJSONMixin(m.LoadableMixin(q.EsriPromiseMixin(g))));g.VERSION=W;a.__decorate([A.property({type:na,json:{write:!0}})],g.prototype,"applicationProperties",void 0);a.__decorate([A.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],g.prototype,"authoringApp",null);a.__decorate([G.writer("authoringApp")],g.prototype,
"writeAuthoringApp",null);a.__decorate([A.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],g.prototype,"authoringAppVersion",null);a.__decorate([G.writer("authoringAppVersion")],g.prototype,"writeAuthoringAppVersion",null);a.__decorate([A.property({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],g.prototype,"basemap",void 0);a.__decorate([A.property({type:fa,json:{write:{overridePolicy(O){return{enabled:!!(O&&0<O.length),ignoreOrigin:!0}}}}})],g.prototype,"bookmarks",
void 0);a.__decorate([A.property({type:ja,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],g.prototype,"floorInfo",void 0);a.__decorate([A.property({type:V,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:ea},"initialState.viewpoint":{type:t},mapRangeInfo:{type:da},spatialReference:{type:N}}}}})],g.prototype,"initialViewProperties",void 0);a.__decorate([z.reader("initialViewProperties")],
g.prototype,"readInitialViewProperties",null);a.__decorate([G.writer("initialViewProperties")],g.prototype,"writeInitialViewProperties",null);a.__decorate([A.property({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],g.prototype,"layers",void 0);a.__decorate([G.writer("layers")],g.prototype,"writeLayers",null);a.__decorate([A.property({type:aa})],g.prototype,"portalItem",void 0);a.__decorate([A.property({json:{write:!0}})],g.prototype,"presentation",void 0);a.__decorate([A.property()],
g.prototype,"resourceInfo",void 0);a.__decorate([A.property({readOnly:!0,type:R.Version,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],g.prototype,"sourceVersion",void 0);a.__decorate([z.reader("sourceVersion")],g.prototype,"readSourceVersion",null);a.__decorate([G.writer("sourceVersion")],g.prototype,"writeSourceVersion",null);a.__decorate([A.property({json:{read:!1,write:{ignoreOrigin:!0}}})],g.prototype,"tables",void 0);a.__decorate([G.writer("tables")],
g.prototype,"writeTables",null);a.__decorate([A.property()],g.prototype,"thumbnailUrl",null);a.__decorate([A.property({type:ka,json:{write:!0}})],g.prototype,"widgets",void 0);a.__decorate([A.property({type:v,json:{read:!0,write:!0}})],g.prototype,"utilityNetworks",void 0);return g=a.__decorate([H.subclass("esri.WebMap")],g)});